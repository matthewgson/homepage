<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Matthew Son: Cookbook for R</title>

<meta property="description" itemprop="description" content="My R/Python Code cookbook"/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-08-27"/>
<meta property="article:created" itemprop="dateCreated" content="2022-08-27"/>
<meta name="article:author" content="Matthew Son"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Matthew Son: Cookbook for R"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="My R/Python Code cookbook"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Matthew Son"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="Matthew Son: Cookbook for R"/>
<meta property="twitter:description" content="My R/Python Code cookbook"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","output","params","date"]}},"value":[{"type":"character","attributes":{},"value":["Cookbook for R"]},{"type":"character","attributes":{},"value":["My R/Python Code cookbook"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Matthew Son"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_float","number_sections","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]}]}]},{"type":"character","attributes":{},"value":["HOHO"]},{"type":"character","attributes":{},"value":["08-27-2022"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"list","attributes":{},"value":[]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
        var fn = $(this).children()[0]
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */


@import url('https://fonts.googleapis.com/css2?family=Open+Sans&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Roboto+Slab&family=Salsa&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Salsa&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Crimson+Text&family=Playfair+Display&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Crimson+Text&family=Lora&family=Playfair+Display&display=swap');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    "Playfair Display";
  --mono-font:       monospace;
  --body-font:       "Crimson Text"; /*sans-serif;*/
  --navbar-font:     "Lora"; /*sans-serif;*/  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
  <script>/*! jQuery v3.6.0 | (c) OpenJS Foundation and other contributors | jquery.org/license */
!function(e,t){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(C,e){"use strict";var t=[],r=Object.getPrototypeOf,s=t.slice,g=t.flat?function(e){return t.flat.call(e)}:function(e){return t.concat.apply([],e)},u=t.push,i=t.indexOf,n={},o=n.toString,v=n.hasOwnProperty,a=v.toString,l=a.call(Object),y={},m=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},x=function(e){return null!=e&&e===e.window},E=C.document,c={type:!0,src:!0,nonce:!0,noModule:!0};function b(e,t,n){var r,i,o=(n=n||E).createElement("script");if(o.text=e,t)for(r in c)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function w(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[o.call(e)]||"object":typeof e}var f="3.6.0",S=function(e,t){return new S.fn.init(e,t)};function p(e){var t=!!e&&"length"in e&&e.length,n=w(e);return!m(e)&&!x(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}S.fn=S.prototype={jquery:f,constructor:S,length:0,toArray:function(){return s.call(this)},get:function(e){return null==e?s.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=S.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return S.each(this,e)},map:function(n){return this.pushStack(S.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(s.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(S.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(S.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:u,sort:t.sort,splice:t.splice},S.extend=S.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||m(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(S.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?[]:i||S.isPlainObject(n)?n:{},i=!1,a[t]=S.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},S.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==o.call(e))&&(!(t=r(e))||"function"==typeof(n=v.call(t,"constructor")&&t.constructor)&&a.call(n)===l)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){b(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(p(e)){for(n=e.length;r<n;r++)if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(p(Object(e))?S.merge(n,"string"==typeof e?[e]:e):u.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:i.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(p(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,support:y}),"function"==typeof Symbol&&(S.fn[Symbol.iterator]=t[Symbol.iterator]),S.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var d=function(n){var e,d,b,o,i,h,f,g,w,u,l,T,C,a,E,v,s,c,y,S="sizzle"+1*new Date,p=n.document,k=0,r=0,m=ue(),x=ue(),A=ue(),N=ue(),j=function(e,t){return e===t&&(l=!0),0},D={}.hasOwnProperty,t=[],q=t.pop,L=t.push,H=t.push,O=t.slice,P=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",M="[\\x20\\t\\r\\n\\f]",I="(?:\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",W="\\["+M+"*("+I+")(?:"+M+"*([*^$|!~]?=)"+M+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+I+"))|)"+M+"*\\]",F=":("+I+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+W+")*)|.*)\\)|)",B=new RegExp(M+"+","g"),$=new RegExp("^"+M+"+|((?:^|[^\\\\])(?:\\\\.)*)"+M+"+$","g"),_=new RegExp("^"+M+"*,"+M+"*"),z=new RegExp("^"+M+"*([>+~]|"+M+")"+M+"*"),U=new RegExp(M+"|>"),X=new RegExp(F),V=new RegExp("^"+I+"$"),G={ID:new RegExp("^#("+I+")"),CLASS:new RegExp("^\\.("+I+")"),TAG:new RegExp("^("+I+"|[*])"),ATTR:new RegExp("^"+W),PSEUDO:new RegExp("^"+F),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+M+"*(even|odd|(([+-]|)(\\d*)n|)"+M+"*(?:([+-]|)"+M+"*(\\d+)|))"+M+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+M+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+M+"*((?:-\\d)?\\d*)"+M+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+M+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},oe=function(){T()},ae=be(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{H.apply(t=O.call(p.childNodes),p.childNodes),t[p.childNodes.length].nodeType}catch(e){H={apply:t.length?function(e,t){L.apply(e,O.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}function se(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(T(e),e=e||C,E)){if(11!==p&&(u=Z.exec(t)))if(i=u[1]){if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return n.push(a),n}else if(f&&(a=f.getElementById(i))&&y(e,a)&&a.id===i)return n.push(a),n}else{if(u[2])return H.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&d.getElementsByClassName&&e.getElementsByClassName)return H.apply(n,e.getElementsByClassName(i)),n}if(d.qsa&&!N[t+" "]&&(!v||!v.test(t))&&(1!==p||"object"!==e.nodeName.toLowerCase())){if(c=t,f=e,1===p&&(U.test(t)||z.test(t))){(f=ee.test(t)&&ye(e.parentNode)||e)===e&&d.scope||((s=e.getAttribute("id"))?s=s.replace(re,ie):e.setAttribute("id",s=S)),o=(l=h(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+xe(l[o]);c=l.join(",")}try{return H.apply(n,f.querySelectorAll(c)),n}catch(e){N(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return g(t.replace($,"$1"),e,n,r)}function ue(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],e[t+" "]=n}}function le(e){return e[S]=!0,e}function ce(e){var t=C.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function fe(e,t){var n=e.split("|"),r=n.length;while(r--)b.attrHandle[n[r]]=t}function pe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function de(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function he(n){return function(e){var t=e.nodeName.toLowerCase();return("input"===t||"button"===t)&&e.type===n}}function ge(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&ae(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ve(a){return le(function(o){return o=+o,le(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function ye(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}for(e in d=se.support={},i=se.isXML=function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},T=se.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:p;return r!=C&&9===r.nodeType&&r.documentElement&&(a=(C=r).documentElement,E=!i(C),p!=C&&(n=C.defaultView)&&n.top!==n&&(n.addEventListener?n.addEventListener("unload",oe,!1):n.attachEvent&&n.attachEvent("onunload",oe)),d.scope=ce(function(e){return a.appendChild(e).appendChild(C.createElement("div")),"undefined"!=typeof e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),d.attributes=ce(function(e){return e.className="i",!e.getAttribute("className")}),d.getElementsByTagName=ce(function(e){return e.appendChild(C.createComment("")),!e.getElementsByTagName("*").length}),d.getElementsByClassName=K.test(C.getElementsByClassName),d.getById=ce(function(e){return a.appendChild(e).id=S,!C.getElementsByName||!C.getElementsByName(S).length}),d.getById?(b.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(te,ne);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&E){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&n.value===e)return[o]}return[]}}),b.find.TAG=d.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):d.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);if("*"===e){while(n=o[i++])1===n.nodeType&&r.push(n);return r}return o},b.find.CLASS=d.getElementsByClassName&&function(e,t){if("undefined"!=typeof t.getElementsByClassName&&E)return t.getElementsByClassName(e)},s=[],v=[],(d.qsa=K.test(C.querySelectorAll))&&(ce(function(e){var t;a.appendChild(e).innerHTML="<a id='"+S+"'></a><select id='"+S+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&v.push("[*^$]="+M+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||v.push("\\["+M+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+S+"-]").length||v.push("~="),(t=C.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||v.push("\\["+M+"*name"+M+"*="+M+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||v.push(":checked"),e.querySelectorAll("a#"+S+"+*").length||v.push(".#.+[+~]"),e.querySelectorAll("\\\f"),v.push("[\\r\\n\\f]")}),ce(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=C.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&v.push("name"+M+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&v.push(":enabled",":disabled"),a.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(d.matchesSelector=K.test(c=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.msMatchesSelector))&&ce(function(e){d.disconnectedMatch=c.call(e,"*"),c.call(e,"[s!='']:x"),s.push("!=",F)}),v=v.length&&new RegExp(v.join("|")),s=s.length&&new RegExp(s.join("|")),t=K.test(a.compareDocumentPosition),y=t||K.test(a.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},j=t?function(e,t){if(e===t)return l=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!d.sortDetached&&t.compareDocumentPosition(e)===n?e==C||e.ownerDocument==p&&y(p,e)?-1:t==C||t.ownerDocument==p&&y(p,t)?1:u?P(u,e)-P(u,t):0:4&n?-1:1)}:function(e,t){if(e===t)return l=!0,0;var n,r=0,i=e.parentNode,o=t.parentNode,a=[e],s=[t];if(!i||!o)return e==C?-1:t==C?1:i?-1:o?1:u?P(u,e)-P(u,t):0;if(i===o)return pe(e,t);n=e;while(n=n.parentNode)a.unshift(n);n=t;while(n=n.parentNode)s.unshift(n);while(a[r]===s[r])r++;return r?pe(a[r],s[r]):a[r]==p?-1:s[r]==p?1:0}),C},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(T(e),d.matchesSelector&&E&&!N[t+" "]&&(!s||!s.test(t))&&(!v||!v.test(t)))try{var n=c.call(e,t);if(n||d.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){N(t,!0)}return 0<se(t,C,null,[e]).length},se.contains=function(e,t){return(e.ownerDocument||e)!=C&&T(e),y(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=C&&T(e);var n=b.attrHandle[t.toLowerCase()],r=n&&D.call(b.attrHandle,t.toLowerCase())?n(e,t,!E):void 0;return void 0!==r?r:d.attributes||!E?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},se.escape=function(e){return(e+"").replace(re,ie)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,n=[],r=0,i=0;if(l=!d.detectDuplicates,u=!d.sortStable&&e.slice(0),e.sort(j),l){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)e.splice(n[r],1)}return u=null,e},o=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else while(t=e[r++])n+=o(t);return n},(b=se.selectors={cacheLength:50,createPseudo:le,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return G.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&X.test(n)&&(t=h(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=m[e+" "];return t||(t=new RegExp("(^|"+M+")"+e+"("+M+"|$)"))&&m(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,r,i){return function(e){var t=se.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(B," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(h,e,t,g,v){var y="nth"!==h.slice(0,3),m="last"!==h.slice(-4),x="of-type"===e;return 1===g&&0===v?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u,l=y!==m?"nextSibling":"previousSibling",c=e.parentNode,f=x&&e.nodeName.toLowerCase(),p=!n&&!x,d=!1;if(c){if(y){while(l){a=e;while(a=a[l])if(x?a.nodeName.toLowerCase()===f:1===a.nodeType)return!1;u=l="only"===h&&!u&&"nextSibling"}return!0}if(u=[m?c.firstChild:c.lastChild],m&&p){d=(s=(r=(i=(o=(a=c)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1])&&r[2],a=s&&c.childNodes[s];while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if(1===a.nodeType&&++d&&a===e){i[h]=[k,s,d];break}}else if(p&&(d=s=(r=(i=(o=(a=e)[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]||[])[0]===k&&r[1]),!1===d)while(a=++s&&a&&a[l]||(d=s=0)||u.pop())if((x?a.nodeName.toLowerCase()===f:1===a.nodeType)&&++d&&(p&&((i=(o=a[S]||(a[S]={}))[a.uniqueID]||(o[a.uniqueID]={}))[h]=[k,d]),a===e))break;return(d-=v)===g||d%g==0&&0<=d/g}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?le(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=P(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:le(function(e){var r=[],i=[],s=f(e.replace($,"$1"));return s[S]?le(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:le(function(t){return function(e){return 0<se(t,e).length}}),contains:le(function(t){return t=t.replace(te,ne),function(e){return-1<(e.textContent||o(e)).indexOf(t)}}),lang:le(function(n){return V.test(n||"")||se.error("unsupported lang: "+n),n=n.replace(te,ne).toLowerCase(),function(e){var t;do{if(t=E?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=t.toLowerCase())===n||0===t.indexOf(n+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=n.location&&n.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===a},focus:function(e){return e===C.activeElement&&(!C.hasFocus||C.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return J.test(e.nodeName)},input:function(e){return Q.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:ve(function(){return[0]}),last:ve(function(e,t){return[t-1]}),eq:ve(function(e,t,n){return[n<0?n+t:n]}),even:ve(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:ve(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:ve(function(e,t,n){for(var r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:ve(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=de(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=he(e);function me(){}function xe(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function be(s,e,t){var u=e.dir,l=e.next,c=l||u,f=t&&"parentNode"===c,p=r++;return e.first?function(e,t,n){while(e=e[u])if(1===e.nodeType||f)return s(e,t,n);return!1}:function(e,t,n){var r,i,o,a=[k,p];if(n){while(e=e[u])if((1===e.nodeType||f)&&s(e,t,n))return!0}else while(e=e[u])if(1===e.nodeType||f)if(i=(o=e[S]||(e[S]={}))[e.uniqueID]||(o[e.uniqueID]={}),l&&l===e.nodeName.toLowerCase())e=e[u]||e;else{if((r=i[c])&&r[0]===k&&r[1]===p)return a[2]=r[2];if((i[c]=a)[2]=s(e,t,n))return!0}return!1}}function we(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,t,n))return!1;return!0}:i[0]}function Te(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function Ce(d,h,g,v,y,e){return v&&!v[S]&&(v=Ce(v)),y&&!y[S]&&(y=Ce(y,e)),le(function(e,t,n,r){var i,o,a,s=[],u=[],l=t.length,c=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)se(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),f=!d||!e&&h?c:Te(c,s,d,n,r),p=g?y||(e?d:l||v)?[]:t:f;if(g&&g(f,p,n,r),v){i=Te(p,u),v(i,[],n,r),o=i.length;while(o--)(a=i[o])&&(p[u[o]]=!(f[u[o]]=a))}if(e){if(y||d){if(y){i=[],o=p.length;while(o--)(a=p[o])&&i.push(f[o]=a);y(null,p=[],i,r)}o=p.length;while(o--)(a=p[o])&&-1<(i=y?P(e,a):s[o])&&(e[i]=!(t[i]=a))}}else p=Te(p===t?p.splice(l,p.length):p),y?y(null,t,p,r):H.apply(t,p)})}function Ee(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=be(function(e){return e===i},a,!0),l=be(function(e){return-1<P(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!==w)||((i=t).nodeType?u(e,t,n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[be(we(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return Ce(1<s&&we(c),1<s&&xe(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace($,"$1"),t,s<n&&Ee(e.slice(s,n)),n<r&&Ee(e=e.slice(n)),n<r&&xe(e))}c.push(t)}return we(c)}return me.prototype=b.filters=b.pseudos,b.setFilters=new me,h=se.tokenize=function(e,t){var n,r,i,o,a,s,u,l=x[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=_.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=z.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace($," ")}),a=a.slice(n.length)),b.filter)!(r=G[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?se.error(e):x(e,s).slice(0)},f=se.compile=function(e,t){var n,v,y,m,x,r,i=[],o=[],a=A[e+" "];if(!a){t||(t=h(e)),n=t.length;while(n--)(a=Ee(t[n]))[S]?i.push(a):o.push(a);(a=A(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=k+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==C||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==C||(T(o),n=!E);while(s=v[a++])if(s(o,t||C,n)){r.push(o);break}i&&(k=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=q.call(r));f=Te(f)}H.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&se.uniqueSort(r)}return i&&(k=h,w=p),c},m?le(r):r))).selector=e}return a},g=se.select=function(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&h(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&E&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(te,ne),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=G.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&(r=u(a.matches[0].replace(te,ne),ee.test(o[0].type)&&ye(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&xe(o)))return H.apply(n,r),n;break}}}return(l||f(e,c))(r,t,!E,n,!t||ee.test(e)&&ye(t.parentNode)||t),n},d.sortStable=S.split("").sort(j).join("")===S,d.detectDuplicates=!!l,T(),d.sortDetached=ce(function(e){return 1&e.compareDocumentPosition(C.createElement("fieldset"))}),ce(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||fe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),d.attributes&&ce(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||fe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),ce(function(e){return null==e.getAttribute("disabled")})||fe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(C);S.find=d,S.expr=d.selectors,S.expr[":"]=S.expr.pseudos,S.uniqueSort=S.unique=d.uniqueSort,S.text=d.getText,S.isXMLDoc=d.isXML,S.contains=d.contains,S.escapeSelector=d.escape;var h=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&S(e).is(n))break;r.push(e)}return r},T=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},k=S.expr.match.needsContext;function A(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var N=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(e,n,r){return m(n)?S.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?S.grep(e,function(e){return e===n!==r}):"string"!=typeof n?S.grep(e,function(e){return-1<i.call(n,e)!==r}):S.filter(n,e,r)}S.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?S.find.matchesSelector(r,e)?[r]:[]:S.find.matches(e,S.grep(t,function(e){return 1===e.nodeType}))},S.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(S(e).filter(function(){for(t=0;t<r;t++)if(S.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)S.find(e,i[t],n);return 1<r?S.uniqueSort(n):n},filter:function(e){return this.pushStack(j(this,e||[],!1))},not:function(e){return this.pushStack(j(this,e||[],!0))},is:function(e){return!!j(this,"string"==typeof e&&k.test(e)?S(e):e||[],!1).length}});var D,q=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(S.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||D,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&3<=e.length?[null,e,null]:q.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof S?t[0]:t,S.merge(this,S.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),N.test(r[1])&&S.isPlainObject(t))for(r in t)m(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=E.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):m(e)?void 0!==n.ready?n.ready(e):e(S):S.makeArray(e,this)}).prototype=S.fn,D=S(E);var L=/^(?:parents|prev(?:Until|All))/,H={children:!0,contents:!0,next:!0,prev:!0};function O(e,t){while((e=e[t])&&1!==e.nodeType);return e}S.fn.extend({has:function(e){var t=S(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(S.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&S(e);if(!k.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&S.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(1<o.length?S.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?i.call(S(e),this[0]):i.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(S.uniqueSort(S.merge(this.get(),S(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),S.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return h(e,"parentNode")},parentsUntil:function(e,t,n){return h(e,"parentNode",n)},next:function(e){return O(e,"nextSibling")},prev:function(e){return O(e,"previousSibling")},nextAll:function(e){return h(e,"nextSibling")},prevAll:function(e){return h(e,"previousSibling")},nextUntil:function(e,t,n){return h(e,"nextSibling",n)},prevUntil:function(e,t,n){return h(e,"previousSibling",n)},siblings:function(e){return T((e.parentNode||{}).firstChild,e)},children:function(e){return T(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(A(e,"template")&&(e=e.content||e),S.merge([],e.childNodes))}},function(r,i){S.fn[r]=function(e,t){var n=S.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=S.filter(t,n)),1<this.length&&(H[r]||S.uniqueSort(n),L.test(r)&&n.reverse()),this.pushStack(n)}});var P=/[^\x20\t\r\n\f]+/g;function R(e){return e}function M(e){throw e}function I(e,t,n,r){var i;try{e&&m(i=e.promise)?i.call(e).done(t).fail(n):e&&m(i=e.then)?i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}S.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},S.each(e.match(P)||[],function(e,t){n[t]=!0}),n):S.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){S.each(e,function(e,t){m(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==w(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return S.each(arguments,function(e,t){var n;while(-1<(n=S.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<S.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},S.extend({Deferred:function(e){var o=[["notify","progress",S.Callbacks("memory"),S.Callbacks("memory"),2],["resolve","done",S.Callbacks("once memory"),S.Callbacks("once memory"),0,"resolved"],["reject","fail",S.Callbacks("once memory"),S.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return S.Deferred(function(r){S.each(o,function(e,t){var n=m(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&m(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");t=e&&("object"==typeof e||"function"==typeof e)&&e.then,m(t)?s?t.call(e,l(u,o,R,s),l(u,o,M,s)):(u++,t.call(e,l(u,o,R,s),l(u,o,M,s),l(u,o,R,o.notifyWith))):(a!==R&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){S.Deferred.exceptionHook&&S.Deferred.exceptionHook(e,t.stackTrace),u<=i+1&&(a!==M&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(S.Deferred.getStackHook&&(t.stackTrace=S.Deferred.getStackHook()),C.setTimeout(t))}}return S.Deferred(function(e){o[0][3].add(l(0,e,m(r)?r:R,e.notifyWith)),o[1][3].add(l(0,e,m(t)?t:R)),o[2][3].add(l(0,e,m(n)?n:M))}).promise()},promise:function(e){return null!=e?S.extend(e,a):a}},s={};return S.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=s.call(arguments),o=S.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?s.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(I(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||m(i[t]&&i[t].then)))return o.then();while(t--)I(i[t],a(t),o.reject);return o.promise()}});var W=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;S.Deferred.exceptionHook=function(e,t){C.console&&C.console.warn&&e&&W.test(e.name)&&C.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},S.readyException=function(e){C.setTimeout(function(){throw e})};var F=S.Deferred();function B(){E.removeEventListener("DOMContentLoaded",B),C.removeEventListener("load",B),S.ready()}S.fn.ready=function(e){return F.then(e)["catch"](function(e){S.readyException(e)}),this},S.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--S.readyWait:S.isReady)||(S.isReady=!0)!==e&&0<--S.readyWait||F.resolveWith(E,[S])}}),S.ready.then=F.then,"complete"===E.readyState||"loading"!==E.readyState&&!E.documentElement.doScroll?C.setTimeout(S.ready):(E.addEventListener("DOMContentLoaded",B),C.addEventListener("load",B));var $=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===w(n))for(s in i=!0,n)$(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,m(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(S(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?e:l?t.call(e):u?t(e[0],n):o},_=/^-ms-/,z=/-([a-z])/g;function U(e,t){return t.toUpperCase()}function X(e){return e.replace(_,"ms-").replace(z,U)}var V=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=S.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},V(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[X(t)]=n;else for(r in t)i[X(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][X(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(X):(t=X(t))in r?[t]:t.match(P)||[]).length;while(n--)delete r[t[n]]}(void 0===t||S.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!S.isEmptyObject(t)}};var Y=new G,Q=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:J.test(i)?JSON.parse(i):i)}catch(e){}Q.set(e,t,n)}else n=void 0;return n}S.extend({hasData:function(e){return Q.hasData(e)||Y.hasData(e)},data:function(e,t,n){return Q.access(e,t,n)},removeData:function(e,t){Q.remove(e,t)},_data:function(e,t,n){return Y.access(e,t,n)},_removeData:function(e,t){Y.remove(e,t)}}),S.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=Q.get(o),1===o.nodeType&&!Y.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=X(r.slice(5)),Z(o,r,i[r]));Y.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){Q.set(this,n)}):$(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=Q.get(o,n))?t:void 0!==(t=Z(o,n))?t:void 0;this.each(function(){Q.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){Q.remove(this,e)})}}),S.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=Y.get(e,t),n&&(!r||Array.isArray(n)?r=Y.access(e,t,S.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=S.queue(e,t),r=n.length,i=n.shift(),o=S._queueHooks(e,t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){S.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return Y.get(e,n)||Y.access(e,n,{empty:S.Callbacks("once memory").add(function(){Y.remove(e,[t+"queue",n])})})}}),S.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?S.queue(this[0],t):void 0===n?this:this.each(function(){var e=S.queue(this,t,n);S._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&S.dequeue(this,t)})},dequeue:function(e){return this.each(function(){S.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=S.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=Y.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var ee=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,te=new RegExp("^(?:([+-])=|)("+ee+")([a-z%]*)$","i"),ne=["Top","Right","Bottom","Left"],re=E.documentElement,ie=function(e){return S.contains(e.ownerDocument,e)},oe={composed:!0};re.getRootNode&&(ie=function(e){return S.contains(e.ownerDocument,e)||e.getRootNode(oe)===e.ownerDocument});var ae=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&ie(e)&&"none"===S.css(e,"display")};function se(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return S.css(e,t,"")},u=s(),l=n&&n[3]||(S.cssNumber[t]?"":"px"),c=e.nodeType&&(S.cssNumber[t]||"px"!==l&&+u)&&te.exec(S.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)S.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,S.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ue={};function le(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=Y.get(r,"display")||null,l[c]||(r.style.display="")),""===r.style.display&&ae(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ue[s])||(o=a.body.appendChild(a.createElement(s)),u=S.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ue[s]=u)))):"none"!==n&&(l[c]="none",Y.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}S.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ae(this)?S(this).show():S(this).hide()})}});var ce,fe,pe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;ce=E.createDocumentFragment().appendChild(E.createElement("div")),(fe=E.createElement("input")).setAttribute("type","radio"),fe.setAttribute("checked","checked"),fe.setAttribute("name","t"),ce.appendChild(fe),y.checkClone=ce.cloneNode(!0).cloneNode(!0).lastChild.checked,ce.innerHTML="<textarea>x</textarea>",y.noCloneChecked=!!ce.cloneNode(!0).lastChild.defaultValue,ce.innerHTML="<option></option>",y.option=!!ce.lastChild;var ge={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ve(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&A(e,t)?S.merge([e],n):n}function ye(e,t){for(var n=0,r=e.length;n<r;n++)Y.set(e[n],"globalEval",!t||Y.get(t[n],"globalEval"))}ge.tbody=ge.tfoot=ge.colgroup=ge.caption=ge.thead,ge.th=ge.td,y.option||(ge.optgroup=ge.option=[1,"<select multiple='multiple'>","</select>"]);var me=/<|&#?\w+;/;function xe(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===w(o))S.merge(p,o.nodeType?[o]:o);else if(me.test(o)){a=a||f.appendChild(t.createElement("div")),s=(de.exec(o)||["",""])[1].toLowerCase(),u=ge[s]||ge._default,a.innerHTML=u[1]+S.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;S.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<S.inArray(o,r))i&&i.push(o);else if(l=ie(o),a=ve(f.appendChild(o),"script"),l&&ye(a),n){c=0;while(o=a[c++])he.test(o.type||"")&&n.push(o)}return f}var be=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(e,t){return e===function(){try{return E.activeElement}catch(e){}}()==("focus"===t)}function Ee(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)Ee(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=Te;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return S().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=S.guid++)),e.each(function(){S.event.add(this,t,i,r,n)})}function Se(e,i,o){o?(Y.set(e,i,!1),S.event.add(e,i,{namespace:!1,handler:function(e){var t,n,r=Y.get(this,i);if(1&e.isTrigger&&this[i]){if(r.length)(S.event.special[i]||{}).delegateType&&e.stopPropagation();else if(r=s.call(arguments),Y.set(this,i,r),t=o(this,i),this[i](),r!==(n=Y.get(this,i))||t?Y.set(this,i,!1):n={},r!==n)return e.stopImmediatePropagation(),e.preventDefault(),n&&n.value}else r.length&&(Y.set(this,i,{value:S.event.trigger(S.extend(r[0],S.Event.prototype),r.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===Y.get(e,i)&&S.event.add(e,i,we)}S.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.get(t);if(V(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&S.find.matchesSelector(re,i),n.guid||(n.guid=S.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof S&&S.event.triggered!==e.type?S.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(P)||[""]).length;while(l--)d=g=(s=be.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=S.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=S.event.special[d]||{},c=S.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&S.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),S.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=Y.hasData(e)&&Y.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(P)||[""]).length;while(l--)if(d=g=(s=be.exec(t[l])||[])[1],h=(s[2]||"").split(".").sort(),d){f=S.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||S.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)S.event.remove(e,d+t[l],n,r,!0);S.isEmptyObject(u)&&Y.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=S.event.fix(e),l=(Y.get(this,"events")||Object.create(null))[u.type]||[],c=S.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=S.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((S.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<S(i,this).index(l):S.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(S.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[S.expando]?e:new S.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click",we),!1},trigger:function(e){var t=this||e;return pe.test(t.type)&&t.click&&A(t,"input")&&Se(t,"click"),!0},_default:function(e){var t=e.target;return pe.test(t.type)&&t.click&&A(t,"input")&&Y.get(t,"click")||A(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},S.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},S.Event=function(e,t){if(!(this instanceof S.Event))return new S.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?we:Te,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&S.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[S.expando]=!0},S.Event.prototype={constructor:S.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=we,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=we,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=we,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},S.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},S.event.addProp),S.each({focus:"focusin",blur:"focusout"},function(e,t){S.event.special[e]={setup:function(){return Se(this,e,Ce),!1},trigger:function(){return Se(this,e),!0},_default:function(){return!0},delegateType:t}}),S.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){S.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||S.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),e.type=i),t}}}),S.fn.extend({on:function(e,t,n,r){return Ee(this,e,t,n,r)},one:function(e,t,n,r){return Ee(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,S(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=Te),this.each(function(){S.event.remove(this,e,n,t)})}});var ke=/<script|<style|<link/i,Ae=/checked\s*(?:[^=]|=\s*.checked.)/i,Ne=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function je(e,t){return A(e,"table")&&A(11!==t.nodeType?t:t.firstChild,"tr")&&S(e).children("tbody")[0]||e}function De(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function qe(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Le(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(Y.hasData(e)&&(s=Y.get(e).events))for(i in Y.remove(t,"handle events"),s)for(n=0,r=s[i].length;n<r;n++)S.event.add(t,i,s[i][n]);Q.hasData(e)&&(o=Q.access(e),a=S.extend({},o),Q.set(t,a))}}function He(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=m(d);if(h||1<f&&"string"==typeof d&&!y.checkClone&&Ae.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),He(t,r,i,o)});if(f&&(t=(e=xe(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=S.map(ve(e,"script"),De)).length;c<f;c++)u=e,c!==p&&(u=S.clone(u,!0,!0),s&&S.merge(a,ve(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,S.map(a,qe),c=0;c<s;c++)u=a[c],he.test(u.type||"")&&!Y.access(u,"globalEval")&&S.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?S._evalUrl&&!u.noModule&&S._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):b(u.textContent.replace(Ne,""),u,l))}return n}function Oe(e,t,n){for(var r,i=t?S.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||S.cleanData(ve(r)),r.parentNode&&(n&&ie(r)&&ye(ve(r,"script")),r.parentNode.removeChild(r));return e}S.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=ie(e);if(!(y.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||S.isXMLDoc(e)))for(a=ve(c),r=0,i=(o=ve(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&pe.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||ve(e),a=a||ve(c),r=0,i=o.length;r<i;r++)Le(o[r],a[r]);else Le(e,c);return 0<(a=ve(c,"script")).length&&ye(a,!f&&ve(e,"script")),c},cleanData:function(e){for(var t,n,r,i=S.event.special,o=0;void 0!==(n=e[o]);o++)if(V(n)){if(t=n[Y.expando]){if(t.events)for(r in t.events)i[r]?S.event.remove(n,r):S.removeEvent(n,r,t.handle);n[Y.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),S.fn.extend({detach:function(e){return Oe(this,e,!0)},remove:function(e){return Oe(this,e)},text:function(e){return $(this,function(e){return void 0===e?S.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return He(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,e).appendChild(e)})},prepend:function(){return He(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=je(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return He(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(S.cleanData(ve(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return S.clone(this,e,t)})},html:function(e){return $(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!ke.test(e)&&!ge[(de.exec(e)||["",""])[1].toLowerCase()]){e=S.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(S.cleanData(ve(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return He(this,arguments,function(e){var t=this.parentNode;S.inArray(this,n)<0&&(S.cleanData(ve(this)),t&&t.replaceChild(e,this))},n)}}),S.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){S.fn[e]=function(e){for(var t,n=[],r=S(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),S(r[o])[a](t),u.apply(n,t.get());return this.pushStack(n)}});var Pe=new RegExp("^("+ee+")(?!px)[a-z%]+$","i"),Re=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=C),t.getComputedStyle(e)},Me=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=o[i];return r},Ie=new RegExp(ne.join("|"),"i");function We(e,t,n){var r,i,o,a,s=e.style;return(n=n||Re(e))&&(""!==(a=n.getPropertyValue(t)||n[t])||ie(e)||(a=S.style(e,t)),!y.pixelBoxStyles()&&Pe.test(a)&&Ie.test(t)&&(r=s.width,i=s.minWidth,o=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=r,s.minWidth=i,s.maxWidth=o)),void 0!==a?a+"":a}function Fe(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",re.appendChild(u).appendChild(l);var e=C.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),re.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}var n,r,i,o,a,s,u=E.createElement("div"),l=E.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",y.clearCloneStyle="content-box"===l.style.backgroundClip,S.extend(y,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=E.createElement("table"),t=E.createElement("tr"),n=E.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",re.appendChild(e).appendChild(t).appendChild(n),r=C.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,re.removeChild(e)),a}}))}();var Be=["Webkit","Moz","ms"],$e=E.createElement("div").style,_e={};function ze(e){var t=S.cssProps[e]||_e[e];return t||(e in $e?e:_e[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Be.length;while(n--)if((e=Be[n]+t)in $e)return e}(e)||e)}var Ue=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ve={position:"absolute",visibility:"hidden",display:"block"},Ge={letterSpacing:"0",fontWeight:"400"};function Ye(e,t,n){var r=te.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Qe(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0;if(n===(r?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(u+=S.css(e,n+ne[a],!0,i)),r?("content"===n&&(u-=S.css(e,"padding"+ne[a],!0,i)),"margin"!==n&&(u-=S.css(e,"border"+ne[a]+"Width",!0,i))):(u+=S.css(e,"padding"+ne[a],!0,i),"padding"!==n?u+=S.css(e,"border"+ne[a]+"Width",!0,i):s+=S.css(e,"border"+ne[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u}function Je(e,t,n){var r=Re(e),i=(!y.boxSizingReliable()||n)&&"border-box"===S.css(e,"boxSizing",!1,r),o=i,a=We(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Pe.test(a)){if(!n)return a;a="auto"}return(!y.boxSizingReliable()&&i||!y.reliableTrDimensions()&&A(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===S.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===S.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+Qe(e,t,n||(i?"border":"content"),o,r,a)+"px"}function Ke(e,t,n,r,i){return new Ke.prototype.init(e,t,n,r,i)}S.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=We(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,o,a,s=X(t),u=Xe.test(t),l=e.style;if(u||(t=ze(s)),a=S.cssHooks[t]||S.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=te.exec(n))&&i[1]&&(n=se(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(S.cssNumber[s]?"":"px")),y.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=X(t);return Xe.test(t)||(t=ze(s)),(a=S.cssHooks[t]||S.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=We(e,t,r)),"normal"===i&&t in Ge&&(i=Ge[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),S.each(["height","width"],function(e,u){S.cssHooks[u]={get:function(e,t,n){if(t)return!Ue.test(S.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Je(e,u,n):Me(e,Ve,function(){return Je(e,u,n)})},set:function(e,t,n){var r,i=Re(e),o=!y.scrollboxSize()&&"absolute"===i.position,a=(o||n)&&"border-box"===S.css(e,"boxSizing",!1,i),s=n?Qe(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-Qe(e,u,"border",!1,i)-.5)),s&&(r=te.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=S.css(e,u)),Ye(0,t,s)}}}),S.cssHooks.marginLeft=Fe(y.reliableMarginLeft,function(e,t){if(t)return(parseFloat(We(e,"marginLeft"))||e.getBoundingClientRect().left-Me(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),S.each({margin:"",padding:"",border:"Width"},function(i,o){S.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+ne[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(S.cssHooks[i+o].set=Ye)}),S.fn.extend({css:function(e,t){return $(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Re(e),i=t.length;a<i;a++)o[t[a]]=S.css(e,t[a],!1,r);return o}return void 0!==n?S.style(e,t,n):S.css(e,t)},e,t,1<arguments.length)}}),((S.Tween=Ke).prototype={constructor:Ke,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||S.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(S.cssNumber[n]?"":"px")},cur:function(){var e=Ke.propHooks[this.prop];return e&&e.get?e.get(this):Ke.propHooks._default.get(this)},run:function(e){var t,n=Ke.propHooks[this.prop];return this.options.duration?this.pos=t=S.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ke.propHooks._default.set(this),this}}).init.prototype=Ke.prototype,(Ke.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=S.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){S.fx.step[e.prop]?S.fx.step[e.prop](e):1!==e.elem.nodeType||!S.cssHooks[e.prop]&&null==e.elem.style[ze(e.prop)]?e.elem[e.prop]=e.now:S.style(e.elem,e.prop,e.now+e.unit)}}}).scrollTop=Ke.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},S.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},S.fx=Ke.prototype.init,S.fx.step={};var Ze,et,tt,nt,rt=/^(?:toggle|show|hide)$/,it=/queueHooks$/;function ot(){et&&(!1===E.hidden&&C.requestAnimationFrame?C.requestAnimationFrame(ot):C.setTimeout(ot,S.fx.interval),S.fx.tick())}function at(){return C.setTimeout(function(){Ze=void 0}),Ze=Date.now()}function st(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=ne[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function ut(e,t,n){for(var r,i=(lt.tweeners[t]||[]).concat(lt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function lt(o,e,t){var n,a,r=0,i=lt.prefilters.length,s=S.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=Ze||at(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:S.extend({},e),opts:S.extend(!0,{specialEasing:{},easing:S.easing._default},t),originalProperties:e,originalOptions:t,startTime:Ze||at(),duration:t.duration,tweens:[],createTween:function(e,t){var n=S.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=X(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=S.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=lt.prefilters[r].call(l,o,c,l.opts))return m(n.stop)&&(S._queueHooks(l.elem,l.opts.queue).stop=n.stop.bind(n)),n;return S.map(c,ut,l),m(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),S.fx.timer(S.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}S.Animation=S.extend(lt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return se(n.elem,e,te.exec(t),n),n}]},tweener:function(e,t){m(e)?(t=e,e=["*"]):e=e.match(P);for(var n,r=0,i=e.length;r<i;r++)n=e[r],lt.tweeners[n]=lt.tweeners[n]||[],lt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ae(e),v=Y.get(e,"fxshow");for(r in n.queue||(null==(a=S._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,S.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],rt.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||S.style(e,r)}if((u=!S.isEmptyObject(t))||!S.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=Y.get(e,"display")),"none"===(c=S.css(e,"display"))&&(l?c=l:(le([e],!0),l=e.style.display||l,c=S.css(e,"display"),le([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===S.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=Y.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&le([e],!0),p.done(function(){for(r in g||le([e]),Y.remove(e,"fxshow"),d)S.style(e,r,d[r])})),u=ut(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?lt.prefilters.unshift(e):lt.prefilters.push(e)}}),S.speed=function(e,t,n){var r=e&&"object"==typeof e?S.extend({},e):{complete:n||!n&&t||m(e)&&e,duration:e,easing:n&&t||t&&!m(t)&&t};return S.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in S.fx.speeds?r.duration=S.fx.speeds[r.duration]:r.duration=S.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){m(r.old)&&r.old.call(this),r.queue&&S.dequeue(this,r.queue)},r},S.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ae).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(t,e,n,r){var i=S.isEmptyObject(t),o=S.speed(e,n,r),a=function(){var e=lt(this,S.extend({},t),o);(i||Y.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=S.timers,r=Y.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&r[t].stop&&it.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||S.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=Y.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=S.timers,o=n?n.length:0;for(t.finish=!0,S.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete t.finish})}}),S.each(["toggle","show","hide"],function(e,r){var i=S.fn[r];S.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(st(r,!0),e,t,n)}}),S.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){S.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),S.timers=[],S.fx.tick=function(){var e,t=0,n=S.timers;for(Ze=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||S.fx.stop(),Ze=void 0},S.fx.timer=function(e){S.timers.push(e),S.fx.start()},S.fx.interval=13,S.fx.start=function(){et||(et=!0,ot())},S.fx.stop=function(){et=null},S.fx.speeds={slow:600,fast:200,_default:400},S.fn.delay=function(r,e){return r=S.fx&&S.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=C.setTimeout(e,r);t.stop=function(){C.clearTimeout(n)}})},tt=E.createElement("input"),nt=E.createElement("select").appendChild(E.createElement("option")),tt.type="checkbox",y.checkOn=""!==tt.value,y.optSelected=nt.selected,(tt=E.createElement("input")).value="t",tt.type="radio",y.radioValue="t"===tt.value;var ct,ft=S.expr.attrHandle;S.fn.extend({attr:function(e,t){return $(this,S.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){S.removeAttr(this,e)})}}),S.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?S.prop(e,t,n):(1===o&&S.isXMLDoc(e)||(i=S.attrHooks[t.toLowerCase()]||(S.expr.match.bool.test(t)?ct:void 0)),void 0!==n?null===n?void S.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=S.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!y.radioValue&&"radio"===t&&A(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(P);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),ct={set:function(e,t,n){return!1===t?S.removeAttr(e,n):e.setAttribute(n,n),n}},S.each(S.expr.match.bool.source.match(/\w+/g),function(e,t){var a=ft[t]||S.find.attr;ft[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=ft[o],ft[o]=r,r=null!=a(e,t,n)?o:null,ft[o]=i),r}});var pt=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(P)||[]).join(" ")}function gt(e){return e.getAttribute&&e.getAttribute("class")||""}function vt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(P)||[]}S.fn.extend({prop:function(e,t){return $(this,S.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[S.propFix[e]||e]})}}),S.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&S.isXMLDoc(e)||(t=S.propFix[t]||t,i=S.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=S.find.attr(e,"tabindex");return t?parseInt(t,10):pt.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),y.optSelected||(S.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),S.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){S.propFix[this.toLowerCase()]=this}),S.fn.extend({addClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).addClass(t.call(this,e,gt(this)))});if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])r.indexOf(" "+o+" ")<0&&(r+=o+" ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,r,i,o,a,s,u=0;if(m(t))return this.each(function(e){S(this).removeClass(t.call(this,e,gt(this)))});if(!arguments.length)return this.attr("class","");if((e=vt(t)).length)while(n=this[u++])if(i=gt(n),r=1===n.nodeType&&" "+ht(i)+" "){a=0;while(o=e[a++])while(-1<r.indexOf(" "+o+" "))r=r.replace(" "+o+" "," ");i!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(i,t){var o=typeof i,a="string"===o||Array.isArray(i);return"boolean"==typeof t&&a?t?this.addClass(i):this.removeClass(i):m(i)?this.each(function(e){S(this).toggleClass(i.call(this,e,gt(this),t),t)}):this.each(function(){var e,t,n,r;if(a){t=0,n=S(this),r=vt(i);while(e=r[t++])n.hasClass(e)?n.removeClass(e):n.addClass(e)}else void 0!==i&&"boolean"!==o||((e=gt(this))&&Y.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===i?"":Y.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+ht(gt(n))+" ").indexOf(t))return!0;return!1}});var yt=/\r/g;S.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=m(n),this.each(function(e){var t;1===this.nodeType&&(null==(t=i?n.call(this,e,S(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=S.map(t,function(e){return null==e?"":e+""})),(r=S.valHooks[this.type]||S.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=S.valHooks[t.type]||S.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(yt,""):null==e?"":e:void 0}}),S.extend({valHooks:{option:{get:function(e){var t=S.find.attr(e,"value");return null!=t?t:ht(S.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!A(n.parentNode,"optgroup"))){if(t=S(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=S.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<S.inArray(S.valHooks.option.get(r),o))&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),S.each(["radio","checkbox"],function(){S.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<S.inArray(S(e).val(),t)}},y.checkOn||(S.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),y.focusin="onfocusin"in C;var mt=/^(?:focusinfocus|focusoutblur)$/,xt=function(e){e.stopPropagation()};S.extend(S.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||E],d=v.call(e,"type")?e.type:e,h=v.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||E,3!==n.nodeType&&8!==n.nodeType&&!mt.test(d+S.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+d,(e=e[S.expando]?e:new S.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:S.makeArray(t,[e]),c=S.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!x(n)){for(s=c.delegateType||d,mt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||E)&&p.push(a.defaultView||a.parentWindow||C)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(Y.get(o,"events")||Object.create(null))[e.type]&&Y.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&V(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!V(n)||u&&m(n[d])&&!x(n)&&((a=n[u])&&(n[u]=null),S.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,xt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,xt),S.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=S.extend(new S.Event,n,{type:e,isSimulated:!0});S.event.trigger(r,null,t)}}),S.fn.extend({trigger:function(e,t){return this.each(function(){S.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return S.event.trigger(e,t,n,!0)}}),y.focusin||S.each({focus:"focusin",blur:"focusout"},function(n,r){var i=function(e){S.event.simulate(r,e.target,S.event.fix(e))};S.event.special[r]={setup:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r);t||e.addEventListener(n,i,!0),Y.access(e,r,(t||0)+1)},teardown:function(){var e=this.ownerDocument||this.document||this,t=Y.access(e,r)-1;t?Y.access(e,r,t):(e.removeEventListener(n,i,!0),Y.remove(e,r))}}});var bt=C.location,wt={guid:Date.now()},Tt=/\?/;S.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new C.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],t&&!n||S.error("Invalid XML: "+(n?S.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Ct=/\[\]$/,Et=/\r?\n/g,St=/^(?:submit|button|image|reset|file)$/i,kt=/^(?:input|select|textarea|keygen)/i;function At(n,e,r,i){var t;if(Array.isArray(e))S.each(e,function(e,t){r||Ct.test(n)?i(n,t):At(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==w(e))i(n,e);else for(t in e)At(n+"["+t+"]",e[t],r,i)}S.param=function(e,t){var n,r=[],i=function(e,t){var n=m(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!S.isPlainObject(e))S.each(e,function(){i(this.name,this.value)});else for(n in e)At(n,e[n],t,i);return r.join("&")},S.fn.extend({serialize:function(){return S.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=S.prop(this,"elements");return e?S.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!S(this).is(":disabled")&&kt.test(this.nodeName)&&!St.test(e)&&(this.checked||!pe.test(e))}).map(function(e,t){var n=S(this).val();return null==n?null:Array.isArray(n)?S.map(n,function(e){return{name:t.name,value:e.replace(Et,"\r\n")}}):{name:t.name,value:n.replace(Et,"\r\n")}}).get()}});var Nt=/%20/g,jt=/#.*$/,Dt=/([?&])_=[^&]*/,qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Lt=/^(?:GET|HEAD)$/,Ht=/^\/\//,Ot={},Pt={},Rt="*/".concat("*"),Mt=E.createElement("a");function It(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(P)||[];if(m(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Wt(t,i,o,a){var s={},u=t===Pt;function l(e){var r;return s[e]=!0,S.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Ft(e,t){var n,r,i=S.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&S.extend(!0,e,r),e}Mt.href=bt.href,S.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:bt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":S.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Ft(Ft(e,S.ajaxSettings),t):Ft(S.ajaxSettings,e)},ajaxPrefilter:It(Ot),ajaxTransport:It(Pt),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=S.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?S(y):S.event,x=S.Deferred(),b=S.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=qt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||bt.href)+"").replace(Ht,bt.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(P)||[""],null==v.crossDomain){r=E.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Mt.protocol+"//"+Mt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=S.param(v.data,v.traditional)),Wt(Ot,v,t,T),h)return T;for(i in(g=S.event&&v.global)&&0==S.active++&&S.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Lt.test(v.type),f=v.url.replace(jt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&(v.data=v.data.replace(Nt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(Tt.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(Dt,"$1"),o=(Tt.test(f)?"&":"?")+"_="+wt.guid+++o),v.url=f+o),v.ifModified&&(S.lastModified[f]&&T.setRequestHeader("If-Modified-Since",S.lastModified[f]),S.etag[f]&&T.setRequestHeader("If-None-Match",S.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+Rt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Wt(Pt,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=C.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&C.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<S.inArray("script",v.dataTypes)&&S.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(S.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(S.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--S.active||S.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return S.get(e,t,n,"json")},getScript:function(e,t){return S.get(e,void 0,t,"script")}}),S.each(["get","post"],function(e,i){S[i]=function(e,t,n,r){return m(t)&&(r=r||n,n=t,t=void 0),S.ajax(S.extend({url:e,type:i,dataType:r,data:t,success:n},S.isPlainObject(e)&&e))}}),S.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),S._evalUrl=function(e,t,n){return S.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){S.globalEval(e,t,n)}})},S.fn.extend({wrapAll:function(e){var t;return this[0]&&(m(e)&&(e=e.call(this[0])),t=S(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return m(n)?this.each(function(e){S(this).wrapInner(n.call(this,e))}):this.each(function(){var e=S(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=m(t);return this.each(function(e){S(this).wrapAll(n?t.call(this,e):t)})},unwrap:function(e){return this.parent(e).not("body").each(function(){S(this).replaceWith(this.childNodes)}),this}}),S.expr.pseudos.hidden=function(e){return!S.expr.pseudos.visible(e)},S.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},S.ajaxSettings.xhr=function(){try{return new C.XMLHttpRequest}catch(e){}};var Bt={0:200,1223:204},$t=S.ajaxSettings.xhr();y.cors=!!$t&&"withCredentials"in $t,y.ajax=$t=!!$t,S.ajaxTransport(function(i){var o,a;if(y.cors||$t&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Bt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&C.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e}},abort:function(){o&&o()}}}),S.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),S.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return S.globalEval(e),e}}}),S.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),S.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,t){r=S("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),E.head.appendChild(r[0])},abort:function(){i&&i()}}});var _t,zt=[],Ut=/(=)\?(?=&|$)|\?\?/;S.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=zt.pop()||S.expando+"_"+wt.guid++;return this[e]=!0,e}}),S.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Ut.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ut.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=m(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Ut,"$1"+r):!1!==e.jsonp&&(e.url+=(Tt.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||S.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=C[r],C[r]=function(){o=arguments},n.always(function(){void 0===i?S(C).removeProp(r):C[r]=i,e[r]&&(e.jsonpCallback=t.jsonpCallback,zt.push(r)),o&&m(i)&&i(o[0]),o=i=void 0}),"script"}),y.createHTMLDocument=((_t=E.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===_t.childNodes.length),S.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(y.createHTMLDocument?((r=(t=E.implementation.createHTMLDocument("")).createElement("base")).href=E.location.href,t.head.appendChild(r)):t=E),o=!n&&[],(i=N.exec(e))?[t.createElement(i[1])]:(i=xe([e],t,o),o&&o.length&&S(o).remove(),S.merge([],i.childNodes)));var r,i,o},S.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=ht(e.slice(s)),e=e.slice(0,s)),m(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&S.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?S("<div>").append(S.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},S.expr.pseudos.animated=function(t){return S.grep(S.timers,function(e){return t===e.elem}).length},S.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=S.css(e,"position"),c=S(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=S.css(e,"top"),u=S.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),m(t)&&(t=t.call(e,n,S.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),"using"in t?t.using.call(e,f):c.css(f)}},S.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){S.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===S.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===S.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=S(e).offset()).top+=S.css(e,"borderTopWidth",!0),i.left+=S.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-S.css(r,"marginTop",!0),left:t.left-i.left-S.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===S.css(e,"position"))e=e.offsetParent;return e||re})}}),S.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;S.fn[t]=function(e){return $(this,function(e,t,n){var r;if(x(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),S.each(["top","left"],function(e,n){S.cssHooks[n]=Fe(y.pixelPosition,function(e,t){if(t)return t=We(e,n),Pe.test(t)?S(e).position()[n]+"px":t})}),S.each({Height:"height",Width:"width"},function(a,s){S.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){S.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return $(this,function(e,t,n){var r;return x(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?S.css(e,t,i):S.style(e,t,n,i)},s,n?e:void 0,n)}})}),S.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){S.fn[t]=function(e){return this.on(t,e)}}),S.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),S.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,n){S.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var Xt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;S.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),m(e))return r=s.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(s.call(arguments)))}).guid=e.guid=e.guid||S.guid++,i},S.holdReady=function(e){e?S.readyWait++:S.ready(!0)},S.isArray=Array.isArray,S.parseJSON=JSON.parse,S.nodeName=A,S.isFunction=m,S.isWindow=x,S.camelCase=X,S.type=w,S.now=Date.now,S.isNumeric=function(e){var t=S.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},S.trim=function(e){return null==e?"":(e+"").replace(Xt,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return S});var Vt=C.jQuery,Gt=C.$;return S.noConflict=function(e){return C.$===S&&(C.$=Gt),e&&C.jQuery===S&&(C.jQuery=Vt),S},"undefined"==typeof e&&(C.jQuery=C.$=S),S});
</script>
  <script>/**
 * @popperjs/core v2.6.0 - MIT License
 */

"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).Popper={})}(this,(function(e){function t(e){return{width:(e=e.getBoundingClientRect()).width,height:e.height,top:e.top,right:e.right,bottom:e.bottom,left:e.left,x:e.left,y:e.top}}function n(e){return"[object Window]"!==e.toString()?(e=e.ownerDocument)&&e.defaultView||window:e}function r(e){return{scrollLeft:(e=n(e)).pageXOffset,scrollTop:e.pageYOffset}}function o(e){return e instanceof n(e).Element||e instanceof Element}function i(e){return e instanceof n(e).HTMLElement||e instanceof HTMLElement}function a(e){return e?(e.nodeName||"").toLowerCase():null}function s(e){return((o(e)?e.ownerDocument:e.document)||window.document).documentElement}function f(e){return t(s(e)).left+r(e).scrollLeft}function c(e){return n(e).getComputedStyle(e)}function p(e){return e=c(e),/auto|scroll|overlay|hidden/.test(e.overflow+e.overflowY+e.overflowX)}function l(e,o,c){void 0===c&&(c=!1);var l=s(o);e=t(e);var u=i(o),d={scrollLeft:0,scrollTop:0},m={x:0,y:0};return(u||!u&&!c)&&(("body"!==a(o)||p(l))&&(d=o!==n(o)&&i(o)?{scrollLeft:o.scrollLeft,scrollTop:o.scrollTop}:r(o)),i(o)?((m=t(o)).x+=o.clientLeft,m.y+=o.clientTop):l&&(m.x=f(l))),{x:e.left+d.scrollLeft-m.x,y:e.top+d.scrollTop-m.y,width:e.width,height:e.height}}function u(e){return{x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}}function d(e){return"html"===a(e)?e:e.assignedSlot||e.parentNode||e.host||s(e)}function m(e,t){void 0===t&&(t=[]);var r=function e(t){return 0<=["html","body","#document"].indexOf(a(t))?t.ownerDocument.body:i(t)&&p(t)?t:e(d(t))}(e);e="body"===a(r);var o=n(r);return r=e?[o].concat(o.visualViewport||[],p(r)?r:[]):r,t=t.concat(r),e?t:t.concat(m(d(r)))}function h(e){if(!i(e)||"fixed"===c(e).position)return null;if(e=e.offsetParent){var t=s(e);if("body"===a(e)&&"static"===c(e).position&&"static"!==c(t).position)return t}return e}function g(e){for(var t=n(e),r=h(e);r&&0<=["table","td","th"].indexOf(a(r))&&"static"===c(r).position;)r=h(r);if(r&&"body"===a(r)&&"static"===c(r).position)return t;if(!r)e:{for(e=d(e);i(e)&&0>["html","body"].indexOf(a(e));){if("none"!==(r=c(e)).transform||"none"!==r.perspective||r.willChange&&"auto"!==r.willChange){r=e;break e}e=e.parentNode}r=null}return r||t}function v(e){var t=new Map,n=new Set,r=[];return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||function e(o){n.add(o.name),[].concat(o.requires||[],o.requiresIfExists||[]).forEach((function(r){n.has(r)||(r=t.get(r))&&e(r)})),r.push(o)}(e)})),r}function b(e){var t;return function(){return t||(t=new Promise((function(n){Promise.resolve().then((function(){t=void 0,n(e())}))}))),t}}function y(e){return e.split("-")[0]}function O(e,t){var r,o=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if((r=o)&&(r=o instanceof(r=n(o).ShadowRoot)||o instanceof ShadowRoot),r)do{if(t&&e.isSameNode(t))return!0;t=t.parentNode||t.host}while(t);return!1}function w(e){return Object.assign(Object.assign({},e),{},{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function x(e,o){if("viewport"===o){o=n(e);var a=s(e);o=o.visualViewport;var p=a.clientWidth;a=a.clientHeight;var l=0,u=0;o&&(p=o.width,a=o.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(l=o.offsetLeft,u=o.offsetTop)),e=w(e={width:p,height:a,x:l+f(e),y:u})}else i(o)?((e=t(o)).top+=o.clientTop,e.left+=o.clientLeft,e.bottom=e.top+o.clientHeight,e.right=e.left+o.clientWidth,e.width=o.clientWidth,e.height=o.clientHeight,e.x=e.left,e.y=e.top):(u=s(e),e=s(u),l=r(u),o=u.ownerDocument.body,p=Math.max(e.scrollWidth,e.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=Math.max(e.scrollHeight,e.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),u=-l.scrollLeft+f(u),l=-l.scrollTop,"rtl"===c(o||e).direction&&(u+=Math.max(e.clientWidth,o?o.clientWidth:0)-p),e=w({width:p,height:a,x:u,y:l}));return e}function j(e,t,n){return t="clippingParents"===t?function(e){var t=m(d(e)),n=0<=["absolute","fixed"].indexOf(c(e).position)&&i(e)?g(e):e;return o(n)?t.filter((function(e){return o(e)&&O(e,n)&&"body"!==a(e)})):[]}(e):[].concat(t),(n=(n=[].concat(t,[n])).reduce((function(t,n){return n=x(e,n),t.top=Math.max(n.top,t.top),t.right=Math.min(n.right,t.right),t.bottom=Math.min(n.bottom,t.bottom),t.left=Math.max(n.left,t.left),t}),x(e,n[0]))).width=n.right-n.left,n.height=n.bottom-n.top,n.x=n.left,n.y=n.top,n}function M(e){return 0<=["top","bottom"].indexOf(e)?"x":"y"}function E(e){var t=e.reference,n=e.element,r=(e=e.placement)?y(e):null;e=e?e.split("-")[1]:null;var o=t.x+t.width/2-n.width/2,i=t.y+t.height/2-n.height/2;switch(r){case"top":o={x:o,y:t.y-n.height};break;case"bottom":o={x:o,y:t.y+t.height};break;case"right":o={x:t.x+t.width,y:i};break;case"left":o={x:t.x-n.width,y:i};break;default:o={x:t.x,y:t.y}}if(null!=(r=r?M(r):null))switch(i="y"===r?"height":"width",e){case"start":o[r]-=t[i]/2-n[i]/2;break;case"end":o[r]+=t[i]/2-n[i]/2}return o}function D(e){return Object.assign(Object.assign({},{top:0,right:0,bottom:0,left:0}),e)}function P(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function L(e,n){void 0===n&&(n={});var r=n;n=void 0===(n=r.placement)?e.placement:n;var i=r.boundary,a=void 0===i?"clippingParents":i,f=void 0===(i=r.rootBoundary)?"viewport":i;i=void 0===(i=r.elementContext)?"popper":i;var c=r.altBoundary,p=void 0!==c&&c;r=D("number"!=typeof(r=void 0===(r=r.padding)?0:r)?r:P(r,T));var l=e.elements.reference;c=e.rects.popper,a=j(o(p=e.elements[p?"popper"===i?"reference":"popper":i])?p:p.contextElement||s(e.elements.popper),a,f),p=E({reference:f=t(l),element:c,strategy:"absolute",placement:n}),c=w(Object.assign(Object.assign({},c),p)),f="popper"===i?c:f;var u={top:a.top-f.top+r.top,bottom:f.bottom-a.bottom+r.bottom,left:a.left-f.left+r.left,right:f.right-a.right+r.right};if(e=e.modifiersData.offset,"popper"===i&&e){var d=e[n];Object.keys(u).forEach((function(e){var t=0<=["right","bottom"].indexOf(e)?1:-1,n=0<=["top","bottom"].indexOf(e)?"y":"x";u[e]+=d[n]*t}))}return u}function k(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function B(e){void 0===e&&(e={});var t=e.defaultModifiers,n=void 0===t?[]:t,r=void 0===(e=e.defaultOptions)?V:e;return function(e,t,i){function a(){f.forEach((function(e){return e()})),f=[]}void 0===i&&(i=r);var s={placement:"bottom",orderedModifiers:[],options:Object.assign(Object.assign({},V),r),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},f=[],c=!1,p={state:s,setOptions:function(i){return a(),s.options=Object.assign(Object.assign(Object.assign({},r),s.options),i),s.scrollParents={reference:o(e)?m(e):e.contextElement?m(e.contextElement):[],popper:m(t)},i=function(e){var t=v(e);return N.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign(Object.assign(Object.assign({},n),t),{},{options:Object.assign(Object.assign({},n.options),t.options),data:Object.assign(Object.assign({},n.data),t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(n,s.options.modifiers))),s.orderedModifiers=i.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options;n=void 0===n?{}:n,"function"==typeof(e=e.effect)&&(t=e({state:s,name:t,instance:p,options:n}),f.push(t||function(){}))})),p.update()},forceUpdate:function(){if(!c){var e=s.elements,t=e.reference;if(k(t,e=e.popper))for(s.rects={reference:l(t,g(e),"fixed"===s.options.strategy),popper:u(e)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)})),t=0;t<s.orderedModifiers.length;t++)if(!0===s.reset)s.reset=!1,t=-1;else{var n=s.orderedModifiers[t];e=n.fn;var r=n.options;r=void 0===r?{}:r,n=n.name,"function"==typeof e&&(s=e({state:s,options:r,name:n,instance:p})||s)}}},update:b((function(){return new Promise((function(e){p.forceUpdate(),e(s)}))})),destroy:function(){a(),c=!0}};return k(e,t)?(p.setOptions(i).then((function(e){!c&&i.onFirstUpdate&&i.onFirstUpdate(e)})),p):p}}function W(e){var t,r=e.popper,o=e.popperRect,i=e.placement,a=e.offsets,f=e.position,c=e.gpuAcceleration,p=e.adaptive;e.roundOffsets?(e=window.devicePixelRatio||1,e={x:Math.round(a.x*e)/e||0,y:Math.round(a.y*e)/e||0}):e=a;var l=e;e=void 0===(e=l.x)?0:e,l=void 0===(l=l.y)?0:l;var u=a.hasOwnProperty("x");a=a.hasOwnProperty("y");var d,m="left",h="top",v=window;if(p){var b=g(r);b===n(r)&&(b=s(r)),"top"===i&&(h="bottom",l-=b.clientHeight-o.height,l*=c?1:-1),"left"===i&&(m="right",e-=b.clientWidth-o.width,e*=c?1:-1)}return r=Object.assign({position:f},p&&z),c?Object.assign(Object.assign({},r),{},((d={})[h]=a?"0":"",d[m]=u?"0":"",d.transform=2>(v.devicePixelRatio||1)?"translate("+e+"px, "+l+"px)":"translate3d("+e+"px, "+l+"px, 0)",d)):Object.assign(Object.assign({},r),{},((t={})[h]=a?l+"px":"",t[m]=u?e+"px":"",t.transform="",t))}function A(e){return e.replace(/left|right|bottom|top/g,(function(e){return G[e]}))}function H(e){return e.replace(/start|end/g,(function(e){return J[e]}))}function R(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function S(e){return["top","right","bottom","left"].some((function(t){return 0<=e[t]}))}var T=["top","bottom","right","left"],q=T.reduce((function(e,t){return e.concat([t+"-start",t+"-end"])}),[]),C=[].concat(T,["auto"]).reduce((function(e,t){return e.concat([t,t+"-start",t+"-end"])}),[]),N="beforeRead read afterRead beforeMain main afterMain beforeWrite write afterWrite".split(" "),V={placement:"bottom",modifiers:[],strategy:"absolute"},I={passive:!0},_={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,r=e.instance,o=(e=e.options).scroll,i=void 0===o||o,a=void 0===(e=e.resize)||e,s=n(t.elements.popper),f=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&f.forEach((function(e){e.addEventListener("scroll",r.update,I)})),a&&s.addEventListener("resize",r.update,I),function(){i&&f.forEach((function(e){e.removeEventListener("scroll",r.update,I)})),a&&s.removeEventListener("resize",r.update,I)}},data:{}},U={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state;t.modifiersData[e.name]=E({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},z={top:"auto",right:"auto",bottom:"auto",left:"auto"},F={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options;e=void 0===(e=n.gpuAcceleration)||e;var r=n.adaptive;r=void 0===r||r,n=void 0===(n=n.roundOffsets)||n,e={placement:y(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:e},null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign(Object.assign({},t.styles.popper),W(Object.assign(Object.assign({},e),{},{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:r,roundOffsets:n})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign(Object.assign({},t.styles.arrow),W(Object.assign(Object.assign({},e),{},{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:n})))),t.attributes.popper=Object.assign(Object.assign({},t.attributes.popper),{},{"data-popper-placement":t.placement})},data:{}},X={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];i(o)&&a(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{};e=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{}),i(r)&&a(r)&&(Object.assign(r.style,e),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]},Y={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.name,r=void 0===(e=e.options.offset)?[0,0]:e,o=(e=C.reduce((function(e,n){var o=t.rects,i=y(n),a=0<=["left","top"].indexOf(i)?-1:1,s="function"==typeof r?r(Object.assign(Object.assign({},o),{},{placement:n})):r;return o=(o=s[0])||0,s=((s=s[1])||0)*a,i=0<=["left","right"].indexOf(i)?{x:s,y:o}:{x:o,y:s},e[n]=i,e}),{}))[t.placement],i=o.x;o=o.y,null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=i,t.modifiersData.popperOffsets.y+=o),t.modifiersData[n]=e}},G={left:"right",right:"left",bottom:"top",top:"bottom"},J={start:"end",end:"start"},K={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options;if(e=e.name,!t.modifiersData[e]._skip){var r=n.mainAxis;r=void 0===r||r;var o=n.altAxis;o=void 0===o||o;var i=n.fallbackPlacements,a=n.padding,s=n.boundary,f=n.rootBoundary,c=n.altBoundary,p=n.flipVariations,l=void 0===p||p,u=n.allowedAutoPlacements;p=y(n=t.options.placement),i=i||(p!==n&&l?function(e){if("auto"===y(e))return[];var t=A(e);return[H(e),t,H(t)]}(n):[A(n)]);var d=[n].concat(i).reduce((function(e,n){return e.concat("auto"===y(n)?function(e,t){void 0===t&&(t={});var n=t.boundary,r=t.rootBoundary,o=t.padding,i=t.flipVariations,a=t.allowedAutoPlacements,s=void 0===a?C:a,f=t.placement.split("-")[1];0===(i=(t=f?i?q:q.filter((function(e){return e.split("-")[1]===f})):T).filter((function(e){return 0<=s.indexOf(e)}))).length&&(i=t);var c=i.reduce((function(t,i){return t[i]=L(e,{placement:i,boundary:n,rootBoundary:r,padding:o})[y(i)],t}),{});return Object.keys(c).sort((function(e,t){return c[e]-c[t]}))}(t,{placement:n,boundary:s,rootBoundary:f,padding:a,flipVariations:l,allowedAutoPlacements:u}):n)}),[]);n=t.rects.reference,i=t.rects.popper;var m=new Map;p=!0;for(var h=d[0],g=0;g<d.length;g++){var v=d[g],b=y(v),O="start"===v.split("-")[1],w=0<=["top","bottom"].indexOf(b),x=w?"width":"height",j=L(t,{placement:v,boundary:s,rootBoundary:f,altBoundary:c,padding:a});if(O=w?O?"right":"left":O?"bottom":"top",n[x]>i[x]&&(O=A(O)),x=A(O),w=[],r&&w.push(0>=j[b]),o&&w.push(0>=j[O],0>=j[x]),w.every((function(e){return e}))){h=v,p=!1;break}m.set(v,w)}if(p)for(r=function(e){var t=d.find((function(t){if(t=m.get(t))return t.slice(0,e).every((function(e){return e}))}));if(t)return h=t,"break"},o=l?3:1;0<o&&"break"!==r(o);o--);t.placement!==h&&(t.modifiersData[e]._skip=!0,t.placement=h,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},Q={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options;e=e.name;var r=n.mainAxis,o=void 0===r||r;r=void 0!==(r=n.altAxis)&&r;var i=n.tether;i=void 0===i||i;var a=n.tetherOffset,s=void 0===a?0:a;n=L(t,{boundary:n.boundary,rootBoundary:n.rootBoundary,padding:n.padding,altBoundary:n.altBoundary}),a=y(t.placement);var f=t.placement.split("-")[1],c=!f,p=M(a);a="x"===p?"y":"x";var l=t.modifiersData.popperOffsets,d=t.rects.reference,m=t.rects.popper,h="function"==typeof s?s(Object.assign(Object.assign({},t.rects),{},{placement:t.placement})):s;if(s={x:0,y:0},l){if(o){var v="y"===p?"top":"left",b="y"===p?"bottom":"right",O="y"===p?"height":"width";o=l[p];var w=l[p]+n[v],x=l[p]-n[b],j=i?-m[O]/2:0,E="start"===f?d[O]:m[O];f="start"===f?-m[O]:-d[O],m=t.elements.arrow,m=i&&m?u(m):{width:0,height:0};var D=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0};v=D[v],b=D[b],m=Math.max(0,Math.min(d[O],m[O])),E=c?d[O]/2-j-m-v-h:E-m-v-h,c=c?-d[O]/2+j+m+b+h:f+m+b+h,h=t.elements.arrow&&g(t.elements.arrow),d=t.modifiersData.offset?t.modifiersData.offset[t.placement][p]:0,h=l[p]+E-d-(h?"y"===p?h.clientTop||0:h.clientLeft||0:0),c=l[p]+c-d,i=Math.max(i?Math.min(w,h):w,Math.min(o,i?Math.max(x,c):x)),l[p]=i,s[p]=i-o}r&&(r=l[a],i=Math.max(r+n["x"===p?"top":"left"],Math.min(r,r-n["x"===p?"bottom":"right"])),l[a]=i,s[a]=i-r),t.modifiersData[e]=s}},requiresIfExists:["offset"]},Z={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state;e=e.name;var r=n.elements.arrow,o=n.modifiersData.popperOffsets,i=y(n.placement),a=M(i);if(i=0<=["left","right"].indexOf(i)?"height":"width",r&&o){var s=n.modifiersData[e+"#persistent"].padding,f=u(r),c="y"===a?"top":"left",p="y"===a?"bottom":"right",l=n.rects.reference[i]+n.rects.reference[a]-o[a]-n.rects.popper[i];o=o[a]-n.rects.reference[a],l=(r=(r=g(r))?"y"===a?r.clientHeight||0:r.clientWidth||0:0)/2-f[i]/2+(l/2-o/2),i=Math.max(s[c],Math.min(l,r-f[i]-s[p])),n.modifiersData[e]=((t={})[a]=i,t.centerOffset=i-l,t)}},effect:function(e){var t=e.state,n=e.options;e=e.name;var r=n.element;if(r=void 0===r?"[data-popper-arrow]":r,n=void 0===(n=n.padding)?0:n,null!=r){if("string"==typeof r&&!(r=t.elements.popper.querySelector(r)))return;O(t.elements.popper,r)&&(t.elements.arrow=r,t.modifiersData[e+"#persistent"]={padding:D("number"!=typeof n?n:P(n,T))})}},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},$={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state;e=e.name;var n=t.rects.reference,r=t.rects.popper,o=t.modifiersData.preventOverflow,i=L(t,{elementContext:"reference"}),a=L(t,{altBoundary:!0});n=R(i,n),r=R(a,r,o),o=S(n),a=S(r),t.modifiersData[e]={referenceClippingOffsets:n,popperEscapeOffsets:r,isReferenceHidden:o,hasPopperEscaped:a},t.attributes.popper=Object.assign(Object.assign({},t.attributes.popper),{},{"data-popper-reference-hidden":o,"data-popper-escaped":a})}},ee=B({defaultModifiers:[_,U,F,X]}),te=[_,U,F,X,Y,K,Q,Z,$],ne=B({defaultModifiers:te});e.applyStyles=X,e.arrow=Z,e.computeStyles=F,e.createPopper=ne,e.createPopperLite=ee,e.defaultModifiers=te,e.detectOverflow=L,e.eventListeners=_,e.flip=K,e.hide=$,e.offset=Y,e.popperGenerator=B,e.popperOffsets=U,e.preventOverflow=Q,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=popper.min.js.map
</script>
  <style type="text/css">.tippy-box[data-animation=fade][data-state=hidden]{opacity:0}[data-tippy-root]{max-width:calc(100vw - 10px)}.tippy-box{position:relative;background-color:#333;color:#fff;border-radius:4px;font-size:14px;line-height:1.4;outline:0;transition-property:transform,visibility,opacity}.tippy-box[data-placement^=top]>.tippy-arrow{bottom:0}.tippy-box[data-placement^=top]>.tippy-arrow:before{bottom:-7px;left:0;border-width:8px 8px 0;border-top-color:initial;transform-origin:center top}.tippy-box[data-placement^=bottom]>.tippy-arrow{top:0}.tippy-box[data-placement^=bottom]>.tippy-arrow:before{top:-7px;left:0;border-width:0 8px 8px;border-bottom-color:initial;transform-origin:center bottom}.tippy-box[data-placement^=left]>.tippy-arrow{right:0}.tippy-box[data-placement^=left]>.tippy-arrow:before{border-width:8px 0 8px 8px;border-left-color:initial;right:-7px;transform-origin:center left}.tippy-box[data-placement^=right]>.tippy-arrow{left:0}.tippy-box[data-placement^=right]>.tippy-arrow:before{left:-7px;border-width:8px 8px 8px 0;border-right-color:initial;transform-origin:center right}.tippy-box[data-inertia][data-state=visible]{transition-timing-function:cubic-bezier(.54,1.5,.38,1.11)}.tippy-arrow{width:16px;height:16px;color:#333}.tippy-arrow:before{content:"";position:absolute;border-color:transparent;border-style:solid}.tippy-content{position:relative;padding:5px 9px;z-index:1}</style>
  <style type="text/css">.tippy-box[data-theme~=light-border]{background-color:#fff;background-clip:padding-box;border:1px solid rgba(0,8,16,.15);color:#333;box-shadow:0 4px 14px -2px rgba(0,8,16,.08)}.tippy-box[data-theme~=light-border]>.tippy-backdrop{background-color:#fff}.tippy-box[data-theme~=light-border]>.tippy-arrow:after,.tippy-box[data-theme~=light-border]>.tippy-svg-arrow:after{content:"";position:absolute;z-index:-1}.tippy-box[data-theme~=light-border]>.tippy-arrow:after{border-color:transparent;border-style:solid}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-arrow:before{border-top-color:#fff}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-arrow:after{border-top-color:rgba(0,8,16,.2);border-width:7px 7px 0;top:17px;left:1px}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-svg-arrow>svg{top:16px}.tippy-box[data-theme~=light-border][data-placement^=top]>.tippy-svg-arrow:after{top:17px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-arrow:before{border-bottom-color:#fff;bottom:16px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-arrow:after{border-bottom-color:rgba(0,8,16,.2);border-width:0 7px 7px;bottom:17px;left:1px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-svg-arrow>svg{bottom:16px}.tippy-box[data-theme~=light-border][data-placement^=bottom]>.tippy-svg-arrow:after{bottom:17px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-arrow:before{border-left-color:#fff}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-arrow:after{border-left-color:rgba(0,8,16,.2);border-width:7px 0 7px 7px;left:17px;top:1px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-svg-arrow>svg{left:11px}.tippy-box[data-theme~=light-border][data-placement^=left]>.tippy-svg-arrow:after{left:12px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-arrow:before{border-right-color:#fff;right:16px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-arrow:after{border-width:7px 7px 7px 0;right:17px;top:1px;border-right-color:rgba(0,8,16,.2)}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-svg-arrow>svg{right:11px}.tippy-box[data-theme~=light-border][data-placement^=right]>.tippy-svg-arrow:after{right:12px}.tippy-box[data-theme~=light-border]>.tippy-svg-arrow{fill:#fff}.tippy-box[data-theme~=light-border]>.tippy-svg-arrow:after{background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMCA2czEuNzk2LS4wMTMgNC42Ny0zLjYxNUM1Ljg1MS45IDYuOTMuMDA2IDggMGMxLjA3LS4wMDYgMi4xNDguODg3IDMuMzQzIDIuMzg1QzE0LjIzMyA2LjAwNSAxNiA2IDE2IDZIMHoiIGZpbGw9InJnYmEoMCwgOCwgMTYsIDAuMikiLz48L3N2Zz4=);background-size:16px 6px;width:16px;height:6px}</style>
  <script>!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@popperjs/core")):"function"==typeof define&&define.amd?define(["@popperjs/core"],e):(t=t||self).tippy=e(t.Popper)}(this,(function(t){"use strict";var e={passive:!0,capture:!0};function n(t,e,n){if(Array.isArray(t)){var r=t[e];return null==r?Array.isArray(n)?n[e]:n:r}return t}function r(t,e){var n={}.toString.call(t);return 0===n.indexOf("[object")&&n.indexOf(e+"]")>-1}function i(t,e){return"function"==typeof t?t.apply(void 0,e):t}function o(t,e){return 0===e?t:function(r){clearTimeout(n),n=setTimeout((function(){t(r)}),e)};var n}function a(t,e){var n=Object.assign({},t);return e.forEach((function(t){delete n[t]})),n}function s(t){return[].concat(t)}function u(t,e){-1===t.indexOf(e)&&t.push(e)}function c(t){return t.split("-")[0]}function p(t){return[].slice.call(t)}function f(){return document.createElement("div")}function l(t){return["Element","Fragment"].some((function(e){return r(t,e)}))}function d(t){return r(t,"MouseEvent")}function v(t){return!(!t||!t._tippy||t._tippy.reference!==t)}function m(t){return l(t)?[t]:function(t){return r(t,"NodeList")}(t)?p(t):Array.isArray(t)?t:p(document.querySelectorAll(t))}function g(t,e){t.forEach((function(t){t&&(t.style.transitionDuration=e+"ms")}))}function h(t,e){t.forEach((function(t){t&&t.setAttribute("data-state",e)}))}function b(t){var e=s(t)[0];return e&&e.ownerDocument||document}function y(t,e,n){var r=e+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(e){t[r](e,n)}))}var w={isTouch:!1},E=0;function T(){w.isTouch||(w.isTouch=!0,window.performance&&document.addEventListener("mousemove",C))}function C(){var t=performance.now();t-E<20&&(w.isTouch=!1,document.removeEventListener("mousemove",C)),E=t}function x(){var t=document.activeElement;if(v(t)){var e=t._tippy;t.blur&&!e.state.isVisible&&t.blur()}}var A="undefined"!=typeof window&&"undefined"!=typeof document?navigator.userAgent:"",O=/MSIE |Trident\//.test(A),L=Object.assign({appendTo:function(){return document.body},aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},{animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),D=Object.keys(L);function k(t){var e=(t.plugins||[]).reduce((function(e,n){var r=n.name,i=n.defaultValue;return r&&(e[r]=void 0!==t[r]?t[r]:i),e}),{});return Object.assign({},t,{},e)}function R(t,e){var n=Object.assign({},e,{content:i(e.content,[t])},e.ignoreAttributes?{}:function(t,e){return(e?Object.keys(k(Object.assign({},L,{plugins:e}))):D).reduce((function(e,n){var r=(t.getAttribute("data-tippy-"+n)||"").trim();if(!r)return e;if("content"===n)e[n]=r;else try{e[n]=JSON.parse(r)}catch(t){e[n]=r}return e}),{})}(t,e.plugins));return n.aria=Object.assign({},L.aria,{},n.aria),n.aria={expanded:"auto"===n.aria.expanded?e.interactive:n.aria.expanded,content:"auto"===n.aria.content?e.interactive?null:"describedby":n.aria.content},n}function M(t,e){t.innerHTML=e}function P(t){var e=f();return!0===t?e.className="tippy-arrow":(e.className="tippy-svg-arrow",l(t)?e.appendChild(t):M(e,t)),e}function V(t,e){l(e.content)?(M(t,""),t.appendChild(e.content)):"function"!=typeof e.content&&(e.allowHTML?M(t,e.content):t.textContent=e.content)}function j(t){var e=t.firstElementChild,n=p(e.children);return{box:e,content:n.find((function(t){return t.classList.contains("tippy-content")})),arrow:n.find((function(t){return t.classList.contains("tippy-arrow")||t.classList.contains("tippy-svg-arrow")})),backdrop:n.find((function(t){return t.classList.contains("tippy-backdrop")}))}}function I(t){var e=f(),n=f();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=f();function i(n,r){var i=j(e),o=i.box,a=i.content,s=i.arrow;r.theme?o.setAttribute("data-theme",r.theme):o.removeAttribute("data-theme"),"string"==typeof r.animation?o.setAttribute("data-animation",r.animation):o.removeAttribute("data-animation"),r.inertia?o.setAttribute("data-inertia",""):o.removeAttribute("data-inertia"),o.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?o.setAttribute("role",r.role):o.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||V(a,t.props),r.arrow?s?n.arrow!==r.arrow&&(o.removeChild(s),o.appendChild(P(r.arrow))):o.appendChild(P(r.arrow)):s&&o.removeChild(s)}return r.className="tippy-content",r.setAttribute("data-state","hidden"),V(r,t.props),e.appendChild(n),n.appendChild(r),i(t.props,t.props),{popper:e,onUpdate:i}}I.$$tippy=!0;var S=1,B=[],H=[];function N(r,a){var l,v,m,E,T,C,x,A,D,M=R(r,Object.assign({},L,{},k((l=a,Object.keys(l).reduce((function(t,e){return void 0!==l[e]&&(t[e]=l[e]),t}),{}))))),P=!1,V=!1,I=!1,N=!1,U=[],_=o(bt,M.interactiveDebounce),F=S++,W=(D=M.plugins).filter((function(t,e){return D.indexOf(t)===e})),X={id:F,reference:r,popper:f(),popperInstance:null,props:M,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:W,clearDelayTimeouts:function(){clearTimeout(v),clearTimeout(m),cancelAnimationFrame(E)},setProps:function(t){if(X.state.isDestroyed)return;it("onBeforeUpdate",[X,t]),gt();var e=X.props,n=R(r,Object.assign({},X.props,{},t,{ignoreAttributes:!0}));X.props=n,mt(),e.interactiveDebounce!==n.interactiveDebounce&&(st(),_=o(bt,n.interactiveDebounce));e.triggerTarget&&!n.triggerTarget?s(e.triggerTarget).forEach((function(t){t.removeAttribute("aria-expanded")})):n.triggerTarget&&r.removeAttribute("aria-expanded");at(),rt(),q&&q(e,n);X.popperInstance&&(Tt(),xt().forEach((function(t){requestAnimationFrame(t._tippy.popperInstance.forceUpdate)})));it("onAfterUpdate",[X,t])},setContent:function(t){X.setProps({content:t})},show:function(){var t=X.state.isVisible,e=X.state.isDestroyed,r=!X.state.isEnabled,o=w.isTouch&&!X.props.touch,a=n(X.props.duration,0,L.duration);if(t||e||r||o)return;if(Z().hasAttribute("disabled"))return;if(it("onShow",[X],!1),!1===X.props.onShow(X))return;X.state.isVisible=!0,Q()&&($.style.visibility="visible");rt(),ft(),X.state.isMounted||($.style.transition="none");if(Q()){var s=et(),c=s.box,p=s.content;g([c,p],0)}x=function(){if(X.state.isVisible&&!N){if(N=!0,$.offsetHeight,$.style.transition=X.props.moveTransition,Q()&&X.props.animation){var t=et(),e=t.box,n=t.content;g([e,n],a),h([e,n],"visible")}ot(),at(),u(H,X),X.state.isMounted=!0,it("onMount",[X]),X.props.animation&&Q()&&function(t,e){dt(t,e)}(a,(function(){X.state.isShown=!0,it("onShown",[X])}))}},function(){var t,e=X.props.appendTo,n=Z();t=X.props.interactive&&e===L.appendTo||"parent"===e?n.parentNode:i(e,[n]);t.contains($)||t.appendChild($);Tt()}()},hide:function(){var t=!X.state.isVisible,e=X.state.isDestroyed,r=!X.state.isEnabled,i=n(X.props.duration,1,L.duration);if(t||e||r)return;if(it("onHide",[X],!1),!1===X.props.onHide(X))return;X.state.isVisible=!1,X.state.isShown=!1,N=!1,P=!1,Q()&&($.style.visibility="hidden");if(st(),lt(),rt(),Q()){var o=et(),a=o.box,s=o.content;X.props.animation&&(g([a,s],i),h([a,s],"hidden"))}ot(),at(),X.props.animation?Q()&&function(t,e){dt(t,(function(){!X.state.isVisible&&$.parentNode&&$.parentNode.contains($)&&e()}))}(i,X.unmount):X.unmount()},hideWithInteractivity:function(t){tt().addEventListener("mousemove",_),u(B,_),_(t)},enable:function(){X.state.isEnabled=!0},disable:function(){X.hide(),X.state.isEnabled=!1},unmount:function(){X.state.isVisible&&X.hide();if(!X.state.isMounted)return;Ct(),xt().forEach((function(t){t._tippy.unmount()})),$.parentNode&&$.parentNode.removeChild($);H=H.filter((function(t){return t!==X})),X.state.isMounted=!1,it("onHidden",[X])},destroy:function(){if(X.state.isDestroyed)return;X.clearDelayTimeouts(),X.unmount(),gt(),delete r._tippy,X.state.isDestroyed=!0,it("onDestroy",[X])}};if(!M.render)return X;var Y=M.render(X),$=Y.popper,q=Y.onUpdate;$.setAttribute("data-tippy-root",""),$.id="tippy-"+X.id,X.popper=$,r._tippy=X,$._tippy=X;var z=W.map((function(t){return t.fn(X)})),J=r.hasAttribute("aria-expanded");return mt(),at(),rt(),it("onCreate",[X]),M.showOnCreate&&At(),$.addEventListener("mouseenter",(function(){X.props.interactive&&X.state.isVisible&&X.clearDelayTimeouts()})),$.addEventListener("mouseleave",(function(t){X.props.interactive&&X.props.trigger.indexOf("mouseenter")>=0&&(tt().addEventListener("mousemove",_),_(t))})),X;function G(){var t=X.props.touch;return Array.isArray(t)?t:[t,0]}function K(){return"hold"===G()[0]}function Q(){var t;return!!(null==(t=X.props.render)?void 0:t.$$tippy)}function Z(){return A||r}function tt(){var t=Z().parentNode;return t?b(t):document}function et(){return j($)}function nt(t){return X.state.isMounted&&!X.state.isVisible||w.isTouch||T&&"focus"===T.type?0:n(X.props.delay,t?0:1,L.delay)}function rt(){$.style.pointerEvents=X.props.interactive&&X.state.isVisible?"":"none",$.style.zIndex=""+X.props.zIndex}function it(t,e,n){var r;(void 0===n&&(n=!0),z.forEach((function(n){n[t]&&n[t].apply(void 0,e)})),n)&&(r=X.props)[t].apply(r,e)}function ot(){var t=X.props.aria;if(t.content){var e="aria-"+t.content,n=$.id;s(X.props.triggerTarget||r).forEach((function(t){var r=t.getAttribute(e);if(X.state.isVisible)t.setAttribute(e,r?r+" "+n:n);else{var i=r&&r.replace(n,"").trim();i?t.setAttribute(e,i):t.removeAttribute(e)}}))}}function at(){!J&&X.props.aria.expanded&&s(X.props.triggerTarget||r).forEach((function(t){X.props.interactive?t.setAttribute("aria-expanded",X.state.isVisible&&t===Z()?"true":"false"):t.removeAttribute("aria-expanded")}))}function st(){tt().removeEventListener("mousemove",_),B=B.filter((function(t){return t!==_}))}function ut(t){if(!(w.isTouch&&(I||"mousedown"===t.type)||X.props.interactive&&$.contains(t.target))){if(Z().contains(t.target)){if(w.isTouch)return;if(X.state.isVisible&&X.props.trigger.indexOf("click")>=0)return}else it("onClickOutside",[X,t]);!0===X.props.hideOnClick&&(X.clearDelayTimeouts(),X.hide(),V=!0,setTimeout((function(){V=!1})),X.state.isMounted||lt())}}function ct(){I=!0}function pt(){I=!1}function ft(){var t=tt();t.addEventListener("mousedown",ut,!0),t.addEventListener("touchend",ut,e),t.addEventListener("touchstart",pt,e),t.addEventListener("touchmove",ct,e)}function lt(){var t=tt();t.removeEventListener("mousedown",ut,!0),t.removeEventListener("touchend",ut,e),t.removeEventListener("touchstart",pt,e),t.removeEventListener("touchmove",ct,e)}function dt(t,e){var n=et().box;function r(t){t.target===n&&(y(n,"remove",r),e())}if(0===t)return e();y(n,"remove",C),y(n,"add",r),C=r}function vt(t,e,n){void 0===n&&(n=!1),s(X.props.triggerTarget||r).forEach((function(r){r.addEventListener(t,e,n),U.push({node:r,eventType:t,handler:e,options:n})}))}function mt(){var t;K()&&(vt("touchstart",ht,{passive:!0}),vt("touchend",yt,{passive:!0})),(t=X.props.trigger,t.split(/\s+/).filter(Boolean)).forEach((function(t){if("manual"!==t)switch(vt(t,ht),t){case"mouseenter":vt("mouseleave",yt);break;case"focus":vt(O?"focusout":"blur",wt);break;case"focusin":vt("focusout",wt)}}))}function gt(){U.forEach((function(t){var e=t.node,n=t.eventType,r=t.handler,i=t.options;e.removeEventListener(n,r,i)})),U=[]}function ht(t){var e,n=!1;if(X.state.isEnabled&&!Et(t)&&!V){var r="focus"===(null==(e=T)?void 0:e.type);T=t,A=t.currentTarget,at(),!X.state.isVisible&&d(t)&&B.forEach((function(e){return e(t)})),"click"===t.type&&(X.props.trigger.indexOf("mouseenter")<0||P)&&!1!==X.props.hideOnClick&&X.state.isVisible?n=!0:At(t),"click"===t.type&&(P=!n),n&&!r&&Ot(t)}}function bt(t){var e=t.target,n=Z().contains(e)||$.contains(e);"mousemove"===t.type&&n||function(t,e){var n=e.clientX,r=e.clientY;return t.every((function(t){var e=t.popperRect,i=t.popperState,o=t.props.interactiveBorder,a=c(i.placement),s=i.modifiersData.offset;if(!s)return!0;var u="bottom"===a?s.top.y:0,p="top"===a?s.bottom.y:0,f="right"===a?s.left.x:0,l="left"===a?s.right.x:0,d=e.top-r+u>o,v=r-e.bottom-p>o,m=e.left-n+f>o,g=n-e.right-l>o;return d||v||m||g}))}(xt().concat($).map((function(t){var e,n=null==(e=t._tippy.popperInstance)?void 0:e.state;return n?{popperRect:t.getBoundingClientRect(),popperState:n,props:M}:null})).filter(Boolean),t)&&(st(),Ot(t))}function yt(t){Et(t)||X.props.trigger.indexOf("click")>=0&&P||(X.props.interactive?X.hideWithInteractivity(t):Ot(t))}function wt(t){X.props.trigger.indexOf("focusin")<0&&t.target!==Z()||X.props.interactive&&t.relatedTarget&&$.contains(t.relatedTarget)||Ot(t)}function Et(t){return!!w.isTouch&&K()!==t.type.indexOf("touch")>=0}function Tt(){Ct();var e=X.props,n=e.popperOptions,i=e.placement,o=e.offset,a=e.getReferenceClientRect,s=e.moveTransition,u=Q()?j($).arrow:null,c=a?{getBoundingClientRect:a,contextElement:a.contextElement||Z()}:r,p=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!s}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(t){var e=t.state;if(Q()){var n=et().box;["placement","reference-hidden","escaped"].forEach((function(t){"placement"===t?n.setAttribute("data-placement",e.placement):e.attributes.popper["data-popper-"+t]?n.setAttribute("data-"+t,""):n.removeAttribute("data-"+t)})),e.attributes.popper={}}}}];Q()&&u&&p.push({name:"arrow",options:{element:u,padding:3}}),p.push.apply(p,(null==n?void 0:n.modifiers)||[]),X.popperInstance=t.createPopper(c,$,Object.assign({},n,{placement:i,onFirstUpdate:x,modifiers:p}))}function Ct(){X.popperInstance&&(X.popperInstance.destroy(),X.popperInstance=null)}function xt(){return p($.querySelectorAll("[data-tippy-root]"))}function At(t){X.clearDelayTimeouts(),t&&it("onTrigger",[X,t]),ft();var e=nt(!0),n=G(),r=n[0],i=n[1];w.isTouch&&"hold"===r&&i&&(e=i),e?v=setTimeout((function(){X.show()}),e):X.show()}function Ot(t){if(X.clearDelayTimeouts(),it("onUntrigger",[X,t]),X.state.isVisible){if(!(X.props.trigger.indexOf("mouseenter")>=0&&X.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(t.type)>=0&&P)){var e=nt(!1);e?m=setTimeout((function(){X.state.isVisible&&X.hide()}),e):E=requestAnimationFrame((function(){X.hide()}))}}else lt()}}function U(t,n){void 0===n&&(n={});var r=L.plugins.concat(n.plugins||[]);document.addEventListener("touchstart",T,e),window.addEventListener("blur",x);var i=Object.assign({},n,{plugins:r}),o=m(t).reduce((function(t,e){var n=e&&N(e,i);return n&&t.push(n),t}),[]);return l(t)?o[0]:o}U.defaultProps=L,U.setDefaultProps=function(t){Object.keys(t).forEach((function(e){L[e]=t[e]}))},U.currentInput=w;var _={mouseover:"mouseenter",focusin:"focus",click:"click"};var F={name:"animateFill",defaultValue:!1,fn:function(t){var e;if(!(null==(e=t.props.render)?void 0:e.$$tippy))return{};var n=j(t.popper),r=n.box,i=n.content,o=t.props.animateFill?function(){var t=f();return t.className="tippy-backdrop",h([t],"hidden"),t}():null;return{onCreate:function(){o&&(r.insertBefore(o,r.firstElementChild),r.setAttribute("data-animatefill",""),r.style.overflow="hidden",t.setProps({arrow:!1,animation:"shift-away"}))},onMount:function(){if(o){var t=r.style.transitionDuration,e=Number(t.replace("ms",""));i.style.transitionDelay=Math.round(e/10)+"ms",o.style.transitionDuration=t,h([o],"visible")}},onShow:function(){o&&(o.style.transitionDuration="0ms")},onHide:function(){o&&h([o],"hidden")}}}};var W={clientX:0,clientY:0},X=[];function Y(t){var e=t.clientX,n=t.clientY;W={clientX:e,clientY:n}}var $={name:"followCursor",defaultValue:!1,fn:function(t){var e=t.reference,n=b(t.props.triggerTarget||e),r=!1,i=!1,o=!0,a=t.props;function s(){return"initial"===t.props.followCursor&&t.state.isVisible}function u(){n.addEventListener("mousemove",f)}function c(){n.removeEventListener("mousemove",f)}function p(){r=!0,t.setProps({getReferenceClientRect:null}),r=!1}function f(n){var r=!n.target||e.contains(n.target),i=t.props.followCursor,o=n.clientX,a=n.clientY,s=e.getBoundingClientRect(),u=o-s.left,c=a-s.top;!r&&t.props.interactive||t.setProps({getReferenceClientRect:function(){var t=e.getBoundingClientRect(),n=o,r=a;"initial"===i&&(n=t.left+u,r=t.top+c);var s="horizontal"===i?t.top:r,p="vertical"===i?t.right:n,f="horizontal"===i?t.bottom:r,l="vertical"===i?t.left:n;return{width:p-l,height:f-s,top:s,right:p,bottom:f,left:l}}})}function l(){t.props.followCursor&&(X.push({instance:t,doc:n}),function(t){t.addEventListener("mousemove",Y)}(n))}function v(){0===(X=X.filter((function(e){return e.instance!==t}))).filter((function(t){return t.doc===n})).length&&function(t){t.removeEventListener("mousemove",Y)}(n)}return{onCreate:l,onDestroy:v,onBeforeUpdate:function(){a=t.props},onAfterUpdate:function(e,n){var o=n.followCursor;r||void 0!==o&&a.followCursor!==o&&(v(),o?(l(),!t.state.isMounted||i||s()||u()):(c(),p()))},onMount:function(){t.props.followCursor&&!i&&(o&&(f(W),o=!1),s()||u())},onTrigger:function(t,e){d(e)&&(W={clientX:e.clientX,clientY:e.clientY}),i="focus"===e.type},onHidden:function(){t.props.followCursor&&(p(),c(),o=!0)}}}};var q={name:"inlinePositioning",defaultValue:!1,fn:function(t){var e,n=t.reference;var r=-1,i=!1,o={name:"tippyInlinePositioning",enabled:!0,phase:"afterWrite",fn:function(i){var o=i.state;t.props.inlinePositioning&&(e!==o.placement&&t.setProps({getReferenceClientRect:function(){return function(t){return function(t,e,n,r){if(n.length<2||null===t)return e;if(2===n.length&&r>=0&&n[0].left>n[1].right)return n[r]||e;switch(t){case"top":case"bottom":var i=n[0],o=n[n.length-1],a="top"===t,s=i.top,u=o.bottom,c=a?i.left:o.left,p=a?i.right:o.right;return{top:s,bottom:u,left:c,right:p,width:p-c,height:u-s};case"left":case"right":var f=Math.min.apply(Math,n.map((function(t){return t.left}))),l=Math.max.apply(Math,n.map((function(t){return t.right}))),d=n.filter((function(e){return"left"===t?e.left===f:e.right===l})),v=d[0].top,m=d[d.length-1].bottom;return{top:v,bottom:m,left:f,right:l,width:l-f,height:m-v};default:return e}}(c(t),n.getBoundingClientRect(),p(n.getClientRects()),r)}(o.placement)}}),e=o.placement)}};function a(){var e;i||(e=function(t,e){var n;return{popperOptions:Object.assign({},t.popperOptions,{modifiers:[].concat(((null==(n=t.popperOptions)?void 0:n.modifiers)||[]).filter((function(t){return t.name!==e.name})),[e])})}}(t.props,o),i=!0,t.setProps(e),i=!1)}return{onCreate:a,onAfterUpdate:a,onTrigger:function(e,n){if(d(n)){var i=p(t.reference.getClientRects()),o=i.find((function(t){return t.left-2<=n.clientX&&t.right+2>=n.clientX&&t.top-2<=n.clientY&&t.bottom+2>=n.clientY}));r=i.indexOf(o)}},onUntrigger:function(){r=-1}}}};var z={name:"sticky",defaultValue:!1,fn:function(t){var e=t.reference,n=t.popper;function r(e){return!0===t.props.sticky||t.props.sticky===e}var i=null,o=null;function a(){var s=r("reference")?(t.popperInstance?t.popperInstance.state.elements.reference:e).getBoundingClientRect():null,u=r("popper")?n.getBoundingClientRect():null;(s&&J(i,s)||u&&J(o,u))&&t.popperInstance&&t.popperInstance.update(),i=s,o=u,t.state.isMounted&&requestAnimationFrame(a)}return{onMount:function(){t.props.sticky&&a()}}}};function J(t,e){return!t||!e||(t.top!==e.top||t.right!==e.right||t.bottom!==e.bottom||t.left!==e.left)}return U.setDefaultProps({plugins:[F,$,q,z],render:I}),U.createSingleton=function(t,e){void 0===e&&(e={});var n,r=t,i=[],o=e.overrides,s=[];function u(){i=r.map((function(t){return t.reference}))}function c(t){r.forEach((function(e){t?e.enable():e.disable()}))}function p(t){return r.map((function(e){var r=e.setProps;return e.setProps=function(i){r(i),e.reference===n&&t.setProps(i)},function(){e.setProps=r}}))}c(!1),u();var l={fn:function(){return{onDestroy:function(){c(!0)},onTrigger:function(t,e){var a=e.currentTarget,s=i.indexOf(a);if(a!==n){n=a;var u=(o||[]).concat("content").reduce((function(t,e){return t[e]=r[s].props[e],t}),{});t.setProps(Object.assign({},u,{getReferenceClientRect:"function"==typeof u.getReferenceClientRect?u.getReferenceClientRect:function(){return a.getBoundingClientRect()}}))}}}}},d=U(f(),Object.assign({},a(e,["overrides"]),{plugins:[l].concat(e.plugins||[]),triggerTarget:i})),v=d.setProps;return d.setProps=function(t){o=t.overrides||o,v(t)},d.setInstances=function(t){c(!0),s.forEach((function(t){return t()})),r=t,c(!1),u(),p(d),d.setProps({triggerTarget:i})},s=p(d),d},U.delegate=function(t,e){var n=[],r=[],i=!1,o=e.target,u=a(e,["target"]),c=Object.assign({},u,{trigger:"manual",touch:!1}),p=Object.assign({},u,{showOnCreate:!0}),f=U(t,c);function l(t){if(t.target&&!i){var n=t.target.closest(o);if(n){var a=n.getAttribute("data-tippy-trigger")||e.trigger||L.trigger;if(!n._tippy&&!("touchstart"===t.type&&"boolean"==typeof p.touch||"touchstart"!==t.type&&a.indexOf(_[t.type])<0)){var s=U(n,p);s&&(r=r.concat(s))}}}}function d(t,e,r,i){void 0===i&&(i=!1),t.addEventListener(e,r,i),n.push({node:t,eventType:e,handler:r,options:i})}return s(f).forEach((function(t){var e=t.destroy,o=t.enable,a=t.disable;t.destroy=function(t){void 0===t&&(t=!0),t&&r.forEach((function(t){t.destroy()})),r=[],n.forEach((function(t){var e=t.node,n=t.eventType,r=t.handler,i=t.options;e.removeEventListener(n,r,i)})),n=[],e()},t.enable=function(){o(),r.forEach((function(t){return t.enable()})),i=!1},t.disable=function(){a(),r.forEach((function(t){return t.disable()})),i=!0},function(t){var e=t.reference;d(e,"touchstart",l),d(e,"mouseover",l),d(e,"focusin",l),d(e,"click",l)}(t)})),f},U.hideAll=function(t){var e=void 0===t?{}:t,n=e.exclude,r=e.duration;H.forEach((function(t){var e=!1;if(n&&(e=v(n)?t.reference===n:t.popper===n.popper),!e){var i=t.props.duration;t.setProps({duration:r}),t.hide(),t.state.isDestroyed||t.setProps({duration:i})}}))},U.roundArrow='<svg width="16" height="6" xmlns="http://www.w3.org/2000/svg"><path d="M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z"></svg>',U}));
//# sourceMappingURL=tippy.umd.min.js.map
</script>
  <script>// @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt Expat
//
// AnchorJS - v4.2.2 - 2019-11-14
// https://www.bryanbraun.com/anchorjs/
// Copyright (c) 2019 Bryan Braun; Licensed MIT
//
// @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&dn=expat.txt Expat
!function(A,e){"use strict";"function"==typeof define&&define.amd?define([],e):"object"==typeof module&&module.exports?module.exports=e():(A.AnchorJS=e(),A.anchors=new A.AnchorJS)}(this,function(){"use strict";return function(A){function f(A){A.icon=A.hasOwnProperty("icon")?A.icon:"",A.visible=A.hasOwnProperty("visible")?A.visible:"hover",A.placement=A.hasOwnProperty("placement")?A.placement:"right",A.ariaLabel=A.hasOwnProperty("ariaLabel")?A.ariaLabel:"Anchor",A.class=A.hasOwnProperty("class")?A.class:"",A.base=A.hasOwnProperty("base")?A.base:"",A.truncate=A.hasOwnProperty("truncate")?Math.floor(A.truncate):64,A.titleText=A.hasOwnProperty("titleText")?A.titleText:""}function p(A){var e;if("string"==typeof A||A instanceof String)e=[].slice.call(document.querySelectorAll(A));else{if(!(Array.isArray(A)||A instanceof NodeList))throw new Error("The selector provided to AnchorJS was invalid.");e=[].slice.call(A)}return e}this.options=A||{},this.elements=[],f(this.options),this.isTouchDevice=function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)},this.add=function(A){var e,t,i,n,o,s,a,r,c,h,l,u,d=[];if(f(this.options),"touch"===(l=this.options.visible)&&(l=this.isTouchDevice()?"always":"hover"),0===(e=p(A=A||"h2, h3, h4, h5, h6")).length)return this;for(!function(){if(null!==document.head.querySelector("style.anchorjs"))return;var A,e=document.createElement("style");e.className="anchorjs",e.appendChild(document.createTextNode("")),void 0===(A=document.head.querySelector('[rel="stylesheet"], style'))?document.head.appendChild(e):document.head.insertBefore(e,A);e.sheet.insertRule(" .anchorjs-link {   opacity: 0;   text-decoration: none;   -webkit-font-smoothing: antialiased;   -moz-osx-font-smoothing: grayscale; }",e.sheet.cssRules.length),e.sheet.insertRule(" *:hover > .anchorjs-link, .anchorjs-link:focus  {   opacity: 1; }",e.sheet.cssRules.length),e.sheet.insertRule(" [data-anchorjs-icon]::after {   content: attr(data-anchorjs-icon); }",e.sheet.cssRules.length),e.sheet.insertRule(' @font-face {   font-family: "anchorjs-icons";   src: url(data:n/a;base64,AAEAAAALAIAAAwAwT1MvMg8yG2cAAAE4AAAAYGNtYXDp3gC3AAABpAAAAExnYXNwAAAAEAAAA9wAAAAIZ2x5ZlQCcfwAAAH4AAABCGhlYWQHFvHyAAAAvAAAADZoaGVhBnACFwAAAPQAAAAkaG10eASAADEAAAGYAAAADGxvY2EACACEAAAB8AAAAAhtYXhwAAYAVwAAARgAAAAgbmFtZQGOH9cAAAMAAAAAunBvc3QAAwAAAAADvAAAACAAAQAAAAEAAHzE2p9fDzz1AAkEAAAAAADRecUWAAAAANQA6R8AAAAAAoACwAAAAAgAAgAAAAAAAAABAAADwP/AAAACgAAA/9MCrQABAAAAAAAAAAAAAAAAAAAAAwABAAAAAwBVAAIAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAMCQAGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAg//0DwP/AAEADwABAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAAIAAAACgAAxAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEADAAAAAIAAgAAgAAACDpy//9//8AAAAg6cv//f///+EWNwADAAEAAAAAAAAAAAAAAAAACACEAAEAAAAAAAAAAAAAAAAxAAACAAQARAKAAsAAKwBUAAABIiYnJjQ3NzY2MzIWFxYUBwcGIicmNDc3NjQnJiYjIgYHBwYUFxYUBwYGIwciJicmNDc3NjIXFhQHBwYUFxYWMzI2Nzc2NCcmNDc2MhcWFAcHBgYjARQGDAUtLXoWOR8fORYtLTgKGwoKCjgaGg0gEhIgDXoaGgkJBQwHdR85Fi0tOAobCgoKOBoaDSASEiANehoaCQkKGwotLXoWOR8BMwUFLYEuehYXFxYugC44CQkKGwo4GkoaDQ0NDXoaShoKGwoFBe8XFi6ALjgJCQobCjgaShoNDQ0NehpKGgobCgoKLYEuehYXAAAADACWAAEAAAAAAAEACAAAAAEAAAAAAAIAAwAIAAEAAAAAAAMACAAAAAEAAAAAAAQACAAAAAEAAAAAAAUAAQALAAEAAAAAAAYACAAAAAMAAQQJAAEAEAAMAAMAAQQJAAIABgAcAAMAAQQJAAMAEAAMAAMAAQQJAAQAEAAMAAMAAQQJAAUAAgAiAAMAAQQJAAYAEAAMYW5jaG9yanM0MDBAAGEAbgBjAGgAbwByAGoAcwA0ADAAMABAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAH//wAP) format("truetype"); }',e.sheet.cssRules.length)}(),t=document.querySelectorAll("[id]"),i=[].map.call(t,function(A){return A.id}),o=0;o<e.length;o++)if(this.hasAnchorJSLink(e[o]))d.push(o);else{if(e[o].hasAttribute("id"))n=e[o].getAttribute("id");else if(e[o].hasAttribute("data-anchor-id"))n=e[o].getAttribute("data-anchor-id");else{for(c=r=this.urlify(e[o].textContent),a=0;void 0!==s&&(c=r+"-"+a),a+=1,-1!==(s=i.indexOf(c)););s=void 0,i.push(c),e[o].setAttribute("id",c),n=c}(h=document.createElement("a")).className="anchorjs-link "+this.options.class,h.setAttribute("aria-label",this.options.ariaLabel),h.setAttribute("data-anchorjs-icon",this.options.icon),this.options.titleText&&(h.title=this.options.titleText),u=document.querySelector("base")?window.location.pathname+window.location.search:"",u=this.options.base||u,h.href=u+"#"+n,"always"===l&&(h.style.opacity="1"),""===this.options.icon&&(h.style.font="1em/1 anchorjs-icons","left"===this.options.placement&&(h.style.lineHeight="inherit")),"left"===this.options.placement?(h.style.position="absolute",h.style.marginLeft="-1em",h.style.paddingRight="0.5em",e[o].insertBefore(h,e[o].firstChild)):(h.style.paddingLeft="0.375em",e[o].appendChild(h))}for(o=0;o<d.length;o++)e.splice(d[o]-o,1);return this.elements=this.elements.concat(e),this},this.remove=function(A){for(var e,t,i=p(A),n=0;n<i.length;n++)(t=i[n].querySelector(".anchorjs-link"))&&(-1!==(e=this.elements.indexOf(i[n]))&&this.elements.splice(e,1),i[n].removeChild(t));return this},this.removeAll=function(){this.remove(this.elements)},this.urlify=function(A){return this.options.truncate||f(this.options),A.trim().replace(/\'/gi,"").replace(/[& +$,:;=?@"#{}|^~[`%!'<>\]\.\/\(\)\*\\\n\t\b\v]/g,"-").replace(/-{2,}/g,"-").substring(0,this.options.truncate).replace(/^-+|-+$/gm,"").toLowerCase()},this.hasAnchorJSLink=function(A){var e=A.firstChild&&-1<(" "+A.firstChild.className+" ").indexOf(" anchorjs-link "),t=A.lastChild&&-1<(" "+A.lastChild.className+" ").indexOf(" anchorjs-link ");return e||t||!1}}});
// @license-end</script>
  <script>/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */
!function(e,t,n){typeof module!="undefined"&&module.exports?module.exports=n():typeof define=="function"&&define.amd?define(t,n):e[t]=n()}(this,"bowser",function(){function t(t){function n(e){var n=t.match(e);return n&&n.length>1&&n[1]||""}function r(e){var n=t.match(e);return n&&n.length>1&&n[2]||""}function N(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return undefined}}var i=n(/(ipod|iphone|ipad)/i).toLowerCase(),s=/like android/i.test(t),o=!s&&/android/i.test(t),u=/nexus\s*[0-6]\s*/i.test(t),a=!u&&/nexus\s*[0-9]+/i.test(t),f=/CrOS/.test(t),l=/silk/i.test(t),c=/sailfish/i.test(t),h=/tizen/i.test(t),p=/(web|hpw)os/i.test(t),d=/windows phone/i.test(t),v=/SamsungBrowser/i.test(t),m=!d&&/windows/i.test(t),g=!i&&!l&&/macintosh/i.test(t),y=!o&&!c&&!h&&!p&&/linux/i.test(t),b=r(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),w=n(/version\/(\d+(\.\d+)?)/i),E=/tablet/i.test(t)&&!/tablet pc/i.test(t),S=!E&&/[^-]mobi/i.test(t),x=/xbox/i.test(t),T;/opera/i.test(t)?T={name:"Opera",opera:e,version:w||n(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(t)?T={name:"Opera",opera:e,version:n(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||w}:/SamsungBrowser/i.test(t)?T={name:"Samsung Internet for Android",samsungBrowser:e,version:w||n(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(t)?T={name:"Opera Coast",coast:e,version:w||n(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(t)?T={name:"Yandex Browser",yandexbrowser:e,version:w||n(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(t)?T={name:"UC Browser",ucbrowser:e,version:n(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(t)?T={name:"Maxthon",maxthon:e,version:n(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(t)?T={name:"Epiphany",epiphany:e,version:n(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(t)?T={name:"Puffin",puffin:e,version:n(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(t)?T={name:"Sleipnir",sleipnir:e,version:n(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(t)?T={name:"K-Meleon",kMeleon:e,version:n(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:d?(T={name:"Windows Phone",osname:"Windows Phone",windowsphone:e},b?(T.msedge=e,T.version=b):(T.msie=e,T.version=n(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(t)?T={name:"Internet Explorer",msie:e,version:n(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:f?T={name:"Chrome",osname:"Chrome OS",chromeos:e,chromeBook:e,chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(t)?T={name:"Microsoft Edge",msedge:e,version:b}:/vivaldi/i.test(t)?T={name:"Vivaldi",vivaldi:e,version:n(/vivaldi\/(\d+(\.\d+)?)/i)||w}:c?T={name:"Sailfish",osname:"Sailfish OS",sailfish:e,version:n(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(t)?T={name:"SeaMonkey",seamonkey:e,version:n(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(t)?(T={name:"Firefox",firefox:e,version:n(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(t)&&(T.firefoxos=e,T.osname="Firefox OS")):l?T={name:"Amazon Silk",silk:e,version:n(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(t)?T={name:"PhantomJS",phantom:e,version:n(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(t)?T={name:"SlimerJS",slimer:e,version:n(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(t)||/rim\stablet/i.test(t)?T={name:"BlackBerry",osname:"BlackBerry OS",blackberry:e,version:w||n(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:p?(T={name:"WebOS",osname:"WebOS",webos:e,version:w||n(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(t)&&(T.touchpad=e)):/bada/i.test(t)?T={name:"Bada",osname:"Bada",bada:e,version:n(/dolfin\/(\d+(\.\d+)?)/i)}:h?T={name:"Tizen",osname:"Tizen",tizen:e,version:n(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||w}:/qupzilla/i.test(t)?T={name:"QupZilla",qupzilla:e,version:n(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||w}:/chromium/i.test(t)?T={name:"Chromium",chromium:e,version:n(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||w}:/chrome|crios|crmo/i.test(t)?T={name:"Chrome",chrome:e,version:n(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:o?T={name:"Android",version:w}:/safari|applewebkit/i.test(t)?(T={name:"Safari",safari:e},w&&(T.version=w)):i?(T={name:i=="iphone"?"iPhone":i=="ipad"?"iPad":"iPod"},w&&(T.version=w)):/googlebot/i.test(t)?T={name:"Googlebot",googlebot:e,version:n(/googlebot\/(\d+(\.\d+))/i)||w}:T={name:n(/^(.*)\/(.*) /),version:r(/^(.*)\/(.*) /)},!T.msedge&&/(apple)?webkit/i.test(t)?(/(apple)?webkit\/537\.36/i.test(t)?(T.name=T.name||"Blink",T.blink=e):(T.name=T.name||"Webkit",T.webkit=e),!T.version&&w&&(T.version=w)):!T.opera&&/gecko\//i.test(t)&&(T.name=T.name||"Gecko",T.gecko=e,T.version=T.version||n(/gecko\/(\d+(\.\d+)?)/i)),!T.windowsphone&&(o||T.silk)?(T.android=e,T.osname="Android"):!T.windowsphone&&i?(T[i]=e,T.ios=e,T.osname="iOS"):g?(T.mac=e,T.osname="macOS"):x?(T.xbox=e,T.osname="Xbox"):m?(T.windows=e,T.osname="Windows"):y&&(T.linux=e,T.osname="Linux");var C="";T.windows?C=N(n(/Windows ((NT|XP)( \d\d?.\d)?)/i)):T.windowsphone?C=n(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):T.mac?(C=n(/Mac OS X (\d+([_\.\s]\d+)*)/i),C=C.replace(/[_\s]/g,".")):i?(C=n(/os (\d+([_\s]\d+)*) like mac os x/i),C=C.replace(/[_\s]/g,".")):o?C=n(/android[ \/-](\d+(\.\d+)*)/i):T.webos?C=n(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):T.blackberry?C=n(/rim\stablet\sos\s(\d+(\.\d+)*)/i):T.bada?C=n(/bada\/(\d+(\.\d+)*)/i):T.tizen&&(C=n(/tizen[\/\s](\d+(\.\d+)*)/i)),C&&(T.osversion=C);var k=!T.windows&&C.split(".")[0];if(E||a||i=="ipad"||o&&(k==3||k>=4&&!S)||T.silk)T.tablet=e;else if(S||i=="iphone"||i=="ipod"||o||u||T.blackberry||T.webos||T.bada)T.mobile=e;return T.msedge||T.msie&&T.version>=10||T.yandexbrowser&&T.version>=15||T.vivaldi&&T.version>=1||T.chrome&&T.version>=20||T.samsungBrowser&&T.version>=4||T.firefox&&T.version>=20||T.safari&&T.version>=6||T.opera&&T.version>=10||T.ios&&T.osversion&&T.osversion.split(".")[0]>=6||T.blackberry&&T.version>=10.1||T.chromium&&T.version>=20?T.a=e:T.msie&&T.version<10||T.chrome&&T.version<20||T.firefox&&T.version<20||T.safari&&T.version<6||T.opera&&T.version<10||T.ios&&T.osversion&&T.osversion.split(".")[0]<6||T.chromium&&T.version<20?T.c=e:T.x=e,T}function r(e){return e.split(".").length}function i(e,t){var n=[],r;if(Array.prototype.map)return Array.prototype.map.call(e,t);for(r=0;r<e.length;r++)n.push(t(e[r]));return n}function s(e){var t=Math.max(r(e[0]),r(e[1])),n=i(e,function(e){var n=t-r(e);return e+=(new Array(n+1)).join(".0"),i(e.split("."),function(e){return(new Array(20-e.length)).join("0")+e}).reverse()});while(--t>=0){if(n[0][t]>n[1][t])return 1;if(n[0][t]!==n[1][t])return-1;if(t===0)return 0}}function o(e,r,i){var o=n;typeof r=="string"&&(i=r,r=void 0),r===void 0&&(r=!1),i&&(o=t(i));var u=""+o.version;for(var a in e)if(e.hasOwnProperty(a)&&o[a]){if(typeof e[a]!="string")throw new Error("Browser version in the minVersion map should be a string: "+a+": "+String(e));return s([u,e[a]])<0}return r}function u(e,t,n){return!o(e,t,n)}var e=!0,n=t(typeof navigator!="undefined"?navigator.userAgent||"":"");return n.test=function(e){for(var t=0;t<e.length;++t){var r=e[t];if(typeof r=="string"&&r in n)return!0}return!1},n.isUnsupportedBrowser=o,n.compareVersions=s,n.check=u,n._detect=t,n.detect=t,n})</script>
  <script>// webcomponents.js requires Set api which is not available in all browsers
if (typeof(Set) !== "undefined") {
/**
@license @nocompile
Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
(function(){/*

 Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
 This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 Code distributed by Google as part of the polymer project is also
 subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
'use strict';var q,aa="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,ba="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};function ca(){ca=function(){};aa.Symbol||(aa.Symbol=da)}var da=function(){var a=0;return function(b){return"jscomp_symbol_"+(b||"")+a++}}();
function ea(){ca();var a=aa.Symbol.iterator;a||(a=aa.Symbol.iterator=aa.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&ba(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return fa(this)}});ea=function(){}}function fa(a){var b=0;return ha(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})}function ha(a){ea();a={next:a};a[aa.Symbol.iterator]=function(){return this};return a}function ia(a){ea();var b=a[Symbol.iterator];return b?b.call(a):fa(a)}
function ja(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}
(function(){if(!function(){var a=document.createEvent("Event");a.initEvent("foo",!0,!0);a.preventDefault();return a.defaultPrevented}()){var a=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(a.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var b=/Trident/.test(navigator.userAgent);if(!window.CustomEvent||b&&"function"!==typeof window.CustomEvent)window.CustomEvent=function(a,b){b=b||{};var c=document.createEvent("CustomEvent");
c.initCustomEvent(a,!!b.bubbles,!!b.cancelable,b.detail);return c},window.CustomEvent.prototype=window.Event.prototype;if(!window.Event||b&&"function"!==typeof window.Event){var c=window.Event;window.Event=function(a,b){b=b||{};var c=document.createEvent("Event");c.initEvent(a,!!b.bubbles,!!b.cancelable);return c};if(c)for(var d in c)window.Event[d]=c[d];window.Event.prototype=c.prototype}if(!window.MouseEvent||b&&"function"!==typeof window.MouseEvent){b=window.MouseEvent;window.MouseEvent=function(a,
b){b=b||{};var c=document.createEvent("MouseEvent");c.initMouseEvent(a,!!b.bubbles,!!b.cancelable,b.view||window,b.detail,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,b.button,b.relatedTarget);return c};if(b)for(d in b)window.MouseEvent[d]=b[d];window.MouseEvent.prototype=b.prototype}Array.from||(Array.from=function(a){return[].slice.call(a)});Object.assign||(Object.assign=function(a,b){for(var c=[].slice.call(arguments,1),d=0,e;d<c.length;d++)if(e=c[d])for(var f=
a,n=e,r=Object.getOwnPropertyNames(n),G=0;G<r.length;G++)e=r[G],f[e]=n[e];return a})})(window.WebComponents);(function(){function a(){}function b(a,b){if(!a.childNodes.length)return[];switch(a.nodeType){case Node.DOCUMENT_NODE:return G.call(a,b);case Node.DOCUMENT_FRAGMENT_NODE:return x.call(a,b);default:return r.call(a,b)}}var c="undefined"===typeof HTMLTemplateElement,d=!(document.createDocumentFragment().cloneNode()instanceof DocumentFragment),e=!1;/Trident/.test(navigator.userAgent)&&function(){function a(a,b){if(a instanceof DocumentFragment)for(var d;d=a.firstChild;)c.call(this,d,b);else c.call(this,
a,b);return a}e=!0;var b=Node.prototype.cloneNode;Node.prototype.cloneNode=function(a){a=b.call(this,a);this instanceof DocumentFragment&&(a.__proto__=DocumentFragment.prototype);return a};DocumentFragment.prototype.querySelectorAll=HTMLElement.prototype.querySelectorAll;DocumentFragment.prototype.querySelector=HTMLElement.prototype.querySelector;Object.defineProperties(DocumentFragment.prototype,{nodeType:{get:function(){return Node.DOCUMENT_FRAGMENT_NODE},configurable:!0},localName:{get:function(){},
configurable:!0},nodeName:{get:function(){return"#document-fragment"},configurable:!0}});var c=Node.prototype.insertBefore;Node.prototype.insertBefore=a;var d=Node.prototype.appendChild;Node.prototype.appendChild=function(b){b instanceof DocumentFragment?a.call(this,b,null):d.call(this,b);return b};var f=Node.prototype.removeChild,g=Node.prototype.replaceChild;Node.prototype.replaceChild=function(b,c){b instanceof DocumentFragment?(a.call(this,b,c),f.call(this,c)):g.call(this,b,c);return c};Document.prototype.createDocumentFragment=
function(){var a=this.createElement("df");a.__proto__=DocumentFragment.prototype;return a};var h=Document.prototype.importNode;Document.prototype.importNode=function(a,b){b=h.call(this,a,b||!1);a instanceof DocumentFragment&&(b.__proto__=DocumentFragment.prototype);return b}}();var f=Node.prototype.cloneNode,g=Document.prototype.createElement,h=Document.prototype.importNode,k=Node.prototype.removeChild,m=Node.prototype.appendChild,n=Node.prototype.replaceChild,r=Element.prototype.querySelectorAll,
G=Document.prototype.querySelectorAll,x=DocumentFragment.prototype.querySelectorAll,v=function(){if(!c){var a=document.createElement("template"),b=document.createElement("template");b.content.appendChild(document.createElement("div"));a.content.appendChild(b);a=a.cloneNode(!0);return 0===a.content.childNodes.length||0===a.content.firstChild.content.childNodes.length||d}}();if(c){var U=document.implementation.createHTMLDocument("template"),Dc=!0,xa=document.createElement("style");xa.textContent="template{display:none;}";
var Ec=document.head;Ec.insertBefore(xa,Ec.firstElementChild);a.prototype=Object.create(HTMLElement.prototype);var mf=!document.createElement("div").hasOwnProperty("innerHTML");a.R=function(b){if(!b.content&&b.namespaceURI===document.documentElement.namespaceURI){b.content=U.createDocumentFragment();for(var c;c=b.firstChild;)m.call(b.content,c);if(mf)b.__proto__=a.prototype;else if(b.cloneNode=function(b){return a.a(this,b)},Dc)try{p(b),Fc(b)}catch(zh){Dc=!1}a.b(b.content)}};var p=function(b){Object.defineProperty(b,
"innerHTML",{get:function(){return Gc(this)},set:function(b){U.body.innerHTML=b;for(a.b(U);this.content.firstChild;)k.call(this.content,this.content.firstChild);for(;U.body.firstChild;)m.call(this.content,U.body.firstChild)},configurable:!0})},Fc=function(a){Object.defineProperty(a,"outerHTML",{get:function(){return"<template>"+this.innerHTML+"</template>"},set:function(a){if(this.parentNode){U.body.innerHTML=a;for(a=this.ownerDocument.createDocumentFragment();U.body.firstChild;)m.call(a,U.body.firstChild);
n.call(this.parentNode,a,this)}else throw Error("Failed to set the 'outerHTML' property on 'Element': This element has no parent node.");},configurable:!0})};p(a.prototype);Fc(a.prototype);a.b=function(c){c=b(c,"template");for(var d=0,e=c.length,f;d<e&&(f=c[d]);d++)a.R(f)};document.addEventListener("DOMContentLoaded",function(){a.b(document)});Document.prototype.createElement=function(){var b=g.apply(this,arguments);"template"===b.localName&&a.R(b);return b};var nf=/[&\u00A0"]/g,kb=/[&\u00A0<>]/g,
l=function(a){switch(a){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";case '"':return"&quot;";case "\u00a0":return"&nbsp;"}};xa=function(a){for(var b={},c=0;c<a.length;c++)b[a[c]]=!0;return b};var F=xa("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),of=xa("style script xmp iframe noembed noframes plaintext noscript".split(" ")),Gc=function(a,b){"template"===a.localName&&(a=a.content);for(var c="",d=b?b(a):a.childNodes,e=0,f=d.length,
g;e<f&&(g=d[e]);e++){a:{var h=g;var k=a;var m=b;switch(h.nodeType){case Node.ELEMENT_NODE:for(var n=h.localName,v="<"+n,r=h.attributes,p=0;k=r[p];p++)v+=" "+k.name+'="'+k.value.replace(nf,l)+'"';v+=">";h=F[n]?v:v+Gc(h,m)+"</"+n+">";break a;case Node.TEXT_NODE:h=h.data;h=k&&of[k.localName]?h:h.replace(kb,l);break a;case Node.COMMENT_NODE:h="\x3c!--"+h.data+"--\x3e";break a;default:throw window.console.error(h),Error("not implemented");}}c+=h}return c}}if(c||v){a.a=function(a,b){var c=f.call(a,!1);
this.R&&this.R(c);b&&(m.call(c.content,f.call(a.content,!0)),lb(c.content,a.content));return c};var lb=function(c,d){if(d.querySelectorAll&&(d=b(d,"template"),0!==d.length)){c=b(c,"template");for(var e=0,f=c.length,g,h;e<f;e++)h=d[e],g=c[e],a&&a.R&&a.R(h),n.call(g.parentNode,pf.call(h,!0),g)}},pf=Node.prototype.cloneNode=function(b){if(!e&&d&&this instanceof DocumentFragment)if(b)var c=qf.call(this.ownerDocument,this,!0);else return this.ownerDocument.createDocumentFragment();else this.nodeType===
Node.ELEMENT_NODE&&"template"===this.localName&&this.namespaceURI==document.documentElement.namespaceURI?c=a.a(this,b):c=f.call(this,b);b&&lb(c,this);return c},qf=Document.prototype.importNode=function(c,d){d=d||!1;if("template"===c.localName)return a.a(c,d);var e=h.call(this,c,d);if(d){lb(e,c);c=b(e,'script:not([type]),script[type="application/javascript"],script[type="text/javascript"]');for(var f,k=0;k<c.length;k++){f=c[k];d=g.call(document,"script");d.textContent=f.textContent;for(var m=f.attributes,
l=0,v;l<m.length;l++)v=m[l],d.setAttribute(v.name,v.value);n.call(f.parentNode,d,f)}}return e}}c&&(window.HTMLTemplateElement=a)})();var ka;Array.isArray?ka=Array.isArray:ka=function(a){return"[object Array]"===Object.prototype.toString.call(a)};var la=ka;var ma=0,na,oa="undefined"!==typeof window?window:void 0,pa=oa||{},qa=pa.MutationObserver||pa.WebKitMutationObserver,ra="undefined"===typeof self&&"undefined"!==typeof process&&"[object process]"==={}.toString.call(process),sa="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel;function ta(){return"undefined"!==typeof na?function(){na(ua)}:va()}
function wa(){var a=0,b=new qa(ua),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function ya(){var a=new MessageChannel;a.port1.onmessage=ua;return function(){return a.port2.postMessage(0)}}function va(){var a=setTimeout;return function(){return a(ua,1)}}var za=Array(1E3);function ua(){for(var a=0;a<ma;a+=2)(0,za[a])(za[a+1]),za[a]=void 0,za[a+1]=void 0;ma=0}var Aa,Ba;
if(ra)Ba=function(){return process.xb(ua)};else{var Ca;if(qa)Ca=wa();else{var Da;if(sa)Da=ya();else{var Ea;if(void 0===oa&&"function"===typeof require)try{var Fa=require("vertx");na=Fa.zb||Fa.yb;Ea=ta()}catch(a){Ea=va()}else Ea=va();Da=Ea}Ca=Da}Ba=Ca}Aa=Ba;function Ga(a,b){za[ma]=a;za[ma+1]=b;ma+=2;2===ma&&Aa()};function Ha(a,b){var c=this,d=new this.constructor(Ia);void 0===d[Ja]&&Ka(d);var e=c.o;if(e){var f=arguments[e-1];Ga(function(){return La(e,d,f,c.l)})}else Ma(c,d,a,b);return d};function Na(a){if(a&&"object"===typeof a&&a.constructor===this)return a;var b=new this(Ia);Oa(b,a);return b};var Ja=Math.random().toString(36).substring(16);function Ia(){}var Qa=new Pa;function Ra(a){try{return a.then}catch(b){return Qa.error=b,Qa}}function Sa(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function Ta(a,b,c){Ga(function(a){var d=!1,f=Sa(c,b,function(c){d||(d=!0,b!==c?Oa(a,c):t(a,c))},function(b){d||(d=!0,u(a,b))});!d&&f&&(d=!0,u(a,f))},a)}function Ua(a,b){1===b.o?t(a,b.l):2===b.o?u(a,b.l):Ma(b,void 0,function(b){return Oa(a,b)},function(b){return u(a,b)})}
function Va(a,b,c){b.constructor===a.constructor&&c===Ha&&b.constructor.resolve===Na?Ua(a,b):c===Qa?(u(a,Qa.error),Qa.error=null):void 0===c?t(a,b):"function"===typeof c?Ta(a,b,c):t(a,b)}function Oa(a,b){if(a===b)u(a,new TypeError("You cannot resolve a promise with itself"));else{var c=typeof b;null===b||"object"!==c&&"function"!==c?t(a,b):Va(a,b,Ra(b))}}function Wa(a){a.xa&&a.xa(a.l);Xa(a)}function t(a,b){void 0===a.o&&(a.l=b,a.o=1,0!==a.U.length&&Ga(Xa,a))}
function u(a,b){void 0===a.o&&(a.o=2,a.l=b,Ga(Wa,a))}function Ma(a,b,c,d){var e=a.U,f=e.length;a.xa=null;e[f]=b;e[f+1]=c;e[f+2]=d;0===f&&a.o&&Ga(Xa,a)}function Xa(a){var b=a.U,c=a.o;if(0!==b.length){for(var d,e,f=a.l,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?La(c,d,e,f):e(f);a.U.length=0}}function Pa(){this.error=null}var Ya=new Pa;
function La(a,b,c,d){var e="function"===typeof c;if(e){try{var f=c(d)}catch(m){Ya.error=m,f=Ya}if(f===Ya){var g=!0;var h=f.error;f.error=null}else var k=!0;if(b===f){u(b,new TypeError("A promises callback cannot return that same promise."));return}}else f=d,k=!0;void 0===b.o&&(e&&k?Oa(b,f):g?u(b,h):1===a?t(b,f):2===a&&u(b,f))}function Za(a,b){try{b(function(b){Oa(a,b)},function(b){u(a,b)})}catch(c){u(a,c)}}var $a=0;function Ka(a){a[Ja]=$a++;a.o=void 0;a.l=void 0;a.U=[]};function ab(a,b){this.Na=a;this.N=new a(Ia);this.N[Ja]||Ka(this.N);if(la(b))if(this.$=this.length=b.length,this.l=Array(this.length),0===this.length)t(this.N,this.l);else{this.length=this.length||0;for(a=0;void 0===this.o&&a<b.length;a++)bb(this,b[a],a);0===this.$&&t(this.N,this.l)}else u(this.N,Error("Array Methods must be provided an Array"))}
function bb(a,b,c){var d=a.Na,e=d.resolve;e===Na?(e=Ra(b),e===Ha&&void 0!==b.o?cb(a,b.o,c,b.l):"function"!==typeof e?(a.$--,a.l[c]=b):d===w?(d=new d(Ia),Va(d,b,e),db(a,d,c)):db(a,new d(function(a){return a(b)}),c)):db(a,e(b),c)}function cb(a,b,c,d){var e=a.N;void 0===e.o&&(a.$--,2===b?u(e,d):a.l[c]=d);0===a.$&&t(e,a.l)}function db(a,b,c){Ma(b,void 0,function(b){return cb(a,1,c,b)},function(b){return cb(a,2,c,b)})};function eb(a){return(new ab(this,a)).N};function fb(a){var b=this;return la(a)?new b(function(c,d){for(var e=a.length,f=0;f<e;f++)b.resolve(a[f]).then(c,d)}):new b(function(a,b){return b(new TypeError("You must pass an array to race."))})};function gb(a){var b=new this(Ia);u(b,a);return b};function w(a){this[Ja]=$a++;this.l=this.o=void 0;this.U=[];if(Ia!==a){if("function"!==typeof a)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(this instanceof w)Za(this,a);else throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");}}w.prototype={constructor:w,then:Ha,a:function(a){return this.then(null,a)}};/*

Copyright (c) 2017 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
window.Promise||(window.Promise=w,w.prototype["catch"]=w.prototype.a,w.prototype.then=w.prototype.then,w.all=eb,w.race=fb,w.resolve=Na,w.reject=gb);/*

 Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 Code distributed by Google as part of the polymer project is also
 subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
window.WebComponents=window.WebComponents||{flags:{}};var hb=document.querySelector('script[src*="webcomponents-bundle"]'),ib=/wc-(.+)/,y={};if(!y.noOpts){location.search.slice(1).split("&").forEach(function(a){a=a.split("=");var b;a[0]&&(b=a[0].match(ib))&&(y[b[1]]=a[1]||!0)});if(hb)for(var jb=0,mb;mb=hb.attributes[jb];jb++)"src"!==mb.name&&(y[mb.name]=mb.value||!0);if(y.log&&y.log.split){var nb=y.log.split(",");y.log={};nb.forEach(function(a){y.log[a]=!0})}else y.log={}}
window.WebComponents.flags=y;var ob=y.shadydom;ob&&(window.ShadyDOM=window.ShadyDOM||{},window.ShadyDOM.force=ob);var pb=y.register||y.ce;pb&&window.customElements&&(window.customElements.forcePolyfill=pb);/*

Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
function qb(){this.Da=this.root=null;this.da=!1;this.L=this.Z=this.pa=this.assignedSlot=this.assignedNodes=this.S=null;this.childNodes=this.nextSibling=this.previousSibling=this.lastChild=this.firstChild=this.parentNode=this.V=void 0;this.Ia=this.va=!1}qb.prototype.toJSON=function(){return{}};function z(a){a.ka||(a.ka=new qb);return a.ka}function A(a){return a&&a.ka};var B=window.ShadyDOM||{};B.Ua=!(!Element.prototype.attachShadow||!Node.prototype.getRootNode);var rb=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild");B.I=!!(rb&&rb.configurable&&rb.get);B.Ba=B.force||!B.Ua;var sb=navigator.userAgent.match("Trident"),tb=navigator.userAgent.match("Edge");void 0===B.Fa&&(B.Fa=B.I&&(sb||tb));function ub(a){return(a=A(a))&&void 0!==a.firstChild}function C(a){return"ShadyRoot"===a.Oa}function vb(a){a=a.getRootNode();if(C(a))return a}
var wb=Element.prototype,xb=wb.matches||wb.matchesSelector||wb.mozMatchesSelector||wb.msMatchesSelector||wb.oMatchesSelector||wb.webkitMatchesSelector;function yb(a,b){if(a&&b)for(var c=Object.getOwnPropertyNames(b),d=0,e;d<c.length&&(e=c[d]);d++){var f=Object.getOwnPropertyDescriptor(b,e);f&&Object.defineProperty(a,e,f)}}function zb(a,b){for(var c=[],d=1;d<arguments.length;++d)c[d-1]=arguments[d];for(d=0;d<c.length;d++)yb(a,c[d]);return a}function Ab(a,b){for(var c in b)a[c]=b[c]}
var Bb=document.createTextNode(""),Cb=0,Db=[];(new MutationObserver(function(){for(;Db.length;)try{Db.shift()()}catch(a){throw Bb.textContent=Cb++,a;}})).observe(Bb,{characterData:!0});function Eb(a){Db.push(a);Bb.textContent=Cb++}var Fb=!!document.contains;function Gb(a,b){for(;b;){if(b==a)return!0;b=b.parentNode}return!1};var Hb=[],Ib;function Jb(a){Ib||(Ib=!0,Eb(Kb));Hb.push(a)}function Kb(){Ib=!1;for(var a=!!Hb.length;Hb.length;)Hb.shift()();return a}Kb.list=Hb;function Lb(){this.a=!1;this.addedNodes=[];this.removedNodes=[];this.ca=new Set}function Mb(a){a.a||(a.a=!0,Eb(function(){Nb(a)}))}function Nb(a){if(a.a){a.a=!1;var b=a.takeRecords();b.length&&a.ca.forEach(function(a){a(b)})}}Lb.prototype.takeRecords=function(){if(this.addedNodes.length||this.removedNodes.length){var a=[{addedNodes:this.addedNodes,removedNodes:this.removedNodes}];this.addedNodes=[];this.removedNodes=[];return a}return[]};
function Ob(a,b){var c=z(a);c.S||(c.S=new Lb);c.S.ca.add(b);var d=c.S;return{La:b,P:d,Pa:a,takeRecords:function(){return d.takeRecords()}}}function Pb(a){var b=a&&a.P;b&&(b.ca.delete(a.La),b.ca.size||(z(a.Pa).S=null))}
function Qb(a,b){var c=b.getRootNode();return a.map(function(a){var b=c===a.target.getRootNode();if(b&&a.addedNodes){if(b=Array.from(a.addedNodes).filter(function(a){return c===a.getRootNode()}),b.length)return a=Object.create(a),Object.defineProperty(a,"addedNodes",{value:b,configurable:!0}),a}else if(b)return a}).filter(function(a){return a})};var D={},Rb=Element.prototype.insertBefore,Sb=Element.prototype.replaceChild,Tb=Element.prototype.removeChild,Ub=Element.prototype.setAttribute,Vb=Element.prototype.removeAttribute,Wb=Element.prototype.cloneNode,Xb=Document.prototype.importNode,Yb=Element.prototype.addEventListener,Zb=Element.prototype.removeEventListener,$b=Window.prototype.addEventListener,ac=Window.prototype.removeEventListener,bc=Element.prototype.dispatchEvent,cc=Node.prototype.contains||HTMLElement.prototype.contains,dc=Document.prototype.getElementById,
ec=Element.prototype.querySelector,fc=DocumentFragment.prototype.querySelector,gc=Document.prototype.querySelector,hc=Element.prototype.querySelectorAll,ic=DocumentFragment.prototype.querySelectorAll,jc=Document.prototype.querySelectorAll;D.appendChild=Element.prototype.appendChild;D.insertBefore=Rb;D.replaceChild=Sb;D.removeChild=Tb;D.setAttribute=Ub;D.removeAttribute=Vb;D.cloneNode=Wb;D.importNode=Xb;D.addEventListener=Yb;D.removeEventListener=Zb;D.eb=$b;D.fb=ac;D.dispatchEvent=bc;D.contains=cc;
D.getElementById=dc;D.ob=ec;D.sb=fc;D.mb=gc;D.querySelector=function(a){switch(this.nodeType){case Node.ELEMENT_NODE:return ec.call(this,a);case Node.DOCUMENT_NODE:return gc.call(this,a);default:return fc.call(this,a)}};D.pb=hc;D.tb=ic;D.nb=jc;D.querySelectorAll=function(a){switch(this.nodeType){case Node.ELEMENT_NODE:return hc.call(this,a);case Node.DOCUMENT_NODE:return jc.call(this,a);default:return ic.call(this,a)}};var kc=/[&\u00A0"]/g,lc=/[&\u00A0<>]/g;function mc(a){switch(a){case "&":return"&amp;";case "<":return"&lt;";case ">":return"&gt;";case '"':return"&quot;";case "\u00a0":return"&nbsp;"}}function nc(a){for(var b={},c=0;c<a.length;c++)b[a[c]]=!0;return b}var oc=nc("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),pc=nc("style script xmp iframe noembed noframes plaintext noscript".split(" "));
function qc(a,b){"template"===a.localName&&(a=a.content);for(var c="",d=b?b(a):a.childNodes,e=0,f=d.length,g;e<f&&(g=d[e]);e++){a:{var h=g;var k=a;var m=b;switch(h.nodeType){case Node.ELEMENT_NODE:for(var n=h.localName,r="<"+n,G=h.attributes,x=0;k=G[x];x++)r+=" "+k.name+'="'+k.value.replace(kc,mc)+'"';r+=">";h=oc[n]?r:r+qc(h,m)+"</"+n+">";break a;case Node.TEXT_NODE:h=h.data;h=k&&pc[k.localName]?h:h.replace(lc,mc);break a;case Node.COMMENT_NODE:h="\x3c!--"+h.data+"--\x3e";break a;default:throw window.console.error(h),
Error("not implemented");}}c+=h}return c};var E={},H=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),I=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT,null,!1);function rc(a){var b=[];H.currentNode=a;for(a=H.firstChild();a;)b.push(a),a=H.nextSibling();return b}E.parentNode=function(a){H.currentNode=a;return H.parentNode()};E.firstChild=function(a){H.currentNode=a;return H.firstChild()};E.lastChild=function(a){H.currentNode=a;return H.lastChild()};E.previousSibling=function(a){H.currentNode=a;return H.previousSibling()};
E.nextSibling=function(a){H.currentNode=a;return H.nextSibling()};E.childNodes=rc;E.parentElement=function(a){I.currentNode=a;return I.parentNode()};E.firstElementChild=function(a){I.currentNode=a;return I.firstChild()};E.lastElementChild=function(a){I.currentNode=a;return I.lastChild()};E.previousElementSibling=function(a){I.currentNode=a;return I.previousSibling()};E.nextElementSibling=function(a){I.currentNode=a;return I.nextSibling()};
E.children=function(a){var b=[];I.currentNode=a;for(a=I.firstChild();a;)b.push(a),a=I.nextSibling();return b};E.innerHTML=function(a){return qc(a,function(a){return rc(a)})};E.textContent=function(a){switch(a.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:a=document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);for(var b="",c;c=a.nextNode();)b+=c.nodeValue;return b;default:return a.nodeValue}};var J={},sc=B.I,tc=[Node.prototype,Element.prototype,HTMLElement.prototype];function K(a){var b;a:{for(b=0;b<tc.length;b++){var c=tc[b];if(c.hasOwnProperty(a)){b=c;break a}}b=void 0}if(!b)throw Error("Could not find descriptor for "+a);return Object.getOwnPropertyDescriptor(b,a)}
var L=sc?{parentNode:K("parentNode"),firstChild:K("firstChild"),lastChild:K("lastChild"),previousSibling:K("previousSibling"),nextSibling:K("nextSibling"),childNodes:K("childNodes"),parentElement:K("parentElement"),previousElementSibling:K("previousElementSibling"),nextElementSibling:K("nextElementSibling"),innerHTML:K("innerHTML"),textContent:K("textContent"),firstElementChild:K("firstElementChild"),lastElementChild:K("lastElementChild"),children:K("children")}:{},uc=sc?{firstElementChild:Object.getOwnPropertyDescriptor(DocumentFragment.prototype,
"firstElementChild"),lastElementChild:Object.getOwnPropertyDescriptor(DocumentFragment.prototype,"lastElementChild"),children:Object.getOwnPropertyDescriptor(DocumentFragment.prototype,"children")}:{},vc=sc?{firstElementChild:Object.getOwnPropertyDescriptor(Document.prototype,"firstElementChild"),lastElementChild:Object.getOwnPropertyDescriptor(Document.prototype,"lastElementChild"),children:Object.getOwnPropertyDescriptor(Document.prototype,"children")}:{};J.Ca=L;J.rb=uc;J.lb=vc;J.parentNode=function(a){return L.parentNode.get.call(a)};
J.firstChild=function(a){return L.firstChild.get.call(a)};J.lastChild=function(a){return L.lastChild.get.call(a)};J.previousSibling=function(a){return L.previousSibling.get.call(a)};J.nextSibling=function(a){return L.nextSibling.get.call(a)};J.childNodes=function(a){return Array.prototype.slice.call(L.childNodes.get.call(a))};J.parentElement=function(a){return L.parentElement.get.call(a)};J.previousElementSibling=function(a){return L.previousElementSibling.get.call(a)};J.nextElementSibling=function(a){return L.nextElementSibling.get.call(a)};
J.innerHTML=function(a){return L.innerHTML.get.call(a)};J.textContent=function(a){return L.textContent.get.call(a)};J.children=function(a){switch(a.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:a=uc.children.get.call(a);break;case Node.DOCUMENT_NODE:a=vc.children.get.call(a);break;default:a=L.children.get.call(a)}return Array.prototype.slice.call(a)};
J.firstElementChild=function(a){switch(a.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:return uc.firstElementChild.get.call(a);case Node.DOCUMENT_NODE:return vc.firstElementChild.get.call(a);default:return L.firstElementChild.get.call(a)}};J.lastElementChild=function(a){switch(a.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:return uc.lastElementChild.get.call(a);case Node.DOCUMENT_NODE:return vc.lastElementChild.get.call(a);default:return L.lastElementChild.get.call(a)}};var M=B.Fa?J:E;function wc(a){for(;a.firstChild;)a.removeChild(a.firstChild)}
var xc=B.I,yc=document.implementation.createHTMLDocument("inert"),zc=Object.getOwnPropertyDescriptor(Node.prototype,"isConnected"),Ac=zc&&zc.get,Bc=Object.getOwnPropertyDescriptor(Document.prototype,"activeElement"),Cc={parentElement:{get:function(){var a=A(this);(a=a&&a.parentNode)&&a.nodeType!==Node.ELEMENT_NODE&&(a=null);return void 0!==a?a:M.parentElement(this)},configurable:!0},parentNode:{get:function(){var a=A(this);a=a&&a.parentNode;return void 0!==a?a:M.parentNode(this)},configurable:!0},
nextSibling:{get:function(){var a=A(this);a=a&&a.nextSibling;return void 0!==a?a:M.nextSibling(this)},configurable:!0},previousSibling:{get:function(){var a=A(this);a=a&&a.previousSibling;return void 0!==a?a:M.previousSibling(this)},configurable:!0},nextElementSibling:{get:function(){var a=A(this);if(a&&void 0!==a.nextSibling){for(a=this.nextSibling;a&&a.nodeType!==Node.ELEMENT_NODE;)a=a.nextSibling;return a}return M.nextElementSibling(this)},configurable:!0},previousElementSibling:{get:function(){var a=
A(this);if(a&&void 0!==a.previousSibling){for(a=this.previousSibling;a&&a.nodeType!==Node.ELEMENT_NODE;)a=a.previousSibling;return a}return M.previousElementSibling(this)},configurable:!0}},Hc={className:{get:function(){return this.getAttribute("class")||""},set:function(a){this.setAttribute("class",a)},configurable:!0}},Ic={childNodes:{get:function(){if(ub(this)){var a=A(this);if(!a.childNodes){a.childNodes=[];for(var b=this.firstChild;b;b=b.nextSibling)a.childNodes.push(b)}var c=a.childNodes}else c=
M.childNodes(this);c.item=function(a){return c[a]};return c},configurable:!0},childElementCount:{get:function(){return this.children.length},configurable:!0},firstChild:{get:function(){var a=A(this);a=a&&a.firstChild;return void 0!==a?a:M.firstChild(this)},configurable:!0},lastChild:{get:function(){var a=A(this);a=a&&a.lastChild;return void 0!==a?a:M.lastChild(this)},configurable:!0},textContent:{get:function(){if(ub(this)){for(var a=[],b=0,c=this.childNodes,d;d=c[b];b++)d.nodeType!==Node.COMMENT_NODE&&
a.push(d.textContent);return a.join("")}return M.textContent(this)},set:function(a){if("undefined"===typeof a||null===a)a="";switch(this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:if(!ub(this)&&xc){var b=this.firstChild;(b!=this.lastChild||b&&b.nodeType!=Node.TEXT_NODE)&&wc(this);J.Ca.textContent.set.call(this,a)}else wc(this),(0<a.length||this.nodeType===Node.ELEMENT_NODE)&&this.appendChild(document.createTextNode(a));break;default:this.nodeValue=a}},configurable:!0},firstElementChild:{get:function(){var a=
A(this);if(a&&void 0!==a.firstChild){for(a=this.firstChild;a&&a.nodeType!==Node.ELEMENT_NODE;)a=a.nextSibling;return a}return M.firstElementChild(this)},configurable:!0},lastElementChild:{get:function(){var a=A(this);if(a&&void 0!==a.lastChild){for(a=this.lastChild;a&&a.nodeType!==Node.ELEMENT_NODE;)a=a.previousSibling;return a}return M.lastElementChild(this)},configurable:!0},children:{get:function(){var a;ub(this)?a=Array.prototype.filter.call(this.childNodes,function(a){return a.nodeType===Node.ELEMENT_NODE}):
a=M.children(this);a.item=function(b){return a[b]};return a},configurable:!0},innerHTML:{get:function(){return ub(this)?qc("template"===this.localName?this.content:this):M.innerHTML(this)},set:function(a){var b="template"===this.localName?this.content:this;wc(b);var c=this.localName;c&&"template"!==c||(c="div");c=yc.createElement(c);for(xc?J.Ca.innerHTML.set.call(c,a):c.innerHTML=a;c.firstChild;)b.appendChild(c.firstChild)},configurable:!0}},Jc={shadowRoot:{get:function(){var a=A(this);return a&&
a.Da||null},configurable:!0}},Kc={activeElement:{get:function(){var a=Bc&&Bc.get?Bc.get.call(document):B.I?void 0:document.activeElement;if(a&&a.nodeType){var b=!!C(this);if(this===document||b&&this.host!==a&&D.contains.call(this.host,a)){for(b=vb(a);b&&b!==this;)a=b.host,b=vb(a);a=this===document?b?null:a:b===this?a:null}else a=null}else a=null;return a},set:function(){},configurable:!0}};
function N(a,b,c){for(var d in b){var e=Object.getOwnPropertyDescriptor(a,d);e&&e.configurable||!e&&c?Object.defineProperty(a,d,b[d]):c&&console.warn("Could not define",d,"on",a)}}function Lc(a){N(a,Cc);N(a,Hc);N(a,Ic);N(a,Kc)}
function Mc(){var a=Nc.prototype;a.__proto__=DocumentFragment.prototype;N(a,Cc,!0);N(a,Ic,!0);N(a,Kc,!0);Object.defineProperties(a,{nodeType:{value:Node.DOCUMENT_FRAGMENT_NODE,configurable:!0},nodeName:{value:"#document-fragment",configurable:!0},nodeValue:{value:null,configurable:!0}});["localName","namespaceURI","prefix"].forEach(function(b){Object.defineProperty(a,b,{value:void 0,configurable:!0})});["ownerDocument","baseURI","isConnected"].forEach(function(b){Object.defineProperty(a,b,{get:function(){return this.host[b]},
configurable:!0})})}var Oc=B.I?function(){}:function(a){var b=z(a);b.va||(b.va=!0,N(a,Cc,!0),N(a,Hc,!0))},Pc=B.I?function(){}:function(a){z(a).Ia||(N(a,Ic,!0),N(a,Jc,!0))};var Qc=M.childNodes;function Rc(a,b,c){Oc(a);c=c||null;var d=z(a),e=z(b),f=c?z(c):null;d.previousSibling=c?f.previousSibling:b.lastChild;if(f=A(d.previousSibling))f.nextSibling=a;if(f=A(d.nextSibling=c))f.previousSibling=a;d.parentNode=b;c?c===e.firstChild&&(e.firstChild=a):(e.lastChild=a,e.firstChild||(e.firstChild=a));e.childNodes=null}
function Sc(a,b){var c=z(a);if(void 0===c.firstChild)for(b=b||Qc(a),c.firstChild=b[0]||null,c.lastChild=b[b.length-1]||null,Pc(a),c=0;c<b.length;c++){var d=b[c],e=z(d);e.parentNode=a;e.nextSibling=b[c+1]||null;e.previousSibling=b[c-1]||null;Oc(d)}};var Tc=M.parentNode;
function Uc(a,b,c){if(b===a)throw Error("Failed to execute 'appendChild' on 'Node': The new child element contains the parent.");if(c){var d=A(c);d=d&&d.parentNode;if(void 0!==d&&d!==a||void 0===d&&Tc(c)!==a)throw Error("Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.");}if(c===b)return b;b.parentNode&&Vc(b.parentNode,b);var e,f;if(!b.__noInsertionPoint){if(f=e=vb(a)){var g;"slot"===b.localName?g=[b]:b.querySelectorAll&&
(g=b.querySelectorAll("slot"));f=g&&g.length?g:void 0}f&&(g=e,d=f,g.a=g.a||[],g.m=g.m||[],g.w=g.w||{},g.a.push.apply(g.a,[].concat(d instanceof Array?d:ja(ia(d)))))}("slot"===a.localName||f)&&(e=e||vb(a))&&Wc(e);if(ub(a)){e=c;Pc(a);f=z(a);void 0!==f.firstChild&&(f.childNodes=null);if(b.nodeType===Node.DOCUMENT_FRAGMENT_NODE){f=b.childNodes;for(g=0;g<f.length;g++)Rc(f[g],a,e);e=z(b);f=void 0!==e.firstChild?null:void 0;e.firstChild=e.lastChild=f;e.childNodes=f}else Rc(b,a,e);e=A(a);if(Xc(a)){Wc(e.root);
var h=!0}else e.root&&(h=!0)}h||(h=C(a)?a.host:a,c?(c=Yc(c),D.insertBefore.call(h,b,c)):D.appendChild.call(h,b));Zc(a,b);return b}
function Vc(a,b){if(b.parentNode!==a)throw Error("The node to be removed is not a child of this node: "+b);var c=vb(b),d=A(a);if(ub(a)){var e=z(b),f=z(a);b===f.firstChild&&(f.firstChild=e.nextSibling);b===f.lastChild&&(f.lastChild=e.previousSibling);var g=e.previousSibling,h=e.nextSibling;g&&(z(g).nextSibling=h);h&&(z(h).previousSibling=g);e.parentNode=e.previousSibling=e.nextSibling=void 0;void 0!==f.childNodes&&(f.childNodes=null);if(Xc(a)){Wc(d.root);var k=!0}}$c(b);if(c){(e=a&&"slot"===a.localName)&&
(k=!0);if(c.m){ad(c);f=c.w;for(v in f)for(g=f[v],h=0;h<g.length;h++){var m=g[h];if(Gb(b,m)){g.splice(h,1);var n=c.m.indexOf(m);0<=n&&c.m.splice(n,1);h--;n=A(m);if(m=n.L)for(var r=0;r<m.length;r++){var G=m[r],x=bd(G);x&&D.removeChild.call(x,G)}n.L=[];n.assignedNodes=[];n=!0}}var v=n}else v=void 0;(v||e)&&Wc(c)}k||(k=C(a)?a.host:a,(!d.root&&"slot"!==b.localName||k===Tc(b))&&D.removeChild.call(k,b));Zc(a,null,b);return b}
function $c(a){var b=A(a);if(b&&void 0!==b.V){b=a.childNodes;for(var c=0,d=b.length,e;c<d&&(e=b[c]);c++)$c(e)}if(a=A(a))a.V=void 0}function Yc(a){var b=a;a&&"slot"===a.localName&&(b=(b=(b=A(a))&&b.L)&&b.length?b[0]:Yc(a.nextSibling));return b}function Xc(a){return(a=(a=A(a))&&a.root)&&cd(a)}
function dd(a,b){if("slot"===b)a=a.parentNode,Xc(a)&&Wc(A(a).root);else if("slot"===a.localName&&"name"===b&&(b=vb(a))){if(b.m){var c=a.Ja,d=ed(a);if(d!==c){c=b.w[c];var e=c.indexOf(a);0<=e&&c.splice(e,1);c=b.w[d]||(b.w[d]=[]);c.push(a);1<c.length&&(b.w[d]=fd(c))}}Wc(b)}}function Zc(a,b,c){if(a=(a=A(a))&&a.S)b&&a.addedNodes.push(b),c&&a.removedNodes.push(c),Mb(a)}
function gd(a){if(a&&a.nodeType){var b=z(a),c=b.V;void 0===c&&(C(a)?(c=a,b.V=c):(c=(c=a.parentNode)?gd(c):a,D.contains.call(document.documentElement,a)&&(b.V=c)));return c}}function hd(a,b,c){var d=[];id(a.childNodes,b,c,d);return d}function id(a,b,c,d){for(var e=0,f=a.length,g;e<f&&(g=a[e]);e++){var h;if(h=g.nodeType===Node.ELEMENT_NODE){h=g;var k=b,m=c,n=d,r=k(h);r&&n.push(h);m&&m(r)?h=r:(id(h.childNodes,k,m,n),h=void 0)}if(h)break}}var jd=null;
function kd(a,b,c){jd||(jd=window.ShadyCSS&&window.ShadyCSS.ScopingShim);jd&&"class"===b?jd.setElementClass(a,c):(D.setAttribute.call(a,b,c),dd(a,b))}function ld(a,b){if(a.ownerDocument!==document)return D.importNode.call(document,a,b);var c=D.importNode.call(document,a,!1);if(b){a=a.childNodes;b=0;for(var d;b<a.length;b++)d=ld(a[b],!0),c.appendChild(d)}return c};var md="__eventWrappers"+Date.now(),nd={blur:!0,focus:!0,focusin:!0,focusout:!0,click:!0,dblclick:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,wheel:!0,beforeinput:!0,input:!0,keydown:!0,keyup:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,touchstart:!0,touchend:!0,touchmove:!0,touchcancel:!0,pointerover:!0,pointerenter:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointercancel:!0,pointerout:!0,pointerleave:!0,gotpointercapture:!0,lostpointercapture:!0,
dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0,DOMActivate:!0,DOMFocusIn:!0,DOMFocusOut:!0,keypress:!0};function od(a,b){var c=[],d=a;for(a=a===window?window:a.getRootNode();d;)c.push(d),d=d.assignedSlot?d.assignedSlot:d.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&d.host&&(b||d!==a)?d.host:d.parentNode;c[c.length-1]===document&&c.push(window);return c}
function pd(a,b){if(!C)return a;a=od(a,!0);for(var c=0,d,e,f,g;c<b.length;c++)if(d=b[c],f=d===window?window:d.getRootNode(),f!==e&&(g=a.indexOf(f),e=f),!C(f)||-1<g)return d}
var qd={get composed(){!1!==this.isTrusted&&void 0===this.ha&&(this.ha=nd[this.type]);return this.ha||!1},composedPath:function(){this.ta||(this.ta=od(this.__target,this.composed));return this.ta},get target(){return pd(this.currentTarget,this.composedPath())},get relatedTarget(){if(!this.ja)return null;this.wa||(this.wa=od(this.ja,!0));return pd(this.currentTarget,this.wa)},stopPropagation:function(){Event.prototype.stopPropagation.call(this);this.ia=!0},stopImmediatePropagation:function(){Event.prototype.stopImmediatePropagation.call(this);
this.ia=this.Ha=!0}};function rd(a){function b(b,d){b=new a(b,d);b.ha=d&&!!d.composed;return b}Ab(b,a);b.prototype=a.prototype;return b}var sd={focus:!0,blur:!0};function td(a){return a.__target!==a.target||a.ja!==a.relatedTarget}function ud(a,b,c){if(c=b.__handlers&&b.__handlers[a.type]&&b.__handlers[a.type][c])for(var d=0,e;(e=c[d])&&(!td(a)||a.target!==a.relatedTarget)&&(e.call(b,a),!a.Ha);d++);}
function vd(a){var b=a.composedPath();Object.defineProperty(a,"currentTarget",{get:function(){return d},configurable:!0});for(var c=b.length-1;0<=c;c--){var d=b[c];ud(a,d,"capture");if(a.ia)return}Object.defineProperty(a,"eventPhase",{get:function(){return Event.AT_TARGET}});var e;for(c=0;c<b.length;c++){d=b[c];var f=A(d);f=f&&f.root;if(0===c||f&&f===e)if(ud(a,d,"bubble"),d!==window&&(e=d.getRootNode()),a.ia)break}}
function wd(a,b,c,d,e,f){for(var g=0;g<a.length;g++){var h=a[g],k=h.type,m=h.capture,n=h.once,r=h.passive;if(b===h.node&&c===k&&d===m&&e===n&&f===r)return g}return-1}
function xd(a,b,c){if(b){var d=typeof b;if("function"===d||"object"===d)if("object"!==d||b.handleEvent&&"function"===typeof b.handleEvent){if(c&&"object"===typeof c){var e=!!c.capture;var f=!!c.once;var g=!!c.passive}else e=!!c,g=f=!1;var h=c&&c.la||this,k=b[md];if(k){if(-1<wd(k,h,a,e,f,g))return}else b[md]=[];k=function(e){f&&this.removeEventListener(a,b,c);e.__target||yd(e);if(h!==this){var g=Object.getOwnPropertyDescriptor(e,"currentTarget");Object.defineProperty(e,"currentTarget",{get:function(){return h},
configurable:!0})}if(e.composed||-1<e.composedPath().indexOf(h))if(td(e)&&e.target===e.relatedTarget)e.eventPhase===Event.BUBBLING_PHASE&&e.stopImmediatePropagation();else if(e.eventPhase===Event.CAPTURING_PHASE||e.bubbles||e.target===h||h instanceof Window){var k="function"===d?b.call(h,e):b.handleEvent&&b.handleEvent(e);h!==this&&(g?(Object.defineProperty(e,"currentTarget",g),g=null):delete e.currentTarget);return k}};b[md].push({node:h,type:a,capture:e,once:f,passive:g,gb:k});sd[a]?(this.__handlers=
this.__handlers||{},this.__handlers[a]=this.__handlers[a]||{capture:[],bubble:[]},this.__handlers[a][e?"capture":"bubble"].push(k)):(this instanceof Window?D.eb:D.addEventListener).call(this,a,k,c)}}}
function zd(a,b,c){if(b){if(c&&"object"===typeof c){var d=!!c.capture;var e=!!c.once;var f=!!c.passive}else d=!!c,f=e=!1;var g=c&&c.la||this,h=void 0;var k=null;try{k=b[md]}catch(m){}k&&(e=wd(k,g,a,d,e,f),-1<e&&(h=k.splice(e,1)[0].gb,k.length||(b[md]=void 0)));(this instanceof Window?D.fb:D.removeEventListener).call(this,a,h||b,c);h&&sd[a]&&this.__handlers&&this.__handlers[a]&&(a=this.__handlers[a][d?"capture":"bubble"],h=a.indexOf(h),-1<h&&a.splice(h,1))}}
function Ad(){for(var a in sd)window.addEventListener(a,function(a){a.__target||(yd(a),vd(a))},!0)}function yd(a){a.__target=a.target;a.ja=a.relatedTarget;if(B.I){var b=Object.getPrototypeOf(a);if(!b.hasOwnProperty("__patchProto")){var c=Object.create(b);c.ib=b;yb(c,qd);b.__patchProto=c}a.__proto__=b.__patchProto}else yb(a,qd)}var Bd=rd(window.Event),Cd=rd(window.CustomEvent),Dd=rd(window.MouseEvent);function Ed(a,b){return{index:a,W:[],ba:b}}
function Fd(a,b,c,d){var e=0,f=0,g=0,h=0,k=Math.min(b-e,d-f);if(0==e&&0==f)a:{for(g=0;g<k;g++)if(a[g]!==c[g])break a;g=k}if(b==a.length&&d==c.length){h=a.length;for(var m=c.length,n=0;n<k-g&&Gd(a[--h],c[--m]);)n++;h=n}e+=g;f+=g;b-=h;d-=h;if(0==b-e&&0==d-f)return[];if(e==b){for(b=Ed(e,0);f<d;)b.W.push(c[f++]);return[b]}if(f==d)return[Ed(e,b-e)];k=e;g=f;d=d-g+1;h=b-k+1;b=Array(d);for(m=0;m<d;m++)b[m]=Array(h),b[m][0]=m;for(m=0;m<h;m++)b[0][m]=m;for(m=1;m<d;m++)for(n=1;n<h;n++)if(a[k+n-1]===c[g+m-1])b[m][n]=
b[m-1][n-1];else{var r=b[m-1][n]+1,G=b[m][n-1]+1;b[m][n]=r<G?r:G}k=b.length-1;g=b[0].length-1;d=b[k][g];for(a=[];0<k||0<g;)0==k?(a.push(2),g--):0==g?(a.push(3),k--):(h=b[k-1][g-1],m=b[k-1][g],n=b[k][g-1],r=m<n?m<h?m:h:n<h?n:h,r==h?(h==d?a.push(0):(a.push(1),d=h),k--,g--):r==m?(a.push(3),k--,d=m):(a.push(2),g--,d=n));a.reverse();b=void 0;k=[];for(g=0;g<a.length;g++)switch(a[g]){case 0:b&&(k.push(b),b=void 0);e++;f++;break;case 1:b||(b=Ed(e,0));b.ba++;e++;b.W.push(c[f]);f++;break;case 2:b||(b=Ed(e,
0));b.ba++;e++;break;case 3:b||(b=Ed(e,0)),b.W.push(c[f]),f++}b&&k.push(b);return k}function Gd(a,b){return a===b};var bd=M.parentNode,Hd=M.childNodes,Id={};function Jd(a){var b=[];do b.unshift(a);while(a=a.parentNode);return b}function Nc(a,b,c){if(a!==Id)throw new TypeError("Illegal constructor");this.Oa="ShadyRoot";a=Hd(b);this.host=b;this.b=c&&c.mode;Sc(b,a);c=A(b);c.root=this;c.Da="closed"!==this.b?this:null;c=z(this);c.firstChild=c.lastChild=c.parentNode=c.nextSibling=c.previousSibling=null;c.childNodes=[];this.aa=!1;this.a=this.w=this.m=null;c=0;for(var d=a.length;c<d;c++)D.removeChild.call(b,a[c])}
function Wc(a){a.aa||(a.aa=!0,Jb(function(){return Kd(a)}))}function Kd(a){for(var b;a;){a.aa&&(b=a);a:{var c=a;a=c.host.getRootNode();if(C(a))for(var d=c.host.childNodes,e=0;e<d.length;e++)if(c=d[e],"slot"==c.localName)break a;a=void 0}}b&&b._renderRoot()}
Nc.prototype._renderRoot=function(){this.aa=!1;if(this.m){ad(this);for(var a=0,b;a<this.m.length;a++){b=this.m[a];var c=A(b),d=c.assignedNodes;c.assignedNodes=[];c.L=[];if(c.pa=d)for(c=0;c<d.length;c++){var e=A(d[c]);e.Z=e.assignedSlot;e.assignedSlot===b&&(e.assignedSlot=null)}}for(b=this.host.firstChild;b;b=b.nextSibling)Ld(this,b);for(a=0;a<this.m.length;a++){b=this.m[a];d=A(b);if(!d.assignedNodes.length)for(c=b.firstChild;c;c=c.nextSibling)Ld(this,c,b);(c=(c=A(b.parentNode))&&c.root)&&cd(c)&&c._renderRoot();
Md(this,d.L,d.assignedNodes);if(c=d.pa){for(e=0;e<c.length;e++)A(c[e]).Z=null;d.pa=null;c.length>d.assignedNodes.length&&(d.da=!0)}d.da&&(d.da=!1,Nd(this,b))}a=this.m;b=[];for(d=0;d<a.length;d++)c=a[d].parentNode,(e=A(c))&&e.root||!(0>b.indexOf(c))||b.push(c);for(a=0;a<b.length;a++){d=b[a];c=d===this?this.host:d;e=[];d=d.childNodes;for(var f=0;f<d.length;f++){var g=d[f];if("slot"==g.localName){g=A(g).L;for(var h=0;h<g.length;h++)e.push(g[h])}else e.push(g)}d=void 0;f=Hd(c);g=Fd(e,e.length,f,f.length);
for(var k=h=0;h<g.length&&(d=g[h]);h++){for(var m=0,n;m<d.W.length&&(n=d.W[m]);m++)bd(n)===c&&D.removeChild.call(c,n),f.splice(d.index+k,1);k-=d.ba}for(k=0;k<g.length&&(d=g[k]);k++)for(h=f[d.index],m=d.index;m<d.index+d.ba;m++)n=e[m],D.insertBefore.call(c,n,h),f.splice(m,0,n)}}};function Ld(a,b,c){var d=z(b),e=d.Z;d.Z=null;c||(c=(a=a.w[b.slot||"__catchall"])&&a[0]);c?(z(c).assignedNodes.push(b),d.assignedSlot=c):d.assignedSlot=void 0;e!==d.assignedSlot&&d.assignedSlot&&(z(d.assignedSlot).da=!0)}
function Md(a,b,c){for(var d=0,e;d<c.length&&(e=c[d]);d++)if("slot"==e.localName){var f=A(e).assignedNodes;f&&f.length&&Md(a,b,f)}else b.push(c[d])}function Nd(a,b){D.dispatchEvent.call(b,new Event("slotchange"));b=A(b);b.assignedSlot&&Nd(a,b.assignedSlot)}function ad(a){if(a.a&&a.a.length){for(var b=a.a,c,d=0;d<b.length;d++){var e=b[d];Sc(e);Sc(e.parentNode);var f=ed(e);a.w[f]?(c=c||{},c[f]=!0,a.w[f].push(e)):a.w[f]=[e];a.m.push(e)}if(c)for(var g in c)a.w[g]=fd(a.w[g]);a.a=[]}}
function ed(a){var b=a.name||a.getAttribute("name")||"__catchall";return a.Ja=b}function fd(a){return a.sort(function(a,c){a=Jd(a);for(var b=Jd(c),e=0;e<a.length;e++){c=a[e];var f=b[e];if(c!==f)return a=Array.from(c.parentNode.childNodes),a.indexOf(c)-a.indexOf(f)}})}function cd(a){ad(a);return!(!a.m||!a.m.length)};function Od(a){var b=a.getRootNode();C(b)&&Kd(b);return(a=A(a))&&a.assignedSlot||null}
var Pd={addEventListener:xd.bind(window),removeEventListener:zd.bind(window)},Qd={addEventListener:xd,removeEventListener:zd,appendChild:function(a){return Uc(this,a)},insertBefore:function(a,b){return Uc(this,a,b)},removeChild:function(a){return Vc(this,a)},replaceChild:function(a,b){Uc(this,a,b);Vc(this,b);return a},cloneNode:function(a){if("template"==this.localName)var b=D.cloneNode.call(this,a);else if(b=D.cloneNode.call(this,!1),a){a=this.childNodes;for(var c=0,d;c<a.length;c++)d=a[c].cloneNode(!0),
b.appendChild(d)}return b},getRootNode:function(){return gd(this)},contains:function(a){return Gb(this,a)},dispatchEvent:function(a){Kb();return D.dispatchEvent.call(this,a)}};
Object.defineProperties(Qd,{isConnected:{get:function(){if(Ac&&Ac.call(this))return!0;if(this.nodeType==Node.DOCUMENT_FRAGMENT_NODE)return!1;var a=this.ownerDocument;if(Fb){if(D.contains.call(a,this))return!0}else if(a.documentElement&&D.contains.call(a.documentElement,this))return!0;for(a=this;a&&!(a instanceof Document);)a=a.parentNode||(C(a)?a.host:void 0);return!!(a&&a instanceof Document)},configurable:!0}});
var Rd={get assignedSlot(){return Od(this)}},Sd={querySelector:function(a){return hd(this,function(b){return xb.call(b,a)},function(a){return!!a})[0]||null},querySelectorAll:function(a,b){if(b){b=Array.prototype.slice.call(D.querySelectorAll(this,a));var c=this.getRootNode();return b.filter(function(a){return a.getRootNode()==c})}return hd(this,function(b){return xb.call(b,a)})}},Td={assignedNodes:function(a){if("slot"===this.localName){var b=this.getRootNode();C(b)&&Kd(b);return(b=A(this))?(a&&a.flatten?
b.L:b.assignedNodes)||[]:[]}}},Ud=zb({setAttribute:function(a,b){kd(this,a,b)},removeAttribute:function(a){D.removeAttribute.call(this,a);dd(this,a)},attachShadow:function(a){if(!this)throw"Must provide a host.";if(!a)throw"Not enough arguments.";return new Nc(Id,this,a)},get slot(){return this.getAttribute("slot")},set slot(a){kd(this,"slot",a)},get assignedSlot(){return Od(this)}},Sd,Td);Object.defineProperties(Ud,Jc);
var Vd=zb({importNode:function(a,b){return ld(a,b)},getElementById:function(a){return hd(this,function(b){return b.id==a},function(a){return!!a})[0]||null}},Sd);Object.defineProperties(Vd,{_activeElement:Kc.activeElement});
var Wd=HTMLElement.prototype.blur,Xd=zb({blur:function(){var a=A(this);(a=(a=a&&a.root)&&a.activeElement)?a.blur():Wd.call(this)}}),Yd={addEventListener:function(a,b,c){"object"!==typeof c&&(c={capture:!!c});c.la=this;this.host.addEventListener(a,b,c)},removeEventListener:function(a,b,c){"object"!==typeof c&&(c={capture:!!c});c.la=this;this.host.removeEventListener(a,b,c)},getElementById:function(a){return hd(this,function(b){return b.id==a},function(a){return!!a})[0]||null}};
function Zd(a,b){for(var c=Object.getOwnPropertyNames(b),d=0;d<c.length;d++){var e=c[d],f=Object.getOwnPropertyDescriptor(b,e);f.value?a[e]=f.value:Object.defineProperty(a,e,f)}};if(B.Ba){var ShadyDOM={inUse:B.Ba,patch:function(a){Pc(a);Oc(a);return a},isShadyRoot:C,enqueue:Jb,flush:Kb,settings:B,filterMutations:Qb,observeChildren:Ob,unobserveChildren:Pb,nativeMethods:D,nativeTree:M};window.ShadyDOM=ShadyDOM;window.Event=Bd;window.CustomEvent=Cd;window.MouseEvent=Dd;Ad();var $d=window.customElements&&window.customElements.nativeHTMLElement||HTMLElement;Zd(Nc.prototype,Yd);Zd(window.Node.prototype,Qd);Zd(window.Window.prototype,Pd);Zd(window.Text.prototype,Rd);Zd(window.DocumentFragment.prototype,
Sd);Zd(window.Element.prototype,Ud);Zd(window.Document.prototype,Vd);window.HTMLSlotElement&&Zd(window.HTMLSlotElement.prototype,Td);Zd($d.prototype,Xd);B.I&&(Lc(window.Node.prototype),Lc(window.Text.prototype),Lc(window.DocumentFragment.prototype),Lc(window.Element.prototype),Lc($d.prototype),Lc(window.Document.prototype),window.HTMLSlotElement&&Lc(window.HTMLSlotElement.prototype));Mc();window.ShadowRoot=Nc};var ae=new Set("annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" "));function be(a){var b=ae.has(a);a=/^[a-z][.0-9_a-z]*-[\-.0-9_a-z]*$/.test(a);return!b&&a}function O(a){var b=a.isConnected;if(void 0!==b)return b;for(;a&&!(a.__CE_isImportDocument||a instanceof Document);)a=a.parentNode||(window.ShadowRoot&&a instanceof ShadowRoot?a.host:void 0);return!(!a||!(a.__CE_isImportDocument||a instanceof Document))}
function ce(a,b){for(;b&&b!==a&&!b.nextSibling;)b=b.parentNode;return b&&b!==a?b.nextSibling:null}
function de(a,b,c){c=void 0===c?new Set:c;for(var d=a;d;){if(d.nodeType===Node.ELEMENT_NODE){var e=d;b(e);var f=e.localName;if("link"===f&&"import"===e.getAttribute("rel")){d=e.import;if(d instanceof Node&&!c.has(d))for(c.add(d),d=d.firstChild;d;d=d.nextSibling)de(d,b,c);d=ce(a,e);continue}else if("template"===f){d=ce(a,e);continue}if(e=e.__CE_shadowRoot)for(e=e.firstChild;e;e=e.nextSibling)de(e,b,c)}d=d.firstChild?d.firstChild:ce(a,d)}}function P(a,b,c){a[b]=c};function ee(){this.a=new Map;this.M=new Map;this.F=[];this.c=!1}function fe(a,b,c){a.a.set(b,c);a.M.set(c.constructor,c)}function ge(a,b){a.c=!0;a.F.push(b)}function he(a,b){a.c&&de(b,function(b){return a.b(b)})}ee.prototype.b=function(a){if(this.c&&!a.__CE_patched){a.__CE_patched=!0;for(var b=0;b<this.F.length;b++)this.F[b](a)}};function Q(a,b){var c=[];de(b,function(a){return c.push(a)});for(b=0;b<c.length;b++){var d=c[b];1===d.__CE_state?a.connectedCallback(d):ie(a,d)}}
function R(a,b){var c=[];de(b,function(a){return c.push(a)});for(b=0;b<c.length;b++){var d=c[b];1===d.__CE_state&&a.disconnectedCallback(d)}}
function je(a,b,c){c=void 0===c?{}:c;var d=c.bb||new Set,e=c.ga||function(b){return ie(a,b)},f=[];de(b,function(b){if("link"===b.localName&&"import"===b.getAttribute("rel")){var c=b.import;c instanceof Node&&(c.__CE_isImportDocument=!0,c.__CE_hasRegistry=!0);c&&"complete"===c.readyState?c.__CE_documentLoadHandled=!0:b.addEventListener("load",function(){var c=b.import;if(!c.__CE_documentLoadHandled){c.__CE_documentLoadHandled=!0;var f=new Set(d);f.delete(c);je(a,c,{bb:f,ga:e})}})}else f.push(b)},d);
if(a.c)for(b=0;b<f.length;b++)a.b(f[b]);for(b=0;b<f.length;b++)e(f[b])}
function ie(a,b){if(void 0===b.__CE_state){var c=b.ownerDocument;if(c.defaultView||c.__CE_isImportDocument&&c.__CE_hasRegistry)if(c=a.a.get(b.localName)){c.constructionStack.push(b);var d=c.constructor;try{try{if(new d!==b)throw Error("The custom element constructor did not produce the element being upgraded.");}finally{c.constructionStack.pop()}}catch(g){throw b.__CE_state=2,g;}b.__CE_state=1;b.__CE_definition=c;if(c.attributeChangedCallback)for(c=c.observedAttributes,d=0;d<c.length;d++){var e=c[d],
f=b.getAttribute(e);null!==f&&a.attributeChangedCallback(b,e,null,f,null)}O(b)&&a.connectedCallback(b)}}}ee.prototype.connectedCallback=function(a){var b=a.__CE_definition;b.connectedCallback&&b.connectedCallback.call(a)};ee.prototype.disconnectedCallback=function(a){var b=a.__CE_definition;b.disconnectedCallback&&b.disconnectedCallback.call(a)};
ee.prototype.attributeChangedCallback=function(a,b,c,d,e){var f=a.__CE_definition;f.attributeChangedCallback&&-1<f.observedAttributes.indexOf(b)&&f.attributeChangedCallback.call(a,b,c,d,e)};function ke(a){var b=document;this.A=a;this.a=b;this.P=void 0;je(this.A,this.a);"loading"===this.a.readyState&&(this.P=new MutationObserver(this.b.bind(this)),this.P.observe(this.a,{childList:!0,subtree:!0}))}function le(a){a.P&&a.P.disconnect()}ke.prototype.b=function(a){var b=this.a.readyState;"interactive"!==b&&"complete"!==b||le(this);for(b=0;b<a.length;b++)for(var c=a[b].addedNodes,d=0;d<c.length;d++)je(this.A,c[d])};function me(){var a=this;this.b=this.a=void 0;this.c=new Promise(function(b){a.b=b;a.a&&b(a.a)})}me.prototype.resolve=function(a){if(this.a)throw Error("Already resolved.");this.a=a;this.b&&this.b(a)};function S(a){this.ma=!1;this.A=a;this.ra=new Map;this.na=function(a){return a()};this.Y=!1;this.oa=[];this.Ma=new ke(a)}q=S.prototype;
q.define=function(a,b){var c=this;if(!(b instanceof Function))throw new TypeError("Custom element constructors must be functions.");if(!be(a))throw new SyntaxError("The element name '"+a+"' is not valid.");if(this.A.a.get(a))throw Error("A custom element with name '"+a+"' has already been defined.");if(this.ma)throw Error("A custom element is already being defined.");this.ma=!0;try{var d=function(a){var b=e[a];if(void 0!==b&&!(b instanceof Function))throw Error("The '"+a+"' callback must be a function.");
return b},e=b.prototype;if(!(e instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var f=d("connectedCallback");var g=d("disconnectedCallback");var h=d("adoptedCallback");var k=d("attributeChangedCallback");var m=b.observedAttributes||[]}catch(n){return}finally{this.ma=!1}b={localName:a,constructor:b,connectedCallback:f,disconnectedCallback:g,adoptedCallback:h,attributeChangedCallback:k,observedAttributes:m,constructionStack:[]};fe(this.A,a,b);this.oa.push(b);
this.Y||(this.Y=!0,this.na(function(){return ne(c)}))};q.ga=function(a){je(this.A,a)};
function ne(a){if(!1!==a.Y){a.Y=!1;for(var b=a.oa,c=[],d=new Map,e=0;e<b.length;e++)d.set(b[e].localName,[]);je(a.A,document,{ga:function(b){if(void 0===b.__CE_state){var e=b.localName,f=d.get(e);f?f.push(b):a.A.a.get(e)&&c.push(b)}}});for(e=0;e<c.length;e++)ie(a.A,c[e]);for(;0<b.length;){var f=b.shift();e=f.localName;f=d.get(f.localName);for(var g=0;g<f.length;g++)ie(a.A,f[g]);(e=a.ra.get(e))&&e.resolve(void 0)}}}q.get=function(a){if(a=this.A.a.get(a))return a.constructor};
q.whenDefined=function(a){if(!be(a))return Promise.reject(new SyntaxError("'"+a+"' is not a valid custom element name."));var b=this.ra.get(a);if(b)return b.c;b=new me;this.ra.set(a,b);this.A.a.get(a)&&!this.oa.some(function(b){return b.localName===a})&&b.resolve(void 0);return b.c};q.Xa=function(a){le(this.Ma);var b=this.na;this.na=function(c){return a(function(){return b(c)})}};window.CustomElementRegistry=S;S.prototype.define=S.prototype.define;S.prototype.upgrade=S.prototype.ga;
S.prototype.get=S.prototype.get;S.prototype.whenDefined=S.prototype.whenDefined;S.prototype.polyfillWrapFlushCallback=S.prototype.Xa;var oe=window.Document.prototype.createElement,pe=window.Document.prototype.createElementNS,qe=window.Document.prototype.importNode,re=window.Document.prototype.prepend,se=window.Document.prototype.append,te=window.DocumentFragment.prototype.prepend,ue=window.DocumentFragment.prototype.append,ve=window.Node.prototype.cloneNode,we=window.Node.prototype.appendChild,xe=window.Node.prototype.insertBefore,ye=window.Node.prototype.removeChild,ze=window.Node.prototype.replaceChild,Ae=Object.getOwnPropertyDescriptor(window.Node.prototype,
"textContent"),Be=window.Element.prototype.attachShadow,Ce=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),De=window.Element.prototype.getAttribute,Ee=window.Element.prototype.setAttribute,Fe=window.Element.prototype.removeAttribute,Ge=window.Element.prototype.getAttributeNS,He=window.Element.prototype.setAttributeNS,Ie=window.Element.prototype.removeAttributeNS,Je=window.Element.prototype.insertAdjacentElement,Ke=window.Element.prototype.insertAdjacentHTML,Le=window.Element.prototype.prepend,
Me=window.Element.prototype.append,Ne=window.Element.prototype.before,Oe=window.Element.prototype.after,Pe=window.Element.prototype.replaceWith,Qe=window.Element.prototype.remove,Re=window.HTMLElement,Se=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),Te=window.HTMLElement.prototype.insertAdjacentElement,Ue=window.HTMLElement.prototype.insertAdjacentHTML;var Ve=new function(){};function We(){var a=Xe;window.HTMLElement=function(){function b(){var b=this.constructor,d=a.M.get(b);if(!d)throw Error("The custom element being constructed was not registered with `customElements`.");var e=d.constructionStack;if(0===e.length)return e=oe.call(document,d.localName),Object.setPrototypeOf(e,b.prototype),e.__CE_state=1,e.__CE_definition=d,a.b(e),e;d=e.length-1;var f=e[d];if(f===Ve)throw Error("The HTMLElement constructor was either called reentrantly for this constructor or called multiple times.");
e[d]=Ve;Object.setPrototypeOf(f,b.prototype);a.b(f);return f}b.prototype=Re.prototype;return b}()};function Ye(a,b,c){function d(b){return function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];e=[];for(var f=[],m=0;m<d.length;m++){var n=d[m];n instanceof Element&&O(n)&&f.push(n);if(n instanceof DocumentFragment)for(n=n.firstChild;n;n=n.nextSibling)e.push(n);else e.push(n)}b.apply(this,d);for(d=0;d<f.length;d++)R(a,f[d]);if(O(this))for(d=0;d<e.length;d++)f=e[d],f instanceof Element&&Q(a,f)}}void 0!==c.fa&&(b.prepend=d(c.fa));void 0!==c.append&&(b.append=d(c.append))};function Ze(){var a=Xe;P(Document.prototype,"createElement",function(b){if(this.__CE_hasRegistry){var c=a.a.get(b);if(c)return new c.constructor}b=oe.call(this,b);a.b(b);return b});P(Document.prototype,"importNode",function(b,c){b=qe.call(this,b,c);this.__CE_hasRegistry?je(a,b):he(a,b);return b});P(Document.prototype,"createElementNS",function(b,c){if(this.__CE_hasRegistry&&(null===b||"http://www.w3.org/1999/xhtml"===b)){var d=a.a.get(c);if(d)return new d.constructor}b=pe.call(this,b,c);a.b(b);return b});
Ye(a,Document.prototype,{fa:re,append:se})};function $e(){var a=Xe;function b(b,d){Object.defineProperty(b,"textContent",{enumerable:d.enumerable,configurable:!0,get:d.get,set:function(b){if(this.nodeType===Node.TEXT_NODE)d.set.call(this,b);else{var c=void 0;if(this.firstChild){var e=this.childNodes,h=e.length;if(0<h&&O(this)){c=Array(h);for(var k=0;k<h;k++)c[k]=e[k]}}d.set.call(this,b);if(c)for(b=0;b<c.length;b++)R(a,c[b])}}})}P(Node.prototype,"insertBefore",function(b,d){if(b instanceof DocumentFragment){var c=Array.prototype.slice.apply(b.childNodes);
b=xe.call(this,b,d);if(O(this))for(d=0;d<c.length;d++)Q(a,c[d]);return b}c=O(b);d=xe.call(this,b,d);c&&R(a,b);O(this)&&Q(a,b);return d});P(Node.prototype,"appendChild",function(b){if(b instanceof DocumentFragment){var c=Array.prototype.slice.apply(b.childNodes);b=we.call(this,b);if(O(this))for(var e=0;e<c.length;e++)Q(a,c[e]);return b}c=O(b);e=we.call(this,b);c&&R(a,b);O(this)&&Q(a,b);return e});P(Node.prototype,"cloneNode",function(b){b=ve.call(this,b);this.ownerDocument.__CE_hasRegistry?je(a,b):
he(a,b);return b});P(Node.prototype,"removeChild",function(b){var c=O(b),e=ye.call(this,b);c&&R(a,b);return e});P(Node.prototype,"replaceChild",function(b,d){if(b instanceof DocumentFragment){var c=Array.prototype.slice.apply(b.childNodes);b=ze.call(this,b,d);if(O(this))for(R(a,d),d=0;d<c.length;d++)Q(a,c[d]);return b}c=O(b);var f=ze.call(this,b,d),g=O(this);g&&R(a,d);c&&R(a,b);g&&Q(a,b);return f});Ae&&Ae.get?b(Node.prototype,Ae):ge(a,function(a){b(a,{enumerable:!0,configurable:!0,get:function(){for(var a=
[],b=0;b<this.childNodes.length;b++)a.push(this.childNodes[b].textContent);return a.join("")},set:function(a){for(;this.firstChild;)ye.call(this,this.firstChild);we.call(this,document.createTextNode(a))}})})};function af(a){var b=Element.prototype;function c(b){return function(c){for(var d=[],e=0;e<arguments.length;++e)d[e-0]=arguments[e];e=[];for(var h=[],k=0;k<d.length;k++){var m=d[k];m instanceof Element&&O(m)&&h.push(m);if(m instanceof DocumentFragment)for(m=m.firstChild;m;m=m.nextSibling)e.push(m);else e.push(m)}b.apply(this,d);for(d=0;d<h.length;d++)R(a,h[d]);if(O(this))for(d=0;d<e.length;d++)h=e[d],h instanceof Element&&Q(a,h)}}void 0!==Ne&&(b.before=c(Ne));void 0!==Ne&&(b.after=c(Oe));void 0!==
Pe&&P(b,"replaceWith",function(b){for(var c=[],d=0;d<arguments.length;++d)c[d-0]=arguments[d];d=[];for(var g=[],h=0;h<c.length;h++){var k=c[h];k instanceof Element&&O(k)&&g.push(k);if(k instanceof DocumentFragment)for(k=k.firstChild;k;k=k.nextSibling)d.push(k);else d.push(k)}h=O(this);Pe.apply(this,c);for(c=0;c<g.length;c++)R(a,g[c]);if(h)for(R(a,this),c=0;c<d.length;c++)g=d[c],g instanceof Element&&Q(a,g)});void 0!==Qe&&P(b,"remove",function(){var b=O(this);Qe.call(this);b&&R(a,this)})};function bf(){var a=Xe;function b(b,c){Object.defineProperty(b,"innerHTML",{enumerable:c.enumerable,configurable:!0,get:c.get,set:function(b){var d=this,e=void 0;O(this)&&(e=[],de(this,function(a){a!==d&&e.push(a)}));c.set.call(this,b);if(e)for(var f=0;f<e.length;f++){var g=e[f];1===g.__CE_state&&a.disconnectedCallback(g)}this.ownerDocument.__CE_hasRegistry?je(a,this):he(a,this);return b}})}function c(b,c){P(b,"insertAdjacentElement",function(b,d){var e=O(d);b=c.call(this,b,d);e&&R(a,d);O(b)&&Q(a,
d);return b})}function d(b,c){function d(b,c){for(var d=[];b!==c;b=b.nextSibling)d.push(b);for(c=0;c<d.length;c++)je(a,d[c])}P(b,"insertAdjacentHTML",function(a,b){a=a.toLowerCase();if("beforebegin"===a){var e=this.previousSibling;c.call(this,a,b);d(e||this.parentNode.firstChild,this)}else if("afterbegin"===a)e=this.firstChild,c.call(this,a,b),d(this.firstChild,e);else if("beforeend"===a)e=this.lastChild,c.call(this,a,b),d(e||this.firstChild,null);else if("afterend"===a)e=this.nextSibling,c.call(this,
a,b),d(this.nextSibling,e);else throw new SyntaxError("The value provided ("+String(a)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");})}Be&&P(Element.prototype,"attachShadow",function(a){return this.__CE_shadowRoot=a=Be.call(this,a)});Ce&&Ce.get?b(Element.prototype,Ce):Se&&Se.get?b(HTMLElement.prototype,Se):ge(a,function(a){b(a,{enumerable:!0,configurable:!0,get:function(){return ve.call(this,!0).innerHTML},set:function(a){var b="template"===this.localName,c=b?this.content:
this,d=oe.call(document,this.localName);for(d.innerHTML=a;0<c.childNodes.length;)ye.call(c,c.childNodes[0]);for(a=b?d.content:d;0<a.childNodes.length;)we.call(c,a.childNodes[0])}})});P(Element.prototype,"setAttribute",function(b,c){if(1!==this.__CE_state)return Ee.call(this,b,c);var d=De.call(this,b);Ee.call(this,b,c);c=De.call(this,b);a.attributeChangedCallback(this,b,d,c,null)});P(Element.prototype,"setAttributeNS",function(b,c,d){if(1!==this.__CE_state)return He.call(this,b,c,d);var e=Ge.call(this,
b,c);He.call(this,b,c,d);d=Ge.call(this,b,c);a.attributeChangedCallback(this,c,e,d,b)});P(Element.prototype,"removeAttribute",function(b){if(1!==this.__CE_state)return Fe.call(this,b);var c=De.call(this,b);Fe.call(this,b);null!==c&&a.attributeChangedCallback(this,b,c,null,null)});P(Element.prototype,"removeAttributeNS",function(b,c){if(1!==this.__CE_state)return Ie.call(this,b,c);var d=Ge.call(this,b,c);Ie.call(this,b,c);var e=Ge.call(this,b,c);d!==e&&a.attributeChangedCallback(this,c,d,e,b)});Te?
c(HTMLElement.prototype,Te):Je?c(Element.prototype,Je):console.warn("Custom Elements: `Element#insertAdjacentElement` was not patched.");Ue?d(HTMLElement.prototype,Ue):Ke?d(Element.prototype,Ke):console.warn("Custom Elements: `Element#insertAdjacentHTML` was not patched.");Ye(a,Element.prototype,{fa:Le,append:Me});af(a)};var cf=window.customElements;if(!cf||cf.forcePolyfill||"function"!=typeof cf.define||"function"!=typeof cf.get){var Xe=new ee;We();Ze();Ye(Xe,DocumentFragment.prototype,{fa:te,append:ue});$e();bf();document.__CE_hasRegistry=!0;var customElements=new S(Xe);Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:customElements})};function df(){this.end=this.start=0;this.rules=this.parent=this.previous=null;this.cssText=this.parsedCssText="";this.atRule=!1;this.type=0;this.parsedSelector=this.selector=this.keyframesName=""}
function ef(a){a=a.replace(ff,"").replace(gf,"");var b=hf,c=a,d=new df;d.start=0;d.end=c.length;for(var e=d,f=0,g=c.length;f<g;f++)if("{"===c[f]){e.rules||(e.rules=[]);var h=e,k=h.rules[h.rules.length-1]||null;e=new df;e.start=f+1;e.parent=h;e.previous=k;h.rules.push(e)}else"}"===c[f]&&(e.end=f+1,e=e.parent||d);return b(d,a)}
function hf(a,b){var c=b.substring(a.start,a.end-1);a.parsedCssText=a.cssText=c.trim();a.parent&&(c=b.substring(a.previous?a.previous.end:a.parent.start,a.start-1),c=jf(c),c=c.replace(kf," "),c=c.substring(c.lastIndexOf(";")+1),c=a.parsedSelector=a.selector=c.trim(),a.atRule=0===c.indexOf("@"),a.atRule?0===c.indexOf("@media")?a.type=lf:c.match(rf)&&(a.type=sf,a.keyframesName=a.selector.split(kf).pop()):a.type=0===c.indexOf("--")?tf:uf);if(c=a.rules)for(var d=0,e=c.length,f;d<e&&(f=c[d]);d++)hf(f,
b);return a}function jf(a){return a.replace(/\\([0-9a-f]{1,6})\s/gi,function(a,c){a=c;for(c=6-a.length;c--;)a="0"+a;return"\\"+a})}
function vf(a,b,c){c=void 0===c?"":c;var d="";if(a.cssText||a.rules){var e=a.rules,f;if(f=e)f=e[0],f=!(f&&f.selector&&0===f.selector.indexOf("--"));if(f){f=0;for(var g=e.length,h;f<g&&(h=e[f]);f++)d=vf(h,b,d)}else b?b=a.cssText:(b=a.cssText,b=b.replace(wf,"").replace(xf,""),b=b.replace(yf,"").replace(zf,"")),(d=b.trim())&&(d="  "+d+"\n")}d&&(a.selector&&(c+=a.selector+" {\n"),c+=d,a.selector&&(c+="}\n\n"));return c}
var uf=1,sf=7,lf=4,tf=1E3,ff=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,gf=/@import[^;]*;/gim,wf=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,xf=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,yf=/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,zf=/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,rf=/^@[^\s]*keyframes/,kf=/\s+/g;var T=!(window.ShadyDOM&&window.ShadyDOM.inUse),Af;function Bf(a){Af=a&&a.shimcssproperties?!1:T||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)"))}window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?Af=window.ShadyCSS.nativeCss:window.ShadyCSS?(Bf(window.ShadyCSS),window.ShadyCSS=void 0):Bf(window.WebComponents&&window.WebComponents.flags);var V=Af;var Cf=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,Df=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,Ef=/(--[\w-]+)\s*([:,;)]|$)/gi,Ff=/(animation\s*:)|(animation-name\s*:)/,Gf=/@media\s(.*)/,Hf=/\{[^}]*\}/g;var If=new Set;function Jf(a,b){if(!a)return"";"string"===typeof a&&(a=ef(a));b&&Kf(a,b);return vf(a,V)}function Lf(a){!a.__cssRules&&a.textContent&&(a.__cssRules=ef(a.textContent));return a.__cssRules||null}function Mf(a){return!!a.parent&&a.parent.type===sf}function Kf(a,b,c,d){if(a){var e=!1,f=a.type;if(d&&f===lf){var g=a.selector.match(Gf);g&&(window.matchMedia(g[1]).matches||(e=!0))}f===uf?b(a):c&&f===sf?c(a):f===tf&&(e=!0);if((a=a.rules)&&!e){e=0;f=a.length;for(var h;e<f&&(h=a[e]);e++)Kf(h,b,c,d)}}}
function Nf(a,b,c,d){var e=document.createElement("style");b&&e.setAttribute("scope",b);e.textContent=a;Of(e,c,d);return e}var Pf=null;function Of(a,b,c){b=b||document.head;b.insertBefore(a,c&&c.nextSibling||b.firstChild);Pf?a.compareDocumentPosition(Pf)===Node.DOCUMENT_POSITION_PRECEDING&&(Pf=a):Pf=a}
function Qf(a,b){var c=a.indexOf("var(");if(-1===c)return b(a,"","","");a:{var d=0;var e=c+3;for(var f=a.length;e<f;e++)if("("===a[e])d++;else if(")"===a[e]&&0===--d)break a;e=-1}d=a.substring(c+4,e);c=a.substring(0,c);a=Qf(a.substring(e+1),b);e=d.indexOf(",");return-1===e?b(c,d.trim(),"",a):b(c,d.substring(0,e).trim(),d.substring(e+1).trim(),a)}function Rf(a,b){T?a.setAttribute("class",b):window.ShadyDOM.nativeMethods.setAttribute.call(a,"class",b)}
function Sf(a){var b=a.localName,c="";b?-1<b.indexOf("-")||(c=b,b=a.getAttribute&&a.getAttribute("is")||""):(b=a.is,c=a.extends);return{is:b,X:c}};function Tf(){}function Uf(a,b,c){var d=Vf;a.__styleScoped?a.__styleScoped=null:Wf(d,a,b||"",c)}function Wf(a,b,c,d){b.nodeType===Node.ELEMENT_NODE&&Xf(b,c,d);if(b="template"===b.localName?(b.content||b.jb).childNodes:b.children||b.childNodes)for(var e=0;e<b.length;e++)Wf(a,b[e],c,d)}
function Xf(a,b,c){if(b)if(a.classList)c?(a.classList.remove("style-scope"),a.classList.remove(b)):(a.classList.add("style-scope"),a.classList.add(b));else if(a.getAttribute){var d=a.getAttribute(Yf);c?d&&(b=d.replace("style-scope","").replace(b,""),Rf(a,b)):Rf(a,(d?d+" ":"")+"style-scope "+b)}}function Zf(a,b,c){var d=Vf,e=a.__cssBuild;T||"shady"===e?b=Jf(b,c):(a=Sf(a),b=$f(d,b,a.is,a.X,c)+"\n\n");return b.trim()}
function $f(a,b,c,d,e){var f=ag(c,d);c=c?bg+c:"";return Jf(b,function(b){b.c||(b.selector=b.G=cg(a,b,a.b,c,f),b.c=!0);e&&e(b,c,f)})}function ag(a,b){return b?"[is="+a+"]":a}function cg(a,b,c,d,e){var f=b.selector.split(dg);if(!Mf(b)){b=0;for(var g=f.length,h;b<g&&(h=f[b]);b++)f[b]=c.call(a,h,d,e)}return f.join(dg)}function eg(a){return a.replace(fg,function(a,c,d){-1<d.indexOf("+")?d=d.replace(/\+/g,"___"):-1<d.indexOf("___")&&(d=d.replace(/___/g,"+"));return":"+c+"("+d+")"})}
Tf.prototype.b=function(a,b,c){var d=!1;a=a.trim();var e=fg.test(a);e&&(a=a.replace(fg,function(a,b,c){return":"+b+"("+c.replace(/\s/g,"")+")"}),a=eg(a));a=a.replace(gg,hg+" $1");a=a.replace(ig,function(a,e,h){d||(a=jg(h,e,b,c),d=d||a.stop,e=a.Sa,h=a.value);return e+h});e&&(a=eg(a));return a};
function jg(a,b,c,d){var e=a.indexOf(kg);0<=a.indexOf(hg)?a=lg(a,d):0!==e&&(a=c?mg(a,c):a);c=!1;0<=e&&(b="",c=!0);if(c){var f=!0;c&&(a=a.replace(ng,function(a,b){return" > "+b}))}a=a.replace(og,function(a,b,c){return'[dir="'+c+'"] '+b+", "+b+'[dir="'+c+'"]'});return{value:a,Sa:b,stop:f}}function mg(a,b){a=a.split(pg);a[0]+=b;return a.join(pg)}
function lg(a,b){var c=a.match(qg);return(c=c&&c[2].trim()||"")?c[0].match(rg)?a.replace(qg,function(a,c,f){return b+f}):c.split(rg)[0]===b?c:sg:a.replace(hg,b)}function tg(a){a.selector===ug&&(a.selector="html")}Tf.prototype.c=function(a){return a.match(kg)?this.b(a,vg):mg(a.trim(),vg)};aa.Object.defineProperties(Tf.prototype,{a:{configurable:!0,enumerable:!0,get:function(){return"style-scope"}}});
var fg=/:(nth[-\w]+)\(([^)]+)\)/,vg=":not(.style-scope)",dg=",",ig=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=[])+)/g,rg=/[[.:#*]/,hg=":host",ug=":root",kg="::slotted",gg=new RegExp("^("+kg+")"),qg=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,ng=/(?:::slotted)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,og=/(.*):dir\((?:(ltr|rtl))\)/,bg=".",pg=":",Yf="class",sg="should_not_match",Vf=new Tf;function wg(a,b,c,d){this.K=a||null;this.b=b||null;this.sa=c||[];this.T=null;this.X=d||"";this.a=this.H=this.O=null}function xg(a){return a?a.__styleInfo:null}function yg(a,b){return a.__styleInfo=b}wg.prototype.c=function(){return this.K};wg.prototype._getStyleRules=wg.prototype.c;function zg(a){var b=this.matches||this.matchesSelector||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;return b&&b.call(this,a)}var Ag=navigator.userAgent.match("Trident");function Bg(){}function Cg(a){var b={},c=[],d=0;Kf(a,function(a){Dg(a);a.index=d++;a=a.B.cssText;for(var c;c=Ef.exec(a);){var e=c[1];":"!==c[2]&&(b[e]=!0)}},function(a){c.push(a)});a.b=c;a=[];for(var e in b)a.push(e);return a}
function Dg(a){if(!a.B){var b={},c={};Eg(a,c)&&(b.J=c,a.rules=null);b.cssText=a.parsedCssText.replace(Hf,"").replace(Cf,"");a.B=b}}function Eg(a,b){var c=a.B;if(c){if(c.J)return Object.assign(b,c.J),!0}else{c=a.parsedCssText;for(var d;a=Cf.exec(c);){d=(a[2]||a[3]).trim();if("inherit"!==d||"unset"!==d)b[a[1].trim()]=d;d=!0}return d}}
function Fg(a,b,c){b&&(b=0<=b.indexOf(";")?Gg(a,b,c):Qf(b,function(b,e,f,g){if(!e)return b+g;(e=Fg(a,c[e],c))&&"initial"!==e?"apply-shim-inherit"===e&&(e="inherit"):e=Fg(a,c[f]||f,c)||f;return b+(e||"")+g}));return b&&b.trim()||""}
function Gg(a,b,c){b=b.split(";");for(var d=0,e,f;d<b.length;d++)if(e=b[d]){Df.lastIndex=0;if(f=Df.exec(e))e=Fg(a,c[f[1]],c);else if(f=e.indexOf(":"),-1!==f){var g=e.substring(f);g=g.trim();g=Fg(a,g,c)||g;e=e.substring(0,f)+g}b[d]=e&&e.lastIndexOf(";")===e.length-1?e.slice(0,-1):e||""}return b.join(";")}
function Hg(a,b){var c={},d=[];Kf(a,function(a){a.B||Dg(a);var e=a.G||a.parsedSelector;b&&a.B.J&&e&&zg.call(b,e)&&(Eg(a,c),a=a.index,e=parseInt(a/32,10),d[e]=(d[e]||0)|1<<a%32)},null,!0);return{J:c,key:d}}
function Ig(a,b,c,d){b.B||Dg(b);if(b.B.J){var e=Sf(a);a=e.is;e=e.X;e=a?ag(a,e):"html";var f=b.parsedSelector,g=":host > *"===f||"html"===f,h=0===f.indexOf(":host")&&!g;"shady"===c&&(g=f===e+" > *."+e||-1!==f.indexOf("html"),h=!g&&0===f.indexOf(e));"shadow"===c&&(g=":host > *"===f||"html"===f,h=h&&!g);if(g||h)c=e,h&&(b.G||(b.G=cg(Vf,b,Vf.b,a?bg+a:"",e)),c=b.G||e),d({Za:c,Wa:h,wb:g})}}
function Jg(a,b){var c={},d={},e=b&&b.__cssBuild;Kf(b,function(b){Ig(a,b,e,function(e){zg.call(a.kb||a,e.Za)&&(e.Wa?Eg(b,c):Eg(b,d))})},null,!0);return{Ya:d,Va:c}}
function Kg(a,b,c,d){var e=Sf(b),f=ag(e.is,e.X),g=new RegExp("(?:^|[^.#[:])"+(b.extends?"\\"+f.slice(0,-1)+"\\]":f)+"($|[.:[\\s>+~])");e=xg(b).K;var h=Lg(e,d);return Zf(b,e,function(b){var e="";b.B||Dg(b);b.B.cssText&&(e=Gg(a,b.B.cssText,c));b.cssText=e;if(!T&&!Mf(b)&&b.cssText){var k=e=b.cssText;null==b.za&&(b.za=Ff.test(e));if(b.za)if(null==b.ea){b.ea=[];for(var r in h)k=h[r],k=k(e),e!==k&&(e=k,b.ea.push(r))}else{for(r=0;r<b.ea.length;++r)k=h[b.ea[r]],e=k(e);k=e}b.cssText=k;b.G=b.G||b.selector;
e="."+d;r=b.G.split(",");k=0;for(var G=r.length,x;k<G&&(x=r[k]);k++)r[k]=x.match(g)?x.replace(f,e):e+" "+x;b.selector=r.join(",")}})}function Lg(a,b){a=a.b;var c={};if(!T&&a)for(var d=0,e=a[d];d<a.length;e=a[++d]){var f=e,g=b;f.F=new RegExp("\\b"+f.keyframesName+"(?!\\B|-)","g");f.a=f.keyframesName+"-"+g;f.G=f.G||f.selector;f.selector=f.G.replace(f.keyframesName,f.a);c[e.keyframesName]=Mg(e)}return c}function Mg(a){return function(b){return b.replace(a.F,a.a)}}
function Ng(a,b){var c=Og,d=Lf(a);a.textContent=Jf(d,function(a){var d=a.cssText=a.parsedCssText;a.B&&a.B.cssText&&(d=d.replace(wf,"").replace(xf,""),a.cssText=Gg(c,d,b))})}aa.Object.defineProperties(Bg.prototype,{a:{configurable:!0,enumerable:!0,get:function(){return"x-scope"}}});var Og=new Bg;var Pg={},Qg=window.customElements;if(Qg&&!T){var Rg=Qg.define;Qg.define=function(a,b,c){var d=document.createComment(" Shady DOM styles for "+a+" "),e=document.head;e.insertBefore(d,(Pf?Pf.nextSibling:null)||e.firstChild);Pf=d;Pg[a]=d;Rg.call(Qg,a,b,c)}};function Sg(){this.cache={}}Sg.prototype.store=function(a,b,c,d){var e=this.cache[a]||[];e.push({J:b,styleElement:c,H:d});100<e.length&&e.shift();this.cache[a]=e};Sg.prototype.fetch=function(a,b,c){if(a=this.cache[a])for(var d=a.length-1;0<=d;d--){var e=a[d],f;a:{for(f=0;f<c.length;f++){var g=c[f];if(e.J[g]!==b[g]){f=!1;break a}}f=!0}if(f)return e}};function Tg(){}
function Ug(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.target!==document.documentElement&&c.target!==document.head)for(var d=0;d<c.addedNodes.length;d++){var e=c.addedNodes[d];if(e.nodeType===Node.ELEMENT_NODE){var f=e.getRootNode();var g=e;var h=[];g.classList?h=Array.from(g.classList):g instanceof window.SVGElement&&g.hasAttribute("class")&&(h=g.getAttribute("class").split(/\s+/));g=h;h=g.indexOf(Vf.a);if((g=-1<h?g[h+1]:"")&&f===e.ownerDocument)Uf(e,g,!0);else if(f.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&
(f=f.host))if(f=Sf(f).is,g===f)for(e=window.ShadyDOM.nativeMethods.querySelectorAll.call(e,":not(."+Vf.a+")"),f=0;f<e.length;f++)Xf(e[f],g);else g&&Uf(e,g,!0),Uf(e,f)}}}}
if(!T){var Vg=new MutationObserver(Ug),Wg=function(a){Vg.observe(a,{childList:!0,subtree:!0})};if(window.customElements&&!window.customElements.polyfillWrapFlushCallback)Wg(document);else{var Xg=function(){Wg(document.body)};window.HTMLImports?window.HTMLImports.whenReady(Xg):requestAnimationFrame(function(){if("loading"===document.readyState){var a=function(){Xg();document.removeEventListener("readystatechange",a)};document.addEventListener("readystatechange",a)}else Xg()})}Tg=function(){Ug(Vg.takeRecords())}}
var Yg=Tg;var Zg={};var $g=Promise.resolve();function ah(a){if(a=Zg[a])a._applyShimCurrentVersion=a._applyShimCurrentVersion||0,a._applyShimValidatingVersion=a._applyShimValidatingVersion||0,a._applyShimNextVersion=(a._applyShimNextVersion||0)+1}function bh(a){return a._applyShimCurrentVersion===a._applyShimNextVersion}function ch(a){a._applyShimValidatingVersion=a._applyShimNextVersion;a.b||(a.b=!0,$g.then(function(){a._applyShimCurrentVersion=a._applyShimNextVersion;a.b=!1}))};var dh=new Sg;function W(){this.Aa={};this.c=document.documentElement;var a=new df;a.rules=[];this.F=yg(this.c,new wg(a));this.M=!1;this.b=this.a=null}q=W.prototype;q.Ga=function(){Yg()};q.Ta=function(a){return Lf(a)};q.ab=function(a){return Jf(a)};
q.prepareTemplate=function(a,b,c){if(!a.F){a.F=!0;a.name=b;a.extends=c;Zg[b]=a;var d=(d=a.content.querySelector("style"))?d.getAttribute("css-build")||"":"";var e=[];for(var f=a.content.querySelectorAll("style"),g=0;g<f.length;g++){var h=f[g];if(h.hasAttribute("shady-unscoped")){if(!T){var k=h.textContent;If.has(k)||(If.add(k),k=h.cloneNode(!0),document.head.appendChild(k));h.parentNode.removeChild(h)}}else e.push(h.textContent),h.parentNode.removeChild(h)}e=e.join("").trim();c={is:b,extends:c,hb:d};
T||Uf(a.content,b);eh(this);f=Df.test(e)||Cf.test(e);Df.lastIndex=0;Cf.lastIndex=0;e=ef(e);f&&V&&this.a&&this.a.transformRules(e,b);a._styleAst=e;a.M=d;d=[];V||(d=Cg(a._styleAst));if(!d.length||V)e=T?a.content:null,b=Pg[b],f=Zf(c,a._styleAst),b=f.length?Nf(f,c.is,e,b):void 0,a.a=b;a.c=d}};
function fh(a){!a.b&&window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface&&(a.b=window.ShadyCSS.CustomStyleInterface,a.b.transformCallback=function(b){a.Ea(b)},a.b.validateCallback=function(){requestAnimationFrame(function(){(a.b.enqueued||a.M)&&a.flushCustomStyles()})})}function eh(a){!a.a&&window.ShadyCSS&&window.ShadyCSS.ApplyShim&&(a.a=window.ShadyCSS.ApplyShim,a.a.invalidCallback=ah);fh(a)}
q.flushCustomStyles=function(){eh(this);if(this.b){var a=this.b.processStyles();if(this.b.enqueued){if(V)for(var b=0;b<a.length;b++){var c=this.b.getStyleForCustomStyle(a[b]);if(c&&V&&this.a){var d=Lf(c);eh(this);this.a.transformRules(d);c.textContent=Jf(d)}}else for(gh(this,this.c,this.F),b=0;b<a.length;b++)(c=this.b.getStyleForCustomStyle(a[b]))&&Ng(c,this.F.O);this.b.enqueued=!1;this.M&&!V&&this.styleDocument()}}};
q.styleElement=function(a,b){var c=Sf(a).is,d=xg(a);if(!d){var e=Sf(a);d=e.is;e=e.X;var f=Pg[d];d=Zg[d];if(d){var g=d._styleAst;var h=d.c}d=yg(a,new wg(g,f,h,e))}a!==this.c&&(this.M=!0);b&&(d.T=d.T||{},Object.assign(d.T,b));if(V){if(d.T){b=d.T;for(var k in b)null===k?a.style.removeProperty(k):a.style.setProperty(k,b[k])}if(((k=Zg[c])||a===this.c)&&k&&k.a&&!bh(k)){if(bh(k)||k._applyShimValidatingVersion!==k._applyShimNextVersion)eh(this),this.a&&this.a.transformRules(k._styleAst,c),k.a.textContent=
Zf(a,d.K),ch(k);T&&(c=a.shadowRoot)&&(c.querySelector("style").textContent=Zf(a,d.K));d.K=k._styleAst}}else if(gh(this,a,d),d.sa&&d.sa.length){c=d;k=Sf(a).is;d=(b=dh.fetch(k,c.O,c.sa))?b.styleElement:null;g=c.H;(h=b&&b.H)||(h=this.Aa[k]=(this.Aa[k]||0)+1,h=k+"-"+h);c.H=h;h=c.H;e=Og;e=d?d.textContent||"":Kg(e,a,c.O,h);f=xg(a);var m=f.a;m&&!T&&m!==d&&(m._useCount--,0>=m._useCount&&m.parentNode&&m.parentNode.removeChild(m));T?f.a?(f.a.textContent=e,d=f.a):e&&(d=Nf(e,h,a.shadowRoot,f.b)):d?d.parentNode||
(Ag&&-1<e.indexOf("@media")&&(d.textContent=e),Of(d,null,f.b)):e&&(d=Nf(e,h,null,f.b));d&&(d._useCount=d._useCount||0,f.a!=d&&d._useCount++,f.a=d);h=d;T||(d=c.H,f=e=a.getAttribute("class")||"",g&&(f=e.replace(new RegExp("\\s*x-scope\\s*"+g+"\\s*","g")," ")),f+=(f?" ":"")+"x-scope "+d,e!==f&&Rf(a,f));b||dh.store(k,c.O,h,c.H)}};function hh(a,b){return(b=b.getRootNode().host)?xg(b)?b:hh(a,b):a.c}
function gh(a,b,c){a=hh(a,b);var d=xg(a);a=Object.create(d.O||null);var e=Jg(b,c.K);b=Hg(d.K,b).J;Object.assign(a,e.Va,b,e.Ya);b=c.T;for(var f in b)if((e=b[f])||0===e)a[f]=e;f=Og;b=Object.getOwnPropertyNames(a);for(e=0;e<b.length;e++)d=b[e],a[d]=Fg(f,a[d],a);c.O=a}q.styleDocument=function(a){this.styleSubtree(this.c,a)};
q.styleSubtree=function(a,b){var c=a.shadowRoot;(c||a===this.c)&&this.styleElement(a,b);if(b=c&&(c.children||c.childNodes))for(a=0;a<b.length;a++)this.styleSubtree(b[a]);else if(a=a.children||a.childNodes)for(b=0;b<a.length;b++)this.styleSubtree(a[b])};q.Ea=function(a){var b=this,c=Lf(a);Kf(c,function(a){if(T)tg(a);else{var c=Vf;a.selector=a.parsedSelector;tg(a);a.selector=a.G=cg(c,a,c.c,void 0,void 0)}V&&(eh(b),b.a&&b.a.transformRule(a))});V?a.textContent=Jf(c):this.F.K.rules.push(c)};
q.getComputedStyleValue=function(a,b){var c;V||(c=(xg(a)||xg(hh(this,a))).O[b]);return(c=c||window.getComputedStyle(a).getPropertyValue(b))?c.trim():""};q.$a=function(a,b){var c=a.getRootNode();b=b?b.split(/\s/):[];c=c.host&&c.host.localName;if(!c){var d=a.getAttribute("class");if(d){d=d.split(/\s/);for(var e=0;e<d.length;e++)if(d[e]===Vf.a){c=d[e+1];break}}}c&&b.push(Vf.a,c);V||(c=xg(a))&&c.H&&b.push(Og.a,c.H);Rf(a,b.join(" "))};q.Qa=function(a){return xg(a)};W.prototype.flush=W.prototype.Ga;
W.prototype.prepareTemplate=W.prototype.prepareTemplate;W.prototype.styleElement=W.prototype.styleElement;W.prototype.styleDocument=W.prototype.styleDocument;W.prototype.styleSubtree=W.prototype.styleSubtree;W.prototype.getComputedStyleValue=W.prototype.getComputedStyleValue;W.prototype.setElementClass=W.prototype.$a;W.prototype._styleInfoForNode=W.prototype.Qa;W.prototype.transformCustomStyleForDocument=W.prototype.Ea;W.prototype.getStyleAst=W.prototype.Ta;W.prototype.styleAstToString=W.prototype.ab;
W.prototype.flushCustomStyles=W.prototype.flushCustomStyles;Object.defineProperties(W.prototype,{nativeShadow:{get:function(){return T}},nativeCss:{get:function(){return V}}});var X=new W,ih,jh;window.ShadyCSS&&(ih=window.ShadyCSS.ApplyShim,jh=window.ShadyCSS.CustomStyleInterface);
window.ShadyCSS={ScopingShim:X,prepareTemplate:function(a,b,c){X.flushCustomStyles();X.prepareTemplate(a,b,c)},styleSubtree:function(a,b){X.flushCustomStyles();X.styleSubtree(a,b)},styleElement:function(a){X.flushCustomStyles();X.styleElement(a)},styleDocument:function(a){X.flushCustomStyles();X.styleDocument(a)},flushCustomStyles:function(){X.flushCustomStyles()},getComputedStyleValue:function(a,b){return X.getComputedStyleValue(a,b)},nativeCss:V,nativeShadow:T};ih&&(window.ShadyCSS.ApplyShim=ih);
jh&&(window.ShadyCSS.CustomStyleInterface=jh);(function(a){function b(a){""==a&&(f.call(this),this.h=!0);return a.toLowerCase()}function c(a){var b=a.charCodeAt(0);return 32<b&&127>b&&-1==[34,35,60,62,63,96].indexOf(b)?a:encodeURIComponent(a)}function d(a){var b=a.charCodeAt(0);return 32<b&&127>b&&-1==[34,35,60,62,96].indexOf(b)?a:encodeURIComponent(a)}function e(a,e,g){function h(a){kb.push(a)}var k=e||"scheme start",v=0,p="",x=!1,U=!1,kb=[];a:for(;(void 0!=a[v-1]||0==v)&&!this.h;){var l=a[v];switch(k){case "scheme start":if(l&&r.test(l))p+=
l.toLowerCase(),k="scheme";else if(e){h("Invalid scheme.");break a}else{p="";k="no scheme";continue}break;case "scheme":if(l&&G.test(l))p+=l.toLowerCase();else if(":"==l){this.g=p;p="";if(e)break a;void 0!==m[this.g]&&(this.D=!0);k="file"==this.g?"relative":this.D&&g&&g.g==this.g?"relative or authority":this.D?"authority first slash":"scheme data"}else if(e){void 0!=l&&h("Code point not allowed in scheme: "+l);break a}else{p="";v=0;k="no scheme";continue}break;case "scheme data":"?"==l?(this.u="?",
k="query"):"#"==l?(this.C="#",k="fragment"):void 0!=l&&"\t"!=l&&"\n"!=l&&"\r"!=l&&(this.qa+=c(l));break;case "no scheme":if(g&&void 0!==m[g.g]){k="relative";continue}else h("Missing scheme."),f.call(this),this.h=!0;break;case "relative or authority":if("/"==l&&"/"==a[v+1])k="authority ignore slashes";else{h("Expected /, got: "+l);k="relative";continue}break;case "relative":this.D=!0;"file"!=this.g&&(this.g=g.g);if(void 0==l){this.i=g.i;this.s=g.s;this.j=g.j.slice();this.u=g.u;this.v=g.v;this.f=g.f;
break a}else if("/"==l||"\\"==l)"\\"==l&&h("\\ is an invalid code point."),k="relative slash";else if("?"==l)this.i=g.i,this.s=g.s,this.j=g.j.slice(),this.u="?",this.v=g.v,this.f=g.f,k="query";else if("#"==l)this.i=g.i,this.s=g.s,this.j=g.j.slice(),this.u=g.u,this.C="#",this.v=g.v,this.f=g.f,k="fragment";else{k=a[v+1];var F=a[v+2];if("file"!=this.g||!r.test(l)||":"!=k&&"|"!=k||void 0!=F&&"/"!=F&&"\\"!=F&&"?"!=F&&"#"!=F)this.i=g.i,this.s=g.s,this.v=g.v,this.f=g.f,this.j=g.j.slice(),this.j.pop();k=
"relative path";continue}break;case "relative slash":if("/"==l||"\\"==l)"\\"==l&&h("\\ is an invalid code point."),k="file"==this.g?"file host":"authority ignore slashes";else{"file"!=this.g&&(this.i=g.i,this.s=g.s,this.v=g.v,this.f=g.f);k="relative path";continue}break;case "authority first slash":if("/"==l)k="authority second slash";else{h("Expected '/', got: "+l);k="authority ignore slashes";continue}break;case "authority second slash":k="authority ignore slashes";if("/"!=l){h("Expected '/', got: "+
l);continue}break;case "authority ignore slashes":if("/"!=l&&"\\"!=l){k="authority";continue}else h("Expected authority, got: "+l);break;case "authority":if("@"==l){x&&(h("@ already seen."),p+="%40");x=!0;for(l=0;l<p.length;l++)F=p[l],"\t"==F||"\n"==F||"\r"==F?h("Invalid whitespace in authority."):":"==F&&null===this.f?this.f="":(F=c(F),null!==this.f?this.f+=F:this.v+=F);p=""}else if(void 0==l||"/"==l||"\\"==l||"?"==l||"#"==l){v-=p.length;p="";k="host";continue}else p+=l;break;case "file host":if(void 0==
l||"/"==l||"\\"==l||"?"==l||"#"==l){2!=p.length||!r.test(p[0])||":"!=p[1]&&"|"!=p[1]?(0!=p.length&&(this.i=b.call(this,p),p=""),k="relative path start"):k="relative path";continue}else"\t"==l||"\n"==l||"\r"==l?h("Invalid whitespace in file host."):p+=l;break;case "host":case "hostname":if(":"!=l||U)if(void 0==l||"/"==l||"\\"==l||"?"==l||"#"==l){this.i=b.call(this,p);p="";k="relative path start";if(e)break a;continue}else"\t"!=l&&"\n"!=l&&"\r"!=l?("["==l?U=!0:"]"==l&&(U=!1),p+=l):h("Invalid code point in host/hostname: "+
l);else if(this.i=b.call(this,p),p="",k="port","hostname"==e)break a;break;case "port":if(/[0-9]/.test(l))p+=l;else if(void 0==l||"/"==l||"\\"==l||"?"==l||"#"==l||e){""!=p&&(p=parseInt(p,10),p!=m[this.g]&&(this.s=p+""),p="");if(e)break a;k="relative path start";continue}else"\t"==l||"\n"==l||"\r"==l?h("Invalid code point in port: "+l):(f.call(this),this.h=!0);break;case "relative path start":"\\"==l&&h("'\\' not allowed in path.");k="relative path";if("/"!=l&&"\\"!=l)continue;break;case "relative path":if(void 0!=
l&&"/"!=l&&"\\"!=l&&(e||"?"!=l&&"#"!=l))"\t"!=l&&"\n"!=l&&"\r"!=l&&(p+=c(l));else{"\\"==l&&h("\\ not allowed in relative path.");if(F=n[p.toLowerCase()])p=F;".."==p?(this.j.pop(),"/"!=l&&"\\"!=l&&this.j.push("")):"."==p&&"/"!=l&&"\\"!=l?this.j.push(""):"."!=p&&("file"==this.g&&0==this.j.length&&2==p.length&&r.test(p[0])&&"|"==p[1]&&(p=p[0]+":"),this.j.push(p));p="";"?"==l?(this.u="?",k="query"):"#"==l&&(this.C="#",k="fragment")}break;case "query":e||"#"!=l?void 0!=l&&"\t"!=l&&"\n"!=l&&"\r"!=l&&(this.u+=
d(l)):(this.C="#",k="fragment");break;case "fragment":void 0!=l&&"\t"!=l&&"\n"!=l&&"\r"!=l&&(this.C+=l)}v++}}function f(){this.v=this.qa=this.g="";this.f=null;this.s=this.i="";this.j=[];this.C=this.u="";this.D=this.h=!1}function g(a,b){void 0===b||b instanceof g||(b=new g(String(b)));this.Ra=a;f.call(this);a=a.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");e.call(this,a,null,b)}var h=!1;if(!a.qb)try{var k=new URL("b","http://a");k.pathname="c%20d";h="http://a/c%20d"===k.href}catch(v){}if(!h){var m=Object.create(null);
m.ftp=21;m.file=0;m.gopher=70;m.http=80;m.https=443;m.ws=80;m.wss=443;var n=Object.create(null);n["%2e"]=".";n[".%2e"]="..";n["%2e."]="..";n["%2e%2e"]="..";var r=/[a-zA-Z]/,G=/[a-zA-Z0-9\+\-\.]/;g.prototype={toString:function(){return this.href},get href(){if(this.h)return this.Ra;var a="";if(""!=this.v||null!=this.f)a=this.v+(null!=this.f?":"+this.f:"")+"@";return this.protocol+(this.D?"//"+a+this.host:"")+this.pathname+this.u+this.C},set href(a){f.call(this);e.call(this,a)},get protocol(){return this.g+
":"},set protocol(a){this.h||e.call(this,a+":","scheme start")},get host(){return this.h?"":this.s?this.i+":"+this.s:this.i},set host(a){!this.h&&this.D&&e.call(this,a,"host")},get hostname(){return this.i},set hostname(a){!this.h&&this.D&&e.call(this,a,"hostname")},get port(){return this.s},set port(a){!this.h&&this.D&&e.call(this,a,"port")},get pathname(){return this.h?"":this.D?"/"+this.j.join("/"):this.qa},set pathname(a){!this.h&&this.D&&(this.j=[],e.call(this,a,"relative path start"))},get search(){return this.h||
!this.u||"?"==this.u?"":this.u},set search(a){!this.h&&this.D&&(this.u="?","?"==a[0]&&(a=a.slice(1)),e.call(this,a,"query"))},get hash(){return this.h||!this.C||"#"==this.C?"":this.C},set hash(a){this.h||(this.C="#","#"==a[0]&&(a=a.slice(1)),e.call(this,a,"fragment"))},get origin(){var a;if(this.h||!this.g)return"";switch(this.g){case "data":case "file":case "javascript":case "mailto":return"null"}return(a=this.host)?this.g+"://"+a:""}};var x=a.URL;x&&(g.createObjectURL=function(a){return x.createObjectURL.apply(x,
arguments)},g.revokeObjectURL=function(a){x.revokeObjectURL(a)});a.URL=g}})(window);var kh={},lh=Object.create,mh=Object.defineProperties,nh=Object.defineProperty;function Y(a,b){b=void 0===b?{}:b;return{value:a,configurable:!!b.ya,writable:!!b.cb,enumerable:!!b.e}}var oh=void 0;try{oh=1===nh({},"y",{get:function(){return 1}}).y}catch(a){oh=!1}var ph={};function qh(a){a=String(a);for(var b="",c=0;ph[a+b];)b=c+=1;ph[a+b]=1;var d="Symbol("+a+""+b+")";oh&&nh(Object.prototype,d,{get:void 0,set:function(a){nh(this,d,Y(a,{ya:!0,cb:!0}))},configurable:!0,enumerable:!1});return d}
var rh=lh(null);function Z(a){if(this instanceof Z)throw new TypeError("Symbol is not a constructor");a=void 0===a?"":String(a);var b=qh(a);return oh?lh(rh,{ua:Y(a),Ka:Y(b)}):b}mh(Z,{"for":Y(function(a){a=String(a);if(kh[a])return kh[a];var b=Z(a);return kh[a]=b}),keyFor:Y(function(a){if(oh&&(!a||"Symbol"!==a[Z.toStringTag]))throw new TypeError(""+a+" is not a symbol");for(var b in kh)if(kh[b]===a)return oh?kh[b].ua:kh[b].substr(7,kh[b].length-8)})});
mh(Z,{ub:Y(Z("hasInstance")),vb:Y(Z("isConcatSpreadable")),iterator:Y(Z("iterator")),match:Y(Z("match")),replace:Y(Z("replace")),search:Y(Z("search")),Ab:Y(Z("species")),split:Y(Z("split")),Bb:Y(Z("toPrimitive")),toStringTag:Y(Z("toStringTag")),unscopables:Y(Z("unscopables"))});mh(rh,{constructor:Y(Z),toString:Y(function(){return this.Ka}),valueOf:Y(function(){return"Symbol("+this.ua+")"})});oh&&nh(rh,Z.toStringTag,Y("Symbol",{ya:!0}));var sh="function"===typeof Symbol?Symbol:Z;/*

Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
window.Symbol||(window.Symbol=sh,Array.prototype[sh.iterator]=function(){function a(a,e,h){for(;;)switch(b){case 0:c=0;case 1:if(!(c<d.length)){b=3;break}b=4;return{value:d[c],done:!1};case 4:if(1!=a){b=5;break}b=-1;throw h;case 5:case 2:c++;b=1;break;case 3:b=-1;default:return{value:void 0,done:!0}}}var b=0,c,d=this,e={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(){throw Error("Not yet implemented");}};ea();e[Symbol.iterator]=function(){return this};
return e},Set.prototype[sh.iterator]=function(){function a(a,f,k){for(;;)switch(b){case 0:d=[],e.forEach(function(a){d.push(a)}),c=0;case 1:if(!(c<d.length)){b=3;break}b=4;return{value:d[c],done:!1};case 4:if(1!=a){b=5;break}b=-1;throw k;case 5:case 2:c++;b=1;break;case 3:b=-1;default:return{value:void 0,done:!0}}}var b=0,c,d,e=this,f={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(){throw Error("Not yet implemented");}};ea();f[Symbol.iterator]=function(){return this};
return f},Map.prototype[sh.iterator]=function(){function a(a,f,k){for(;;)switch(b){case 0:d=[],e.forEach(function(a,b){d.push([b,a])}),c=0;case 1:if(!(c<d.length)){b=3;break}b=4;return{value:d[c],done:!1};case 4:if(1!=a){b=5;break}b=-1;throw k;case 5:case 2:c++;b=1;break;case 3:b=-1;default:return{value:void 0,done:!0}}}var b=0,c,d,e=this,f={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(){throw Error("Not yet implemented");}};ea();f[Symbol.iterator]=
function(){return this};return f},String.prototype[sh.iterator]=function(){function a(a,e,h){for(;;)switch(b){case 0:c=0;case 1:if(!(c<d.length)){b=3;break}b=4;return{value:d[c],done:!1};case 4:if(1!=a){b=5;break}b=-1;throw h;case 5:case 2:c++;b=1;break;case 3:b=-1;default:return{value:void 0,done:!0}}}var b=0,c,d=this,e={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(){throw Error("Not yet implemented");}};ea();e[Symbol.iterator]=function(){return this};
return e});var th=document.createElement("style");th.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var uh=document.querySelector("head");uh.insertBefore(th,uh.firstChild);var vh=window.customElements,wh=!1,xh=null;vh.polyfillWrapFlushCallback&&vh.polyfillWrapFlushCallback(function(a){xh=a;wh&&a()});function yh(){window.HTMLTemplateElement.bootstrap&&window.HTMLTemplateElement.bootstrap(window.document);xh&&xh();wh=!0;window.WebComponents.ready=!0;document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))}
"complete"!==document.readyState?(window.addEventListener("load",yh),window.addEventListener("DOMContentLoaded",function(){window.removeEventListener("load",yh);yh()})):yh();}).call(this);
}
</script>
  <script>function load_distill_framework() {
(function(e,t){'object'==typeof exports&&'undefined'!=typeof module?t():'function'==typeof define&&define.amd?define(t):t()})(this,function(){'use strict';function e(e,t){e.title=t.title,t.published&&(t.published instanceof Date?e.publishedDate=t.published:t.published.constructor===String&&(e.publishedDate=new Date(t.published))),t.publishedDate&&(t.publishedDate instanceof Date?e.publishedDate=t.publishedDate:t.publishedDate.constructor===String?e.publishedDate=new Date(t.publishedDate):console.error('Don\'t know what to do with published date: '+t.publishedDate)),e.description=t.description,e.authors=t.authors.map((e)=>new Qn(e)),e.katex=t.katex,e.password=t.password}function t(e=document){const t=new Set,n=e.querySelectorAll('d-cite');for(const i of n){const e=i.getAttribute('key').split(',');for(const n of e)t.add(n)}return[...t]}function n(e,t,n,i){if(null==e.author)return'';var a=e.author.split(' and ');let d=a.map((e)=>{if(e=e.trim(),e.match(/\{.+\}/)){var n=/\{([^}]+)\}/,i=n.exec(e);return i[1]}if(-1!=e.indexOf(','))var a=e.split(',')[0].trim(),d=e.split(',')[1];else var a=e.split(' ').slice(-1)[0].trim(),d=e.split(' ').slice(0,-1).join(' ');var r='';return void 0!=d&&(r=d.trim().split(' ').map((e)=>e.trim()[0]),r=r.join('.')+'.'),t.replace('${F}',d).replace('${L}',a).replace('${I}',r)});if(1<a.length){var r=d.slice(0,a.length-1).join(n);return r+=(i||n)+d[a.length-1],r}return d[0]}function i(e){var t=e.journal||e.booktitle||'';if('volume'in e){var n=e.issue||e.number;n=void 0==n?'':'('+n+')',t+=', Vol '+e.volume+n}return'pages'in e&&(t+=', pp. '+e.pages),''!=t&&(t+='. '),'publisher'in e&&(t+=e.publisher,'.'!=t[t.length-1]&&(t+='.')),t}function a(e){if('url'in e){var t=e.url,n=/arxiv\.org\/abs\/([0-9\.]*)/.exec(t);if(null!=n&&(t=`http://arxiv.org/pdf/${n[1]}.pdf`),'.pdf'==t.slice(-4))var i='PDF';else if('.html'==t.slice(-5))var i='HTML';return` &ensp;<a href="${t}">[${i||'link'}]</a>`}return''}function d(e,t){return'doi'in e?`${t?'<br>':''} <a href="https://doi.org/${e.doi}" style="text-decoration:inherit;">DOI: ${e.doi}</a>`:''}function r(e){return'<span class="title">'+e.title+'</span> '}function o(e){if(e){var t=r(e);return t+=a(e)+'<br>',e.author&&(t+=n(e,'${L}, ${I}',', ',' and '),(e.year||e.date)&&(t+=', ')),t+=e.year||e.date?(e.year||e.date)+'. ':'. ',t+=i(e),t+=d(e),t}return'?'}function l(e){if(e){var t='';t+='<strong>'+e.title+'</strong>',t+=a(e),t+='<br>';var r=n(e,'${I} ${L}',', ')+'.',o=i(e).trim()+' '+e.year+'. '+d(e,!0);return t+=(r+o).length<Hn(40,e.title.length)?r+' '+o:r+'<br>'+o,t}return'?'}function s(e){for(let t of e.authors){const e=!!t.affiliation,n=!!t.affiliations;if(e)if(n)console.warn(`Author ${t.author} has both old-style ("affiliation" & "affiliationURL") and new style ("affiliations") affiliation information!`);else{let e={name:t.affiliation};t.affiliationURL&&(e.url=t.affiliationURL),t.affiliations=[e]}}return console.log(e),e}function c(e){const t=e.querySelector('script');if(t){const e=t.getAttribute('type');if('json'==e.split('/')[1]){const e=t.textContent,n=JSON.parse(e);return s(n)}console.error('Distill only supports JSON frontmatter tags anymore; no more YAML.')}else console.error('You added a frontmatter tag but did not provide a script tag with front matter data in it. Please take a look at our templates.');return{}}function u(){return-1!==['interactive','complete'].indexOf(document.readyState)}function p(e){const t='distill-prerendered-styles',n=e.getElementById(t);if(!n){const n=e.createElement('style');n.id=t,n.type='text/css';const i=e.createTextNode(bi);n.appendChild(i);const a=e.head.querySelector('script');e.head.insertBefore(n,a)}}function g(e,t){console.info('Runlevel 0: Polyfill required: '+e.name);const n=document.createElement('script');n.src=e.url,n.async=!1,t&&(n.onload=function(){t(e)}),n.onerror=function(){new Error('Runlevel 0: Polyfills failed to load script '+e.name)},document.head.appendChild(n)}function f(e,t){return t={exports:{}},e(t,t.exports),t.exports}function h(e){return e.replace(/[\t\n ]+/g,' ').replace(/{\\["^`.'acu~Hvs]( )?([a-zA-Z])}/g,(e,t,n)=>n).replace(/{\\([a-zA-Z])}/g,(e,t)=>t)}function b(e){const t=new Map,n=_i.toJSON(e);for(const i of n){for(const[e,t]of Object.entries(i.entryTags))i.entryTags[e.toLowerCase()]=h(t);i.entryTags.type=i.entryType,t.set(i.citationKey,i.entryTags)}return t}function m(e){return`@article{${e.slug},
  author = {${e.bibtexAuthors}},
  title = {${e.title}},
  journal = {${e.journal.title}},
  year = {${e.publishedYear}},
  note = {${e.url}},
  doi = {${e.doi}}
}`}function y(e){return`
  <div class="byline grid">
    <div class="authors-affiliations grid">
      <h3>Authors</h3>
      <h3>Affiliations</h3>
      ${e.authors.map((e)=>`
        <p class="author">
          ${e.personalURL?`
            <a class="name" href="${e.personalURL}">${e.name}</a>`:`
            <span class="name">${e.name}</span>`}
        </p>
        <p class="affiliation">
        ${e.affiliations.map((e)=>e.url?`<a class="affiliation" href="${e.url}">${e.name}</a>`:`<span class="affiliation">${e.name}</span>`).join(', ')}
        </p>
      `).join('')}
    </div>
    <div>
      <h3>Published</h3>
      ${e.publishedDate?`
        <p>${e.publishedMonth} ${e.publishedDay}, ${e.publishedYear}</p> `:`
        <p><em>Not published yet.</em></p>`}
    </div>
    <div>
      <h3>DOI</h3>
      ${e.doi?`
        <p><a href="https://doi.org/${e.doi}">${e.doi}</a></p>`:`
        <p><em>No DOI yet.</em></p>`}
    </div>
  </div>
`}function x(e,t,n=document){if(0<t.size){e.style.display='';let i=e.querySelector('.references');if(i)i.innerHTML='';else{const t=n.createElement('style');t.innerHTML=Mi,e.appendChild(t);const a=n.createElement('h3');a.id='references',a.textContent='References',e.appendChild(a),i=n.createElement('ol'),i.id='references-list',i.className='references',e.appendChild(i)}for(const[e,a]of t){const t=n.createElement('li');t.id=e,t.innerHTML=o(a),i.appendChild(t)}}else e.style.display='none'}function k(e,t){let n=`
  <style>

  d-toc {
    contain: layout style;
    display: block;
  }

  d-toc ul {
    padding-left: 0;
  }

  d-toc ul > ul {
    padding-left: 24px;
  }

  d-toc a {
    border-bottom: none;
    text-decoration: none;
  }

  </style>
  <nav role="navigation" class="table-of-contents"></nav>
  <h2>Table of contents</h2>
  <ul>`;for(const i of t){const e='D-TITLE'==i.parentElement.tagName,t=i.getAttribute('no-toc');if(e||t)continue;const a=i.textContent,d='#'+i.getAttribute('id');let r='<li><a href="'+d+'">'+a+'</a></li>';'H3'==i.tagName?r='<ul>'+r+'</ul>':r+='<br>',n+=r}n+='</ul></nav>',e.innerHTML=n}function v(e){return function(t,n){return Xi(e(t),n)}}function w(e,t,n){var i=(t-e)/Rn(0,n),a=Fn(jn(i)/Nn),d=i/In(10,a);return 0<=a?(d>=Gi?10:d>=ea?5:d>=ta?2:1)*In(10,a):-In(10,-a)/(d>=Gi?10:d>=ea?5:d>=ta?2:1)}function S(e,t,n){var i=Un(t-e)/Rn(0,n),a=In(10,Fn(jn(i)/Nn)),d=i/a;return d>=Gi?a*=10:d>=ea?a*=5:d>=ta&&(a*=2),t<e?-a:a}function _(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function L(){}function M(e){var t;return e=(e+'').trim().toLowerCase(),(t=sa.exec(e))?(t=parseInt(t[1],16),new j(15&t>>8|240&t>>4,15&t>>4|240&t,(15&t)<<4|15&t,1)):(t=ca.exec(e))?O(parseInt(t[1],16)):(t=ua.exec(e))?new j(t[1],t[2],t[3],1):(t=pa.exec(e))?new j(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ga.exec(e))?U(t[1],t[2],t[3],t[4]):(t=fa.exec(e))?U(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ha.exec(e))?R(t[1],t[2]/100,t[3]/100,1):(t=ba.exec(e))?R(t[1],t[2]/100,t[3]/100,t[4]):ma.hasOwnProperty(e)?O(ma[e]):'transparent'===e?new j(NaN,NaN,NaN,0):null}function O(e){return new j(255&e>>16,255&e>>8,255&e,1)}function U(e,t,n,i){return 0>=i&&(e=t=n=NaN),new j(e,t,n,i)}function I(e){return(e instanceof L||(e=M(e)),!e)?new j:(e=e.rgb(),new j(e.r,e.g,e.b,e.opacity))}function N(e,t,n,i){return 1===arguments.length?I(e):new j(e,t,n,null==i?1:i)}function j(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}function R(e,t,n,i){return 0>=i?e=t=n=NaN:0>=n||1<=n?e=t=NaN:0>=t&&(e=NaN),new F(e,t,n,i)}function q(e){if(e instanceof F)return new F(e.h,e.s,e.l,e.opacity);if(e instanceof L||(e=M(e)),!e)return new F;if(e instanceof F)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,a=Hn(t,n,i),d=Rn(t,n,i),r=NaN,c=d-a,s=(d+a)/2;return c?(r=t===d?(n-i)/c+6*(n<i):n===d?(i-t)/c+2:(t-n)/c+4,c/=0.5>s?d+a:2-d-a,r*=60):c=0<s&&1>s?0:r,new F(r,c,s,e.opacity)}function F(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function P(e,t,n){return 255*(60>e?t+(n-t)*e/60:180>e?n:240>e?t+(n-t)*(240-e)/60:t)}function H(e){if(e instanceof Y)return new Y(e.l,e.a,e.b,e.opacity);if(e instanceof X){var t=e.h*ya;return new Y(e.l,Mn(t)*e.c,Dn(t)*e.c,e.opacity)}e instanceof j||(e=I(e));var n=$(e.r),i=$(e.g),a=$(e.b),d=W((0.4124564*n+0.3575761*i+0.1804375*a)/Kn),r=W((0.2126729*n+0.7151522*i+0.072175*a)/Xn),o=W((0.0193339*n+0.119192*i+0.9503041*a)/Yn);return new Y(116*r-16,500*(d-r),200*(r-o),e.opacity)}function Y(e,t,n,i){this.l=+e,this.a=+t,this.b=+n,this.opacity=+i}function W(e){return e>Sa?In(e,1/3):e/wa+Zn}function V(e){return e>va?e*e*e:wa*(e-Zn)}function K(e){return 255*(0.0031308>=e?12.92*e:1.055*In(e,1/2.4)-0.055)}function $(e){return 0.04045>=(e/=255)?e/12.92:In((e+0.055)/1.055,2.4)}function z(e){if(e instanceof X)return new X(e.h,e.c,e.l,e.opacity);e instanceof Y||(e=H(e));var t=En(e.b,e.a)*xa;return new X(0>t?t+360:t,An(e.a*e.a+e.b*e.b),e.l,e.opacity)}function X(e,t,n,i){this.h=+e,this.c=+t,this.l=+n,this.opacity=+i}function J(e){if(e instanceof Z)return new Z(e.h,e.s,e.l,e.opacity);e instanceof j||(e=I(e));var t=e.r/255,n=e.g/255,i=e.b/255,a=(_a*i+E*t-Ta*n)/(_a+E-Ta),d=i-a,r=(D*(n-a)-B*d)/C,o=An(r*r+d*d)/(D*a*(1-a)),l=o?En(r,d)*xa-120:NaN;return new Z(0>l?l+360:l,o,a,e.opacity)}function Q(e,t,n,i){return 1===arguments.length?J(e):new Z(e,t,n,null==i?1:i)}function Z(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}function G(e,n){return function(i){return e+i*n}}function ee(e,n,i){return e=In(e,i),n=In(n,i)-e,i=1/i,function(a){return In(e+a*n,i)}}function te(e){return 1==(e=+e)?ne:function(t,n){return n-t?ee(t,n,e):La(isNaN(t)?n:t)}}function ne(e,t){var n=t-e;return n?G(e,n):La(isNaN(e)?t:e)}function ie(e){return function(){return e}}function ae(e){return function(n){return e(n)+''}}function de(e){return function t(n){function i(i,t){var a=e((i=Q(i)).h,(t=Q(t)).h),d=ne(i.s,t.s),r=ne(i.l,t.l),o=ne(i.opacity,t.opacity);return function(e){return i.h=a(e),i.s=d(e),i.l=r(In(e,n)),i.opacity=o(e),i+''}}return n=+n,i.gamma=t,i}(1)}function oe(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Pa(t)}function le(e){return function(t,n){var i=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:i(e)}}}function se(e){return function(n,i){var d=e(n=+n,i=+i);return function(e){return 0>=e?n:1<=e?i:d(e)}}}function ce(e,t,n,i){var a=e[0],d=e[1],r=t[0],o=t[1];return d<a?(a=n(d,a),r=i(o,r)):(a=n(a,d),r=i(r,o)),function(e){return r(a(e))}}function ue(e,t,n,a){var o=Hn(e.length,t.length)-1,l=Array(o),d=Array(o),r=-1;for(e[o]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++r<o;)l[r]=n(e[r],e[r+1]),d[r]=a(t[r],t[r+1]);return function(t){var n=Qi(e,t,1,o)-1;return d[n](l[n](t))}}function pe(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function ge(e,t){function n(){return a=2<Hn(o.length,l.length)?ue:ce,d=r=null,i}function i(t){return(d||(d=a(o,l,c?le(e):e,s)))(+t)}var a,d,r,o=za,l=za,s=ja,c=!1;return i.invert=function(e){return(r||(r=a(l,o,oe,c?se(t):t)))(+e)},i.domain=function(e){return arguments.length?(o=aa.call(e,Ha),n()):o.slice()},i.range=function(e){return arguments.length?(l=da.call(e),n()):l.slice()},i.rangeRound=function(e){return l=da.call(e),s=Ra,n()},i.clamp=function(e){return arguments.length?(c=!!e,n()):c},i.interpolate=function(e){return arguments.length?(s=e,n()):s},n()}function fe(e){return new he(e)}function he(e){if(!(t=Xa.exec(e)))throw new Error('invalid format: '+e);var t,n=t[1]||' ',i=t[2]||'>',a=t[3]||'-',d=t[4]||'',r=!!t[5],o=t[6]&&+t[6],l=!!t[7],s=t[8]&&+t[8].slice(1),c=t[9]||'';'n'===c?(l=!0,c='g'):!$a[c]&&(c=''),(r||'0'===n&&'='===i)&&(r=!0,n='0',i='='),this.fill=n,this.align=i,this.sign=a,this.symbol=d,this.zero=r,this.width=o,this.comma=l,this.precision=s,this.type=c}function be(e){var t=e.domain;return e.ticks=function(e){var n=t();return na(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return ad(t(),e,n)},e.nice=function(n){null==n&&(n=10);var i,a=t(),d=0,r=a.length-1,o=a[d],l=a[r];return l<o&&(i=o,o=l,l=i,i=d,d=r,r=i),i=w(o,l,n),0<i?(o=Fn(o/i)*i,l=qn(l/i)*i,i=w(o,l,n)):0>i&&(o=qn(o*i)/i,l=Fn(l*i)/i,i=w(o,l,n)),0<i?(a[d]=Fn(o/i)*i,a[r]=qn(l/i)*i,t(a)):0>i&&(a[d]=qn(o*i)/i,a[r]=Fn(l*i)/i,t(a)),e},e}function me(){var e=ge(oe,Ma);return e.copy=function(){return pe(e,me())},be(e)}function ye(e,t,n,i){function a(t){return e(t=new Date(+t)),t}return a.floor=a,a.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},a.round=function(e){var t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=function(e,n){return t(e=new Date(+e),null==n?1:Fn(n)),e},a.range=function(n,i,d){var r=[];if(n=a.ceil(n),d=null==d?1:Fn(d),!(n<i)||!(0<d))return r;do r.push(new Date(+n));while((t(n,d),e(n),n<i));return r},a.filter=function(n){return ye(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,i){if(e>=e)if(0>i)for(;0>=++i;)for(;t(e,-1),!n(e););else for(;0<=--i;)for(;t(e,1),!n(e););})},n&&(a.count=function(t,i){return dd.setTime(+t),rd.setTime(+i),e(dd),e(rd),Fn(n(dd,rd))},a.every=function(e){return e=Fn(e),isFinite(e)&&0<e?1<e?a.filter(i?function(t){return 0==i(t)%e}:function(t){return 0==a.count(0,t)%e}):a:null}),a}function xe(e){return ye(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sd)/pd})}function ke(e){return ye(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/pd})}function ve(e){if(0<=e.y&&100>e.y){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function we(e){if(0<=e.y&&100>e.y){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Se(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}function Ce(e){function t(e,t){return function(a){var d,r,o,l=[],s=-1,i=0,c=e.length;for(a instanceof Date||(a=new Date(+a));++s<c;)37===e.charCodeAt(s)&&(l.push(e.slice(i,s)),null==(r=Hd[d=e.charAt(++s)])?r='e'===d?' ':'0':d=e.charAt(++s),(o=t[d])&&(d=o(a,r)),l.push(d),i=s+1);return l.push(e.slice(i,s)),l.join('')}}function n(e,t){return function(n){var r=Se(1900),d=a(r,e,n+='',0);if(d!=n.length)return null;if('p'in r&&(r.H=r.H%12+12*r.p),'W'in r||'U'in r){'w'in r||(r.w='W'in r?1:0);var i='Z'in r?we(Se(r.y)).getUTCDay():t(Se(r.y)).getDay();r.m=0,r.d='W'in r?(r.w+6)%7+7*r.W-(i+5)%7:r.w+7*r.U-(i+6)%7}return'Z'in r?(r.H+=0|r.Z/100,r.M+=r.Z%100,we(r)):t(r)}}function a(e,t,a,d){for(var r,o,l=0,i=t.length,n=a.length;l<i;){if(d>=n)return-1;if(r=t.charCodeAt(l++),37===r){if(r=t.charAt(l++),o=C[r in Hd?t.charAt(l++):r],!o||0>(d=o(e,a,d)))return-1;}else if(r!=a.charCodeAt(d++))return-1}return d}var r=e.dateTime,o=e.date,l=e.time,i=e.periods,s=e.days,c=e.shortDays,u=e.months,p=e.shortMonths,g=Le(i),f=Ae(i),h=Le(s),b=Ae(s),m=Le(c),y=Ae(c),x=Le(u),k=Ae(u),v=Le(p),w=Ae(p),d={a:function(e){return c[e.getDay()]},A:function(e){return s[e.getDay()]},b:function(e){return p[e.getMonth()]},B:function(e){return u[e.getMonth()]},c:null,d:Ye,e:Ye,H:Be,I:We,j:Ve,L:Ke,m:$e,M:Xe,p:function(e){return i[+(12<=e.getHours())]},S:Je,U:Qe,w:Ze,W:Ge,x:null,X:null,y:et,Y:tt,Z:nt,"%":mt},S={a:function(e){return c[e.getUTCDay()]},A:function(e){return s[e.getUTCDay()]},b:function(e){return p[e.getUTCMonth()]},B:function(e){return u[e.getUTCMonth()]},c:null,d:it,e:it,H:at,I:dt,j:rt,L:ot,m:lt,M:st,p:function(e){return i[+(12<=e.getUTCHours())]},S:ct,U:ut,w:pt,W:gt,x:null,X:null,y:ft,Y:ht,Z:bt,"%":mt},C={a:function(e,t,a){var i=m.exec(t.slice(a));return i?(e.w=y[i[0].toLowerCase()],a+i[0].length):-1},A:function(e,t,a){var i=h.exec(t.slice(a));return i?(e.w=b[i[0].toLowerCase()],a+i[0].length):-1},b:function(e,t,a){var i=v.exec(t.slice(a));return i?(e.m=w[i[0].toLowerCase()],a+i[0].length):-1},B:function(e,t,a){var i=x.exec(t.slice(a));return i?(e.m=k[i[0].toLowerCase()],a+i[0].length):-1},c:function(e,t,n){return a(e,r,t,n)},d:je,e:je,H:qe,I:qe,j:Re,L:He,m:Ne,M:Fe,p:function(e,t,a){var i=g.exec(t.slice(a));return i?(e.p=f[i[0].toLowerCase()],a+i[0].length):-1},S:Pe,U:De,w:Ee,W:Me,x:function(e,t,n){return a(e,o,t,n)},X:function(e,t,n){return a(e,l,t,n)},y:Ue,Y:Oe,Z:Ie,"%":ze};return d.x=t(o,d),d.X=t(l,d),d.c=t(r,d),S.x=t(o,S),S.X=t(l,S),S.c=t(r,S),{format:function(e){var n=t(e+='',d);return n.toString=function(){return e},n},parse:function(e){var t=n(e+='',ve);return t.toString=function(){return e},t},utcFormat:function(e){var n=t(e+='',S);return n.toString=function(){return e},n},utcParse:function(e){var t=n(e,we);return t.toString=function(){return e},t}}}function Te(e,t,n){var i=0>e?'-':'',a=(i?-e:e)+'',d=a.length;return i+(d<n?Array(n-d+1).join(t)+a:a)}function _e(e){return e.replace(Bd,'\\$&')}function Le(e){return new RegExp('^(?:'+e.map(_e).join('|')+')','i')}function Ae(e){for(var t={},a=-1,i=e.length;++a<i;)t[e[a].toLowerCase()]=a;return t}function Ee(e,t,a){var i=zd.exec(t.slice(a,a+1));return i?(e.w=+i[0],a+i[0].length):-1}function De(e,t,a){var i=zd.exec(t.slice(a));return i?(e.U=+i[0],a+i[0].length):-1}function Me(e,t,a){var i=zd.exec(t.slice(a));return i?(e.W=+i[0],a+i[0].length):-1}function Oe(e,t,a){var i=zd.exec(t.slice(a,a+4));return i?(e.y=+i[0],a+i[0].length):-1}function Ue(e,t,a){var i=zd.exec(t.slice(a,a+2));return i?(e.y=+i[0]+(68<+i[0]?1900:2e3),a+i[0].length):-1}function Ie(e,t,a){var i=/^(Z)|([+-]\d\d)(?:\:?(\d\d))?/.exec(t.slice(a,a+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||'00')),a+i[0].length):-1}function Ne(e,t,a){var i=zd.exec(t.slice(a,a+2));return i?(e.m=i[0]-1,a+i[0].length):-1}function je(e,t,a){var i=zd.exec(t.slice(a,a+2));return i?(e.d=+i[0],a+i[0].length):-1}function Re(e,t,a){var i=zd.exec(t.slice(a,a+3));return i?(e.m=0,e.d=+i[0],a+i[0].length):-1}function qe(e,t,a){var i=zd.exec(t.slice(a,a+2));return i?(e.H=+i[0],a+i[0].length):-1}function Fe(e,t,a){var i=zd.exec(t.slice(a,a+2));return i?(e.M=+i[0],a+i[0].length):-1}function Pe(e,t,a){var i=zd.exec(t.slice(a,a+2));return i?(e.S=+i[0],a+i[0].length):-1}function He(e,t,a){var i=zd.exec(t.slice(a,a+3));return i?(e.L=+i[0],a+i[0].length):-1}function ze(e,t,a){var i=Yd.exec(t.slice(a,a+1));return i?a+i[0].length:-1}function Ye(e,t){return Te(e.getDate(),t,2)}function Be(e,t){return Te(e.getHours(),t,2)}function We(e,t){return Te(e.getHours()%12||12,t,2)}function Ve(e,t){return Te(1+bd.count(Td(e),e),t,3)}function Ke(e,t){return Te(e.getMilliseconds(),t,3)}function $e(e,t){return Te(e.getMonth()+1,t,2)}function Xe(e,t){return Te(e.getMinutes(),t,2)}function Je(e,t){return Te(e.getSeconds(),t,2)}function Qe(e,t){return Te(md.count(Td(e),e),t,2)}function Ze(e){return e.getDay()}function Ge(e,t){return Te(yd.count(Td(e),e),t,2)}function et(e,t){return Te(e.getFullYear()%100,t,2)}function tt(e,t){return Te(e.getFullYear()%1e4,t,4)}function nt(e){var t=e.getTimezoneOffset();return(0<t?'-':(t*=-1,'+'))+Te(0|t/60,'0',2)+Te(t%60,'0',2)}function it(e,t){return Te(e.getUTCDate(),t,2)}function at(e,t){return Te(e.getUTCHours(),t,2)}function dt(e,t){return Te(e.getUTCHours()%12||12,t,2)}function rt(e,t){return Te(1+Ad.count(Rd(e),e),t,3)}function ot(e,t){return Te(e.getUTCMilliseconds(),t,3)}function lt(e,t){return Te(e.getUTCMonth()+1,t,2)}function st(e,t){return Te(e.getUTCMinutes(),t,2)}function ct(e,t){return Te(e.getUTCSeconds(),t,2)}function ut(e,t){return Te(Ed.count(Rd(e),e),t,2)}function pt(e){return e.getUTCDay()}function gt(e,t){return Te(Dd.count(Rd(e),e),t,2)}function ft(e,t){return Te(e.getUTCFullYear()%100,t,2)}function ht(e,t){return Te(e.getUTCFullYear()%1e4,t,4)}function bt(){return'+0000'}function mt(){return'%'}function yt(e){var i=e.length;return function(n){return e[Rn(0,Hn(i-1,Fn(n*i)))]}}function xt(){for(var e,t=0,i=arguments.length,n={};t<i;++t){if(!(e=arguments[t]+'')||e in n)throw new Error('illegal type: '+e);n[e]=[]}return new kt(n)}function kt(e){this._=e}function vt(e,n){return e.trim().split(/^|\s+/).map(function(e){var a='',d=e.indexOf('.');if(0<=d&&(a=e.slice(d+1),e=e.slice(0,d)),e&&!n.hasOwnProperty(e))throw new Error('unknown type: '+e);return{type:e,name:a}})}function wt(e,t){for(var a,d=0,i=e.length;d<i;++d)if((a=e[d]).name===t)return a.value}function St(e,t,a){for(var d=0,i=e.length;d<i;++d)if(e[d].name===t){e[d]=tr,e=e.slice(0,d).concat(e.slice(d+1));break}return null!=a&&e.push({name:t,value:a}),e}function Ct(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===nr&&t.documentElement.namespaceURI===nr?t.createElement(e):t.createElementNS(n,e)}}function Tt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _t(e,t,n){return e=Lt(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function Lt(e,t,n){return function(i){var a=ur;ur=i;try{e.call(this,this.__data__,t,n)}finally{ur=a}}}function At(e){return e.trim().split(/^|\s+/).map(function(e){var n='',a=e.indexOf('.');return 0<=a&&(n=e.slice(a+1),e=e.slice(0,a)),{type:e,name:n}})}function Et(e){return function(){var t=this.__on;if(t){for(var n,a=0,d=-1,i=t.length;a<i;++a)(n=t[a],(!e.type||n.type===e.type)&&n.name===e.name)?this.removeEventListener(n.type,n.listener,n.capture):t[++d]=n;++d?t.length=d:delete this.__on}}}function Dt(e,t,n){var a=cr.hasOwnProperty(e.type)?_t:Lt;return function(r,d,i){var l,o=this.__on,s=a(t,d,i);if(o)for(var c=0,u=o.length;c<u;++c)if((l=o[c]).type===e.type&&l.name===e.name)return this.removeEventListener(l.type,l.listener,l.capture),this.addEventListener(l.type,l.listener=s,l.capture=n),void(l.value=t);this.addEventListener(e.type,s,n),l={type:e.type,name:e.name,value:t,listener:s,capture:n},o?o.push(l):this.__on=[l]}}function Mt(e,t,n,i){var a=ur;e.sourceEvent=ur,ur=e;try{return t.apply(n,i)}finally{ur=a}}function Ot(){}function Ut(){return[]}function It(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function Nt(e,t,n,a,d,r){for(var o,l=0,i=t.length,s=r.length;l<s;++l)(o=t[l])?(o.__data__=r[l],a[l]=o):n[l]=new It(e,r[l]);for(;l<i;++l)(o=t[l])&&(d[l]=o)}function jt(e,t,n,a,d,r,o){var l,i,s,c={},u=t.length,p=r.length,g=Array(u);for(l=0;l<u;++l)(i=t[l])&&(g[l]=s=kr+o.call(i,i.__data__,l,t),s in c?d[l]=i:c[s]=i);for(l=0;l<p;++l)s=kr+o.call(e,r[l],l,r),(i=c[s])?(a[l]=i,i.__data__=r[l],c[s]=null):n[l]=new It(e,r[l]);for(l=0;l<u;++l)(i=t[l])&&c[g[l]]===i&&(d[l]=i)}function Rt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function qt(e){return function(){this.removeAttribute(e)}}function Ft(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Pt(e,t){return function(){this.setAttribute(e,t)}}function Ht(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function zt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Yt(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Bt(e){return function(){this.style.removeProperty(e)}}function Wt(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Vt(e,t,n){return function(){var i=t.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,n)}}function Kt(e,t){return e.style.getPropertyValue(t)||vr(e).getComputedStyle(e,null).getPropertyValue(t)}function $t(e){return function(){delete this[e]}}function Xt(e,t){return function(){this[e]=t}}function Jt(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Qt(e){return e.trim().split(/^|\s+/)}function Zt(e){return e.classList||new Gt(e)}function Gt(e){this._node=e,this._names=Qt(e.getAttribute('class')||'')}function en(e,t){for(var a=Zt(e),d=-1,i=t.length;++d<i;)a.add(t[d])}function tn(e,t){for(var a=Zt(e),d=-1,i=t.length;++d<i;)a.remove(t[d])}function nn(e){return function(){en(this,e)}}function an(e){return function(){tn(this,e)}}function dn(e,t){return function(){(t.apply(this,arguments)?en:tn)(this,e)}}function rn(){this.textContent=''}function on(e){return function(){this.textContent=e}}function ln(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?'':t}}function sn(){this.innerHTML=''}function cn(e){return function(){this.innerHTML=e}}function un(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?'':t}}function pn(){this.nextSibling&&this.parentNode.appendChild(this)}function gn(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function fn(){return null}function hn(){var e=this.parentNode;e&&e.removeChild(this)}function bn(e,t,n){var i=vr(e),a=i.CustomEvent;'function'==typeof a?a=new a(t,n):(a=i.document.createEvent('Event'),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function mn(e,t){return function(){return bn(this,e,t)}}function yn(e,t){return function(){return bn(this,e,t.apply(this,arguments))}}function xn(e,t){this._groups=e,this._parents=t}function kn(){ur.stopImmediatePropagation()}function vn(e,t){var n=e.document.documentElement,i=Sr(e).on('dragstart.drag',null);t&&(i.on('click.drag',Tr,!0),setTimeout(function(){i.on('click.drag',null)},0)),'onselectstart'in n?i.on('selectstart.drag',null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function wn(e,t,n,i,a,d,r,o,l,s){this.target=e,this.type=t,this.subject=n,this.identifier=i,this.active=a,this.x=d,this.y=r,this.dx=o,this.dy=l,this._=s}function Sn(){return!ur.button}function Cn(){return this.parentNode}function Tn(e){return null==e?{x:ur.x,y:ur.y}:e}function _n(){return'ontouchstart'in this}function Ln(e){let t=Nr;'undefined'!=typeof e.githubUrl&&(t+=`
    <h3 id="updates-and-corrections">Updates and Corrections</h3>
    <p>`,e.githubCompareUpdatesUrl&&(t+=`<a href="${e.githubCompareUpdatesUrl}">View all changes</a> to this article since it was first published.`),t+=`
    If you see mistakes or want to suggest changes, please <a href="${e.githubUrl+'/issues/new'}">create an issue on GitHub</a>. </p>
    `);const n=e.journal;return'undefined'!=typeof n&&'Distill'===n.title&&(t+=`
    <h3 id="reuse">Reuse</h3>
    <p>Diagrams and text are licensed under Creative Commons Attribution <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> with the <a class="github" href="${e.githubUrl}">source available on GitHub</a>, unless noted otherwise. The figures that have been reused from other sources dont fall under this license and can be recognized by a note in their caption: Figure from .</p>
    `),'undefined'!=typeof e.publishedDate&&(t+=`
    <h3 id="citation">Citation</h3>
    <p>For attribution in academic contexts, please cite this work as</p>
    <pre class="citation short">${e.concatenatedAuthors}, "${e.title}", Distill, ${e.publishedYear}.</pre>
    <p>BibTeX citation</p>
    <pre class="citation long">${m(e)}</pre>
    `),t}var An=Math.sqrt,En=Math.atan2,Dn=Math.sin,Mn=Math.cos,On=Math.PI,Un=Math.abs,In=Math.pow,Nn=Math.LN10,jn=Math.log,Rn=Math.max,qn=Math.ceil,Fn=Math.floor,Pn=Math.round,Hn=Math.min;const zn=['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],Bn=['Jan.','Feb.','March','April','May','June','July','Aug.','Sept.','Oct.','Nov.','Dec.'],Wn=(e)=>10>e?'0'+e:e,Vn=function(e){const t=zn[e.getDay()].substring(0,3),n=Wn(e.getDate()),i=Bn[e.getMonth()].substring(0,3),a=e.getFullYear().toString(),d=e.getUTCHours().toString(),r=e.getUTCMinutes().toString(),o=e.getUTCSeconds().toString();return`${t}, ${n} ${i} ${a} ${d}:${r}:${o} Z`},$n=function(e){const t=Array.from(e).reduce((e,[t,n])=>Object.assign(e,{[t]:n}),{});return t},Jn=function(e){const t=new Map;for(var n in e)e.hasOwnProperty(n)&&t.set(n,e[n]);return t};class Qn{constructor(e){this.name=e.author,this.personalURL=e.authorURL,this.affiliation=e.affiliation,this.affiliationURL=e.affiliationURL,this.affiliations=e.affiliations||[]}get firstName(){const e=this.name.split(' ');return e.slice(0,e.length-1).join(' ')}get lastName(){const e=this.name.split(' ');return e[e.length-1]}}class Gn{constructor(){this.title='unnamed article',this.description='',this.authors=[],this.bibliography=new Map,this.bibliographyParsed=!1,this.citations=[],this.citationsCollected=!1,this.journal={},this.katex={},this.publishedDate=void 0}set url(e){this._url=e}get url(){if(this._url)return this._url;return this.distillPath&&this.journal.url?this.journal.url+'/'+this.distillPath:this.journal.url?this.journal.url:void 0}get githubUrl(){return this.githubPath?'https://github.com/'+this.githubPath:void 0}set previewURL(e){this._previewURL=e}get previewURL(){return this._previewURL?this._previewURL:this.url+'/thumbnail.jpg'}get publishedDateRFC(){return Vn(this.publishedDate)}get updatedDateRFC(){return Vn(this.updatedDate)}get publishedYear(){return this.publishedDate.getFullYear()}get publishedMonth(){return Bn[this.publishedDate.getMonth()]}get publishedDay(){return this.publishedDate.getDate()}get publishedMonthPadded(){return Wn(this.publishedDate.getMonth()+1)}get publishedDayPadded(){return Wn(this.publishedDate.getDate())}get publishedISODateOnly(){return this.publishedDate.toISOString().split('T')[0]}get volume(){const e=this.publishedYear-2015;if(1>e)throw new Error('Invalid publish date detected during computing volume');return e}get issue(){return this.publishedDate.getMonth()+1}get concatenatedAuthors(){if(2<this.authors.length)return this.authors[0].lastName+', et al.';return 2===this.authors.length?this.authors[0].lastName+' & '+this.authors[1].lastName:1===this.authors.length?this.authors[0].lastName:void 0}get bibtexAuthors(){return this.authors.map((e)=>{return e.lastName+', '+e.firstName}).join(' and ')}get slug(){let e='';return this.authors.length&&(e+=this.authors[0].lastName.toLowerCase(),e+=this.publishedYear,e+=this.title.split(' ')[0].toLowerCase()),e||'Untitled'}get bibliographyEntries(){return new Map(this.citations.map((e)=>{const t=this.bibliography.get(e);return[e,t]}))}set bibliography(e){e instanceof Map?this._bibliography=e:'object'==typeof e&&(this._bibliography=Jn(e))}get bibliography(){return this._bibliography}static fromObject(e){const t=new Gn;return Object.assign(t,e),t}assignToObject(e){Object.assign(e,this),e.bibliography=$n(this.bibliographyEntries),e.url=this.url,e.githubUrl=this.githubUrl,e.previewURL=this.previewURL,this.publishedDate&&(e.volume=this.volume,e.issue=this.issue,e.publishedDateRFC=this.publishedDateRFC,e.publishedYear=this.publishedYear,e.publishedMonth=this.publishedMonth,e.publishedDay=this.publishedDay,e.publishedMonthPadded=this.publishedMonthPadded,e.publishedDayPadded=this.publishedDayPadded),this.updatedDate&&(e.updatedDateRFC=this.updatedDateRFC),e.concatenatedAuthors=this.concatenatedAuthors,e.bibtexAuthors=this.bibtexAuthors,e.slug=this.slug}}const ei=(e)=>{return class extends e{constructor(){super();const e={childList:!0,characterData:!0,subtree:!0},t=new MutationObserver(()=>{t.disconnect(),this.renderIfPossible(),t.observe(this,e)});t.observe(this,e)}connectedCallback(){super.connectedCallback(),this.renderIfPossible()}renderIfPossible(){this.textContent&&this.root&&this.renderContent()}renderContent(){console.error(`Your class ${this.constructor.name} must provide a custom renderContent() method!`)}}},ti=(e,t,n=!0)=>{return(i)=>{const a=document.createElement('template');return a.innerHTML=t,n&&'ShadyCSS'in window&&ShadyCSS.prepareTemplate(a,e),class extends i{static get is(){return e}constructor(){super(),this.clone=document.importNode(a.content,!0),n&&(this.attachShadow({mode:'open'}),this.shadowRoot.appendChild(this.clone))}connectedCallback(){n?'ShadyCSS'in window&&ShadyCSS.styleElement(this):this.insertBefore(this.clone,this.firstChild)}get root(){return n?this.shadowRoot:this}$(e){return this.root.querySelector(e)}$$(e){return this.root.querySelectorAll(e)}}}};var ni='/*\n * Copyright 2018 The Distill Template Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nspan.katex-display {\n  text-align: left;\n  padding: 8px 0 8px 0;\n  margin: 0.5em 0 0.5em 1em;\n}\n\nspan.katex {\n  -webkit-font-smoothing: antialiased;\n  color: rgba(0, 0, 0, 0.8);\n  font-size: 1.18em;\n}\n';const ii=function(e,t,n){let i=n,a=0;for(const d=e.length;i<t.length;){const n=t[i];if(0>=a&&t.slice(i,i+d)===e)return i;'\\'===n?i++:'{'===n?a++:'}'===n&&a--;i++}return-1},ai=function(e,t,n,i){const a=[];for(let d=0;d<e.length;d++)if('text'===e[d].type){const r=e[d].data;let o,l=!0,s=0;for(o=r.indexOf(t),-1!==o&&(s=o,a.push({type:'text',data:r.slice(0,s)}),l=!1);;){if(l){if(o=r.indexOf(t,s),-1===o)break;a.push({type:'text',data:r.slice(s,o)}),s=o}else{if(o=ii(n,r,s+t.length),-1===o)break;a.push({type:'math',data:r.slice(s+t.length,o),rawData:r.slice(s,o+n.length),display:i}),s=o+n.length}l=!l}a.push({type:'text',data:r.slice(s)})}else a.push(e[d]);return a},di=function(e,t){let n=[{type:'text',data:e}];for(let a=0;a<t.length;a++){const e=t[a];n=ai(n,e.left,e.right,e.display||!1)}return n},ri=function(e,t){const n=di(e,t.delimiters),a=document.createDocumentFragment();for(let d=0;d<n.length;d++)if('text'===n[d].type)a.appendChild(document.createTextNode(n[d].data));else{const e=document.createElement('d-math'),i=n[d].data;t.displayMode=n[d].display;try{e.textContent=i,t.displayMode&&e.setAttribute('block','')}catch(i){if(!(i instanceof katex.ParseError))throw i;t.errorCallback('KaTeX auto-render: Failed to parse `'+n[d].data+'` with ',i),a.appendChild(document.createTextNode(n[d].rawData));continue}a.appendChild(e)}return a},oi=function(e,t){for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(3===i.nodeType){const a=ri(i.textContent,t);n+=a.childNodes.length-1,e.replaceChild(a,i)}else if(1===i.nodeType){const e=-1===t.ignoredTags.indexOf(i.nodeName.toLowerCase());e&&oi(i,t)}}},li={delimiters:[{left:'$$',right:'$$',display:!0},{left:'\\[',right:'\\]',display:!0},{left:'\\(',right:'\\)',display:!1}],ignoredTags:['script','noscript','style','textarea','pre','code','svg'],errorCallback:function(e,t){console.error(e,t)}},si=function(e,t){if(!e)throw new Error('No element provided to render');const n=Object.assign({},li,t);oi(e,n)},ci='<link rel="stylesheet" href="https://distill.pub/third-party/katex/katex.min.css" crossorigin="anonymous">',ui=ti('d-math',`
${ci}
<style>

:host {
  display: inline-block;
  contain: content;
}

:host([block]) {
  display: block;
}

${ni}
</style>
<span id='katex-container'></span>
`);class T extends ei(ui(HTMLElement)){static set katexOptions(e){T._katexOptions=e,T.katexOptions.delimiters&&(T.katexAdded?T.katexLoadedCallback():T.addKatex())}static get katexOptions(){return T._katexOptions||(T._katexOptions={delimiters:[{left:'$$',right:'$$',display:!1}]}),T._katexOptions}static katexLoadedCallback(){const e=document.querySelectorAll('d-math');for(const t of e)t.renderContent();if(T.katexOptions.delimiters){const e=document.querySelector('d-article');si(e,T.katexOptions)}}static addKatex(){document.head.insertAdjacentHTML('beforeend',ci);const e=document.createElement('script');e.src='https://distill.pub/third-party/katex/katex.min.js',e.async=!0,e.onload=T.katexLoadedCallback,e.crossorigin='anonymous',document.head.appendChild(e),T.katexAdded=!0}get options(){const e={displayMode:this.hasAttribute('block')};return Object.assign(e,T.katexOptions)}connectedCallback(){super.connectedCallback(),T.katexAdded||T.addKatex()}renderContent(){if('undefined'!=typeof katex){const e=this.root.querySelector('#katex-container');katex.render(this.textContent,e,this.options)}}}T.katexAdded=!1,T.inlineMathRendered=!1,window.DMath=T;class pi extends HTMLElement{static get is(){return'd-front-matter'}constructor(){super();const e=new MutationObserver((e)=>{for(const t of e)if('SCRIPT'===t.target.nodeName||'characterData'===t.type){const e=c(this);this.notify(e)}});e.observe(this,{childList:!0,characterData:!0,subtree:!0})}notify(e){const t=new CustomEvent('onFrontMatterChanged',{detail:e,bubbles:!0});document.dispatchEvent(t)}}var gi=function(e,t){const n=e.body,i=n.querySelector('d-article');if(!i)return void console.warn('No d-article tag found; skipping adding optional components!');let a=e.querySelector('d-byline');a||(t.authors?(a=e.createElement('d-byline'),n.insertBefore(a,i)):console.warn('No authors found in front matter; please add them before submission!'));let d=e.querySelector('d-title');d||(d=e.createElement('d-title'),n.insertBefore(d,a));let r=d.querySelector('h1');r||(r=e.createElement('h1'),r.textContent=t.title,d.insertBefore(r,d.firstChild));const o='undefined'!=typeof t.password;let l=n.querySelector('d-interstitial');if(o&&!l){const i='undefined'!=typeof window,a=i&&window.location.hostname.includes('localhost');i&&a||(l=e.createElement('d-interstitial'),l.password=t.password,n.insertBefore(l,n.firstChild))}else!o&&l&&l.parentElement.removeChild(this);let s=e.querySelector('d-appendix');s||(s=e.createElement('d-appendix'),e.body.appendChild(s));let c=e.querySelector('d-footnote-list');c||(c=e.createElement('d-footnote-list'),s.appendChild(c));let u=e.querySelector('d-citation-list');u||(u=e.createElement('d-citation-list'),s.appendChild(u))};const fi=new Gn,hi={frontMatter:fi,waitingOn:{bibliography:[],citations:[]},listeners:{onCiteKeyCreated(e){const[t,n]=e.detail;if(!fi.citationsCollected)return void hi.waitingOn.citations.push(()=>hi.listeners.onCiteKeyCreated(e));if(!fi.bibliographyParsed)return void hi.waitingOn.bibliography.push(()=>hi.listeners.onCiteKeyCreated(e));const i=n.map((e)=>fi.citations.indexOf(e));t.numbers=i;const a=n.map((e)=>fi.bibliography.get(e));t.entries=a},onCiteKeyChanged(){fi.citations=t(),fi.citationsCollected=!0;for(const e of hi.waitingOn.citations.slice())e();const e=document.querySelector('d-citation-list'),n=new Map(fi.citations.map((e)=>{return[e,fi.bibliography.get(e)]}));e.citations=n;const i=document.querySelectorAll('d-cite');for(const e of i){const t=e.keys,n=t.map((e)=>fi.citations.indexOf(e));e.numbers=n;const i=t.map((e)=>fi.bibliography.get(e));e.entries=i}},onCiteKeyRemoved(e){hi.listeners.onCiteKeyChanged(e)},onBibliographyChanged(e){const t=document.querySelector('d-citation-list'),n=e.detail;fi.bibliography=n,fi.bibliographyParsed=!0;for(const t of hi.waitingOn.bibliography.slice())t();if(!fi.citationsCollected)return void hi.waitingOn.citations.push(function(){hi.listeners.onBibliographyChanged({target:e.target,detail:e.detail})});if(t.hasAttribute('distill-prerendered'))console.info('Citation list was prerendered; not updating it.');else{const e=new Map(fi.citations.map((e)=>{return[e,fi.bibliography.get(e)]}));t.citations=e}},onFootnoteChanged(){const e=document.querySelector('d-footnote-list');if(e){const t=document.querySelectorAll('d-footnote');e.footnotes=t}},onFrontMatterChanged(t){const n=t.detail;e(fi,n);const i=document.querySelector('d-interstitial');i&&('undefined'==typeof fi.password?i.parentElement.removeChild(i):i.password=fi.password);const a=document.body.hasAttribute('distill-prerendered');if(!a&&u()){gi(document,fi);const e=document.querySelector('distill-appendix');e&&(e.frontMatter=fi);const t=document.querySelector('d-byline');t&&(t.frontMatter=fi),n.katex&&(T.katexOptions=n.katex)}},DOMContentLoaded(){if(hi.loaded)return void console.warn('Controller received DOMContentLoaded but was already loaded!');if(!u())return void console.warn('Controller received DOMContentLoaded before appropriate document.readyState!');hi.loaded=!0,console.log('Runlevel 4: Controller running DOMContentLoaded');const e=document.querySelector('d-front-matter'),n=c(e);hi.listeners.onFrontMatterChanged({detail:n}),fi.citations=t(),fi.citationsCollected=!0;for(const e of hi.waitingOn.citations.slice())e();if(fi.bibliographyParsed)for(const e of hi.waitingOn.bibliography.slice())e();const i=document.querySelector('d-footnote-list');if(i){const e=document.querySelectorAll('d-footnote');i.footnotes=e}}}};const bi='/*\n * Copyright 2018 The Distill Template Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nhtml {\n  font-size: 14px;\n\tline-height: 1.6em;\n  /* font-family: "Libre Franklin", "Helvetica Neue", sans-serif; */\n  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;\n  /*, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";*/\n  text-size-adjust: 100%;\n  -ms-text-size-adjust: 100%;\n  -webkit-text-size-adjust: 100%;\n}\n\n@media(min-width: 768px) {\n  html {\n    font-size: 16px;\n  }\n}\n\nbody {\n  margin: 0;\n}\n\na {\n  color: #004276;\n}\n\nfigure {\n  margin: 0;\n}\n\ntable {\n\tborder-collapse: collapse;\n\tborder-spacing: 0;\n}\n\ntable th {\n\ttext-align: left;\n}\n\ntable thead {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n}\n\ntable thead th {\n  padding-bottom: 0.5em;\n}\n\ntable tbody :first-child td {\n  padding-top: 0.5em;\n}\n\npre {\n  overflow: auto;\n  max-width: 100%;\n}\n\np {\n  margin-top: 0;\n  margin-bottom: 1em;\n}\n\nsup, sub {\n  vertical-align: baseline;\n  position: relative;\n  top: -0.4em;\n  line-height: 1em;\n}\n\nsub {\n  top: 0.4em;\n}\n\n.kicker,\n.marker {\n  font-size: 15px;\n  font-weight: 600;\n  color: rgba(0, 0, 0, 0.5);\n}\n\n\n/* Headline */\n\n@media(min-width: 1024px) {\n  d-title h1 span {\n    display: block;\n  }\n}\n\n/* Figure */\n\nfigure {\n  position: relative;\n  margin-bottom: 2.5em;\n  margin-top: 1.5em;\n}\n\nfigcaption+figure {\n\n}\n\nfigure img {\n  width: 100%;\n}\n\nfigure svg text,\nfigure svg tspan {\n}\n\nfigcaption,\n.figcaption {\n  color: rgba(0, 0, 0, 0.6);\n  font-size: 12px;\n  line-height: 1.5em;\n}\n\n@media(min-width: 1024px) {\nfigcaption,\n.figcaption {\n    font-size: 13px;\n  }\n}\n\nfigure.external img {\n  background: white;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);\n  padding: 18px;\n  box-sizing: border-box;\n}\n\nfigcaption a {\n  color: rgba(0, 0, 0, 0.6);\n}\n\nfigcaption b,\nfigcaption strong, {\n  font-weight: 600;\n  color: rgba(0, 0, 0, 1.0);\n}\n'+'/*\n * Copyright 2018 The Distill Template Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n@supports not (display: grid) {\n  .base-grid,\n  distill-header,\n  d-title,\n  d-abstract,\n  d-article,\n  d-appendix,\n  distill-appendix,\n  d-byline,\n  d-footnote-list,\n  d-citation-list,\n  distill-footer {\n    display: block;\n    padding: 8px;\n  }\n}\n\n.base-grid,\ndistill-header,\nd-title,\nd-abstract,\nd-article,\nd-appendix,\ndistill-appendix,\nd-byline,\nd-footnote-list,\nd-citation-list,\ndistill-footer {\n  display: grid;\n  justify-items: stretch;\n  grid-template-columns: [screen-start] 8px [page-start kicker-start text-start gutter-start middle-start] 1fr 1fr 1fr 1fr 1fr 1fr 1fr 1fr [text-end page-end gutter-end kicker-end middle-end] 8px [screen-end];\n  grid-column-gap: 8px;\n}\n\n.grid {\n  display: grid;\n  grid-column-gap: 8px;\n}\n\n@media(min-width: 768px) {\n  .base-grid,\n  distill-header,\n  d-title,\n  d-abstract,\n  d-article,\n  d-appendix,\n  distill-appendix,\n  d-byline,\n  d-footnote-list,\n  d-citation-list,\n  distill-footer {\n    grid-template-columns: [screen-start] 1fr [page-start kicker-start middle-start text-start] 45px 45px 45px 45px 45px 45px 45px 45px [ kicker-end text-end gutter-start] 45px [middle-end] 45px [page-end gutter-end] 1fr [screen-end];\n    grid-column-gap: 16px;\n  }\n\n  .grid {\n    grid-column-gap: 16px;\n  }\n}\n\n@media(min-width: 1000px) {\n  .base-grid,\n  distill-header,\n  d-title,\n  d-abstract,\n  d-article,\n  d-appendix,\n  distill-appendix,\n  d-byline,\n  d-footnote-list,\n  d-citation-list,\n  distill-footer {\n    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 50px [middle-start] 50px [text-start kicker-end] 50px 50px 50px 50px 50px 50px 50px 50px [text-end gutter-start] 50px [middle-end] 50px [page-end gutter-end] 1fr [screen-end];\n    grid-column-gap: 16px;\n  }\n\n  .grid {\n    grid-column-gap: 16px;\n  }\n}\n\n@media(min-width: 1180px) {\n  .base-grid,\n  distill-header,\n  d-title,\n  d-abstract,\n  d-article,\n  d-appendix,\n  distill-appendix,\n  d-byline,\n  d-footnote-list,\n  d-citation-list,\n  distill-footer {\n    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];\n    grid-column-gap: 32px;\n  }\n\n  .grid {\n    grid-column-gap: 32px;\n  }\n}\n\n\n\n\n.base-grid {\n  grid-column: screen;\n}\n\n/* .l-body,\nd-article > *  {\n  grid-column: text;\n}\n\n.l-page,\nd-title > *,\nd-figure {\n  grid-column: page;\n} */\n\n.l-gutter {\n  grid-column: gutter;\n}\n\n.l-text,\n.l-body {\n  grid-column: text;\n}\n\n.l-page {\n  grid-column: page;\n}\n\n.l-body-outset {\n  grid-column: middle;\n}\n\n.l-page-outset {\n  grid-column: page;\n}\n\n.l-screen {\n  grid-column: screen;\n}\n\n.l-screen-inset {\n  grid-column: screen;\n  padding-left: 16px;\n  padding-left: 16px;\n}\n\n\n/* Aside */\n\nd-article aside {\n  grid-column: gutter;\n  font-size: 12px;\n  line-height: 1.6em;\n  color: rgba(0, 0, 0, 0.6)\n}\n\n@media(min-width: 768px) {\n  aside {\n    grid-column: gutter;\n  }\n\n  .side {\n    grid-column: gutter;\n  }\n}\n'+'/*\n * Copyright 2018 The Distill Template Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nd-title {\n  padding: 2rem 0 1.5rem;\n  contain: layout style;\n  overflow-x: hidden;\n}\n\n@media(min-width: 768px) {\n  d-title {\n    padding: 4rem 0 1.5rem;\n  }\n}\n\nd-title h1 {\n  grid-column: text;\n  font-size: 40px;\n  font-weight: 700;\n  line-height: 1.1em;\n  margin: 0 0 0.5rem;\n}\n\n@media(min-width: 768px) {\n  d-title h1 {\n    font-size: 50px;\n  }\n}\n\nd-title p {\n  font-weight: 300;\n  font-size: 1.2rem;\n  line-height: 1.55em;\n  grid-column: text;\n}\n\nd-title .status {\n  margin-top: 0px;\n  font-size: 12px;\n  color: #009688;\n  opacity: 0.8;\n  grid-column: kicker;\n}\n\nd-title .status span {\n  line-height: 1;\n  display: inline-block;\n  padding: 6px 0;\n  border-bottom: 1px solid #80cbc4;\n  font-size: 11px;\n  text-transform: uppercase;\n}\n'+'/*\n * Copyright 2018 The Distill Template Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nd-byline {\n  contain: content;\n  overflow: hidden;\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\n  font-size: 0.8rem;\n  line-height: 1.8em;\n  padding: 1.5rem 0;\n  min-height: 1.8em;\n}\n\n\nd-byline .byline {\n  grid-template-columns: 1fr 1fr;\n  grid-column: text;\n}\n\n@media(min-width: 768px) {\n  d-byline .byline {\n    grid-template-columns: 1fr 1fr 1fr 1fr;\n  }\n}\n\nd-byline .authors-affiliations {\n  grid-column-end: span 2;\n  grid-template-columns: 1fr 1fr;\n  margin-bottom: 1em;\n}\n\n@media(min-width: 768px) {\n  d-byline .authors-affiliations {\n    margin-bottom: 0;\n  }\n}\n\nd-byline h3 {\n  font-size: 0.6rem;\n  font-weight: 400;\n  color: rgba(0, 0, 0, 0.5);\n  margin: 0;\n  text-transform: uppercase;\n}\n\nd-byline p {\n  margin: 0;\n}\n\nd-byline a,\nd-article d-byline a {\n  color: rgba(0, 0, 0, 0.8);\n  text-decoration: none;\n  border-bottom: none;\n}\n\nd-article d-byline a:hover {\n  text-decoration: underline;\n  border-bottom: none;\n}\n\nd-byline p.author {\n  font-weight: 500;\n}\n\nd-byline .affiliations {\n\n}\n'+'/*\n * Copyright 2018 The Distill Template Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nd-article {\n  contain: layout style;\n  overflow-x: hidden;\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\n  padding-top: 2rem;\n  color: rgba(0, 0, 0, 0.8);\n}\n\nd-article > * {\n  grid-column: text;\n}\n\n@media(min-width: 768px) {\n  d-article {\n    font-size: 16px;\n  }\n}\n\n@media(min-width: 1024px) {\n  d-article {\n    font-size: 1.06rem;\n    line-height: 1.7em;\n  }\n}\n\n\n/* H2 */\n\n\nd-article .marker {\n  text-decoration: none;\n  border: none;\n  counter-reset: section;\n  grid-column: kicker;\n  line-height: 1.7em;\n}\n\nd-article .marker:hover {\n  border: none;\n}\n\nd-article .marker span {\n  padding: 0 3px 4px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  position: relative;\n  top: 4px;\n}\n\nd-article .marker:hover span {\n  color: rgba(0, 0, 0, 0.7);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.7);\n}\n\nd-article h2 {\n  font-weight: 600;\n  font-size: 24px;\n  line-height: 1.25em;\n  margin: 2rem 0 1.5rem 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  padding-bottom: 1rem;\n}\n\n@media(min-width: 1024px) {\n  d-article h2 {\n    font-size: 36px;\n  }\n}\n\n/* H3 */\n\nd-article h3 {\n  font-weight: 700;\n  font-size: 18px;\n  line-height: 1.4em;\n  margin-bottom: 1em;\n  margin-top: 2em;\n}\n\n@media(min-width: 1024px) {\n  d-article h3 {\n    font-size: 20px;\n  }\n}\n\n/* H4 */\n\nd-article h4 {\n  font-weight: 600;\n  text-transform: uppercase;\n  font-size: 14px;\n  line-height: 1.4em;\n}\n\nd-article a {\n  color: inherit;\n}\n\nd-article p,\nd-article ul,\nd-article ol,\nd-article blockquote {\n  margin-top: 0;\n  margin-bottom: 1em;\n  margin-left: 0;\n  margin-right: 0;\n}\n\nd-article blockquote {\n  border-left: 2px solid rgba(0, 0, 0, 0.2);\n  padding-left: 2em;\n  font-style: italic;\n  color: rgba(0, 0, 0, 0.6);\n}\n\nd-article a {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.4);\n  text-decoration: none;\n}\n\nd-article a:hover {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.8);\n}\n\nd-article .link {\n  text-decoration: underline;\n  cursor: pointer;\n}\n\nd-article ul,\nd-article ol {\n  padding-left: 24px;\n}\n\nd-article li {\n  margin-bottom: 1em;\n  margin-left: 0;\n  padding-left: 0;\n}\n\nd-article li:last-child {\n  margin-bottom: 0;\n}\n\nd-article pre {\n  font-size: 14px;\n  margin-bottom: 20px;\n}\n\nd-article hr {\n  grid-column: screen;\n  width: 100%;\n  border: none;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.1);\n  margin-top: 60px;\n  margin-bottom: 60px;\n}\n\nd-article section {\n  margin-top: 60px;\n  margin-bottom: 60px;\n}\n\nd-article span.equation-mimic {\n  font-family: georgia;\n  font-size: 115%;\n  font-style: italic;\n}\n\nd-article > d-code,\nd-article section > d-code  {\n  display: block;\n}\n\nd-article > d-math[block],\nd-article section > d-math[block]  {\n  display: block;\n}\n\n@media (max-width: 768px) {\n  d-article > d-code,\n  d-article section > d-code,\n  d-article > d-math[block],\n  d-article section > d-math[block] {\n      overflow-x: scroll;\n      -ms-overflow-style: none;  // IE 10+\n      overflow: -moz-scrollbars-none;  // Firefox\n  }\n\n  d-article > d-code::-webkit-scrollbar,\n  d-article section > d-code::-webkit-scrollbar,\n  d-article > d-math[block]::-webkit-scrollbar,\n  d-article section > d-math[block]::-webkit-scrollbar {\n    display: none;  // Safari and Chrome\n  }\n}\n\nd-article .citation {\n  color: #668;\n  cursor: pointer;\n}\n\nd-include {\n  width: auto;\n  display: block;\n}\n\nd-figure {\n  contain: layout style;\n}\n\n/* KaTeX */\n\n.katex, .katex-prerendered {\n  contain: style;\n  display: inline-block;\n}\n\n/* Tables */\n\nd-article table {\n  border-collapse: collapse;\n  margin-bottom: 1.5rem;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n}\n\nd-article table th {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n}\n\nd-article table td {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n}\n\nd-article table tr:last-of-type td {\n  border-bottom: none;\n}\n\nd-article table th,\nd-article table td {\n  font-size: 15px;\n  padding: 2px 8px;\n}\n\nd-article table tbody :first-child td {\n  padding-top: 2px;\n}\n'+ni+'/*\n * Copyright 2018 The Distill Template Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n@media print {\n\n  @page {\n    size: 8in 11in;\n    @bottom-right {\n      content: counter(page) " of " counter(pages);\n    }\n  }\n\n  html {\n    /* no general margins -- CSS Grid takes care of those */\n  }\n\n  p, code {\n    page-break-inside: avoid;\n  }\n\n  h2, h3 {\n    page-break-after: avoid;\n  }\n\n  d-header {\n    visibility: hidden;\n  }\n\n  d-footer {\n    display: none!important;\n  }\n\n}\n',mi=[{name:'WebComponents',support:function(){return'customElements'in window&&'attachShadow'in Element.prototype&&'getRootNode'in Element.prototype&&'content'in document.createElement('template')&&'Promise'in window&&'from'in Array},url:'https://distill.pub/third-party/polyfills/webcomponents-lite.js'},{name:'IntersectionObserver',support:function(){return'IntersectionObserver'in window&&'IntersectionObserverEntry'in window},url:'https://distill.pub/third-party/polyfills/intersection-observer.js'}];class yi{static browserSupportsAllFeatures(){return mi.every((e)=>e.support())}static load(e){const t=function(t){t.loaded=!0,console.info('Runlevel 0: Polyfill has finished loading: '+t.name),yi.neededPolyfills.every((e)=>e.loaded)&&(console.info('Runlevel 0: All required polyfills have finished loading.'),console.info('Runlevel 0->1.'),window.distillRunlevel=1,e())};for(const n of yi.neededPolyfills)g(n,t)}static get neededPolyfills(){return yi._neededPolyfills||(yi._neededPolyfills=mi.filter((e)=>!e.support())),yi._neededPolyfills}}const xi=ti('d-abstract',`
<style>
  :host {
    font-size: 1.25rem;
    line-height: 1.6em;
    color: rgba(0, 0, 0, 0.7);
    -webkit-font-smoothing: antialiased;
  }

  ::slotted(p) {
    margin-top: 0;
    margin-bottom: 1em;
    grid-column: text-start / middle-end;
  }
  ${function(e){return`${e} {
      grid-column: left / text;
    }
  `}('d-abstract')}
</style>

<slot></slot>
`);class ki extends xi(HTMLElement){}const vi=ti('d-appendix',`
<style>

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

</style>

`,!1);class wi extends vi(HTMLElement){}const Si=/^\s*$/;class Ci extends HTMLElement{static get is(){return'd-article'}constructor(){super(),new MutationObserver((e)=>{for(const t of e)for(const e of t.addedNodes)switch(e.nodeName){case'#text':{const t=e.nodeValue;if(!Si.test(t)){console.warn('Use of unwrapped text in distill articles is discouraged as it breaks layout! Please wrap any text in a <span> or <p> tag. We found the following text: '+t);const n=document.createElement('span');n.innerHTML=e.nodeValue,e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)}}}}).observe(this,{childList:!0})}}var Ti='undefined'==typeof window?'undefined'==typeof global?'undefined'==typeof self?{}:self:global:window,_i=f(function(e,t){(function(e){function t(){this.months=['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec'],this.notKey=[',','{','}',' ','='],this.pos=0,this.input='',this.entries=[],this.currentEntry='',this.setInput=function(e){this.input=e},this.getEntries=function(){return this.entries},this.isWhitespace=function(e){return' '==e||'\r'==e||'\t'==e||'\n'==e},this.match=function(e,t){if((void 0==t||null==t)&&(t=!0),this.skipWhitespace(t),this.input.substring(this.pos,this.pos+e.length)==e)this.pos+=e.length;else throw'Token mismatch, expected '+e+', found '+this.input.substring(this.pos);this.skipWhitespace(t)},this.tryMatch=function(e,t){return(void 0==t||null==t)&&(t=!0),this.skipWhitespace(t),this.input.substring(this.pos,this.pos+e.length)==e},this.matchAt=function(){for(;this.input.length>this.pos&&'@'!=this.input[this.pos];)this.pos++;return!('@'!=this.input[this.pos])},this.skipWhitespace=function(e){for(;this.isWhitespace(this.input[this.pos]);)this.pos++;if('%'==this.input[this.pos]&&!0==e){for(;'\n'!=this.input[this.pos];)this.pos++;this.skipWhitespace(e)}},this.value_braces=function(){var e=0;this.match('{',!1);for(var t=this.pos,n=!1;;){if(!n)if('}'==this.input[this.pos]){if(0<e)e--;else{var i=this.pos;return this.match('}',!1),this.input.substring(t,i)}}else if('{'==this.input[this.pos])e++;else if(this.pos>=this.input.length-1)throw'Unterminated value';n='\\'==this.input[this.pos]&&!1==n,this.pos++}},this.value_comment=function(){for(var e='',t=0;!(this.tryMatch('}',!1)&&0==t);){if(e+=this.input[this.pos],'{'==this.input[this.pos]&&t++,'}'==this.input[this.pos]&&t--,this.pos>=this.input.length-1)throw'Unterminated value:'+this.input.substring(start);this.pos++}return e},this.value_quotes=function(){this.match('"',!1);for(var e=this.pos,t=!1;;){if(!t){if('"'==this.input[this.pos]){var n=this.pos;return this.match('"',!1),this.input.substring(e,n)}if(this.pos>=this.input.length-1)throw'Unterminated value:'+this.input.substring(e)}t='\\'==this.input[this.pos]&&!1==t,this.pos++}},this.single_value=function(){var e=this.pos;if(this.tryMatch('{'))return this.value_braces();if(this.tryMatch('"'))return this.value_quotes();var t=this.key();if(t.match('^[0-9]+$'))return t;if(0<=this.months.indexOf(t.toLowerCase()))return t.toLowerCase();throw'Value expected:'+this.input.substring(e)+' for key: '+t},this.value=function(){for(var e=[this.single_value()];this.tryMatch('#');)this.match('#'),e.push(this.single_value());return e.join('')},this.key=function(){for(var e=this.pos;;){if(this.pos>=this.input.length)throw'Runaway key';if(0<=this.notKey.indexOf(this.input[this.pos]))return this.input.substring(e,this.pos);this.pos++}},this.key_equals_value=function(){var e=this.key();if(this.tryMatch('=')){this.match('=');var t=this.value();return[e,t]}throw'... = value expected, equals sign missing:'+this.input.substring(this.pos)},this.key_value_list=function(){var e=this.key_equals_value();for(this.currentEntry.entryTags={},this.currentEntry.entryTags[e[0]]=e[1];this.tryMatch(',')&&(this.match(','),!this.tryMatch('}'));)e=this.key_equals_value(),this.currentEntry.entryTags[e[0]]=e[1]},this.entry_body=function(e){this.currentEntry={},this.currentEntry.citationKey=this.key(),this.currentEntry.entryType=e.substring(1),this.match(','),this.key_value_list(),this.entries.push(this.currentEntry)},this.directive=function(){return this.match('@'),'@'+this.key()},this.preamble=function(){this.currentEntry={},this.currentEntry.entryType='PREAMBLE',this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.comment=function(){this.currentEntry={},this.currentEntry.entryType='COMMENT',this.currentEntry.entry=this.value_comment(),this.entries.push(this.currentEntry)},this.entry=function(e){this.entry_body(e)},this.bibtex=function(){for(;this.matchAt();){var e=this.directive();this.match('{'),'@STRING'==e?this.string():'@PREAMBLE'==e?this.preamble():'@COMMENT'==e?this.comment():this.entry(e),this.match('}')}}}e.toJSON=function(e){var n=new t;return n.setInput(e),n.bibtex(),n.entries},e.toBibtex=function(e){var t='';for(var n in e){if(t+='@'+e[n].entryType,t+='{',e[n].citationKey&&(t+=e[n].citationKey+', '),e[n].entry&&(t+=e[n].entry),e[n].entryTags){var i='';for(var a in e[n].entryTags)0!=i.length&&(i+=', '),i+=a+'= {'+e[n].entryTags[a]+'}';t+=i}t+='}\n\n'}return t}})(t)});class Li extends HTMLElement{static get is(){return'd-bibliography'}constructor(){super();const e=new MutationObserver((e)=>{for(const t of e)('SCRIPT'===t.target.nodeName||'characterData'===t.type)&&this.parseIfPossible()});e.observe(this,{childList:!0,characterData:!0,subtree:!0})}connectedCallback(){requestAnimationFrame(()=>{this.parseIfPossible()})}parseIfPossible(){const e=this.querySelector('script');if(e)if('text/bibtex'==e.type){const t=e.textContent;if(this.bibtex!==t){this.bibtex=t;const e=b(this.bibtex);this.notify(e)}}else if('text/json'==e.type){const t=new Map(JSON.parse(e.textContent));this.notify(t)}else console.warn('Unsupported bibliography script tag type: '+e.type)}notify(e){const t=new CustomEvent('onBibliographyChanged',{detail:e,bubbles:!0});this.dispatchEvent(t)}static get observedAttributes(){return['src']}receivedBibtex(e){const t=b(e.target.response);this.notify(t)}attributeChangedCallback(e,t,n){var i=new XMLHttpRequest;i.onload=(t)=>this.receivedBibtex(t),i.onerror=()=>console.warn(`Could not load Bibtex! (tried ${n})`),i.responseType='text',i.open('GET',n,!0),i.send()}}class Ai extends HTMLElement{static get is(){return'd-byline'}set frontMatter(e){this.innerHTML=y(e)}}const Ei=ti('d-cite',`
<style>

:host {

}

.citation {
  display: inline-block;
  color: hsla(206, 90%, 20%, 0.7);
}

.citation-number {
  cursor: default;
  white-space: nowrap;
  font-family: -apple-system, BlinkMacSystemFont, "Roboto", Helvetica, sans-serif;
  font-size: 75%;
  color: hsla(206, 90%, 20%, 0.7);
  display: inline-block;
  line-height: 1.1em;
  text-align: center;
  position: relative;
  top: -2px;
  margin: 0 2px;
}

figcaption .citation-number {
  font-size: 11px;
  font-weight: normal;
  top: -2px;
  line-height: 1em;
}

ul {
  margin: 0;
  padding: 0;
  list-style-type: none;
}

ul li {
  padding: 15px 10px 15px 10px;
  border-bottom: 1px solid rgba(0,0,0,0.1)
}

ul li:last-of-type {
  border-bottom: none;
}

</style>

<d-hover-box id="hover-box"></d-hover-box>

<div id="citation-" class="citation">
  <slot></slot>
  <span class="citation-number"></span>
</div>
`);class Di extends Ei(HTMLElement){connectedCallback(){this.outerSpan=this.root.querySelector('#citation-'),this.innerSpan=this.root.querySelector('.citation-number'),this.hoverBox=this.root.querySelector('d-hover-box'),window.customElements.whenDefined('d-hover-box').then(()=>{this.hoverBox.listen(this)})}static get observedAttributes(){return['key']}attributeChangedCallback(e,t,n){const i=t?'onCiteKeyChanged':'onCiteKeyCreated',a=n.split(','),d={detail:[this,a],bubbles:!0},r=new CustomEvent(i,d);document.dispatchEvent(r)}set key(e){this.setAttribute('key',e)}get key(){return this.getAttribute('key')}get keys(){return this.getAttribute('key').split(',')}set numbers(e){const t=e.map((e)=>{return-1==e?'?':e+1+''}),n='['+t.join(', ')+']';this.innerSpan&&(this.innerSpan.textContent=n)}set entries(e){this.hoverBox&&(this.hoverBox.innerHTML=`<ul>
      ${e.map(l).map((e)=>`<li>${e}</li>`).join('\n')}
      </ul>`)}}const Mi=`
d-citation-list {
  contain: layout style;
}

d-citation-list .references {
  grid-column: text;
}

d-citation-list .references .title {
  font-weight: 500;
}
`;class Oi extends HTMLElement{static get is(){return'd-citation-list'}connectedCallback(){this.hasAttribute('distill-prerendered')||(this.style.display='none')}set citations(e){x(this,e)}}var Ui=f(function(e){var t='undefined'==typeof window?'undefined'!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{}:window,n=function(){var e=/\blang(?:uage)?-(\w+)\b/i,n=0,a=t.Prism={util:{encode:function(e){return e instanceof i?new i(e.type,a.util.encode(e.content),e.alias):'Array'===a.util.type(e)?e.map(a.util.encode):e.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/\u00a0/g,' ')},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,'__id',{value:++n}),e.__id},clone:function(e){var t=a.util.type(e);switch(t){case'Object':var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=a.util.clone(e[i]));return n;case'Array':return e.map&&e.map(function(e){return a.util.clone(e)});}return e}},languages:{extend:function(e,t){var n=a.util.clone(a.languages[e]);for(var i in t)n[i]=t[i];return n},insertBefore:function(e,t,n,i){i=i||a.languages;var d=i[e];if(2==arguments.length){for(var r in n=arguments[1],n)n.hasOwnProperty(r)&&(d[r]=n[r]);return d}var o={};for(var l in d)if(d.hasOwnProperty(l)){if(l==t)for(var r in n)n.hasOwnProperty(r)&&(o[r]=n[r]);o[l]=d[l]}return a.languages.DFS(a.languages,function(t,n){n===i[e]&&t!=e&&(this[t]=o)}),i[e]=o},DFS:function(e,t,n,d){for(var r in d=d||{},e)e.hasOwnProperty(r)&&(t.call(e,r,e[r],n||r),'Object'!==a.util.type(e[r])||d[a.util.objId(e[r])]?'Array'===a.util.type(e[r])&&!d[a.util.objId(e[r])]&&(d[a.util.objId(e[r])]=!0,a.languages.DFS(e[r],t,r,d)):(d[a.util.objId(e[r])]=!0,a.languages.DFS(e[r],t,null,d)))}},plugins:{},highlightAll:function(e,t){var n={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};a.hooks.run('before-highlightall',n);for(var d,r=n.elements||document.querySelectorAll(n.selector),o=0;d=r[o++];)a.highlightElement(d,!0===e,n.callback)},highlightElement:function(n,i,d){for(var r,o,l=n;l&&!e.test(l.className);)l=l.parentNode;l&&(r=(l.className.match(e)||[,''])[1].toLowerCase(),o=a.languages[r]),n.className=n.className.replace(e,'').replace(/\s+/g,' ')+' language-'+r,l=n.parentNode,/pre/i.test(l.nodeName)&&(l.className=l.className.replace(e,'').replace(/\s+/g,' ')+' language-'+r);var s=n.textContent,c={element:n,language:r,grammar:o,code:s};if(a.hooks.run('before-sanity-check',c),!c.code||!c.grammar)return c.code&&(c.element.textContent=c.code),void a.hooks.run('complete',c);if(a.hooks.run('before-highlight',c),i&&t.Worker){var u=new Worker(a.filename);u.onmessage=function(e){c.highlightedCode=e.data,a.hooks.run('before-insert',c),c.element.innerHTML=c.highlightedCode,d&&d.call(c.element),a.hooks.run('after-highlight',c),a.hooks.run('complete',c)},u.postMessage(JSON.stringify({language:c.language,code:c.code,immediateClose:!0}))}else c.highlightedCode=a.highlight(c.code,c.grammar,c.language),a.hooks.run('before-insert',c),c.element.innerHTML=c.highlightedCode,d&&d.call(n),a.hooks.run('after-highlight',c),a.hooks.run('complete',c)},highlight:function(e,t,n){var d=a.tokenize(e,t);return i.stringify(a.util.encode(d),n)},tokenize:function(e,t){var n=a.Token,d=[e],r=t.rest;if(r){for(var o in r)t[o]=r[o];delete t.rest}tokenloop:for(var o in t)if(t.hasOwnProperty(o)&&t[o]){var l=t[o];l='Array'===a.util.type(l)?l:[l];for(var s=0;s<l.length;++s){var c=l[s],u=c.inside,g=!!c.lookbehind,f=!!c.greedy,h=0,b=c.alias;if(f&&!c.pattern.global){var m=c.pattern.toString().match(/[imuy]*$/)[0];c.pattern=RegExp(c.pattern.source,m+'g')}c=c.pattern||c;for(var y,x=0,i=0;x<d.length;i+=d[x].length,++x){if(y=d[x],d.length>e.length)break tokenloop;if(!(y instanceof n)){c.lastIndex=0;var v=c.exec(y),w=1;if(!v&&f&&x!=d.length-1){if(c.lastIndex=i,v=c.exec(e),!v)break;for(var S=v.index+(g?v[1].length:0),C=v.index+v[0].length,T=x,k=i,p=d.length;T<p&&k<C;++T)k+=d[T].length,S>=k&&(++x,i=k);if(d[x]instanceof n||d[T-1].greedy)continue;w=T-x,y=e.slice(i,k),v.index-=i}if(v){g&&(h=v[1].length);var S=v.index+h,v=v[0].slice(h),C=S+v.length,_=y.slice(0,S),L=y.slice(C),A=[x,w];_&&A.push(_);var E=new n(o,u?a.tokenize(v,u):v,b,v,f);A.push(E),L&&A.push(L),Array.prototype.splice.apply(d,A)}}}}}return d},hooks:{all:{},add:function(e,t){var n=a.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=a.hooks.all[e];if(n&&n.length)for(var d,r=0;d=n[r++];)d(t)}}},i=a.Token=function(e,t,n,i,a){this.type=e,this.content=t,this.alias=n,this.length=0|(i||'').length,this.greedy=!!a};if(i.stringify=function(e,t,n){if('string'==typeof e)return e;if('Array'===a.util.type(e))return e.map(function(n){return i.stringify(n,t,e)}).join('');var d={type:e.type,content:i.stringify(e.content,t,n),tag:'span',classes:['token',e.type],attributes:{},language:t,parent:n};if('comment'==d.type&&(d.attributes.spellcheck='true'),e.alias){var r='Array'===a.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(d.classes,r)}a.hooks.run('wrap',d);var l=Object.keys(d.attributes).map(function(e){return e+'="'+(d.attributes[e]||'').replace(/"/g,'&quot;')+'"'}).join(' ');return'<'+d.tag+' class="'+d.classes.join(' ')+'"'+(l?' '+l:'')+'>'+d.content+'</'+d.tag+'>'},!t.document)return t.addEventListener?(t.addEventListener('message',function(e){var n=JSON.parse(e.data),i=n.language,d=n.code,r=n.immediateClose;t.postMessage(a.highlight(d,a.languages[i],i)),r&&t.close()},!1),t.Prism):t.Prism;var d=document.currentScript||[].slice.call(document.getElementsByTagName('script')).pop();return d&&(a.filename=d.src,document.addEventListener&&!d.hasAttribute('data-manual')&&('loading'===document.readyState?document.addEventListener('DOMContentLoaded',a.highlightAll):window.requestAnimationFrame?window.requestAnimationFrame(a.highlightAll):window.setTimeout(a.highlightAll,16))),t.Prism}();e.exports&&(e.exports=n),'undefined'!=typeof Ti&&(Ti.Prism=n),n.languages.markup={comment:/<!--[\w\W]*?-->/,prolog:/<\?[\w\W]+?\?>/,doctype:/<!DOCTYPE[\w\W]+?>/i,cdata:/<!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i,inside:{punctuation:/[=>"']/}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},n.hooks.add('wrap',function(e){'entity'===e.type&&(e.attributes.title=e.content.replace(/&amp;/,'&'))}),n.languages.xml=n.languages.markup,n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.css={comment:/\/\*[\w\W]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^\{\}\s][^\{\};]*?(?=\s*\{)/,string:{pattern:/("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/(\b|\B)[\w-]+(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},n.languages.css.atrule.inside.rest=n.util.clone(n.languages.css),n.languages.markup&&(n.languages.insertBefore('markup','tag',{style:{pattern:/(<style[\w\W]*?>)[\w\W]*?(?=<\/style>)/i,lookbehind:!0,inside:n.languages.css,alias:'language-css'}}),n.languages.insertBefore('inside','attr-value',{"style-attr":{pattern:/\s*style=("|').*?\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:n.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:n.languages.css}},alias:'language-css'}},n.languages.markup.tag)),n.languages.clike={comment:[{pattern:/(^|[^\\])#.*/,lookbehind:!0},{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(true|false)\b/,function:/[a-z\.0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend('clike',{keyword:/\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/,number:/\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/,function:/[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*\*?|\/|~|\^|%|\.{3}/}),n.languages.insertBefore('javascript','keyword',{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}}),n.languages.insertBefore('javascript','string',{"template-string":{pattern:/`(?:\\\\|\\?[^\\])*?`/,greedy:!0,inside:{interpolation:{pattern:/\$\{[^}]+\}/,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:'punctuation'},rest:n.languages.javascript}},string:/[\s\S]+/}}}),n.languages.markup&&n.languages.insertBefore('markup','tag',{script:{pattern:/(<script[\w\W]*?>)[\w\W]*?(?=<\/script>)/i,lookbehind:!0,inside:n.languages.javascript,alias:'language-javascript'}}),n.languages.js=n.languages.javascript,function(){'undefined'!=typeof self&&self.Prism&&self.document&&document.querySelector&&(self.Prism.fileHighlight=function(){var e={js:'javascript',py:'python',rb:'ruby',ps1:'powershell',psm1:'powershell',sh:'bash',bat:'batch',h:'c',tex:'latex'};Array.prototype.forEach&&Array.prototype.slice.call(document.querySelectorAll('pre[data-src]')).forEach(function(t){for(var i,a=t.getAttribute('data-src'),d=t,r=/\blang(?:uage)?-(?!\*)(\w+)\b/i;d&&!r.test(d.className);)d=d.parentNode;if(d&&(i=(t.className.match(r)||[,''])[1]),!i){var o=(a.match(/\.(\w+)$/)||[,''])[1];i=e[o]||o}var l=document.createElement('code');l.className='language-'+i,t.textContent='',l.textContent='Loading\u2026',t.appendChild(l);var s=new XMLHttpRequest;s.open('GET',a,!0),s.onreadystatechange=function(){4==s.readyState&&(400>s.status&&s.responseText?(l.textContent=s.responseText,n.highlightElement(l)):400<=s.status?l.textContent='\u2716 Error '+s.status+' while fetching file: '+s.statusText:l.textContent='\u2716 Error: File does not exist or is empty')},s.send(null)})},document.addEventListener('DOMContentLoaded',self.Prism.fileHighlight))}()});Prism.languages.python={"triple-quoted-string":{pattern:/"""[\s\S]+?"""|'''[\s\S]+?'''/,alias:'string'},comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},string:{pattern:/("|')(?:\\\\|\\?[^\\\r\n])*?\1/,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_][a-zA-Z0-9_]*(?=\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)[a-z0-9_]+/i,lookbehind:!0},keyword:/\b(?:as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|pass|print|raise|return|try|while|with|yield)\b/,boolean:/\b(?:True|False)\b/,number:/\b-?(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]|\b(?:or|and|not)\b/,punctuation:/[{}[\];(),.:]/},Prism.languages.clike={comment:[{pattern:/(^|[^\\])#.*/,lookbehind:!0},{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0}],string:{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(true|false)\b/,function:/[a-z\.0-9_]+(?=\()/i,number:/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},Prism.languages.lua={comment:/^#!.+|--(?:\[(=*)\[[\s\S]*?\]\1\]|.*)/m,string:{pattern:/(["'])(?:(?!\1)[^\\\r\n]|\\z(?:\r\n|\s)|\\(?:\r\n|[\s\S]))*\1|\[(=*)\[[\s\S]*?\]\2\]/,greedy:!0},number:/\b0x[a-f\d]+\.?[a-f\d]*(?:p[+-]?\d+)?\b|\b\d+(?:\.\B|\.?\d*(?:e[+-]?\d+)?\b)|\B\.\d+(?:e[+-]?\d+)?\b/i,keyword:/\b(?:and|break|do|else|elseif|end|false|for|function|goto|if|in|local|nil|not|or|repeat|return|then|true|until|while)\b/,function:/(?!\d)\w+(?=\s*(?:[({]))/,operator:[/[-+*%^&|#]|\/\/?|<[<=]?|>[>=]?|[=~]=?/,{pattern:/(^|[^.])\.\.(?!\.)/,lookbehind:!0}],punctuation:/[\[\](){},;]|\.+|:+/},function(e){var t={variable:[{pattern:/\$?\(\([\w\W]+?\)\)/,inside:{variable:[{pattern:/(^\$\(\([\w\W]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b-?(?:0x[\dA-Fa-f]+|\d*\.?\d+(?:[Ee]-?\d+)?)\b/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|<<=?|>>=?|<=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\([^)]+\)|`[^`]+`/,inside:{variable:/^\$\(|^`|\)$|`$/}},/\$(?:[a-z0-9_#\?\*!@]+|\{[^}]+\})/i]};e.languages.bash={shebang:{pattern:/^#!\s*\/bin\/bash|^#!\s*\/bin\/sh/,alias:'important'},comment:{pattern:/(^|[^"{\\])#.*/,lookbehind:!0},string:[{pattern:/((?:^|[^<])<<\s*)(?:"|')?(\w+?)(?:"|')?\s*\r?\n(?:[\s\S])*?\r?\n\2/g,lookbehind:!0,greedy:!0,inside:t},{pattern:/(["'])(?:\\\\|\\?[^\\])*?\1/g,greedy:!0,inside:t}],variable:t.variable,function:{pattern:/(^|\s|;|\||&)(?:alias|apropos|apt-get|aptitude|aspell|awk|basename|bash|bc|bg|builtin|bzip2|cal|cat|cd|cfdisk|chgrp|chmod|chown|chroot|chkconfig|cksum|clear|cmp|comm|command|cp|cron|crontab|csplit|cut|date|dc|dd|ddrescue|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|enable|env|ethtool|eval|exec|expand|expect|export|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|getopts|git|grep|groupadd|groupdel|groupmod|groups|gzip|hash|head|help|hg|history|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|jobs|join|kill|killall|less|link|ln|locate|logname|logout|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|make|man|mkdir|mkfifo|mkisofs|mknod|more|most|mount|mtools|mtr|mv|mmv|nano|netstat|nice|nl|nohup|notify-send|npm|nslookup|open|op|passwd|paste|pathchk|ping|pkill|popd|pr|printcap|printenv|printf|ps|pushd|pv|pwd|quota|quotacheck|quotactl|ram|rar|rcp|read|readarray|readonly|reboot|rename|renice|remsync|rev|rm|rmdir|rsync|screen|scp|sdiff|sed|seq|service|sftp|shift|shopt|shutdown|sleep|slocate|sort|source|split|ssh|stat|strace|su|sudo|sum|suspend|sync|tail|tar|tee|test|time|timeout|times|touch|top|traceroute|trap|tr|tsort|tty|type|ulimit|umask|umount|unalias|uname|unexpand|uniq|units|unrar|unshar|uptime|useradd|userdel|usermod|users|uuencode|uudecode|v|vdir|vi|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yes|zip)(?=$|\s|;|\||&)/,lookbehind:!0},keyword:{pattern:/(^|\s|;|\||&)(?:let|:|\.|if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)(?=$|\s|;|\||&)/,lookbehind:!0},boolean:{pattern:/(^|\s|;|\||&)(?:true|false)(?=$|\s|;|\||&)/,lookbehind:!0},operator:/&&?|\|\|?|==?|!=?|<<<?|>>|<=?|>=?|=~/,punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];]/};var n=t.variable[1].inside;n['function']=e.languages.bash['function'],n.keyword=e.languages.bash.keyword,n.boolean=e.languages.bash.boolean,n.operator=e.languages.bash.operator,n.punctuation=e.languages.bash.punctuation}(Prism),Prism.languages.go=Prism.languages.extend('clike',{keyword:/\b(break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,builtin:/\b(bool|byte|complex(64|128)|error|float(32|64)|rune|string|u?int(8|16|32|64|)|uintptr|append|cap|close|complex|copy|delete|imag|len|make|new|panic|print(ln)?|real|recover)\b/,boolean:/\b(_|iota|nil|true|false)\b/,operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,number:/\b(-?(0x[a-f\d]+|(\d+\.?\d*|\.\d+)(e[-+]?\d+)?)i?)\b/i,string:/("|'|`)(\\?.|\r|\n)*?\1/}),delete Prism.languages.go['class-name'],Prism.languages.markdown=Prism.languages.extend('markup',{}),Prism.languages.insertBefore('markdown','prolog',{blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:'punctuation'},code:[{pattern:/^(?: {4}|\t).+/m,alias:'keyword'},{pattern:/``.+?``|`[^`\n]+`/,alias:'keyword'}],title:[{pattern:/\w+.*(?:\r?\n|\r)(?:==+|--+)/,alias:'important',inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#+.+/m,lookbehind:!0,alias:'important',inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])([\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:'punctuation'},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:'punctuation'},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:'url'},bold:{pattern:/(^|[^\\])(\*\*|__)(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^\*\*|^__|\*\*$|__$/}},italic:{pattern:/(^|[^\\])([*_])(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^[*_]|[*_]$/}},url:{pattern:/!?\[[^\]]+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)| ?\[[^\]\n]*\])/,inside:{variable:{pattern:/(!?\[)[^\]]+(?=\]$)/,lookbehind:!0},string:{pattern:/"(?:\\.|[^"\\])*"(?=\)$)/}}}}),Prism.languages.markdown.bold.inside.url=Prism.util.clone(Prism.languages.markdown.url),Prism.languages.markdown.italic.inside.url=Prism.util.clone(Prism.languages.markdown.url),Prism.languages.markdown.bold.inside.italic=Prism.util.clone(Prism.languages.markdown.italic),Prism.languages.markdown.italic.inside.bold=Prism.util.clone(Prism.languages.markdown.bold),Prism.languages.julia={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},string:/"""[\s\S]+?"""|'''[\s\S]+?'''|("|')(\\?.)*?\1/,keyword:/\b(abstract|baremodule|begin|bitstype|break|catch|ccall|const|continue|do|else|elseif|end|export|finally|for|function|global|if|immutable|import|importall|let|local|macro|module|print|println|quote|return|try|type|typealias|using|while)\b/,boolean:/\b(true|false)\b/,number:/\b-?(0[box])?(?:[\da-f]+\.?\d*|\.\d+)(?:[efp][+-]?\d+)?j?\b/i,operator:/\+=?|-=?|\*=?|\/[\/=]?|\\=?|\^=?|%=?|=?|!=?=?|&=?|\|[=>]?|\$=?|<(?:<=?|[=:])?|>(?:=|>>?=?)?|==?=?|[~]/,punctuation:/[{}[\];(),.:]/};const Ii=ti('d-code',`
<style>

code {
  white-space: nowrap;
  background: rgba(0, 0, 0, 0.04);
  border-radius: 2px;
  padding: 4px 7px;
  font-size: 15px;
  color: rgba(0, 0, 0, 0.6);
}

pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 36px;
}

${'/**\n * prism.js default theme for JavaScript, CSS and HTML\n * Based on dabblet (http://dabblet.com)\n * @author Lea Verou\n */\n\ncode[class*="language-"],\npre[class*="language-"] {\n\tcolor: black;\n\tbackground: none;\n\ttext-shadow: 0 1px white;\n\tfont-family: Consolas, Monaco, \'Andale Mono\', \'Ubuntu Mono\', monospace;\n\ttext-align: left;\n\twhite-space: pre;\n\tword-spacing: normal;\n\tword-break: normal;\n\tword-wrap: normal;\n\tline-height: 1.5;\n\n\t-moz-tab-size: 4;\n\t-o-tab-size: 4;\n\ttab-size: 4;\n\n\t-webkit-hyphens: none;\n\t-moz-hyphens: none;\n\t-ms-hyphens: none;\n\thyphens: none;\n}\n\npre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,\ncode[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {\n\ttext-shadow: none;\n\tbackground: #b3d4fc;\n}\n\npre[class*="language-"]::selection, pre[class*="language-"] ::selection,\ncode[class*="language-"]::selection, code[class*="language-"] ::selection {\n\ttext-shadow: none;\n\tbackground: #b3d4fc;\n}\n\n@media print {\n\tcode[class*="language-"],\n\tpre[class*="language-"] {\n\t\ttext-shadow: none;\n\t}\n}\n\n/* Code blocks */\npre[class*="language-"] {\n\tpadding: 1em;\n\tmargin: .5em 0;\n\toverflow: auto;\n}\n\n:not(pre) > code[class*="language-"],\npre[class*="language-"] {\n\tbackground: #f5f2f0;\n}\n\n/* Inline code */\n:not(pre) > code[class*="language-"] {\n\tpadding: .1em;\n\tborder-radius: .3em;\n\twhite-space: normal;\n}\n\n.token.comment,\n.token.prolog,\n.token.doctype,\n.token.cdata {\n\tcolor: slategray;\n}\n\n.token.punctuation {\n\tcolor: #999;\n}\n\n.namespace {\n\topacity: .7;\n}\n\n.token.property,\n.token.tag,\n.token.boolean,\n.token.number,\n.token.constant,\n.token.symbol,\n.token.deleted {\n\tcolor: #905;\n}\n\n.token.selector,\n.token.attr-name,\n.token.string,\n.token.char,\n.token.builtin,\n.token.inserted {\n\tcolor: #690;\n}\n\n.token.operator,\n.token.entity,\n.token.url,\n.language-css .token.string,\n.style .token.string {\n\tcolor: #a67f59;\n\tbackground: hsla(0, 0%, 100%, .5);\n}\n\n.token.atrule,\n.token.attr-value,\n.token.keyword {\n\tcolor: #07a;\n}\n\n.token.function {\n\tcolor: #DD4A68;\n}\n\n.token.regex,\n.token.important,\n.token.variable {\n\tcolor: #e90;\n}\n\n.token.important,\n.token.bold {\n\tfont-weight: bold;\n}\n.token.italic {\n\tfont-style: italic;\n}\n\n.token.entity {\n\tcursor: help;\n}\n'}
</style>

<code id="code-container"></code>

`);class Ni extends ei(Ii(HTMLElement)){renderContent(){if(this.languageName=this.getAttribute('language'),!this.languageName)return void console.warn('You need to provide a language attribute to your <d-code> block to let us know how to highlight your code; e.g.:\n <d-code language="python">zeros = np.zeros(shape)</d-code>.');const e=Ui.languages[this.languageName];if(void 0==e)return void console.warn(`Distill does not yet support highlighting your code block in "${this.languageName}'.`);let t=this.textContent;const n=this.shadowRoot.querySelector('#code-container');if(this.hasAttribute('block')){t=t.replace(/\n/,'');const e=t.match(/\s*/);if(t=t.replace(new RegExp('\n'+e,'g'),'\n'),t=t.trim(),n.parentNode instanceof ShadowRoot){const e=document.createElement('pre');this.shadowRoot.removeChild(n),e.appendChild(n),this.shadowRoot.appendChild(e)}}n.className=`language-${this.languageName}`,n.innerHTML=Ui.highlight(t,e)}}const ji=ti('d-footnote',`
<style>

d-math[block] {
  display: block;
}

:host {

}

sup {
  line-height: 1em;
  font-size: 0.75em;
  position: relative;
  top: -.5em;
  vertical-align: baseline;
}

span {
  color: hsla(206, 90%, 20%, 0.7);
  cursor: default;
}

.footnote-container {
  padding: 10px;
}

</style>

<d-hover-box>
  <div class="footnote-container">
    <slot id="slot"></slot>
  </div>
</d-hover-box>

<sup>
  <span id="fn-" data-hover-ref=""></span>
</sup>

`);class Ri extends ji(HTMLElement){constructor(){super();const e=new MutationObserver(this.notify);e.observe(this,{childList:!0,characterData:!0,subtree:!0})}notify(){const e={detail:this,bubbles:!0},t=new CustomEvent('onFootnoteChanged',e);document.dispatchEvent(t)}connectedCallback(){this.hoverBox=this.root.querySelector('d-hover-box'),window.customElements.whenDefined('d-hover-box').then(()=>{this.hoverBox.listen(this)}),Ri.currentFootnoteId+=1;const e=Ri.currentFootnoteId.toString();this.root.host.id='d-footnote-'+e;const t='dt-fn-hover-box-'+e;this.hoverBox.id=t;const n=this.root.querySelector('#fn-');n.setAttribute('id','fn-'+e),n.setAttribute('data-hover-ref',t),n.textContent=e}}Ri.currentFootnoteId=0;const qi=ti('d-footnote-list',`
<style>

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}

</style>

<h3>Footnotes</h3>
<ol></ol>
`,!1);class Fi extends qi(HTMLElement){connectedCallback(){super.connectedCallback(),this.list=this.root.querySelector('ol'),this.root.style.display='none'}set footnotes(e){if(this.list.innerHTML='',e.length){this.root.style.display='';for(const t of e){const e=document.createElement('li');e.id=t.id+'-listing',e.innerHTML=t.innerHTML;const n=document.createElement('a');n.setAttribute('class','footnote-backlink'),n.textContent='[\u21A9]',n.href='#'+t.id,e.appendChild(n),this.list.appendChild(e)}}else this.root.style.display='none'}}const Pi=ti('d-hover-box',`
<style>

:host {
  position: absolute;
  width: 100%;
  left: 0px;
  z-index: 10000;
  display: none;
  white-space: normal
}

.container {
  position: relative;
  width: 704px;
  max-width: 100vw;
  margin: 0 auto;
}

.panel {
  position: absolute;
  font-size: 1rem;
  line-height: 1.5em;
  top: 0;
  left: 0;
  width: 100%;
  border: 1px solid rgba(0, 0, 0, 0.1);
  background-color: rgba(250, 250, 250, 0.95);
  box-shadow: 0 0 7px rgba(0, 0, 0, 0.1);
  border-radius: 4px;
  box-sizing: border-box;

  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
}

</style>

<div class="container">
  <div class="panel">
    <slot></slot>
  </div>
</div>
`);class Hi extends Pi(HTMLElement){constructor(){super()}connectedCallback(){}listen(e){this.bindDivEvents(this),this.bindTriggerEvents(e)}bindDivEvents(e){e.addEventListener('mouseover',()=>{this.visible||this.showAtNode(e),this.stopTimeout()}),e.addEventListener('mouseout',()=>{this.extendTimeout(500)}),e.addEventListener('touchstart',(e)=>{e.stopPropagation()},{passive:!0}),document.body.addEventListener('touchstart',()=>{this.hide()},{passive:!0})}bindTriggerEvents(e){e.addEventListener('mouseover',()=>{this.visible||this.showAtNode(e),this.stopTimeout()}),e.addEventListener('mouseout',()=>{this.extendTimeout(300)}),e.addEventListener('touchstart',(t)=>{this.visible?this.hide():this.showAtNode(e),t.stopPropagation()},{passive:!0})}show(e){this.visible=!0,this.style.display='block',this.style.top=Pn(e[1]+10)+'px'}showAtNode(e){const t=e.getBoundingClientRect();this.show([e.offsetLeft+t.width,e.offsetTop+t.height])}hide(){this.visible=!1,this.style.display='none',this.stopTimeout()}stopTimeout(){this.timeout&&clearTimeout(this.timeout)}extendTimeout(e){this.stopTimeout(),this.timeout=setTimeout(()=>{this.hide()},e)}}class zi extends HTMLElement{static get is(){return'd-title'}}const Yi=ti('d-references',`
<style>
d-references {
  display: block;
}
</style>
`,!1);class Bi extends Yi(HTMLElement){}class Wi extends HTMLElement{static get is(){return'd-toc'}connectedCallback(){this.getAttribute('prerendered')||(window.onload=()=>{const e=document.querySelector('d-article'),t=e.querySelectorAll('h2, h3');k(this,t)})}}class Vi extends HTMLElement{static get is(){return'd-figure'}static get readyQueue(){return Vi._readyQueue||(Vi._readyQueue=[]),Vi._readyQueue}static addToReadyQueue(e){-1===Vi.readyQueue.indexOf(e)&&(Vi.readyQueue.push(e),Vi.runReadyQueue())}static runReadyQueue(){const e=Vi.readyQueue.sort((e,t)=>e._seenOnScreen-t._seenOnScreen).filter((e)=>!e._ready).pop();e&&(e.ready(),requestAnimationFrame(Vi.runReadyQueue))}constructor(){super(),this._ready=!1,this._onscreen=!1,this._offscreen=!0}connectedCallback(){this.loadsWhileScrolling=this.hasAttribute('loadsWhileScrolling'),Vi.marginObserver.observe(this),Vi.directObserver.observe(this)}disconnectedCallback(){Vi.marginObserver.unobserve(this),Vi.directObserver.unobserve(this)}static get marginObserver(){if(!Vi._marginObserver){const e=window.innerHeight,t=Fn(2*e),n=Vi.didObserveMarginIntersection,i=new IntersectionObserver(n,{rootMargin:t+'px 0px '+t+'px 0px',threshold:0.01});Vi._marginObserver=i}return Vi._marginObserver}static didObserveMarginIntersection(e){for(const t of e){const e=t.target;t.isIntersecting&&!e._ready&&Vi.addToReadyQueue(e)}}static get directObserver(){return Vi._directObserver||(Vi._directObserver=new IntersectionObserver(Vi.didObserveDirectIntersection,{rootMargin:'0px',threshold:[0,1]})),Vi._directObserver}static didObserveDirectIntersection(e){for(const t of e){const e=t.target;t.isIntersecting?(e._seenOnScreen=new Date,e._offscreen&&e.onscreen()):e._onscreen&&e.offscreen()}}addEventListener(e,t){super.addEventListener(e,t),'ready'===e&&-1!==Vi.readyQueue.indexOf(this)&&(this._ready=!1,Vi.runReadyQueue()),'onscreen'===e&&this.onscreen()}ready(){this._ready=!0,Vi.marginObserver.unobserve(this);const e=new CustomEvent('ready');this.dispatchEvent(e)}onscreen(){this._onscreen=!0,this._offscreen=!1;const e=new CustomEvent('onscreen');this.dispatchEvent(e)}offscreen(){this._onscreen=!1,this._offscreen=!0;const e=new CustomEvent('offscreen');this.dispatchEvent(e)}}if('undefined'!=typeof window){Vi.isScrolling=!1;let e;window.addEventListener('scroll',()=>{Vi.isScrolling=!0,clearTimeout(e),e=setTimeout(()=>{Vi.isScrolling=!1,Vi.runReadyQueue()},500)},!0)}const Ki=ti('d-interstitial',`
<style>

.overlay {
  position: fixed;
  width: 100%;
  height: 100%;
  top: 0;
  left: 0;
  background: white;

  opacity: 1;
  visibility: visible;

  display: flex;
  flex-flow: column;
  justify-content: center;
  z-index: 2147483647 /* MaxInt32 */

}

.container {
  position: relative;
  margin-left: auto;
  margin-right: auto;
  max-width: 420px;
  padding: 2em;
}

h1 {
  text-decoration: underline;
  text-decoration-color: hsl(0,100%,40%);
  -webkit-text-decoration-color: hsl(0,100%,40%);
  margin-bottom: 1em;
  line-height: 1.5em;
}

input[type="password"] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
  -webkit-box-shadow: none;
  -moz-box-shadow: none;
  box-shadow: none;
  -webkit-border-radius: none;
  -moz-border-radius: none;
  -ms-border-radius: none;
  -o-border-radius: none;
  border-radius: none;
  outline: none;

  font-size: 18px;
  background: none;
  width: 25%;
  padding: 10px;
  border: none;
  border-bottom: solid 2px #999;
  transition: border .3s;
}

input[type="password"]:focus {
  border-bottom: solid 2px #333;
}

input[type="password"].wrong {
  border-bottom: solid 2px hsl(0,100%,40%);
}

p small {
  color: #888;
}

.logo {
  position: relative;
  font-size: 1.5em;
  margin-bottom: 3em;
}

.logo svg {
  width: 36px;
  position: relative;
  top: 6px;
  margin-right: 2px;
}

.logo svg path {
  fill: none;
  stroke: black;
  stroke-width: 2px;
}

</style>

<div class="overlay">
  <div class="container">
    <h1>This article is in review.</h1>
    <p>Do not share this URL or the contents of this article. Thank you!</p>
    <input id="interstitial-password-input" type="password" name="password" autofocus/>
    <p><small>Enter the password we shared with you as part of the review process to view the article.</small></p>
  </div>
</div>
`);class $i extends Ki(HTMLElement){connectedCallback(){if(this.shouldRemoveSelf())this.parentElement.removeChild(this);else{const e=this.root.querySelector('#interstitial-password-input');e.oninput=(e)=>this.passwordChanged(e)}}passwordChanged(e){const t=e.target.value;t===this.password&&(console.log('Correct password entered.'),this.parentElement.removeChild(this),'undefined'!=typeof Storage&&(console.log('Saved that correct password was entered.'),localStorage.setItem(this.localStorageIdentifier(),'true')))}shouldRemoveSelf(){return window&&window.location.hostname==='distill.pub'?(console.warn('Interstitial found on production, hiding it.'),!0):'undefined'!=typeof Storage&&'true'===localStorage.getItem(this.localStorageIdentifier())&&(console.log('Loaded that correct password was entered before; skipping interstitial.'),!0)}localStorageIdentifier(){return'distill-drafts'+(window?window.location.pathname:'-')+'interstitial-password-correct'}}var Xi=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Ji=function(e){return 1===e.length&&(e=v(e)),{left:function(t,n,i,a){for(null==i&&(i=0),null==a&&(a=t.length);i<a;){var d=i+a>>>1;0>e(t[d],n)?i=d+1:a=d}return i},right:function(t,n,i,a){for(null==i&&(i=0),null==a&&(a=t.length);i<a;){var d=i+a>>>1;0<e(t[d],n)?a=d:i=d+1}return i}}}(Xi),Qi=Ji.right,Zi=function(e,t,a){e=+e,t=+t,a=2>(i=arguments.length)?(t=e,e=0,1):3>i?1:+a;for(var d=-1,i=0|Rn(0,qn((t-e)/a)),n=Array(i);++d<i;)n[d]=e+d*a;return n},Gi=7.0710678118654755,ea=3.1622776601683795,ta=1.4142135623730951,na=function(e,t,a){var d,r,n,o,l=-1;if(t=+t,e=+e,a=+a,e===t&&0<a)return[e];if((d=t<e)&&(r=e,e=t,t=r),0===(o=w(e,t,a))||!isFinite(o))return[];if(0<o)for(e=qn(e/o),t=Fn(t/o),n=Array(r=qn(t-e+1));++l<r;)n[l]=(e+l)*o;else for(e=Fn(e*o),t=qn(t*o),n=Array(r=qn(e-t+1));++l<r;)n[l]=(e-l)/o;return d&&n.reverse(),n},ia=Array.prototype,aa=ia.map,da=ia.slice,ra=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e},oa=0.7,la=1/oa,sa=/^#([0-9a-f]{3})$/,ca=/^#([0-9a-f]{6})$/,ua=/^rgb\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*\)$/,pa=/^rgb\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,ga=/^rgba\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,fa=/^rgba\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,ha=/^hsl\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*\)$/,ba=/^hsla\(\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)%\s*,\s*([+-]?\d*\.?\d+(?:[eE][+-]?\d+)?)\s*\)$/,ma={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ra(L,M,{displayable:function(){return this.rgb().displayable()},toString:function(){return this.rgb()+''}}),ra(j,N,_(L,{brighter:function(e){return e=null==e?la:In(la,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?oa:In(oa,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&255>=this.r&&0<=this.g&&255>=this.g&&0<=this.b&&255>=this.b&&0<=this.opacity&&1>=this.opacity},toString:function(){var e=this.opacity;return e=isNaN(e)?1:Rn(0,Hn(1,e)),(1===e?'rgb(':'rgba(')+Rn(0,Hn(255,Pn(this.r)||0))+', '+Rn(0,Hn(255,Pn(this.g)||0))+', '+Rn(0,Hn(255,Pn(this.b)||0))+(1===e?')':', '+e+')')}})),ra(F,function(e,t,n,i){return 1===arguments.length?q(e):new F(e,t,n,null==i?1:i)},_(L,{brighter:function(e){return e=null==e?la:In(la,e),new F(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?oa:In(oa,e),new F(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(0>this.h),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(0.5>n?n:1-n)*t,a=2*n-i;return new j(P(240<=e?e-240:e+120,a,i),P(e,a,i),P(120>e?e+240:e-120,a,i),this.opacity)},displayable:function(){return(0<=this.s&&1>=this.s||isNaN(this.s))&&0<=this.l&&1>=this.l&&0<=this.opacity&&1>=this.opacity}}));var ya=On/180,xa=180/On,ka=18,Kn=0.95047,Xn=1,Yn=1.08883,Zn=4/29,va=6/29,wa=3*va*va,Sa=va*va*va;ra(Y,function(e,t,n,i){return 1===arguments.length?H(e):new Y(e,t,n,null==i?1:i)},_(L,{brighter:function(e){return new Y(this.l+ka*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new Y(this.l-ka*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return e=Xn*V(e),t=Kn*V(t),n=Yn*V(n),new j(K(3.2404542*t-1.5371385*e-0.4985314*n),K(-0.969266*t+1.8760108*e+0.041556*n),K(0.0556434*t-0.2040259*e+1.0572252*n),this.opacity)}})),ra(X,function(e,t,n,i){return 1===arguments.length?z(e):new X(e,t,n,null==i?1:i)},_(L,{brighter:function(e){return new X(this.h,this.c,this.l+ka*(null==e?1:e),this.opacity)},darker:function(e){return new X(this.h,this.c,this.l-ka*(null==e?1:e),this.opacity)},rgb:function(){return H(this).rgb()}}));var Ca=-0.14861,A=+1.78277,B=-0.29227,C=-0.90649,D=+1.97294,E=D*C,Ta=D*A,_a=A*B-C*Ca;ra(Z,Q,_(L,{brighter:function(e){return e=null==e?la:In(la,e),new Z(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?oa:In(oa,e),new Z(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*ya,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),i=Mn(e),a=Dn(e);return new j(255*(t+n*(Ca*i+A*a)),255*(t+n*(B*i+C*a)),255*(t+n*(D*i)),this.opacity)}}));var La=function(e){return function(){return e}},Aa=function e(t){function n(e,t){var n=i((e=N(e)).r,(t=N(t)).r),a=i(e.g,t.g),d=i(e.b,t.b),r=ne(e.opacity,t.opacity);return function(i){return e.r=n(i),e.g=a(i),e.b=d(i),e.opacity=r(i),e+''}}var i=te(t);return n.gamma=e,n}(1),Ea=function(e,t){var n,i=t?t.length:0,a=e?Hn(i,e.length):0,d=Array(i),r=Array(i);for(n=0;n<a;++n)d[n]=ja(e[n],t[n]);for(;n<i;++n)r[n]=t[n];return function(e){for(n=0;n<a;++n)r[n]=d[n](e);return r}},Da=function(e,n){var i=new Date;return e=+e,n-=e,function(a){return i.setTime(e+n*a),i}},Ma=function(e,n){return e=+e,n-=e,function(i){return e+n*i}},Oa=function(e,t){var n,d={},i={};for(n in(null===e||'object'!=typeof e)&&(e={}),(null===t||'object'!=typeof t)&&(t={}),t)n in e?d[n]=ja(e[n],t[n]):i[n]=t[n];return function(e){for(n in d)i[n]=d[n](e);return i}},Ua=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ia=new RegExp(Ua.source,'g'),Na=function(e,n){var t,a,d,r=Ua.lastIndex=Ia.lastIndex=0,o=-1,l=[],s=[];for(e+='',n+='';(t=Ua.exec(e))&&(a=Ia.exec(n));)(d=a.index)>r&&(d=n.slice(r,d),l[o]?l[o]+=d:l[++o]=d),(t=t[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,s.push({i:o,x:Ma(t,a)})),r=Ia.lastIndex;return r<n.length&&(d=n.slice(r),l[o]?l[o]+=d:l[++o]=d),2>l.length?s[0]?ae(s[0].x):ie(n):(n=s.length,function(e){for(var t,a=0;a<n;++a)l[(t=s[a]).i]=t.x(e);return l.join('')})},ja=function(e,n){var i,a=typeof n;return null==n||'boolean'==a?La(n):('number'==a?Ma:'string'==a?(i=M(n))?(n=i,Aa):Na:n instanceof M?Aa:n instanceof Date?Da:Array.isArray(n)?Ea:'function'!=typeof n.valueOf&&'function'!=typeof n.toString||isNaN(n)?Oa:Ma)(e,n)},Ra=function(e,n){return e=+e,n-=e,function(i){return Pn(e+n*i)}};de(function(e,t){var n=t-e;return n?G(e,180<n||-180>n?n-360*Pn(n/360):n):La(isNaN(e)?t:e)});var qa,Fa=de(ne),Pa=function(e){return function(){return e}},Ha=function(e){return+e},za=[0,1],Ya=function(e,t){if(0>(n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf('e')))return null;var n,i=e.slice(0,n);return[1<i.length?i[0]+i.slice(2):i,+e.slice(n+1)]},Ba=function(e){return e=Ya(Un(e)),e?e[1]:NaN},Wa=function(e,n){return function(a,d){for(var r=a.length,i=[],t=0,o=e[0],l=0;0<r&&0<o&&(l+o+1>d&&(o=Rn(1,d-l)),i.push(a.substring(r-=o,r+o)),!((l+=o+1)>d));)o=e[t=(t+1)%e.length];return i.reverse().join(n)}},Va=function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}},Ka=function(e,t){var n=Ya(e,t);if(!n)return e+'';var i=n[0],a=n[1];return 0>a?'0.'+Array(-a).join('0')+i:i.length>a+1?i.slice(0,a+1)+'.'+i.slice(a+1):i+Array(a-i.length+2).join('0')},$a={"":function(e,t){e=e.toPrecision(t);out:for(var a,d=e.length,n=1,i=-1;n<d;++n)switch(e[n]){case'.':i=a=n;break;case'0':0===i&&(i=n),a=n;break;case'e':break out;default:0<i&&(i=0);}return 0<i?e.slice(0,i)+e.slice(a+1):e},"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Pn(e).toString(2)},c:function(e){return e+''},d:function(e){return Pn(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Pn(e).toString(8)},p:function(e,t){return Ka(100*e,t)},r:Ka,s:function(e,t){var a=Ya(e,t);if(!a)return e+'';var r=a[0],o=a[1],l=o-(qa=3*Rn(-8,Hn(8,Fn(o/3))))+1,i=r.length;return l===i?r:l>i?r+Array(l-i+1).join('0'):0<l?r.slice(0,l)+'.'+r.slice(l):'0.'+Array(1-l).join('0')+Ya(e,Rn(0,t+l-1))[0]},X:function(e){return Pn(e).toString(16).toUpperCase()},x:function(e){return Pn(e).toString(16)}},Xa=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?([a-z%])?$/i;fe.prototype=he.prototype,he.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?'0':'')+(null==this.width?'':Rn(1,0|this.width))+(this.comma?',':'')+(null==this.precision?'':'.'+Rn(0,0|this.precision))+this.type};var re,Ja,Qa,Za=function(e){return e},Ga=['y','z','a','f','p','n','\xB5','m','','k','M','G','T','P','E','Z','Y'],ed=function(e){function t(e){function t(e){var t,i,n,c=b,k=m;if('c'===h)k=y(e)+k,e='';else{e=+e;var v=0>e;if(e=y(Un(e),f),v&&0==+e&&(v=!1),c=(v?'('===s?s:'-':'-'===s||'('===s?'':s)+c,k=k+('s'===h?Ga[8+qa/3]:'')+(v&&'('===s?')':''),x)for(t=-1,i=e.length;++t<i;)if(n=e.charCodeAt(t),48>n||57<n){k=(46===n?d+e.slice(t+1):e.slice(t))+k,e=e.slice(0,t);break}}g&&!u&&(e=a(e,Infinity));var w=c.length+e.length+k.length,S=w<p?Array(p-w+1).join(o):'';switch(g&&u&&(e=a(S+e,S.length?p-k.length:Infinity),S=''),l){case'<':e=c+e+k+S;break;case'=':e=c+S+e+k;break;case'^':e=S.slice(0,w=S.length>>1)+c+e+k+S.slice(w);break;default:e=S+c+e+k;}return r(e)}e=fe(e);var o=e.fill,l=e.align,s=e.sign,c=e.symbol,u=e.zero,p=e.width,g=e.comma,f=e.precision,h=e.type,b='$'===c?n[0]:'#'===c&&/[boxX]/.test(h)?'0'+h.toLowerCase():'',m='$'===c?n[1]:/[%p]/.test(h)?i:'',y=$a[h],x=!h||/[defgprs%]/.test(h);return f=null==f?h?6:12:/[gprs]/.test(h)?Rn(1,Hn(21,f)):Rn(0,Hn(20,f)),t.toString=function(){return e+''},t}var a=e.grouping&&e.thousands?Wa(e.grouping,e.thousands):Za,n=e.currency,d=e.decimal,r=e.numerals?Va(e.numerals):Za,i=e.percent||'%';return{format:t,formatPrefix:function(n,i){var a=t((n=fe(n),n.type='f',n)),d=3*Rn(-8,Hn(8,Fn(Ba(i)/3))),r=In(10,-d),o=Ga[8+d/3];return function(e){return a(r*e)+o}}}};(function(e){return re=ed(e),Ja=re.format,Qa=re.formatPrefix,re})({decimal:'.',thousands:',',grouping:[3],currency:['$','']});var td=function(e){return Rn(0,-Ba(Un(e)))},nd=function(e,t){return Rn(0,3*Rn(-8,Hn(8,Fn(Ba(t)/3)))-Ba(Un(e)))},id=function(e,t){return e=Un(e),t=Un(t)-e,Rn(0,Ba(t)-Ba(e))+1},ad=function(e,t,n){var i,a=e[0],d=e[e.length-1],r=S(a,d,null==t?10:t);switch(n=fe(null==n?',f':n),n.type){case's':{var o=Rn(Un(a),Un(d));return null!=n.precision||isNaN(i=nd(r,o))||(n.precision=i),Qa(n,o)}case'':case'e':case'g':case'p':case'r':{null!=n.precision||isNaN(i=id(r,Rn(Un(a),Un(d))))||(n.precision=i-('e'===n.type));break}case'f':case'%':{null!=n.precision||isNaN(i=td(r))||(n.precision=i-2*('%'===n.type));break}}return Ja(n)},dd=new Date,rd=new Date,od=ye(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});od.every=function(e){return e=Fn(e),isFinite(e)&&0<e?1<e?ye(function(t){t.setTime(Fn(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):od:null};var ld=1e3,sd=6e4,cd=36e5,ud=864e5,pd=6048e5,gd=ye(function(e){e.setTime(Fn(e/ld)*ld)},function(e,t){e.setTime(+e+t*ld)},function(e,t){return(t-e)/ld},function(e){return e.getUTCSeconds()}),fd=ye(function(e){e.setTime(Fn(e/sd)*sd)},function(e,t){e.setTime(+e+t*sd)},function(e,t){return(t-e)/sd},function(e){return e.getMinutes()}),hd=ye(function(e){var t=e.getTimezoneOffset()*sd%cd;0>t&&(t+=cd),e.setTime(Fn((+e-t)/cd)*cd+t)},function(e,t){e.setTime(+e+t*cd)},function(e,t){return(t-e)/cd},function(e){return e.getHours()}),bd=ye(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sd)/ud},function(e){return e.getDate()-1}),md=xe(0),yd=xe(1),xd=xe(2),kd=xe(3),vd=xe(4),wd=xe(5),Sd=xe(6),Cd=ye(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),Td=ye(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Td.every=function(e){return isFinite(e=Fn(e))&&0<e?ye(function(t){t.setFullYear(Fn(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var _d=ye(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*sd)},function(e,t){return(t-e)/sd},function(e){return e.getUTCMinutes()}),Ld=ye(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*cd)},function(e,t){return(t-e)/cd},function(e){return e.getUTCHours()}),Ad=ye(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/ud},function(e){return e.getUTCDate()-1}),Ed=ke(0),Dd=ke(1),Md=ke(2),Od=ke(3),Ud=ke(4),Id=ke(5),Nd=ke(6),jd=ye(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),Rd=ye(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Rd.every=function(e){return isFinite(e=Fn(e))&&0<e?ye(function(t){t.setUTCFullYear(Fn(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var qd,Fd,Pd,Hd={0:'0',"-":'',_:' '},zd=/^\s*\d+/,Yd=/^%/,Bd=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;(function(e){return qd=Ce(e),Fd=qd.utcFormat,Pd=qd.utcParse,qd})({dateTime:'%x, %X',date:'%-m/%-d/%Y',time:'%-I:%M:%S %p',periods:['AM','PM'],days:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],shortDays:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],months:['January','February','March','April','May','June','July','August','September','October','November','December'],shortMonths:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']});var Wd='%Y-%m-%dT%H:%M:%S.%LZ',Vd=Date.prototype.toISOString?function(e){return e.toISOString()}:Fd(Wd),Kd=+new Date('2000-01-01T00:00:00.000Z')?function(e){var t=new Date(e);return isNaN(t)?null:t}:Pd(Wd),$d=function(e){return e.match(/.{6}/g).map(function(e){return'#'+e})};$d('1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf'),$d('393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6'),$d('3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9'),$d('1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5'),Fa(Q(300,0.5,0),Q(-240,0.5,1));var Xd=Fa(Q(-100,0.75,0.35),Q(80,1.5,0.8)),Jd=Fa(Q(260,0.75,0.35),Q(80,1.5,0.8)),Qd=Q();yt($d('44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725'));var Zd=yt($d('00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf')),Gd=yt($d('00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4')),er=yt($d('0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921')),tr={value:function(){}};kt.prototype=xt.prototype={constructor:kt,on:function(e,a){var d,t=this._,r=vt(e+'',t),o=-1,i=r.length;if(2>arguments.length){for(;++o<i;)if((d=(e=r[o]).type)&&(d=wt(t[d],e.name)))return d;return}if(null!=a&&'function'!=typeof a)throw new Error('invalid callback: '+a);for(;++o<i;)if(d=(e=r[o]).type)t[d]=St(t[d],e.name,a);else if(null==a)for(d in t)t[d]=St(t[d],e.name,null);return this},copy:function(){var e={},n=this._;for(var i in n)e[i]=n[i].slice();return new kt(e)},call:function(e,a){if(0<(d=arguments.length-2))for(var d,n,t=Array(d),r=0;r<d;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error('unknown type: '+e);for(n=this._[e],r=0,d=n.length;r<d;++r)n[r].value.apply(a,t)},apply:function(e,a,d){if(!this._.hasOwnProperty(e))throw new Error('unknown type: '+e);for(var r=this._[e],t=0,i=r.length;t<i;++t)r[t].value.apply(a,d)}};var nr='http://www.w3.org/1999/xhtml',ir={svg:'http://www.w3.org/2000/svg',xhtml:nr,xlink:'http://www.w3.org/1999/xlink',xml:'http://www.w3.org/XML/1998/namespace',xmlns:'http://www.w3.org/2000/xmlns/'},ar=function(e){var t=e+='',n=t.indexOf(':');return 0<=n&&'xmlns'!==(t=e.slice(0,n))&&(e=e.slice(n+1)),ir.hasOwnProperty(t)?{space:ir[t],local:e}:e},dr=function(e){var t=ar(e);return(t.local?Tt:Ct)(t)},rr=function(e){return function(){return this.matches(e)}};if('undefined'!=typeof document){var or=document.documentElement;if(!or.matches){var lr=or.webkitMatchesSelector||or.msMatchesSelector||or.mozMatchesSelector||or.oMatchesSelector;rr=function(e){return function(){return lr.call(this,e)}}}}var sr=rr,cr={},ur=null;if('undefined'!=typeof document){var pr=document.documentElement;'onmouseenter'in pr||(cr={mouseenter:'mouseover',mouseleave:'mouseout'})}var gr=function(){for(var e,t=ur;e=t.sourceEvent;)t=e;return t},fr=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]},hr=function(e){var t=gr();return t.changedTouches&&(t=t.changedTouches[0]),fr(e,t)},br=function(e){return null==e?Ot:function(){return this.querySelector(e)}},mr=function(e){return null==e?Ut:function(){return this.querySelectorAll(e)}},yr=function(e){return Array(e.length)};It.prototype={constructor:It,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var xr=function(e){return function(){return e}},kr='$',vr=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};Gt.prototype={add:function(e){var t=this._names.indexOf(e);0>t&&(this._names.push(e),this._node.setAttribute('class',this._names.join(' ')))},remove:function(e){var t=this._names.indexOf(e);0<=t&&(this._names.splice(t,1),this._node.setAttribute('class',this._names.join(' ')))},contains:function(e){return 0<=this._names.indexOf(e)}};var wr=[null];xn.prototype=function(){return new xn([[document.documentElement]],wr)}.prototype={constructor:xn,select:function(e){'function'!=typeof e&&(e=br(e));for(var t=this._groups,a=t.length,d=Array(a),r=0;r<a;++r)for(var o,l,s=t[r],c=s.length,n=d[r]=Array(c),u=0;u<c;++u)(o=s[u])&&(l=e.call(o,o.__data__,u,s))&&('__data__'in o&&(l.__data__=o.__data__),n[u]=l);return new xn(d,this._parents)},selectAll:function(e){'function'!=typeof e&&(e=mr(e));for(var t=this._groups,a=t.length,d=[],r=[],o=0;o<a;++o)for(var l,s=t[o],c=s.length,n=0;n<c;++n)(l=s[n])&&(d.push(e.call(l,l.__data__,n,s)),r.push(l));return new xn(d,r)},filter:function(e){'function'!=typeof e&&(e=sr(e));for(var t=this._groups,a=t.length,d=Array(a),r=0;r<a;++r)for(var o,l=t[r],s=l.length,n=d[r]=[],c=0;c<s;++c)(o=l[c])&&e.call(o,o.__data__,c,l)&&n.push(o);return new xn(d,this._parents)},data:function(e,t){if(!e)return g=Array(this.size()),s=-1,this.each(function(e){g[++s]=e}),g;var n=t?jt:Nt,i=this._parents,a=this._groups;'function'!=typeof e&&(e=xr(e));for(var d=a.length,r=Array(d),o=Array(d),l=Array(d),s=0;s<d;++s){var c=i[s],u=a[s],p=u.length,g=e.call(c,c&&c.__data__,s,i),f=g.length,h=o[s]=Array(f),b=r[s]=Array(f),m=l[s]=Array(p);n(c,u,h,b,m,g,t);for(var y,x,k=0,v=0;k<f;++k)if(y=h[k]){for(k>=v&&(v=k+1);!(x=b[v])&&++v<f;);y._next=x||null}}return r=new xn(r,i),r._enter=o,r._exit=l,r},enter:function(){return new xn(this._enter||this._groups.map(yr),this._parents)},exit:function(){return new xn(this._exit||this._groups.map(yr),this._parents)},merge:function(e){for(var t=this._groups,a=e._groups,d=t.length,r=a.length,o=Hn(d,r),l=Array(d),s=0;s<o;++s)for(var c,u=t[s],p=a[s],g=u.length,n=l[s]=Array(g),f=0;f<g;++f)(c=u[f]||p[f])&&(n[f]=c);for(;s<d;++s)l[s]=t[s];return new xn(l,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var a,d=e[t],r=d.length-1,i=d[r];0<=--r;)(a=d[r])&&(i&&i!==a.nextSibling&&i.parentNode.insertBefore(a,i),i=a);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=Rt);for(var a=this._groups,d=a.length,r=Array(d),o=0;o<d;++o){for(var l,s=a[o],c=s.length,n=r[o]=Array(c),u=0;u<c;++u)(l=s[u])&&(n[u]=l);n.sort(t)}return new xn(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,a=e.length;t<a;++t)for(var d,r=e[t],o=0,i=r.length;o<i;++o)if(d=r[o],d)return d;return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,a=0,d=t.length;a<d;++a)for(var r,o=t[a],l=0,i=o.length;l<i;++l)(r=o[l])&&e.call(r,r.__data__,l,o);return this},attr:function(e,t){var n=ar(e);if(2>arguments.length){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==t?n.local?Ft:qt:'function'==typeof t?n.local?Yt:zt:n.local?Ht:Pt)(n,t))},style:function(e,t,n){return 1<arguments.length?this.each((null==t?Bt:'function'==typeof t?Vt:Wt)(e,t,null==n?'':n)):Kt(this.node(),e)},property:function(e,t){return 1<arguments.length?this.each((null==t?$t:'function'==typeof t?Jt:Xt)(e,t)):this.node()[e]},classed:function(e,t){var a=Qt(e+'');if(2>arguments.length){for(var d=Zt(this.node()),r=-1,i=a.length;++r<i;)if(!d.contains(a[r]))return!1;return!0}return this.each(('function'==typeof t?dn:t?nn:an)(a,t))},text:function(e){return arguments.length?this.each(null==e?rn:('function'==typeof e?ln:on)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?sn:('function'==typeof e?un:cn)(e)):this.node().innerHTML},raise:function(){return this.each(pn)},lower:function(){return this.each(gn)},append:function(e){var t='function'==typeof e?e:dr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n='function'==typeof e?e:dr(e),i=null==t?fn:'function'==typeof t?t:br(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function(){return this.each(hn)},datum:function(e){return arguments.length?this.property('__data__',e):this.node().__data__},on:function(e,a,d){var r,i,t=At(e+''),l=t.length;if(2>arguments.length){var n=this.node().__on;if(n)for(var s,o=0,c=n.length;o<c;++o)for(r=0,s=n[o];r<l;++r)if((i=t[r]).type===s.type&&i.name===s.name)return s.value;return}for(n=a?Dt:Et,null==d&&(d=!1),r=0;r<l;++r)this.each(n(t[r],a,d));return this},dispatch:function(e,t){return this.each(('function'==typeof t?yn:mn)(e,t))}};var Sr=function(e){return'string'==typeof e?new xn([[document.querySelector(e)]],[document.documentElement]):new xn([[e]],wr)},Cr=function(e,t,a){3>arguments.length&&(a=t,t=gr().changedTouches);for(var d,r=0,i=t?t.length:0;r<i;++r)if((d=t[r]).identifier===a)return fr(e,d);return null},Tr=function(){ur.preventDefault(),ur.stopImmediatePropagation()},_r=function(e){var t=e.document.documentElement,n=Sr(e).on('dragstart.drag',Tr,!0);'onselectstart'in t?n.on('selectstart.drag',Tr,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect='none')},Lr=function(e){return function(){return e}};wn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Ar=function(){function e(e){e.on('mousedown.drag',t).filter(h).on('touchstart.drag',a).on('touchmove.drag',d).on('touchend.drag touchcancel.drag',r).style('touch-action','none').style('-webkit-tap-highlight-color','rgba(0,0,0,0)')}function t(){if(!u&&p.apply(this,arguments)){var e=o('mouse',g.apply(this,arguments),hr,this,arguments);e&&(Sr(ur.view).on('mousemove.drag',n,!0).on('mouseup.drag',i,!0),_r(ur.view),kn(),c=!1,l=ur.clientX,s=ur.clientY,e('start'))}}function n(){if(Tr(),!c){var e=ur.clientX-l,t=ur.clientY-s;c=e*e+t*t>x}b.mouse('drag')}function i(){Sr(ur.view).on('mousemove.drag mouseup.drag',null),vn(ur.view,c),Tr(),b.mouse('end')}function a(){if(p.apply(this,arguments)){var e,t,i=ur.changedTouches,a=g.apply(this,arguments),d=i.length;for(e=0;e<d;++e)(t=o(i[e].identifier,a,Cr,this,arguments))&&(kn(),t('start'))}}function d(){var e,t,i=ur.changedTouches,a=i.length;for(e=0;e<a;++e)(t=b[i[e].identifier])&&(Tr(),t('drag'))}function r(){var e,t,i=ur.changedTouches,a=i.length;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),e=0;e<a;++e)(t=b[i[e].identifier])&&(kn(),t('end'))}function o(t,i,a,d,r){var o,l,s,c=a(i,t),u=m.copy();return Mt(new wn(e,'beforestart',o,t,y,c[0],c[1],0,0,u),function(){return null!=(ur.subject=o=f.apply(d,r))&&(l=o.x-c[0]||0,s=o.y-c[1]||0,!0)})?function p(g){var f,n=c;switch(g){case'start':b[t]=p,f=y++;break;case'end':delete b[t],--y;case'drag':c=a(i,t),f=y;}Mt(new wn(e,g,o,t,f,c[0]+l,c[1]+s,c[0]-n[0],c[1]-n[1],u),u.apply,u,[g,d,r])}:void 0}var l,s,c,u,p=Sn,g=Cn,f=Tn,h=_n,b={},m=xt('start','drag','end'),y=0,x=0;return e.filter=function(t){return arguments.length?(p='function'==typeof t?t:Lr(!!t),e):p},e.container=function(t){return arguments.length?(g='function'==typeof t?t:Lr(t),e):g},e.subject=function(t){return arguments.length?(f='function'==typeof t?t:Lr(t),e):f},e.touchable=function(t){return arguments.length?(h='function'==typeof t?t:Lr(!!t),e):h},e.on=function(){var t=m.on.apply(m,arguments);return t===m?e:t},e.clickDistance=function(t){return arguments.length?(x=(t=+t)*t,e):An(x)},e};const Er=ti('d-slider',`
<style>
  :host {
    position: relative;
    display: inline-block;
  }

  :host(:focus) {
    outline: none;
  }

  .background {
    padding: 9px 0;
    color: white;
    position: relative;
  }

  .track {
    height: 3px;
    width: 100%;
    border-radius: 2px;
    background-color: hsla(0, 0%, 0%, 0.2);
  }

  .track-fill {
    position: absolute;
    top: 9px;
    height: 3px;
    border-radius: 4px;
    background-color: hsl(24, 100%, 50%);
  }

  .knob-container {
    position: absolute;
    top: 10px;
  }

  .knob {
    position: absolute;
    top: -6px;
    left: -6px;
    width: 13px;
    height: 13px;
    background-color: hsl(24, 100%, 50%);
    border-radius: 50%;
    transition-property: transform;
    transition-duration: 0.18s;
    transition-timing-function: ease;
  }
  .mousedown .knob {
    transform: scale(1.5);
  }

  .knob-highlight {
    position: absolute;
    top: -6px;
    left: -6px;
    width: 13px;
    height: 13px;
    background-color: hsla(0, 0%, 0%, 0.1);
    border-radius: 50%;
    transition-property: transform;
    transition-duration: 0.18s;
    transition-timing-function: ease;
  }

  .focus .knob-highlight {
    transform: scale(2);
  }

  .ticks {
    position: absolute;
    top: 16px;
    height: 4px;
    width: 100%;
    z-index: -1;
  }

  .ticks .tick {
    position: absolute;
    height: 100%;
    border-left: 1px solid hsla(0, 0%, 0%, 0.2);
  }

</style>

  <div class='background'>
    <div class='track'></div>
    <div class='track-fill'></div>
    <div class='knob-container'>
      <div class='knob-highlight'></div>
      <div class='knob'></div>
    </div>
    <div class='ticks'></div>
  </div>
`),Dr={left:37,up:38,right:39,down:40,pageUp:33,pageDown:34,end:35,home:36};class Mr extends Er(HTMLElement){connectedCallback(){this.connected=!0,this.setAttribute('role','slider'),this.hasAttribute('tabindex')||this.setAttribute('tabindex',0),this.mouseEvent=!1,this.knob=this.root.querySelector('.knob-container'),this.background=this.root.querySelector('.background'),this.trackFill=this.root.querySelector('.track-fill'),this.track=this.root.querySelector('.track'),this.min=this.min?this.min:0,this.max=this.max?this.max:100,this.scale=me().domain([this.min,this.max]).range([0,1]).clamp(!0),this.origin=this.origin===void 0?this.min:this.origin,this.step=this.step?this.step:1,this.update(this.value?this.value:0),this.ticks=!!this.ticks&&this.ticks,this.renderTicks(),this.drag=Ar().container(this.background).on('start',()=>{this.mouseEvent=!0,this.background.classList.add('mousedown'),this.changeValue=this.value,this.dragUpdate()}).on('drag',()=>{this.dragUpdate()}).on('end',()=>{this.mouseEvent=!1,this.background.classList.remove('mousedown'),this.dragUpdate(),this.changeValue!==this.value&&this.dispatchChange(),this.changeValue=this.value}),this.drag(Sr(this.background)),this.addEventListener('focusin',()=>{this.mouseEvent||this.background.classList.add('focus')}),this.addEventListener('focusout',()=>{this.background.classList.remove('focus')}),this.addEventListener('keydown',this.onKeyDown)}static get observedAttributes(){return['min','max','value','step','ticks','origin','tickValues','tickLabels']}attributeChangedCallback(e,t,n){isNaN(n)||void 0===n||null===n||('min'==e&&(this.min=+n,this.setAttribute('aria-valuemin',this.min)),'max'==e&&(this.max=+n,this.setAttribute('aria-valuemax',this.max)),'value'==e&&this.update(+n),'origin'==e&&(this.origin=+n),'step'==e&&0<n&&(this.step=+n),'ticks'==e&&(this.ticks=!(''!==n)||n))}onKeyDown(e){this.changeValue=this.value;let t=!1;switch(e.keyCode){case Dr.left:case Dr.down:this.update(this.value-this.step),t=!0;break;case Dr.right:case Dr.up:this.update(this.value+this.step),t=!0;break;case Dr.pageUp:this.update(this.value+10*this.step),t=!0;break;case Dr.pageDown:this.update(this.value+10*this.step),t=!0;break;case Dr.home:this.update(this.min),t=!0;break;case Dr.end:this.update(this.max),t=!0;break;default:}t&&(this.background.classList.add('focus'),e.preventDefault(),e.stopPropagation(),this.changeValue!==this.value&&this.dispatchChange())}validateValueRange(e,t,n){return Rn(Hn(t,n),e)}quantizeValue(e,t){return Pn(e/t)*t}dragUpdate(){const e=this.background.getBoundingClientRect(),t=ur.x,n=e.width;this.update(this.scale.invert(t/n))}update(e){let t=e;'any'!==this.step&&(t=this.quantizeValue(e,this.step)),t=this.validateValueRange(this.min,this.max,t),this.connected&&(this.knob.style.left=100*this.scale(t)+'%',this.trackFill.style.width=100*this.scale(this.min+Un(t-this.origin))+'%',this.trackFill.style.left=100*this.scale(Hn(t,this.origin))+'%'),this.value!==t&&(this.value=t,this.setAttribute('aria-valuenow',this.value),this.dispatchInput())}dispatchChange(){const t=new Event('change');this.dispatchEvent(t,{})}dispatchInput(){const t=new Event('input');this.dispatchEvent(t,{})}renderTicks(){const e=this.root.querySelector('.ticks');if(!1!==this.ticks){let t=[];t=0<this.ticks?this.scale.ticks(this.ticks):'any'===this.step?this.scale.ticks():Zi(this.min,this.max+1e-6,this.step),t.forEach((t)=>{const n=document.createElement('div');n.classList.add('tick'),n.style.left=100*this.scale(t)+'%',e.appendChild(n)})}else e.style.display='none'}}var Or='<svg viewBox="-607 419 64 64">\n  <path d="M-573.4,478.9c-8,0-14.6-6.4-14.6-14.5s14.6-25.9,14.6-40.8c0,14.9,14.6,32.8,14.6,40.8S-565.4,478.9-573.4,478.9z"/>\n</svg>\n';const Ur=ti('distill-header',`
<style>
distill-header {
  position: relative;
  height: 60px;
  background-color: hsl(200, 60%, 15%);
  width: 100%;
  box-sizing: border-box;
  z-index: 2;
  color: rgba(0, 0, 0, 0.8);
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  box-shadow: 0 1px 6px rgba(0, 0, 0, 0.05);
}
distill-header .content {
  height: 70px;
  grid-column: page;
}
distill-header a {
  font-size: 16px;
  height: 60px;
  line-height: 60px;
  text-decoration: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 22px 0;
}
distill-header a:hover {
  color: rgba(255, 255, 255, 1);
}
distill-header svg {
  width: 24px;
  position: relative;
  top: 4px;
  margin-right: 2px;
}
@media(min-width: 1080px) {
  distill-header {
    height: 70px;
  }
  distill-header a {
    height: 70px;
    line-height: 70px;
    padding: 28px 0;
  }
  distill-header .logo {
  }
}
distill-header svg path {
  fill: none;
  stroke: rgba(255, 255, 255, 0.8);
  stroke-width: 3px;
}
distill-header .logo {
  font-size: 17px;
  font-weight: 200;
}
distill-header .nav {
  float: right;
  font-weight: 300;
}
distill-header .nav a {
  font-size: 12px;
  margin-left: 24px;
  text-transform: uppercase;
}
</style>
<div class="content">
  <a href="/" class="logo">
    ${Or}
    Distill
  </a>
  <nav class="nav">
    <a href="/about/">About</a>
    <a href="/prize/">Prize</a>
    <a href="/journal/">Submit</a>
  </nav>
</div>
`,!1);class Ir extends Ur(HTMLElement){}const Nr=`
<style>
  distill-appendix {
    contain: layout style;
  }

  distill-appendix .citation {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  distill-appendix > * {
    grid-column: text;
  }
</style>
`;class jr extends HTMLElement{static get is(){return'distill-appendix'}set frontMatter(e){this.innerHTML=Ln(e)}}const Rr=ti('distill-footer',`
<style>

:host {
  color: rgba(255, 255, 255, 0.5);
  font-weight: 300;
  padding: 2rem 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  background-color: hsl(180, 5%, 15%); /*hsl(200, 60%, 15%);*/
  text-align: left;
  contain: content;
}

.logo svg {
  width: 24px;
  position: relative;
  top: 4px;
  margin-right: 2px;
}

.logo svg path {
  fill: none;
  stroke: rgba(255, 255, 255, 0.8);
  stroke-width: 3px;
}

.logo {
  font-size: 17px;
  font-weight: 200;
  color: rgba(255, 255, 255, 0.8);
  text-decoration: none;
  margin-right: 6px;
}

.container {
  grid-column: text;
}

.nav {
  font-size: 0.9em;
  margin-top: 1.5em;
}

.nav a {
  color: rgba(255, 255, 255, 0.8);
  margin-right: 6px;
  text-decoration: none;
}

</style>

<div class='container'>

  <a href="/" class="logo">
    ${Or}
    Distill
  </a> is dedicated to clear explanations of machine learning

  <div class="nav">
    <a href="https://distill.pub/about/">About</a>
    <a href="https://distill.pub/journal/">Submit</a>
    <a href="https://distill.pub/prize/">Prize</a>
    <a href="https://distill.pub/archive/">Archive</a>
    <a href="https://distill.pub/rss.xml">RSS</a>
    <a href="https://github.com/distillpub">GitHub</a>
    <a href="https://twitter.com/distillpub">Twitter</a>
    &nbsp;&nbsp;&nbsp;&nbsp; ISSN 2476-0757
  </div>

</div>

`);class qr extends Rr(HTMLElement){}const Fr=function(){if(1>window.distillRunlevel)throw new Error('Insufficient Runlevel for Distill Template!');if('distillTemplateIsLoading'in window&&window.distillTemplateIsLoading)throw new Error('Runlevel 1: Distill Template is getting loaded more than once, aborting!');else window.distillTemplateIsLoading=!0,console.info('Runlevel 1: Distill Template has started loading.');p(document),console.info('Runlevel 1: Static Distill styles have been added.'),console.info('Runlevel 1->2.'),window.distillRunlevel+=1;for(const[e,t]of Object.entries(hi.listeners))'function'==typeof t?document.addEventListener(e,t):console.error('Runlevel 2: Controller listeners need to be functions!');console.info('Runlevel 2: We can now listen to controller events.'),console.info('Runlevel 2->3.'),window.distillRunlevel+=1;if(2>window.distillRunlevel)throw new Error('Insufficient Runlevel for adding custom elements!');const e=[ki,wi,Ci,Li,Ai,Di,Oi,Ni,Ri,Fi,pi,Hi,zi,T,Bi,Wi,Vi,Mr,$i].concat([Ir,jr,qr]);for(const t of e)console.info('Runlevel 2: Registering custom element: '+t.is),customElements.define(t.is,t);console.info('Runlevel 3: Distill Template finished registering custom elements.'),console.info('Runlevel 3->4.'),window.distillRunlevel+=1,hi.listeners.DOMContentLoaded(),console.info('Runlevel 4: Distill Template initialisation complete.')};window.distillRunlevel=0,yi.browserSupportsAllFeatures()?(console.info('Runlevel 0: No need for polyfills.'),console.info('Runlevel 0->1.'),window.distillRunlevel+=1,Fr()):(console.info('Runlevel 0: Distill Template is loading polyfills.'),yi.load(Fr))});
//# sourceMappingURL=template.v2.js.map
}
</script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Cookbook for R","description":"My R/Python Code cookbook","authors":[{"author":"Matthew Son","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-08-27T00:00:00.000-04:00","citationText":"Son, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">Matthew Son</a>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../research.html">Research</a>
<a href="../../teaching.html">Teaching</a>
<a href="../../blog.html">Codes</a>
<a href="https://github.com/matthewgson">
<i class="fa fa-github" aria-hidden="true"></i>
</a>
<a href="https://stackoverflow.com/users/10484383/matthew-son">
<i class="fab fa-stack-overflow" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Testing</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>My R/Python Code cookbook</p></p>
</div>

<div class="d-byline">
  
  Matthew Son
  
<br />08-27-2022
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#custom-functions-use-cases" id="toc-custom-functions-use-cases">CUSTOM FUNCTIONS &amp; USE CASES</a>
<ul>
<li><a href="#descriptive-statistics" id="toc-descriptive-statistics">Descriptive Statistics</a></li>
<li><a href="#summary-statistics" id="toc-summary-statistics">Summary
Statistics</a></li>
<li><a href="#winsorize" id="toc-winsorize">Winsorize</a></li>
<li><a href="#standardize" id="toc-standardize">Standardize</a></li>
<li><a href="#linear-interpolation" id="toc-linear-interpolation">Linear
interpolation</a></li>
<li><a href="#fast-weighted-mean" id="toc-fast-weighted-mean">Fast
Weighted Mean</a></li>
<li><a href="#rowwise-median" id="toc-rowwise-median">Rowwise
Median</a></li>
<li><a href="#rowsums" id="toc-rowsums">rowSums</a></li>
<li><a href="#standard-error-of-mean" id="toc-standard-error-of-mean">Standard Error of mean</a></li>
<li><a href="#cumsum-ignoring-na" id="toc-cumsum-ignoring-na">Cumsum
ignoring NA</a></li>
<li><a href="#edgelist-generator" id="toc-edgelist-generator">Edgelist
generator</a></li>
<li><a href="#fund-flow-generator" id="toc-fund-flow-generator">Fund
flow generator</a></li>
<li><a href="#linear-interpolation-1" id="toc-linear-interpolation-1">Linear interpolation</a></li>
<li><a href="#decile-factorization" id="toc-decile-factorization">Decile
factorization</a></li>
<li><a href="#multiple-.sds" id="toc-multiple-.sds">Multiple
.SDs</a></li>
<li><a href="#time-interval-grouping" id="toc-time-interval-grouping">Time Interval Grouping</a></li>
<li><a href="#vector-splitting" id="toc-vector-splitting">Vector
Splitting</a></li>
<li><a href="#force-time-zone" id="toc-force-time-zone">Force Time
zone</a></li>
<li><a href="#fast-datetime-conversion" id="toc-fast-datetime-conversion">Fast date/time conversion</a></li>
</ul></li>
<li><a href="#r-compile-installation" id="toc-r-compile-installation">R
Compile &amp; Installation</a>
<ul>
<li><a href="#renviron-setup" id="toc-renviron-setup">Renviron
Setup</a></li>
<li><a href="#rprofile-setup" id="toc-rprofile-setup">Rprofile
Setup</a></li>
<li><a href="#rstudio-setup" id="toc-rstudio-setup">Rstudio Setup</a>
<ul>
<li><a href="#rstudio-ide-options" id="toc-rstudio-ide-options">RStudio
IDE options</a></li>
<li><a href="#view-column-limit" id="toc-view-column-limit">View column
limit</a></li>
</ul></li>
<li><a href="#rrstudio-removal-on-macos" id="toc-rrstudio-removal-on-macos">R/RStudio removal on MacOS</a></li>
<li><a href="#openmpdata.table-fst-for-macos" id="toc-openmpdata.table-fst-for-macos">OpenMP(data.table, fst) for
MacOS</a></li>
<li><a href="#rquantlib" id="toc-rquantlib">RQuantlib</a></li>
<li><a href="#rpostgres" id="toc-rpostgres">RPostgres</a></li>
<li><a href="#install-archived-packages" id="toc-install-archived-packages">Install Archived packages</a></li>
<li><a href="#rtools40-windows" id="toc-rtools40-windows">Rtools40
(Windows)</a></li>
<li><a href="#delete-all-user-installed-packages" id="toc-delete-all-user-installed-packages">Delete all User installed
packages</a></li>
<li><a href="#remove-miniconda-completely" id="toc-remove-miniconda-completely">Remove Miniconda
completely</a></li>
<li><a href="#arrow-with-snappy-compression" id="toc-arrow-with-snappy-compression">Arrow with snappy
compression</a></li>
<li><a href="#reticulate-python" id="toc-reticulate-python">RETICULATE
Python</a>
<ul>
<li><a href="#installation" id="toc-installation">Installation</a></li>
<li><a href="#mac" id="toc-mac">Mac</a></li>
<li><a href="#windows" id="toc-windows">Windows</a></li>
<li><a href="#conda-setup" id="toc-conda-setup">Conda setup</a></li>
</ul></li>
</ul></li>
<li><a href="#r-markdown" id="toc-r-markdown">R MARKDOWN</a>
<ul>
<li><a href="#beamer-examples" id="toc-beamer-examples">Beamer
EXAMPLES</a>
<ul>
<li><a href="#hide-section-slide" id="toc-hide-section-slide">Hide
Section slide</a></li>
<li><a href="#use-custom-style" id="toc-use-custom-style">Use custom
style</a></li>
</ul></li>
<li><a href="#article-example" id="toc-article-example">Article
example</a>
<ul>
<li><a href="#use-custeom-pandoc-template" id="toc-use-custeom-pandoc-template">Use Custeom Pandoc
Template</a></li>
<li><a href="#import-latex-packages" id="toc-import-latex-packages">Import LaTeX packages</a></li>
<li><a href="#prevent-floating" id="toc-prevent-floating">Prevent
floating</a></li>
<li><a href="#subfigures" id="toc-subfigures">Subfigures</a></li>
</ul></li>
<li><a href="#chunk-options" id="toc-chunk-options">chunk options</a>
<ul>
<li><a href="#global-chunk-options" id="toc-global-chunk-options">global
chunk options</a></li>
</ul></li>
<li><a href="#yaml-header" id="toc-yaml-header">YAML Header</a>
<ul>
<li><a href="#yaml-example" id="toc-yaml-example">YAML example</a></li>
<li><a href="#parameter" id="toc-parameter">parameter</a></li>
<li><a href="#style" id="toc-style">style</a></li>
</ul></li>
<li><a href="#markdown" id="toc-markdown">Markdown</a>
<ul>
<li><a href="#text" id="toc-text">text</a></li>
<li><a href="#hyperlink" id="toc-hyperlink">hyperlink</a></li>
<li><a href="#embed-image" id="toc-embed-image">embed image</a></li>
<li><a href="#latex" id="toc-latex">LaTeX</a></li>
</ul></li>
<li><a href="#kable-kableextra" id="toc-kable-kableextra">Kable
(KableExtra)</a>
<ul>
<li><a href="#table-digits-and-formatting" id="toc-table-digits-and-formatting">Table digits and
formatting</a></li>
<li><a href="#internal-links" id="toc-internal-links">Internal
links</a></li>
</ul></li>
</ul></li>
<li><a href="#base-r-rstudio" id="toc-base-r-rstudio">BASE R /
RStudio</a>
<ul>
<li><a href="#r-function-tricks" id="toc-r-function-tricks">R Function
Tricks</a>
<ul>
<li><a href="#expressions-to-string" id="toc-expressions-to-string">Expressions to string</a></li>
<li><a href="#assign-to-string-object" id="toc-assign-to-string-object">assign to string object</a></li>
<li><a href="#string-evaluation" id="toc-string-evaluation">string
evaluation</a></li>
</ul></li>
<li><a href="#options" id="toc-options">Options</a>
<ul>
<li><a href="#rprofile" id="toc-rprofile">.Rprofile</a></li>
<li><a href="#data.table-options" id="toc-data.table-options">data.table
options</a></li>
<li><a href="#str-options" id="toc-str-options">str options</a></li>
<li><a href="#reticulate-options" id="toc-reticulate-options">Reticulate
options</a></li>
</ul></li>
<li><a href="#data.frame" id="toc-data.frame">data.frame</a>
<ul>
<li><a href="#transpose-data.frame" id="toc-transpose-data.frame">transpose data.frame</a></li>
</ul></li>
<li><a href="#shquote" id="toc-shquote">shQuote</a></li>
<li><a href="#outer" id="toc-outer">outer</a></li>
<li><a href="#list.files" id="toc-list.files">list.files</a></li>
<li><a href="#str" id="toc-str">str</a></li>
<li><a href="#cut" id="toc-cut">cut</a></li>
<li><a href="#factor" id="toc-factor">factor</a>
<ul>
<li><a href="#unordered" id="toc-unordered">Unordered</a></li>
<li><a href="#ordered" id="toc-ordered">Ordered</a></li>
</ul></li>
<li><a href="#error-handling" id="toc-error-handling">Error Handling</a>
<ul>
<li><a href="#exists" id="toc-exists">exists()</a></li>
<li><a href="#stop" id="toc-stop">stop()</a></li>
<li><a href="#stopifnot" id="toc-stopifnot">stopifnot()</a></li>
<li><a href="#try" id="toc-try">try()</a></li>
<li><a href="#trycatch" id="toc-trycatch">tryCatch()</a></li>
</ul></li>
<li><a href="#rstudioapi" id="toc-rstudioapi">RStudioapi</a>
<ul>
<li><a href="#run-code-on-terminal" id="toc-run-code-on-terminal">run
code on terminal</a></li>
<li><a href="#increase-view-column-limit" id="toc-increase-view-column-limit">increase View column limit</a></li>
</ul></li>
</ul></li>
<li><a href="#benchmarking" id="toc-benchmarking">BENCHMARKING</a>
<ul>
<li><a href="#system-configurations" id="toc-system-configurations">system configurations</a></li>
<li><a href="#benchmarking-time" id="toc-benchmarking-time">benchmarking
time</a></li>
</ul></li>
<li><a href="#parallel-processing" id="toc-parallel-processing">PARALLEL
PROCESSING</a>
<ul>
<li><a href="#disk.frame" id="toc-disk.frame">DISK.FRAME</a>
<ul>
<li><a href="#setup" id="toc-setup">Setup</a></li>
<li><a href="#basic-operations" id="toc-basic-operations">Basic
operations</a></li>
<li><a href="#examples" id="toc-examples">Examples</a></li>
</ul></li>
<li><a href="#future" id="toc-future">FUTURE</a>
<ul>
<li><a href="#basics-of-future" id="toc-basics-of-future">Basics of
Future</a></li>
<li><a href="#future-with-data.table" id="toc-future-with-data.table">Future with data.table</a></li>
<li><a href="#export-globals" id="toc-export-globals">Export
globals</a></li>
<li><a href="#errors-in-the-future" id="toc-errors-in-the-future">Errors
in the future</a></li>
<li><a href="#set-workers-cores-for-each-process" id="toc-set-workers-cores-for-each-process">Set workers (cores) for each
process</a></li>
<li><a href="#examples-1" id="toc-examples-1">Examples</a></li>
<li><a href="#dofuture" id="toc-dofuture">doFuture</a></li>
<li><a href="#basics" id="toc-basics">Basics</a></li>
<li><a href="#parallel-data.table" id="toc-parallel-data.table">Parallel
data.table</a></li>
</ul></li>
<li><a href="#future.apply-package" id="toc-future.apply-package">future.apply package</a>
<ul>
<li><a href="#plan" id="toc-plan">plan</a></li>
<li><a href="#availablecores" id="toc-availablecores">availableCores</a></li>
<li><a href="#future_lapply" id="toc-future_lapply">future_lapply</a></li>
<li><a href="#reproducibility" id="toc-reproducibility">reproducibility</a></li>
</ul></li>
<li><a href="#parallel-package" id="toc-parallel-package">parallel
package</a>
<ul>
<li><a href="#clusterapply" id="toc-clusterapply">clusterApply()</a></li>
<li><a href="#clusterevalq" id="toc-clusterevalq">clusterEvalQ()</a></li>
<li><a href="#clusterexport" id="toc-clusterexport">clusterExport()</a></li>
<li><a href="#parapply" id="toc-parapply">parApply()</a></li>
<li><a href="#progress-bar" id="toc-progress-bar">progress bar</a></li>
</ul></li>
</ul></li>
<li><a href="#progress-bar-1" id="toc-progress-bar-1">Progress bar</a>
<ul>
<li><a href="#dofuture-foreach-progressbar" id="toc-dofuture-foreach-progressbar">DoFuture Foreach
progressbar</a></li>
<li><a href="#for-loop-progress-bar" id="toc-for-loop-progress-bar">for
loop progress bar</a></li>
<li><a href="#apply-progressbar" id="toc-apply-progressbar">apply
progressbar</a></li>
</ul></li>
<li><a href="#data-io" id="toc-data-io">Data I/O</a>
<ul>
<li><a href="#list-of-files-in-directory" id="toc-list-of-files-in-directory">List of files in directory</a></li>
<li><a href="#read-flat-files" id="toc-read-flat-files">Read flat
files</a></li>
<li><a href="#read-excel-files" id="toc-read-excel-files">Read excel
files</a></li>
<li><a href="#read-stata-files" id="toc-read-stata-files">Read Stata
files</a></li>
<li><a href="#database-backend" id="toc-database-backend">Database
backend</a></li>
<li><a href="#read-parquet" id="toc-read-parquet">Read parquet</a></li>
</ul></li>
<li><a href="#data.table" id="toc-data.table">DATA.TABLE</a>
<ul>
<li><a href="#i-operations" id="toc-i-operations"><code>i</code>
operations</a>
<ul>
<li><a href="#remove-rows-by-reference" id="toc-remove-rows-by-reference">REMOVE ROWS BY REFERENCE</a></li>
<li><a href="#order-rows" id="toc-order-rows">order rows</a></li>
<li><a href="#filtering-rows" id="toc-filtering-rows">filtering
rows</a></li>
<li><a href="#count-unique" id="toc-count-unique">count unique</a></li>
<li><a href="#show-duplicates" id="toc-show-duplicates">show
duplicates</a></li>
<li><a href="#drop-duplicates" id="toc-drop-duplicates">drop
duplicates</a></li>
<li><a href="#na.omit" id="toc-na.omit">na.omit</a></li>
<li><a href="#join" id="toc-join">Join</a></li>
<li><a href="#merge" id="toc-merge">Merge</a></li>
<li><a href="#choose-random-rows" id="toc-choose-random-rows">choose
random rows</a></li>
</ul></li>
<li><a href="#j-operations" id="toc-j-operations"><code>j</code>
operations</a>
<ul>
<li><a href="#order-columns" id="toc-order-columns">order
columns</a></li>
<li><a href="#selecting-columns" id="toc-selecting-columns">selecting
columns</a></li>
<li><a href="#dropping-columns" id="toc-dropping-columns">dropping
columns</a></li>
<li><a href="#replace-values" id="toc-replace-values">replace
values</a></li>
<li><a href="#assigning-columns" id="toc-assigning-columns">assigning
columns</a></li>
<li><a href="#rename-columns" id="toc-rename-columns">rename
columns</a></li>
<li><a href="#columns-class-converting" id="toc-columns-class-converting">columns class converting</a></li>
<li><a href="#grep-function" id="toc-grep-function">grep
function</a></li>
<li><a href="#lapplying-function-calls" id="toc-lapplying-function-calls">lapplying function calls</a></li>
<li><a href="#lead-lag-columns" id="toc-lead-lag-columns">lead &amp; lag
columns</a></li>
</ul></li>
<li><a href="#by-operations" id="toc-by-operations"><code>by</code>
operations</a></li>
<li><a href="#env-operations" id="toc-env-operations"><code>env</code>
operations</a></li>
<li><a href="#mult-opertations" id="toc-mult-opertations"><code>mult</code> opertations</a></li>
<li><a href="#special-symbols" id="toc-special-symbols">Special
symbols</a>
<ul>
<li><a href="#n" id="toc-n"><code>.N</code></a></li>
<li><a href="#sd" id="toc-sd"><code>.SD</code></a></li>
<li><a href="#i" id="toc-i"><code>.I</code></a></li>
<li><a href="#eachi" id="toc-eachi"><code>.EACHI</code></a></li>
<li><a href="#grp" id="toc-grp"><code>.GRP</code></a></li>
<li><a href="#grpn" id="toc-grpn"><code>.GRPN</code></a></li>
</ul></li>
<li><a href="#function-with-data.table" id="toc-function-with-data.table">Function with data.table</a>
<ul>
<li><a href="#get-1" id="toc-get-1">get(), ()</a></li>
</ul></li>
<li><a href="#read-multiple-files-as-data.tables" id="toc-read-multiple-files-as-data.tables">Read multiple files as
data.tables</a></li>
<li><a href="#combinations" id="toc-combinations">Combinations</a></li>
<li><a href="#set-operations" id="toc-set-operations">Set
operations</a></li>
<li><a href="#melt" id="toc-melt">MELT</a></li>
<li><a href="#dcast" id="toc-dcast">DCAST</a>
<ul>
<li><a href="#example-1" id="toc-example-1">Example</a></li>
</ul></li>
<li><a href="#cj" id="toc-cj">CJ</a>
<ul>
<li><a href="#example-2" id="toc-example-2">example</a></li>
</ul></li>
</ul></li>
<li><a href="#string-manipulation" id="toc-string-manipulation">STRING
MANIPULATION</a>
<ul>
<li><a href="#regular-expressions" id="toc-regular-expressions">regular
expressions</a></li>
<li><a href="#base-r" id="toc-base-r">base R</a>
<ul>
<li><a href="#paste" id="toc-paste">paste</a></li>
<li><a href="#substr" id="toc-substr">substr</a></li>
<li><a href="#strsplit" id="toc-strsplit">strsplit</a></li>
<li><a href="#grep-grepl" id="toc-grep-grepl">grep, grepl</a></li>
<li><a href="#sub" id="toc-sub">sub</a></li>
<li><a href="#gsub" id="toc-gsub">gsub</a></li>
<li><a href="#format-strings" id="toc-format-strings">format
strings</a></li>
</ul></li>
<li><a href="#stringr" id="toc-stringr">stringr</a>
<ul>
<li><a href="#str_view" id="toc-str_view">str_view()</a></li>
<li><a href="#str_match" id="toc-str_match">str_match()</a></li>
<li><a href="#str_detect" id="toc-str_detect">str_detect()</a></li>
<li><a href="#str_which" id="toc-str_which">str_which()</a></li>
<li><a href="#str_subset" id="toc-str_subset">str_subset()</a></li>
<li><a href="#str_replace" id="toc-str_replace">str_replace()</a></li>
<li><a href="#str_split" id="toc-str_split">str_split()</a></li>
</ul></li>
<li><a href="#glue-package" id="toc-glue-package">glue package</a></li>
<li><a href="#stringdist-package" id="toc-stringdist-package">stringdist
package</a>
<ul>
<li><a href="#methods" id="toc-methods">methods</a></li>
</ul></li>
<li><a href="#fuzzyjoin-package" id="toc-fuzzyjoin-package">fuzzyjoin
package</a></li>
</ul></li>
<li><a href="#date-and-time" id="toc-date-and-time">DATE and TIME</a>
<ul>
<li><a href="#posix" id="toc-posix">POSIX</a>
<ul>
<li><a href="#datetime-conversions" id="toc-datetime-conversions">Datetime Conversions</a></li>
<li><a href="#generate-date-time-variable" id="toc-generate-date-time-variable">Generate date / time
variable</a></li>
<li><a href="#generate-time-sequence" id="toc-generate-time-sequence">Generate Time Sequence</a></li>
</ul></li>
<li><a href="#data.table-functions" id="toc-data.table-functions">data.table functions</a></li>
<li><a href="#base-r-1" id="toc-base-r-1">base R</a>
<ul>
<li><a href="#numeric-to-date" id="toc-numeric-to-date">numeric to
date</a></li>
<li><a href="#time-difference" id="toc-time-difference">time
difference</a></li>
</ul></li>
<li><a href="#anytime" id="toc-anytime">anytime</a></li>
<li><a href="#lubridate" id="toc-lubridate">lubridate</a></li>
<li><a href="#posixct-base-package" id="toc-posixct-base-package">POSIXct : base package</a>
<ul>
<li><a href="#converting-integer-posix-to-posixct" id="toc-converting-integer-posix-to-posixct">Converting integer posix to
posixct</a></li>
<li><a href="#generating-posix" id="toc-generating-posix">Generating
posix</a></li>
</ul></li>
<li><a href="#xts-package" id="toc-xts-package">xts package</a>
<ul>
<li><a href="#select" id="toc-select">Select</a></li>
<li><a href="#mutate" id="toc-mutate">Mutate</a></li>
<li><a href="#summarize-aggregation-method" id="toc-summarize-aggregation-method">Summarize : aggregation
method</a></li>
<li><a href="#joining-dataframes" id="toc-joining-dataframes">Joining
dataframes</a></li>
</ul></li>
<li><a href="#data-concatenation-binding" id="toc-data-concatenation-binding">Data concatenation
(binding)</a></li>
<li><a href="#cleaning-column-names" id="toc-cleaning-column-names">Cleaning column names</a></li>
<li><a href="#type-format-conversion" id="toc-type-format-conversion">Type (format) conversion</a></li>
</ul></li>
<li><a href="#web-data" id="toc-web-data">WEB DATA</a>
<ul>
<li><a href="#read-csv-from-web" id="toc-read-csv-from-web">Read CSV
from web</a></li>
<li><a href="#download-files" id="toc-download-files">Download
files</a></li>
<li><a href="#using-api" id="toc-using-api">Using API</a>
<ul>
<li><a href="#get-post" id="toc-get-post">GET, POST</a></li>
<li><a href="#page-error-handling" id="toc-page-error-handling">Page
error handling</a></li>
<li><a href="#api" id="toc-api">API</a></li>
</ul></li>
<li><a href="#web-scraping" id="toc-web-scraping">Web scraping</a>
<ul>
<li><a href="#rselenium" id="toc-rselenium">RSelenium</a></li>
<li><a href="#rvest" id="toc-rvest">rvest</a></li>
<li><a href="#css-selector" id="toc-css-selector">CSS selector</a></li>
</ul></li>
</ul></li>
<li><a href="#ggplot2" id="toc-ggplot2">GGPLOT2</a>
<ul>
<li><a href="#my-samples" id="toc-my-samples">My samples</a>
<ul>
<li><a href="#error-bar" id="toc-error-bar">Error bar</a></li>
<li><a href="#legend" id="toc-legend">Legend</a></li>
<li><a href="#scaling-axis" id="toc-scaling-axis">Scaling axis</a></li>
</ul></li>
<li><a href="#aesthetics" id="toc-aesthetics">1 Aesthetics</a>
<ul>
<li><a href="#about-aesthetics-aes" id="toc-about-aesthetics-aes">About
aesthetics (aes)</a></li>
<li><a href="#adjusting-aesthetics" id="toc-adjusting-aesthetics">Adjusting Aesthetics</a></li>
</ul></li>
<li><a href="#geometrics" id="toc-geometrics">2 Geometrics</a>
<ul>
<li><a href="#dot-plots" id="toc-dot-plots">Dot plots</a></li>
<li><a href="#bar-plots" id="toc-bar-plots">Bar plots</a></li>
<li><a href="#line-plots" id="toc-line-plots">Line Plots</a></li>
<li><a href="#box-plots" id="toc-box-plots">Box plots</a></li>
<li><a href="#crosshairs" id="toc-crosshairs">Crosshairs</a></li>
</ul></li>
<li><a href="#facets" id="toc-facets">3 Facets</a>
<ul>
<li><a href="#facet_grid" id="toc-facet_grid">facet_grid()</a></li>
<li><a href="#facet_wrap" id="toc-facet_wrap">facet_wrap()</a></li>
<li><a href="#multiple-plots" id="toc-multiple-plots">Multiple
plots</a></li>
</ul></li>
<li><a href="#statistics" id="toc-statistics">4 Statistics</a></li>
<li><a href="#coordinates" id="toc-coordinates">5 Coordinates</a>
<ul>
<li><a href="#xlim-ylim" id="toc-xlim-ylim">xlim, ylim</a></li>
<li><a href="#coord_cartesian" id="toc-coord_cartesian">coord_cartesian()</a></li>
<li><a href="#coord_fixed" id="toc-coord_fixed">coord_fixed()</a></li>
<li><a href="#coord_expand" id="toc-coord_expand">coord_expand()</a></li>
<li><a href="#coordinates-vs-scales" id="toc-coordinates-vs-scales">coordinates vs scales</a></li>
<li><a href="#coord_flip" id="toc-coord_flip">coord_flip()</a></li>
<li><a href="#sec_axis" id="toc-sec_axis">sec_axis()</a></li>
<li><a href="#polar-coordinates" id="toc-polar-coordinates">polar
coordinates</a></li>
</ul></li>
<li><a href="#themes" id="toc-themes">6 Themes</a>
<ul>
<li><a href="#axis" id="toc-axis">axis</a></li>
<li><a href="#plot" id="toc-plot">plot</a></li>
<li><a href="#panel" id="toc-panel">panel</a></li>
<li><a href="#line" id="toc-line">line</a></li>
<li><a href="#text-1" id="toc-text-1">text</a></li>
<li><a href="#rect" id="toc-rect">rect</a></li>
<li><a href="#legend-1" id="toc-legend-1">legend</a></li>
<li><a href="#built-in-themes" id="toc-built-in-themes">Built-in
themes</a></li>
<li><a href="#update-theme" id="toc-update-theme">update theme</a></li>
<li><a href="#set-default-theme" id="toc-set-default-theme">set default
theme</a></li>
<li><a href="#color-arguments" id="toc-color-arguments">color
arguments</a></li>
</ul></li>
<li><a href="#helper-functions-1" id="toc-helper-functions-1">Helper
functions</a>
<ul>
<li><a href="#reorder" id="toc-reorder">reorder</a></li>
</ul></li>
<li><a href="#examples-2" id="toc-examples-2">EXAMPLES</a>
<ul>
<li><a href="#dynamite-plot" id="toc-dynamite-plot">dynamite
plot</a></li>
</ul></li>
</ul></li>
<li><a href="#regression" id="toc-regression">REGRESSION</a>
<ul>
<li><a href="#linear-regression" id="toc-linear-regression">Linear
regression</a>
<ul>
<li><a href="#fixed-effects-regression" id="toc-fixed-effects-regression">Fixed Effects regression</a></li>
</ul></li>
<li><a href="#logistic-regression" id="toc-logistic-regression">Logistic
Regression</a></li>
<li><a href="#programatic-formula" id="toc-programatic-formula">programatic formula</a></li>
<li><a href="#rmse" id="toc-rmse">RMSE</a></li>
<li><a href="#leverage-and-influence" id="toc-leverage-and-influence">Leverage and Influence</a></li>
<li><a href="#model.matrix" id="toc-model.matrix">model.matrix()</a></li>
</ul></li>
<li><a href="#machine-learning" id="toc-machine-learning">MACHINE
LEARNING</a>
<ul>
<li><a href="#h2o" id="toc-h2o">H2O</a>
<ul>
<li><a href="#init-and-shutdown" id="toc-init-and-shutdown">Init and
Shutdown</a></li>
<li><a href="#h2o.jar-location-installed-by-r" id="toc-h2o.jar-location-installed-by-r">h2o.jar location installed by
R</a></li>
<li><a href="#run-java-instances" id="toc-run-java-instances">Run java
instances</a></li>
</ul></li>
<li><a href="#supervised-ml-caret" id="toc-supervised-ml-caret">Supervised ML: caret</a></li>
<li><a href="#train-test-split" id="toc-train-test-split">train-test
split</a></li>
<li><a href="#train" id="toc-train">train()</a>
<ul>
<li><a href="#preprocess" id="toc-preprocess">1 preProcess</a></li>
<li><a href="#trcontrol" id="toc-trcontrol">2 trControl</a></li>
<li><a href="#tunelength" id="toc-tunelength">3 tuneLength</a></li>
<li><a href="#tunegrid" id="toc-tunegrid">4 tuneGrid</a></li>
</ul></li>
<li><a href="#model-comparison" id="toc-model-comparison">model
comparison</a>
<ul>
<li><a href="#make-prediction" id="toc-make-prediction">Make
prediction</a></li>
<li><a href="#confusion-matrix" id="toc-confusion-matrix">Confusion
Matrix</a></li>
<li><a href="#roc-curve" id="toc-roc-curve">ROC curve</a></li>
<li><a href="#auc" id="toc-auc">AUC</a></li>
<li><a href="#glmnet-model" id="toc-glmnet-model">glmnet Model</a></li>
<li><a href="#random-forest-model" id="toc-random-forest-model">random
forest Model</a></li>
<li><a href="#custom-tuning" id="toc-custom-tuning">custom
tuning</a></li>
</ul></li>
<li><a href="#unsupervised-ml" id="toc-unsupervised-ml">Unsupervised
ML</a>
<ul>
<li><a href="#kmeans" id="toc-kmeans">kmeans</a></li>
<li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering">hierarchical clustering</a></li>
<li><a href="#dimensionality-reduction" id="toc-dimensionality-reduction">Dimensionality reduction</a></li>
</ul></li>
<li><a href="#deep-learning" id="toc-deep-learning">Deep
Learning</a></li>
</ul></li>
<li><a href="#network-analysis" id="toc-network-analysis">NETWORK
ANALYSIS</a>
<ul>
<li><a href="#my-functions" id="toc-my-functions">My Functions</a>
<ul>
<li><a href="#remove-zero-weight-edges" id="toc-remove-zero-weight-edges">Remove zero weight edges</a></li>
</ul></li>
<li><a href="#concepts" id="toc-concepts">Concepts</a>
<ul>
<li><a href="#centrality-measures" id="toc-centrality-measures">Centrality measures</a></li>
<li><a href="#overall-structure-of-network" id="toc-overall-structure-of-network">Overall structure of
network</a></li>
<li><a href="#connectivity" id="toc-connectivity">Connectivity</a></li>
</ul></li>
<li><a href="#igraph-package" id="toc-igraph-package">igraph package</a>
<ul>
<li><a href="#conversion" id="toc-conversion">Conversion</a></li>
<li><a href="#basic-features" id="toc-basic-features">Basic
features</a></li>
<li><a href="#add-attributes" id="toc-add-attributes">add
attributes</a></li>
</ul></li>
<li><a href="#directed-network" id="toc-directed-network">directed
network</a>
<ul>
<li><a href="#eigenvector-centrality" id="toc-eigenvector-centrality">eigenvector centrality</a></li>
</ul></li>
<li><a href="#census" id="toc-census">census</a></li>
<li><a href="#network-structure" id="toc-network-structure">Network
Structure</a>
<ul>
<li><a href="#network-substructure" id="toc-network-substructure">network substructure</a></li>
</ul></li>
<li><a href="#relationship-measures" id="toc-relationship-measures">Relationship measures</a>
<ul>
<li><a href="#community-detection" id="toc-community-detection">community detection</a></li>
<li><a href="#community-comparison" id="toc-community-comparison">community comparison</a></li>
</ul></li>
<li><a href="#network-features" id="toc-network-features">Network
features</a></li>
<li><a href="#network-visualization-package" id="toc-network-visualization-package">Network Visualization package</a>
<ul>
<li><a href="#igraph-base" id="toc-igraph-base">igraph base</a></li>
<li><a href="#ggraph" id="toc-ggraph">ggraph</a></li>
<li><a href="#ggnetwork" id="toc-ggnetwork">ggnetwork</a></li>
<li><a href="#visnetwork" id="toc-visnetwork">visNetwork</a></li>
</ul></li>
<li><a href="#classifier" id="toc-classifier">Classifier</a>
<ul>
<li><a href="#relational-neighber-classifier" id="toc-relational-neighber-classifier">relational neighber
classifier</a></li>
</ul></li>
<li><a href="#adjacency-matrix" id="toc-adjacency-matrix">Adjacency
Matrix</a></li>
<li><a href="#hierarchical-clustering-1" id="toc-hierarchical-clustering-1">Hierarchical clustering</a></li>
<li><a href="#predictive-models" id="toc-predictive-models">Predictive
models</a></li>
<li><a href="#examples-3" id="toc-examples-3">Examples</a></li>
</ul></li>
<li><a href="#database-server-computing-hpc" id="toc-database-server-computing-hpc">DATABASE &amp; SERVER COMPUTING
(HPC)</a>
<ul>
<li><a href="#ssh" id="toc-ssh">SSH</a>
<ul>
<li><a href="#hypergator-conn" id="toc-hypergator-conn">Hypergator
conn</a></li>
<li><a href="#wrds-conn" id="toc-wrds-conn">WRDS conn</a></li>
</ul></li>
<li><a href="#filezilla" id="toc-filezilla">Filezilla</a>
<ul>
<li><a href="#site-manager" id="toc-site-manager">Site Manager</a></li>
</ul></li>
<li><a href="#scp" id="toc-scp">SCP</a></li>
<li><a href="#sparklyr" id="toc-sparklyr">Sparklyr</a>
<ul>
<li><a href="#installation-2" id="toc-installation-2">Installation</a></li>
<li><a href="#config" id="toc-config">Config</a></li>
</ul></li>
<li><a href="#wrds-1" id="toc-wrds-1">WRDS</a>
<ul>
<li><a href="#setup-for-wrds" id="toc-setup-for-wrds">Setup for
WRDS</a></li>
<li><a href="#install-package-rpostgres" id="toc-install-package-rpostgres">Install package : Rpostgres</a></li>
<li><a href="#pgpass-file" id="toc-pgpass-file">.pgpass file</a></li>
<li><a href="#dbplyr-on-wrds" id="toc-dbplyr-on-wrds">DBPLYR ON
WRDS</a></li>
<li><a href="#rpostgres-1" id="toc-rpostgres-1">RPostgres</a></li>
</ul></li>
<li><a href="#batch-job-on-wrds" id="toc-batch-job-on-wrds">Batch Job on
WRDS</a>
<ul>
<li><a href="#batch-job-sas-example" id="toc-batch-job-sas-example">Batch job SAS example</a></li>
<li><a href="#batch-job-r-example" id="toc-batch-job-r-example">Batch
job R example</a></li>
<li><a href="#submit-batch-job" id="toc-submit-batch-job">Submit batch
job</a></li>
<li><a href="#managing-jobs" id="toc-managing-jobs">Managing
jobs</a></li>
<li><a href="#request-more-computing-power" id="toc-request-more-computing-power">request more computing
power</a></li>
</ul></li>
<li><a href="#hipergator" id="toc-hipergator">HiPerGator</a>
<ul>
<li><a href="#base-info" id="toc-base-info">Base Info</a></li>
<li><a href="#connection-id" id="toc-connection-id">Connection &amp;
ID</a></li>
<li><a href="#connect" id="toc-connect">Connect</a></li>
<li><a href="#rstudio-server" id="toc-rstudio-server">RStudio
Server</a></li>
<li><a href="#run-r" id="toc-run-r">Run R</a></li>
<li><a href="#slurm" id="toc-slurm">SLURM</a></li>
</ul></li>
</ul></li>
<li><a href="#unix-shell" id="toc-unix-shell">UNIX SHELL</a>
<ul>
<li><a href="#head" id="toc-head">Head</a></li>
<li><a href="#word-count" id="toc-word-count">Word count</a></li>
<li><a href="#list-files" id="toc-list-files">List files</a></li>
<li><a href="#move-files" id="toc-move-files">Move files</a></li>
</ul></li>
<li><a href="#latex-1" id="toc-latex-1">LaTeX</a>
<ul>
<li><a href="#tinytex" id="toc-tinytex">TinyTex</a></li>
<li><a href="#bibtex" id="toc-bibtex">BibTex</a>
<ul>
<li><a href="#package-install" id="toc-package-install">package
install</a></li>
</ul></li>
<li><a href="#sweave" id="toc-sweave">Sweave</a></li>
<li><a href="#knitr" id="toc-knitr">Knitr</a></li>
<li><a href="#stargazer" id="toc-stargazer">Stargazer</a></li>
</ul></li>
<li><a href="#git-github" id="toc-git-github">Git (Github)</a>
<ul>
<li><a href="#basic-commands-1" id="toc-basic-commands-1">Basic
Commands</a>
<ul>
<li><a href="#status" id="toc-status">status</a></li>
<li><a href="#diff" id="toc-diff">diff</a></li>
<li><a href="#add" id="toc-add">add</a></li>
<li><a href="#reset" id="toc-reset">reset</a></li>
<li><a href="#checkout" id="toc-checkout">checkout</a></li>
<li><a href="#commit" id="toc-commit">commit</a></li>
<li><a href="#log" id="toc-log">log</a></li>
<li><a href="#show" id="toc-show">show</a></li>
<li><a href="#remove" id="toc-remove">remove</a></li>
</ul></li>
<li><a href="#ignore-files" id="toc-ignore-files">Ignore files</a></li>
<li><a href="#config-1" id="toc-config-1">Config</a></li>
</ul></li>
<li><a href="#gmailr" id="toc-gmailr">GmailR</a>
<ul>
<li><a href="#install" id="toc-install">Install</a></li>
<li><a href="#usage" id="toc-usage">Usage</a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="custom-functions-use-cases">CUSTOM FUNCTIONS &amp; USE
CASES</h1>
<h2 id="descriptive-statistics">Descriptive Statistics</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">colms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">&#39;Cust_vol&#39;</span>,<span class="st">&#39;Proc_vol&#39;</span>,<span class="st">&#39;MM_vol&#39;</span>,</span>
<span>  <span class="st">&#39;MID_QUOTE&#39;</span>,<span class="st">&#39;BA_SPREAD&#39;</span>,<span class="st">&#39;PCT_SPREAD&#39;</span>,<span class="st">&#39;EFF_SPREAD&#39;</span>,<span class="st">&#39;PEF_SPREAD&#39;</span>,</span>
<span>  <span class="st">&#39;IMPL_VOL&#39;</span>,<span class="st">&#39;DELTA&#39;</span>,<span class="st">&#39;GAMMA&#39;</span>,<span class="st">&#39;THETA_E&#39;</span>,<span class="st">&#39;VEGA_E&#39;</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">summary_stat</span> <span class="op">=</span> <span class="fu">qsu</span><span class="op">(</span><span class="va">CBOE</span>, cols <span class="op">=</span>  <span class="va">colms</span><span class="op">)</span></span>
<span><span class="va">summary_stat</span> <span class="op">=</span> <span class="va">summary_stat</span> <span class="op">%&gt;%</span> <span class="fu">as.data.table</span><span class="op">(</span>keep.rownames <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">setnames</span><span class="op">(</span><span class="va">.</span>, old<span class="op">=</span><span class="st">&#39;rn&#39;</span>, new<span class="op">=</span><span class="st">&#39;Variable&#39;</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">probs</span> <span class="op">=</span> <span class="va">CBOE</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">quantile</span>, na.rm <span class="op">=</span><span class="cn">T</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="fl">0.99</span><span class="op">)</span><span class="op">)</span>, .SDcols <span class="op">=</span> <span class="va">colms</span> <span class="op">]</span></span>
<span><span class="va">probs</span> <span class="op">=</span> <span class="fu">transpose</span><span class="op">(</span><span class="va">probs</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as.data.table</span></span>
<span></span>
<span><span class="va">summary_stat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">summary_stat</span>, <span class="va">probs</span><span class="op">)</span></span>
<span><span class="va">summary_stat</span> <span class="op">=</span> <span class="va">summary_stat</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">Variable</span>, <span class="va">N</span>,<span class="va">Mean</span>, <span class="va">SD</span>, P1 <span class="op">=</span> <span class="va">V1</span>,P25<span class="op">=</span><span class="va">V2</span>,P50<span class="op">=</span><span class="va">V3</span>,P75<span class="op">=</span><span class="va">V4</span>,P99<span class="op">=</span><span class="va">V5</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<p>advanced : groupby summary</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co">#### Summary (10 min) of Spread by moneyness  ----</span></span>
<span></span>
<span><span class="co"># Summary of Spread and greeks by MONEYNESS</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">CBOE</span><span class="op">)</span></span>
<span><span class="va">vol_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;PCT_SPREAD&#39;</span>,<span class="st">&#39;PEF_SPREAD&#39;</span>, <span class="st">&#39;ABS_DELTA&#39;</span>,<span class="st">&#39;GAMMA&#39;</span>,<span class="st">&#39;THETA_E&#39;</span>,<span class="st">&#39;VEGA_E&#39;</span>, <span class="st">&#39;MONEYNESS2&#39;</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">qsu</span><span class="op">(</span><span class="va">CBOE</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="va">vol_cols</span><span class="op">]</span>, by <span class="op">=</span> <span class="op">~</span><span class="va">MONEYNESS2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as.data.table</span></span>
<span></span>
<span><span class="va">probs</span> <span class="op">=</span> <span class="va">CBOE</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">quantile</span>, na.rm <span class="op">=</span><span class="cn">T</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.01</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="fl">0.99</span><span class="op">)</span><span class="op">)</span>, .SDcols <span class="op">=</span> <span class="va">vol_cols</span><span class="op">[</span><span class="va">vol_cols</span> <span class="op">!=</span><span class="st">&#39;MONEYNESS2&#39;</span><span class="op">]</span> , keyby<span class="op">=</span><span class="va">MONEYNESS2</span> <span class="op">]</span></span>
<span><span class="va">probs</span><span class="op">[</span>, <span class="va">stat</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;P1&#39;</span>,<span class="st">&#39;P25&#39;</span>,<span class="st">&#39;P50&#39;</span>,<span class="st">&#39;P75&#39;</span>,<span class="st">&#39;P99&#39;</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">probs</span> <span class="op">=</span> <span class="fu">melt</span><span class="op">(</span><span class="va">probs</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;MONEYNESS2&#39;</span>,<span class="st">&#39;stat&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">setnames</span><span class="op">(</span><span class="va">probs</span>, new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;V1&#39;</span>,<span class="st">&#39;V2&#39;</span>,<span class="st">&#39;V3&#39;</span>,<span class="st">&#39;value&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">temp</span>,<span class="va">probs</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span><span class="op">[</span>, <span class="va">V3</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">V3</span>, levels <span class="op">=</span> <span class="va">vol_cols</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu">dcast</span><span class="op">(</span><span class="va">temp</span>, <span class="va">V1</span> <span class="op">+</span> <span class="va">V3</span> <span class="op">~</span> <span class="va">V2</span> , value.var <span class="op">=</span> <span class="st">&#39;value&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="fu">setcolorder</span><span class="op">(</span><span class="va">temp</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;V1&#39;</span>,<span class="st">&#39;V3&#39;</span>,<span class="st">&#39;N&#39;</span>,<span class="st">&#39;Mean&#39;</span>,<span class="st">&#39;SD&#39;</span>,<span class="st">&#39;Min&#39;</span>,<span class="st">&#39;Max&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">setnames</span><span class="op">(</span><span class="va">temp</span>, old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;V1&#39;</span>,<span class="st">&#39;V3&#39;</span><span class="op">)</span>, new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Moneyness&#39;</span>,<span class="st">&#39;Variable&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">Min</span>,<span class="op">-</span><span class="va">Max</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="summary-statistics">Summary Statistics</h2>
<p>Package <code>collapse</code> provides very handy and fast summary
stat tool.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">su</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">DT</span>, <span class="va">quant</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://gitlab.com/hrbrmstr/tdigest">tdigest</a></span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">types</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">DT</span>, <span class="va">class</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">unlist</span></span>
<span>  <span class="va">colnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">types</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># include only numeric columns</span></span>
<span>  </span>
<span>  <span class="va">numeric_cols</span> <span class="op">=</span> <span class="va">colnames</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">types</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span> <span class="op">==</span> <span class="st">&#39;numeric&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># N, mean, St.dev, Min, Median, Max</span></span>
<span>  </span>
<span>  <span class="va">N</span> <span class="op">=</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, .SDcols <span class="op">=</span><span class="va">numeric_cols</span><span class="op">]</span></span>
<span>  <span class="va">Mean</span> <span class="op">=</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .SDcols <span class="op">=</span><span class="va">numeric_cols</span><span class="op">]</span></span>
<span>  <span class="va">SD</span> <span class="op">=</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">sd</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .SDcols <span class="op">=</span><span class="va">numeric_cols</span><span class="op">]</span></span>
<span>  <span class="va">Min</span> <span class="op">=</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">min</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .SDcols <span class="op">=</span><span class="va">numeric_cols</span><span class="op">]</span></span>
<span>  <span class="va">Med</span> <span class="op">=</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">median</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .SDcols <span class="op">=</span><span class="va">numeric_cols</span><span class="op">]</span></span>
<span>  <span class="va">Max</span> <span class="op">=</span> <span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">max</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, .SDcols <span class="op">=</span><span class="va">numeric_cols</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">quant</span> <span class="op">!=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">Mean</span>,<span class="va">SD</span>,<span class="va">Min</span>,<span class="va">Med</span>,<span class="va">Max</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, keep.rownames <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">result</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Variable&#39;</span>, <span class="st">&#39;N&#39;</span>,<span class="st">&#39;Mean&#39;</span>,<span class="st">&#39;St.Dev&#39;</span>,<span class="st">&#39;Min&#39;</span>,<span class="st">&#39;Median&#39;</span>,<span class="st">&#39;Max&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&#39;Working on Quantiles..&#39;</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">numeric_cols</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">td</span> <span class="op">=</span> <span class="fu">tdigest</span><span class="op">(</span><span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">numeric_cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">quan</span> <span class="op">=</span> <span class="fu">tquantile</span><span class="op">(</span><span class="va">td</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.25</span>,<span class="fl">0.75</span>,<span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">quan</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;P10&#39;</span>,<span class="st">&#39;P25&#39;</span>,<span class="st">&#39;P75&#39;</span>,<span class="st">&#39;P90&#39;</span><span class="op">)</span></span>
<span>      </span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="winsorize">Winsorize</h2>
<p>From package <code>DescTools</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andrisignorell.github.io/DescTools/">DescTools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># my winsor function</span></span>
<span><span class="va">ms_winsor</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">min</span><span class="op">=</span><span class="fl">0.01</span>, <span class="va">max</span> <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">winsored_vec</span> <span class="op">=</span> <span class="fu"><a href="https://andrisignorell.github.io/DescTools/reference/Winsorize.html">Winsorize</a></span><span class="op">(</span><span class="va">x</span>, minval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">min</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>, maxval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">max</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">min</span>,<span class="va">max</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">winsored_vec</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="standardize">Standardize</h2>
<p>Min-max normalization : scale into [0,1]</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">standardize</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="linear-interpolation">Linear interpolation</h2>
<p>Usage example : <code>approxfun</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">monthly</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">caldt</span>, <span class="va">yearq</span>, <span class="va">yearm</span>, <span class="va">crsp_portno</span>, <span class="va">avg_sim</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approxfun</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">.N</span>, <span class="va">avg_sim</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">.N</span><span class="op">)</span><span class="op">)</span>, by<span class="op">=</span><span class="va">crsp_portno</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="fast-weighted-mean">Fast Weighted Mean</h2>
<p>By far, for weighted average <code>collapse</code> package gives the
best result. It gives fast groupby and fast collapsing(aggregating) with
<code>fmean</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mtcars</span> <span class="op">%&gt;%</span>  <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">cyl</span>,<span class="va">vs</span>,<span class="va">am</span><span class="op">)</span> <span class="op">%&gt;%</span>                 <span class="co"># Equivalent and faster !</span></span>
<span>  <span class="fu">fselect</span><span class="op">(</span><span class="va">mpg</span>,<span class="va">hp</span><span class="op">)</span> <span class="op">%&gt;%</span>  <span class="fu">fmean</span><span class="op">(</span><span class="va">hp</span><span class="op">)</span> <span class="co"># weight by hp</span></span></code></pre>
</div>
</div>
<p>My example</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># weighted average of all variables fselected : weight by trade_size</span></span>
<span><span class="va">agg_sample</span> <span class="op">=</span> <span class="va">cboe_price</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">underlying_symbol</span>,<span class="va">option_type</span>, <span class="va">expiration</span>, <span class="va">days_to_expire</span>, <span class="va">strike</span>, <span class="va">by10</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fselect</span><span class="op">(</span><span class="va">trade_size</span>, <span class="va">BA_SPREAD</span>, <span class="va">MID_QUOTE</span>, <span class="va">PCT_SPREAD</span>, <span class="va">EFF_SPREAD</span>, <span class="va">PEF_SPREAD</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fmean</span><span class="op">(</span><span class="va">trade_size</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fselect</span><span class="op">(</span><span class="op">-</span><span class="va">sum.trade_size</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Aggregation 2 : Selecting variables by regex expression</span></span>
<span></span>
<span><span class="va">agg_sample2</span> <span class="op">=</span> <span class="va">vola_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fgroup_by</span><span class="op">(</span><span class="va">SYM_ROOT</span>, <span class="va">option_type</span>, <span class="va">DateTime</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">get_vars</span><span class="op">(</span><span class="st">&quot;^D_|GT&quot;</span>, regex<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fsum</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="va">setDT</span></span></code></pre>
</div>
</div>
<h2 id="rowwise-median">Rowwise Median</h2>
<p>Package <code>matrixStats</code> is faster than
<code>robustbase</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/matrixStats">matrixStats</a></span><span class="op">)</span></span>
<span><span class="va">data</span><span class="op">[</span>, <span class="va">EndPrice</span> <span class="op">:=</span> <span class="fu">rowMedians</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">BID</span>, <span class="va">ASK</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="rowsums">rowSums</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cboe_volume[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">rowSums</span>(<span class="fu">cbind</span>(OPEN_INTEREST_MM, OPEN_INTEREST_MMBD))]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cboe_volume[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">rowSums</span>(<span class="fu">cbind</span>(.SD)), .SDcols <span class="ot">=</span> .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;OPEN_INTEREST_MM&#39;</span>, <span class="st">&#39;OPEN_INTEREST_MMBD&#39;</span>)]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>cboe_volume[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">rowSums</span>(<span class="fu">as.matrix</span>(.SD)), .SDcols <span class="ot">=</span> .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;OPEN_INTEREST_MM&#39;</span>, <span class="st">&#39;OPEN_INTEREST_MMBD&#39;</span>)] <span class="co"># as.matrix is slightly faster</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>cboe_volume[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">rowSums2</span>(<span class="fu">as.matrix</span>(.SD)), .SDcols <span class="ot">=</span> .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;OPEN_INTEREST_MM&#39;</span>, <span class="st">&#39;OPEN_INTEREST_MMBD&#39;</span>)] <span class="co"># rowSums2 is faster</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>cboe_volume[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">do.call</span>(rowSums, <span class="fu">list</span>( <span class="fu">cbind</span>(OPEN_INTEREST_MM, OPEN_INTEREST_MMBD) ))]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>cboe_volume[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="fu">do.call</span>(rowSums, <span class="fu">list</span>( <span class="fu">cbind</span>(.SD) )), </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>            .SDcols <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;OPEN_INTEREST_MM&#39;</span>, <span class="st">&#39;OPEN_INTEREST_MMBD&#39;</span>) ]</span></code></pre></div>
</div>
<h2 id="standard-error-of-mean">Standard Error of mean</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">se_mean</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="cumsum-ignoring-na">Cumsum ignoring NA</h2>
<p>Skip NA and leave NA as NA</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">skipna_cumsum</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">y</span> <span class="op">=</span> <span class="va">x</span></span>
<span>  <span class="va">y</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
Making NA as 0
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># define cumsum that ignores NA</span></span>
<span><span class="va">na_cumsum</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span> <span class="co"># x is a vector</span></span>
<span>  </span>
<span>  <span class="va">miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># TRUE/FALSE placeholder</span></span>
<span>  <span class="va">x</span><span class="op">[</span><span class="va">miss</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># convert NAs to 0</span></span>
<span>  </span>
<span>  <span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">cs</span><span class="op">[</span><span class="va">miss</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co"># convert back to NA </span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">cs</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="edgelist-generator">Edgelist generator</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gen_edge</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">unique_vector</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>V1 <span class="op">=</span> <span class="va">unique_vector</span><span class="op">)</span></span>
<span>  <span class="va">d</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span>id1 <span class="op">=</span> <span class="fl">1L</span>, id2 <span class="op">=</span> <span class="va">.I</span><span class="op">)</span><span class="op">]</span>  <span class="co">## add interval columns for overlaps</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">setkey</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">id1</span>, <span class="va">id2</span><span class="op">)</span></span>
<span>  <span class="va">olaps</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/foverlaps.html">foverlaps</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">d</span>, type<span class="op">=</span><span class="st">&#39;within&#39;</span>, which<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="va">xid</span> <span class="op">!=</span> <span class="va">yid</span><span class="op">]</span></span>
<span>  <span class="va">ans</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">V1</span><span class="op">[</span><span class="va">olaps</span><span class="op">$</span><span class="va">xid</span><span class="op">]</span>, <span class="va">d</span><span class="op">$</span><span class="va">V1</span><span class="op">[</span><span class="va">olaps</span><span class="op">$</span><span class="va">yid</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ans</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">prep</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dt</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">dt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;from&#39;</span>,<span class="st">&#39;to&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">setorderv</a></span><span class="op">(</span><span class="va">dt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;from&#39;</span>,<span class="st">&#39;to&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">dt</span><span class="op">[</span>,<span class="fu">`:=`</span><span class="op">(</span>unionN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="va">.N</span><span class="op">)</span>,</span>
<span>           intersectN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">integer</a></span><span class="op">(</span><span class="va">.N</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="fund-flow-generator">Fund flow generator</h2>
<p>Use this in the rolling regression setting with zoo::rollapply</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># generate monthly flow </span></span>
<span><span class="va">flow_generator_dt</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">DT</span><span class="op">)</span><span class="op">{</span> </span>
<span>  <span class="co"># Data table with two columns : first TNA, second RET</span></span>
<span>  <span class="co"># needs to be applied in the zoo::rollapply function. </span></span>
<span>  <span class="va">flow</span> <span class="op">=</span> <span class="op">(</span><span class="va">DT</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">DT</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">DT</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">DT</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">flow</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="linear-interpolation-1">Linear interpolation</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># linear interpolate fund age</span></span>
<span><span class="va">monthly</span><span class="op">[</span>, <span class="va">fund_age_port</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html">approxfun</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">.N</span>, <span class="va">fund_age_port</span><span class="op">)</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">.N</span><span class="op">)</span>, by<span class="op">=</span><span class="va">crsp_portno</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="decile-factorization">Decile factorization</h2>
<p>Using <code>cut</code> and <code>quantile</code> functions</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">monthly</span><span class="op">$</span><span class="va">avg_sim_imp</span>, </span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">monthly</span><span class="op">$</span><span class="va">avg_sim_imp</span>,probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.9</span>,<span class="fl">1</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;1st&#39;</span>,<span class="st">&#39;2nd&#39;</span>,<span class="st">&#39;3rd&#39;</span>,<span class="st">&#39;4th&#39;</span>,<span class="st">&#39;5th&#39;</span>,<span class="st">&#39;6th&#39;</span>,<span class="st">&#39;7th&#39;</span>,<span class="st">&#39;8th&#39;</span>,<span class="st">&#39;9th&#39;</span>,<span class="st">&#39;10th&#39;</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="multiple-.sds">Multiple .SDs</h2>
<p>*Multiple <code>.SD</code>s</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">[</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">SD1</span>, <span class="va">sum</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">SD2</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  env <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>SD1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Sepal.Length&#39;</span>,<span class="st">&#39;Sepal.Width&#39;</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             SD2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Petal.Length&#39;</span>,<span class="st">&#39;Petal.Width&#39;</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="va">Species</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>GForce Optimized with name set</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">DT</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cols1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Sepal.Length&#39;</span>,<span class="st">&#39;Sepal.Width&#39;</span><span class="op">)</span></span>
<span><span class="va">cols2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Petal.Length&#39;</span>,<span class="st">&#39;Petal.Width&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DT</span><span class="op">[</span>, </span>
<span>   <span class="va">.j</span>, </span>
<span>   env <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>.j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>nm<span class="op">=</span><span class="va">cols1</span><span class="op">)</span>, <span class="va">as.name</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/call.html">call</a></span><span class="op">(</span><span class="st">&quot;sum&quot;</span>, <span class="va">v</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>nm<span class="op">=</span><span class="va">cols2</span><span class="op">)</span>, <span class="va">as.name</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/call.html">call</a></span><span class="op">(</span><span class="st">&quot;mean&quot;</span>, <span class="va">v</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="op">)</span><span class="op">)</span>,</span>
<span>   by<span class="op">=</span><span class="va">Species</span></span>
<span><span class="op">]</span> <span class="co"># GForce ON</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">cols1</span> <span class="co"># vector</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>nm<span class="op">=</span><span class="va">cols1</span><span class="op">)</span> <span class="co"># named vector that has name as its element</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>nm<span class="op">=</span><span class="va">cols1</span><span class="op">)</span>, <span class="va">as.name</span><span class="op">)</span> <span class="co"># named list that has name as its elemeent</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>nm<span class="op">=</span><span class="va">cols1</span><span class="op">)</span>, <span class="va">as.name</span><span class="op">)</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="va">cols1</span><span class="op">)</span> <span class="co"># each element as separate list</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cols1</span><span class="op">)</span> <span class="co"># one list with elements</span></span>
<span></span>
<span><span class="op">?</span><span class="va">as.name</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/name.html">as.name</a></span><span class="op">(</span><span class="va">cols1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span>nm<span class="op">=</span><span class="va">cols1</span><span class="op">)</span>, <span class="va">as.name</span><span class="op">)</span></span>
<span><span class="va">setNames</span></span>
<span><span class="op">?</span><span class="va">as.name</span></span></code></pre>
</div>
</div>
<h2 id="time-interval-grouping">Time Interval Grouping</h2>
<ol type="1">
<li>Using lubridate::round_date</li>
</ol>
<p>Most clean for the purpose</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">floor_date</span><span class="op">(</span><span class="va">time</span>, unit <span class="op">=</span> <span class="st">&quot;5 min&quot;</span><span class="op">)</span> <span class="co"># round_date, ceiling_date</span></span></code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Using cut</li>
</ol>
<p>cut by breaks, but does not guarantee even (5 min cut could be 47,
52, 57, 02, 07, 12, etc..)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">time</span>, breaks<span class="op">=</span><span class="st">&quot;15 min&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="vector-splitting">Vector Splitting</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">spliter</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">n</span>, labels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="force-time-zone">Force Time zone</h2>
<p>lubridate::force_tz is a bit slower (ten times)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">datetime</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2011-01-01 12:32:23.234&quot;</span>,tz<span class="op">=</span><span class="st">&quot;GMT&quot;</span><span class="op">)</span>,<span class="fl">1e6</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">tz</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, origin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;1970-01-01&quot;</span>, tz<span class="op">=</span><span class="va">tz</span><span class="op">)</span>, tz<span class="op">=</span><span class="va">tz</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">datetime2</span> <span class="op">&lt;-</span> <span class="fu">f</span><span class="op">(</span><span class="va">datetime</span>,<span class="st">&quot;Europe/Paris&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="va">datetime3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/force_tz.html">force_tz</a></span><span class="op">(</span><span class="va">datetime</span>,<span class="st">&quot;Europe/Paris&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">datetime2</span>,<span class="va">datetime3</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="fast-datetime-conversion">Fast date/time conversion</h2>
<p>fasttime::fastPOSIXct with fixed = N (number of year digits)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">bzx</span><span class="op">[</span>, <span class="va">trade_datetime</span> <span class="op">:=</span> <span class="fu">fastPOSIXct</span><span class="op">(</span><span class="va">trade_datetime</span>, fixed<span class="op">=</span><span class="fl">4</span>, tz<span class="op">=</span><span class="st">&#39;UTC&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">bzx</span><span class="op">[</span>, <span class="va">trade_date</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">trade_datetime</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">bzx</span><span class="op">[</span>, <span class="va">expiration_date</span> <span class="op">:=</span> <span class="fu">fastPOSIXct</span><span class="op">(</span><span class="va">expiration_date</span>, fixed<span class="op">=</span><span class="fl">4</span>, tz<span class="op">=</span><span class="st">&#39;UTC&#39;</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">as.Date</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h1 id="r-compile-installation">R Compile &amp; Installation</h1>
<h2 id="renviron-setup">Renviron Setup</h2>
<p>R Environmental variables are set every time R session is
launched.</p>
<p>Rstudio Error Error: vector memory exhausted (limit reached?)</p>
<pre><code>echo &quot;R_MAX_VSIZE=1000Gb&quot; &gt;&gt; ~/.Renviron
echo &quot;R_DEFAULT_INTERNET_TIMEOUT=500&quot; &gt;&gt; ~/.Renviron</code></pre>
<p>Windows Powershell</p>
<pre><code>Add-Content c:\Users\$env:USERNAME\Documents\.Renviron &quot;R_MAX_VSIZE=100Gb&quot;</code></pre>
<p>Windows CMD</p>
<pre><code>echo R_MAX_VSIZE=500Gb &gt;&gt; %userprofile%\Documents\.Rinviron</code></pre>
<h2 id="rprofile-setup">Rprofile Setup</h2>
<p>Rprofiles are run when R session begins. Usually when one needs to
set different default options. It should be located at default HOME
variable path, which can be browsed by
<code>Sys.getenv(&quot;HOME&quot;)</code></p>
<p>Mac/Linux</p>
<pre><code>open ~/.Rprofile</code></pre>
<p>Windows</p>
<pre><code>C:/Users/gunsu.son/Documents</code></pre>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>reticulate.repl.quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># disable reticulate message</span></span>
<span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/memory.size.html">memory.limit</a></span><span class="op">(</span><span class="fl">1e9</span><span class="op">)</span> <span class="co"># for windows machine</span></span></code></pre>
</div>
</div>
<h2 id="rstudio-setup">Rstudio Setup</h2>
<h3 id="rstudio-ide-options">RStudio IDE options</h3>
<p>Like keybindings, dictionaries and other setups, it is saved in</p>
<p>On Mac</p>
<pre><code>~/.config/rstudio</code></pre>
<p>or</p>
<p>On Windows</p>
<pre><code>AppData/Roaming/RStudio</code></pre>
<h3 id="view-column-limit">View column limit</h3>
<p>Increase column limit</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rstudioapi/man/writeRStudioPreference.html">writeRStudioPreference</a></span><span class="op">(</span><span class="st">&quot;data_viewer_max_columns&quot;</span>, <span class="fl">100L</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="rrstudio-removal-on-macos">R/RStudio removal on MacOS</h2>
<p>R, RStudio and miniconda removal</p>
<p>On Terminal,</p>
<pre><code>sudo rm -rf /Applications/R.app
sudo rm -rf /Applications/RStudio.app
sudo rm -rf /Library/Frameworks/R.framework
sudo rm -rf /Library/Saved Application state/org.rstudio*
sudo rm -rf ~/.config/rstudio
sudo rm /usr/local/bin/{R,Rscript}
sudo rm /private/var/db/receipts/org.R-project*
sudo rm /private/var/db/receipts/org.r-project*
sudo rm /private/var/db/receipts/org.rstudio*
rm -rf ~/Library/Application Support/R
rm -rf ~/.Renviron

conda deactivate
sudo rm -rf ~/Library/r-miniconda/
rm -rf ~/.zshrc
rm -rf ~/.bashrc</code></pre>
<p>Remove Rstudio config</p>
<pre><code>sudo rm -rf ~/.config/rstudio
sudo rm -rf ~/.local/share/rstudio</code></pre>
<h2 id="openmpdata.table-fst-for-macos">OpenMP(data.table, fst) for
MacOS</h2>
<p><a href="https://github.com/Rdatatable/data.table/wiki/Installation#openmp-enabled-compiler-for-mac">Wiki</a></p>
<p>R for MacOS doesnt come with OpenMP support after R 4.0</p>
<ol type="1">
<li><p>Install Apple Xcode command line tools</p>
<p>xcode-select install</p></li>
<li><p>Install homebrew</p>
<p>/bin/bash -c $(curl -fsSL <a href="https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh" class="uri">https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh</a>)</p></li>
<li><p>Install gcc, pkg-config</p>
<p>brew install gcc pkg-config</p></li>
<li><p>Check GCC version</p>
<p>brew info gcc</p></li>
<li><p>Generate Makevars</p>
<p>mkdir ~/.R nano ~/.R/Makevars</p></li>
</ol>
<p>Copy &amp; Paste</p>
<pre><code>LOC = /usr/local
#/opt/homebrew for ARM Macs (M1 and its successors)
#/usr/local for Intel Macs

GCC_VER=11
CC=$(LOC)/bin/gcc-$(GCC_VER) -fopenmp
CXX=$(LOC)/bin/g++-$(GCC_VER) -fopenmp
CXX11=$(LOC)/bin/g++-$(GCC_VER) -fopenmp # for fst package

CFLAGS=-g -O3 -Wall -pedantic -std=gnu99 -mtune=native -pipe
CXXFLAGS=-g -O3 -Wall -pedantic -std=c++11 -mtune=native -pipe
LDFLAGS=-L$(LOC)/lib -Wl,-rpath, -I$(LOC)/lib
CPPFLAGS=-I$(LOC)/include -I/Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include</code></pre>
<p>And then install it from the type=source to install</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&quot;data.table&quot;</span>, type <span class="op">=</span> <span class="st">&quot;source&quot;</span>,</span>
<span>    repos <span class="op">=</span> <span class="st">&quot;https://Rdatatable.gitlab.io/data.table&quot;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&#39;fst&#39;</span>, type <span class="op">=</span> <span class="st">&#39;source&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="rquantlib">RQuantlib</h2>
<p>Either installing binary (intraday disabled) or install with brew</p>
<pre><code>brew install boost
brew install quantlib</code></pre>
<p>Disable ~/.R/Makevars (especially with above gcc conflicts : complie
with mac default clang)</p>
<p>Then install from source with configurations</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&quot;RQuantLib&quot;</span>, configure.args <span class="op">=</span> <span class="st">&quot;--with-boost-include=/usr/local/include/ --with-boost-lib=/usr/local/lib/&quot;</span>, type <span class="op">=</span> <span class="st">&quot;source&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>It takes a while to compile them.</p>
<p>Then ressurect Makevars file.</p>
<h2 id="rpostgres">RPostgres</h2>
Temporary solution for error (now fixed)
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&quot;RPostgres&quot;</span>, repos <span class="op">=</span> <span class="st">&quot;https://r-dbi.r-universe.dev&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="install-archived-packages">Install Archived packages</h2>
<p>Should be compiled in the computer using archived package
directory.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&quot;https://cran.r-project.org/src/contrib/Archive/lfe/lfe_2.8-5.1.tar.gz&quot;</span>, repos<span class="op">=</span><span class="cn">NULL</span>, type<span class="op">=</span><span class="st">&#39;source&#39;</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<p>For lfe, gfortran was needed for compliling on Mac, which could be
installed from R homepage <code>tools</code> section.</p>
<h2 id="rtools40-windows">Rtools40 (Windows)</h2>
<p>Starting with R 4.0.0 (released April 2020), R for Windows uses a
toolchain bundle called rtools40. R 4.0 requires to install Rtools to
install from source (C, fortran) for windows machines <a href="https://cran.rstudio.com/bin/windows/Rtools/" class="uri">https://cran.rstudio.com/bin/windows/Rtools/</a></p>
<p>In .Renviron file located in the documents folder, paste</p>
<pre><code>PATH=&quot;${RTOOLS40_HOME}\usr\bin;${PATH}&quot;</code></pre>
<p>To test if the installation &amp; path is set, <code>make</code>
should work.</p>
<pre><code>Sys.which(&quot;make&quot;)
## &quot;C:\\rtools40\\usr\\bin\\make.exe&quot;</code></pre>
<h2 id="delete-all-user-installed-packages">Delete all User installed
packages</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># # create a list of all installed packages</span></span>
<span><span class="co"># ip &lt;- as.data.frame(installed.packages())</span></span>
<span><span class="co"># head(ip)</span></span>
<span><span class="co"># # if you use MRO, make sure that no packages in this library will be removed</span></span>
<span><span class="co"># ip &lt;- subset(ip, !grepl(&quot;MRO&quot;, ip$LibPath))</span></span>
<span><span class="co"># # we don&#39;t want to remove base or recommended packages either\</span></span>
<span><span class="co"># ip &lt;- ip[!(ip[,&quot;Priority&quot;] %in% c(&quot;base&quot;, &quot;recommended&quot;)),]</span></span>
<span><span class="co"># # determine the library where the packages are installed</span></span>
<span><span class="co"># path.lib &lt;- unique(ip$LibPath)</span></span>
<span><span class="co"># # create a vector with all the names of the packages you want to remove</span></span>
<span><span class="co"># pkgs.to.remove &lt;- ip[,1]</span></span>
<span><span class="co"># head(pkgs.to.remove)</span></span>
<span><span class="co"># # remove the packages</span></span>
<span><span class="co"># sapply(pkgs.to.remove, remove.packages, lib = path.lib)</span></span></code></pre>
</div>
</div>
<h2 id="remove-miniconda-completely">Remove Miniconda completely</h2>
<p>Not r-reticulate miniconda</p>
<pre><code>rm -rf opt/miniconda3
rm -rf ~/.condarc ~/.conda ~/.continuum</code></pre>
<h2 id="arrow-with-snappy-compression">Arrow with snappy
compression</h2>
Before installing arrow run
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>ARROW_WITH_SNAPPY <span class="op">=</span> <span class="st">&quot;ON&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Then</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&#39;arrow&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="reticulate-python">RETICULATE Python</h2>
<h3 id="installation">Installation</h3>
<p>Check default installation path :</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">reticulate</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/miniconda_path.html">miniconda_path</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Mac default installation path:</span></span>
<span><span class="co"># /Users/matthewson/Library/r-miniconda/</span></span>
<span></span>
<span><span class="co"># Windows default installation path :</span></span>
<span><span class="co"># &quot;C:/Users/gunsu.son/AppData/Local/r-miniconda&quot;</span></span></code></pre>
</div>
</div>
<h3 id="mac">Mac</h3>
<ol type="1">
<li><p>setup conda :</p>
<p>source /Users/matthewson/Library/r-miniconda/bin/activate</p></li>
<li><p>Initialize conda - base will be activated all the time</p></li>
</ol>
<p>Mac - zsh:</p>
<pre><code>run conda init zsh</code></pre>
<p>linux - bash:</p>
<pre><code>run conda init bash</code></pre>
<ol start="3" type="1">
<li><p>.Renviron Setup</p>
<p>echo
RETICULATE_PYTHON=~/Library/r-miniconda/envs/r-reticulate/bin/python
&gt;&gt; ~/.Renviron</p></li>
<li><p>Browse conda environments</p>
<p>conda env list</p></li>
<li><p>Use reticulate conda</p>
<p>conda activate r-reticulate</p></li>
</ol>
<p>To activate conda</p>
<pre><code>source /Users/matthewson/Library/r-miniconda/bin/activate</code></pre>
<h4 id="apple-sillicon">Apple Sillicon</h4>
<p>Download and install Miniforge3 for Apple silicon, default location
<code>~/miniforge3</code></p>
<p>Then create a new environment, called <code>r-reticulate</code> with
python installed in it.</p>
<pre><code>conda create -n r-reticulate python</code></pre>
<p>Then set environment variable for Rstudio:</p>
<pre><code>echo &#39;RETICULATE_PYTHON=&quot;~/miniforge3/envs/r-reticulate/bin/python&quot;&#39; &gt;&gt; ~/.Renviron</code></pre>
<h3 id="windows">Windows</h3>
<ol start="0" type="1">
<li>Use Anaconda Prompt, or</li>
</ol>
<p>Make Anaconda prompt from CMD</p>
<ol type="1">
<li><p>Create symlink (shortcut) file for cmd located at</p>
<p>%windir%.exe</p></li>
</ol>
<p>and go properties and set target</p>
<pre><code>%windir%\System32\cmd.exe &quot;/K&quot; %userprofile%\AppData\Local\r-miniconda\Scripts\activate.bat</code></pre>
<p>set Start in:</p>
<pre><code>%HOMEPATH%</code></pre>
<p>In order it to be found in the start menu, paste it into</p>
<pre><code>%userprofile%\AppData\Roaming\Microsoft\Windows\Start_Menu\Programs\Miniconda3</code></pre>
<h3 id="conda-setup">Conda setup</h3>
<h4 id="environments">Environments</h4>
<p>Browse list of environments</p>
<pre><code>conda env list</code></pre>
<p>Remove environment</p>
<pre><code>conda env remove -n env_name</code></pre>
<h4 id="channel">Channel</h4>
<p>Change the priority channel</p>
<pre><code>conda config --prepend channels conda-forge</code></pre>
<p>Get channel names</p>
<pre><code>conda config --get channels</code></pre>
<h1 id="r-markdown">R MARKDOWN</h1>
<h2 id="beamer-examples">Beamer EXAMPLES</h2>
<h3 id="hide-section-slide">Hide Section slide</h3>
<p><a href="https://stackoverflow.com/questions/38180441/dropping-frames-of-sections-and-subsections-titles-for-knitr-beamer-slides" class="uri">https://stackoverflow.com/questions/38180441/dropping-frames-of-sections-and-subsections-titles-for-knitr-beamer-slides</a></p>
<p>Add this in YAML header.</p>
<pre><code>header-includes: 
- \AtBeginSubsection{}
- \AtBeginSection{}</code></pre>
<h3 id="use-custom-style">Use custom style</h3>
<p>Using <code>.sty</code> file as external template for latex (beamer
in this example)</p>
<pre><code>output: 
  beamer_presentation:
    includes:
      in_header:
        - Mytheme1.sty</code></pre>
<h2 id="article-example">Article example</h2>
<h3 id="use-custeom-pandoc-template">Use Custeom Pandoc Template</h3>
<p>Because of adjustbox issue, this fixes the issue.</p>
<p>This is the code for test.tex (Gin is making issue with
adjustbox)</p>
<p><a href="https://github.com/jgm/pandoc-templates/blob/master/default.latex" class="uri">https://github.com/jgm/pandoc-templates/blob/master/default.latex</a></p>
<p><strong>Comment out Gin part</strong></p>
<h3 id="import-latex-packages">Import LaTeX packages</h3>
<p>There are basically two ways to include external packages in YAML
header:</p>
<ol type="1">
<li>Use <code>extra_dependencies</code> on pdf_document:</li>
<li>Use <code>header_includes</code> and</li>
</ol>
<pre><code>---
title: &quot;Analysis&quot;
output: 
  pdf_document:
    extra_dependencies: [&quot;float&quot;]
header-includes:
  - \usepackage{booktabs}
  - \usepackage{geometry}
---</code></pre>
<h3 id="prevent-floating">Prevent floating</h3>
<p>In order to prevent floating, package <code>float</code> must be
imported</p>
<pre><code>---
output: 
  pdf_document:
    extra_dependencies: [&quot;float&quot;]
---</code></pre>
<p>Then make a default setup</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>fig.pos <span class="op">=</span> <span class="st">&quot;!H&quot;</span>, out.extra <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="subfigures">Subfigures</h3>
<p>In header-includes: -usepackage{subfig} needs to be included</p>
<pre><code>\begin{figure}[H]
\subfloat[Customer Volume\label{fig:volume_trend-1}]{\includegraphics[width=0.5\linewidth]{plots/trend_customer} }
\subfloat[Professional Volume\label{fig:volume_trend-2}]{\includegraphics[width=0.5\linewidth]{plots/trend_prof} }
\caption{Option Trade Volume Trend}\label{fig:volume_trend}
\textit{Note:} The sample consists of all CBOE options trades on S\&amp;P500 stocks from October 2019 to March 2021. Figure on left display all customer option transaction volume by option types. Figure on the right is trend of professional customer volume by option types.
\end{figure}</code></pre>
<h2 id="chunk-options">chunk options</h2>
<ul>
<li>echo=FALSE : no code chunk but output</li>
</ul>
<div class="layout-chunk" data-layout="l-body">

</div>
<ul>
<li>results=hide : no text output results</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;text&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<ul>
<li><p>include=FALSE : code and output not included, but
executed</p></li>
<li><p>eval=FALSE : code chunk not executed but knitted</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;this chunk is not evaluated. It is good use to only show the code&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<ul>
<li><p>collapse=TRUE : image and text output are merged into a single
block.<br />
Good when warning message(text) is printed when the chunk is executed.
Usually it is the case when plotting graphs.</p></li>
<li><p>error=TRUE : when error has to be reported.</p></li>
</ul>
<h3 id="global-chunk-options">global chunk options</h3>
<h2 id="yaml-header">YAML Header</h2>
<h3 id="yaml-example">YAML example</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">title</span><span class="op">:</span> <span class="st">&quot;R CookBook&quot;</span></span>
<span><span class="va">author</span><span class="op">:</span> <span class="st">&quot;Matthew Son&quot;</span></span>
<span><span class="va">date</span><span class="op">:</span> <span class="st">&quot;Last Updated : `r Sys.Date()`&quot;</span></span>
<span><span class="va">output</span><span class="op">:</span></span>
<span>  <span class="va">html_notebook</span><span class="op">:</span></span>
<span>    <span class="va">toc</span><span class="op">:</span> <span class="va">yes</span></span>
<span>    <span class="va">toc_depth</span><span class="op">:</span> <span class="fl">3</span></span>
<span>    <span class="va">toc_float</span><span class="op">:</span></span>
<span>      <span class="va">collapsed</span><span class="op">:</span> <span class="va">false</span></span>
<span>      <span class="va">smooth_scroll</span><span class="op">:</span> <span class="va">yes</span></span>
<span><span class="va">params</span><span class="op">:</span></span>
<span>  <span class="va">my_param</span><span class="op">:</span> <span class="va">HOHOHO</span></span></code></pre>
</div>
</div>
<h3 id="parameter">parameter</h3>
<!-- Call the parameter with  -->
<h3 id="style">style</h3>
<p>Style can be saved with .css file and be loaded at css</p>
<p>Detailed options for stylish presentation</p>
<ul>
<li><p>body : for entire body of the html</p></li>
<li><p>pre : for code chunks style</p></li>
<li><p>#TOC : for table of contents box</p></li>
<li><p>#header : for header</p>
<ul>
<li>h1.title</li>
<li>h4.author</li>
<li>h4.date</li>
</ul></li>
<li><p>color</p></li>
<li><p>background-color</p></li>
<li><p>font-family</p></li>
<li><p>font-size</p></li>
<li><p>opacity</p></li>
</ul>
<h2 id="markdown">Markdown</h2>
<h3 id="text">text</h3>
<p><strong>bold</strong></p>
<p><em>italic</em></p>
<p><del>strikethrough</del></p>
<pre><code>Message in the Box : double tap


- Double tap and hypen</code></pre>
<h3 id="hyperlink">hyperlink</h3>
<p>This is the <a href="http://google.com/">hyperlink text</a></p>
<h3 id="embed-image">embed image</h3>
<figure>
<img src="data:image/jpeg;base64,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" alt="This is a caption of the image put below" />
<figcaption aria-hidden="true">This is a caption of the image put
below</figcaption>
</figure>
<h3 id="latex">LaTeX</h3>
<h4 id="subscript-superscript">subscript / superscript</h4>
<p>Limits</p>
<p><span class="math display">\[\sum\limits_1^N\]</span></p>
<h4 id="curly-brackets-up-and-down">Curly brackets up and down</h4>
<p>Overbrace and Underbrace</p>
<p><span class="math display">\[\text{NPV} =
\overbrace{\text{CF}_0}^{\substack{\text{Excel&#39; NPV function} \\
\text{does not accont for this}}} +
\underbrace{\sum_{t=1}^N\frac{\text{CF}_t}{(1+r)^t}}_{\substack{
\text{This is what Excel&#39;s} \\ \text{NPV function calculates}}
}\]</span></p>
<h2 id="kable-kableextra">Kable (KableExtra)</h2>
<h3 id="table-digits-and-formatting">Table digits and formatting</h3>
<p>Example</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">summary</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">kbl</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>      format.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>big.mark <span class="op">=</span> <span class="st">&quot;,&quot;</span>, </span>
<span>                         scientific <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>latex_options <span class="op">=</span> <span class="st">&quot;HOLD_position&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">iris</span> <span class="op">%&gt;%</span> <span class="va">head</span>, align <span class="op">=</span> <span class="st">&#39;ccc&#39;</span>, caption <span class="op">=</span> <span class="st">&#39;This is caption&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Comparison : without kable</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">iris</span> <span class="op">%&gt;%</span> <span class="va">head</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="kableextra">kableExtra</h4>
<p>Package that adds more features on kable.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/">kableExtra</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kbl.html">kbl</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_classic_2</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_classic.html">kable_paper</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/scroll_box.html">scroll_box</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">&quot;100%&quot;</span>, height <span class="op">=</span> <span class="st">&quot;200px&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="internal-links">Internal links</h3>
<p>Pandoc supports explicit and implicit section references for headers;
see the pandoc manual.</p>
<ul>
<li><p>explicit: you give a custom name to a header ## Test {#test} and
later refer to it with a link syntax: see <a href="#test">the relevant
section</a>.</p></li>
<li><p>implicit: headers where you dont set a custom name, like ##
Test, can still be refered to: See the section called [Test].</p></li>
</ul>
<h1 id="base-r-rstudio">BASE R / RStudio</h1>
<h2 id="r-function-tricks">R Function Tricks</h2>
<h3 id="expressions-to-string">Expressions to string</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">substitute</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span><span class="op">)</span> <span class="co"># similar but takes the function&#39;s argument instead</span></span></code></pre>
</div>
</div>
<h3 id="assign-to-string-object">assign to string object</h3>
<h4 id="assign-.globalenv">assign / .GlobalEnv</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">x</span> <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/assign.html">assign</a></span><span class="op">(</span><span class="st">&#39;x&#39;</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">.GlobalEnv</span><span class="op">$</span><span class="st">&#39;x&#39;</span> <span class="op">=</span> <span class="fl">3</span></span>
<span></span>
<span><span class="co"># .GlobalEnv gives accessibility </span></span>
<span></span>
<span><span class="va">.GlobalEnv</span><span class="op">$</span><span class="st">&#39;x&#39;</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># automatically generate as list</span></span>
<span><span class="va">.GlobalEnv</span><span class="op">[[</span><span class="st">&#39;x&#39;</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># This one accepts functions</span></span>
<span></span>
<span><span class="va">var</span> <span class="op">=</span> <span class="st">&#39;x&#39;</span></span>
<span><span class="va">.GlobalEnv</span><span class="op">[[</span><span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">&#39;{var}&#39;</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fl">3</span></span></code></pre>
</div>
</div>
<h3 id="string-evaluation">string evaluation</h3>
<p>Two versions : <code>evalparse</code> and <code>get</code></p>
<h4 id="eval-parse">eval parse</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text<span class="op">=</span><span class="st">&#39;iris&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="get-mget">get / mget</h4>
<h5 id="get">get</h5>
<p>A string to point object in environment</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co">#example</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="st">&#39;Hello, world!&#39;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;a&#39;</span><span class="op">)</span> <span class="co"># this is a string</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">&#39;a&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># get(&#39;a&#39;) == a</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h5 id="mget">mget</h5>
<p>Convert a vector of string object names into list of objects</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># example</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">obj_names</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/get.html">mget</a></span><span class="op">(</span><span class="va">obj_names</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="options">Options</h2>
<h3 id="rprofile">.Rprofile</h3>
<p><code>.Rprofle</code> needs to be setup.</p>
<p>On Mac</p>
<pre><code>echo &quot;options(datatable.prine.class =T)&quot; &gt;&gt; ~/.Rprofile</code></pre>
<p>On Windows</p>
<pre><code>echo options(reticulate.repl.quiet = T) &gt; %userprofile%\Documents\.Rprofile</code></pre>
<h3 id="data.table-options">data.table options</h3>
<p>Print options with <code>data.table</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># change default options</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>datatable.print.nrows <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>datatable.print.topn <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>datatable.print.class<span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># change locally</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">DT</span>, topn <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="str-options">str options</h3>
<p>Print options with <code>str</code> function - list.len</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>str <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/str.html">strOptions</a></span><span class="op">(</span>list.len <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="reticulate-options">Reticulate options</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>reticulate.repl.quiet <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="data.frame">data.frame</h2>
<h3 id="transpose-data.frame">transpose data.frame</h3>
When data.frame has row names and column names
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris_transpose</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">iris_df</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="shquote">shQuote</h2>
<p>Adding quotes to each characters</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/shQuote.html">shQuote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;AAPL&#39;</span>,<span class="st">&#39;AA&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># [1] &quot;&#39;AAPL&#39;&quot; &quot;&#39;AA&#39;&quot;</span></span></code></pre>
</div>
</div>
<h2 id="outer">outer</h2>
<p>Outer product of two arrays</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">months</span><span class="op">=</span> <span class="fu">str_pad</span><span class="op">(</span><span class="fl">9</span><span class="op">:</span><span class="fl">12</span>, <span class="fl">2</span>, pad <span class="op">=</span><span class="st">&#39;0&#39;</span><span class="op">)</span></span>
<span><span class="va">days</span> <span class="op">=</span> <span class="fu">str_pad</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span>,<span class="fl">2</span>,pad<span class="op">=</span><span class="st">&#39;0&#39;</span><span class="op">)</span></span>
<span><span class="va">md</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">months</span>, <span class="va">days</span>, FUN <span class="op">=</span> <span class="va">str_c</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="list.files">list.files</h2>
<p>Making the list of file names</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">file.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">&#39;*.xlsx&#39;</span><span class="op">)</span></span>
<span><span class="va">df.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">file.list</span>, <span class="va">read_excel</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="str">str</h2>
<p>Print all of the data.frame (data.table)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># print more</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">df</span>, list.len<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="cut">cut</h2>
<p>Cut and make groups. Useful for time cutting.</p>
My usage example
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">test2</span><span class="op">[</span>,<span class="va">by10</span> <span class="op">:=</span> <span class="fu">fastPOSIXct</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">quote_datetime</span>, breaks<span class="op">=</span><span class="st">&#39;10 min&#39;</span><span class="op">)</span>, tz<span class="op">=</span><span class="st">&#39;UTC&#39;</span><span class="op">)</span> <span class="op">+</span> <span class="fl">600</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="factor">factor</h2>
<h3 id="unordered">Unordered</h3>
<p>labeling makes the column as if character vector</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">fam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`0` <span class="op">=</span> <span class="st">&#39;automatic&#39;</span>,</span>
<span>                                           `1` <span class="op">=</span> <span class="st">&#39;manual&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="ordered">Ordered</h3>
<p>: use <code>level</code> and <code>label</code> both</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">fam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span>,</span>
<span>                     levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;manual&quot;</span>, <span class="st">&quot;automatic&quot;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="error-handling">Error Handling</h2>
<h3 id="exists">exists()</h3>
Stop and error when condition is met. Object name is given in character.
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">simplefunc</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/exists.html">exists</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;Success&#39;</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">simplefunc</span><span class="op">(</span><span class="st">&#39;iris&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="stop">stop()</h3>
<h3 id="stopifnot">stopifnot()</h3>
<h3 id="try">try()</h3>
<p>When error has to be skipped in the loop, use <code>try</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># lapplying log function, error on the last</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="st">&#39;oh&#39;</span>,<span class="fl">4</span><span class="op">)</span></span>
<span><span class="co"># lapply doesn&#39;t report the interim output because of error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">log</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">k</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">a</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># it does work, and shows error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">k</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># try-error</span></span></code></pre>
</div>
</div>
<p>When ran in data.table, errors are recorded with NA</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="va">irist</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">irist</span><span class="op">[</span><span class="fl">3</span>, <span class="va">a</span> <span class="op">:=</span> <span class="fl">5</span><span class="op">]</span></span>
<span><span class="va">irist</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">irist</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">irist</span><span class="op">[</span><span class="va">i</span>, <span class="va">a</span> <span class="op">:=</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">Species</span><span class="op">)</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span> <span class="co"># data.table coerces to NA for numeric column</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h3 id="trycatch">tryCatch()</h3>
<p>More on error handling : what should do when it generates error?</p>
<p>It should be given in functional form. Give anonymous function for
simple operations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="st">&#39;a&#39;</span><span class="op">)</span>,</span>
<span>         error <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;You silly, put number instead&#39;</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span><span class="op">?</span><span class="va">tryCatch</span></span></code></pre>
</div>
</div>
<h2 id="rstudioapi">RStudioapi</h2>
<h3 id="run-code-on-terminal">run code on terminal</h3>
<p>Run code on the terminal from R script</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rstudioapi/man/terminalExecute.html">terminalExecute</a></span><span class="op">(</span><span class="st">&#39;ls&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="increase-view-column-limit">increase View column limit</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rstudioapi/man/writeRStudioPreference.html">writeRStudioPreference</a></span><span class="op">(</span><span class="st">&quot;data_viewer_max_columns&quot;</span>, <span class="fl">1000L</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="benchmarking">BENCHMARKING</h1>
<h2 id="system-configurations">system configurations</h2>
<p>For bug reporting, etc.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p><code>benchmarkme</code> package : checking out the specification of
the local.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Load the package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/csgillespie/benchmarkme">benchmarkme</a></span><span class="op">)</span></span>
<span><span class="co"># Assign the variable ram to the amount of RAM on this machine</span></span>
<span><span class="fu">get_ram</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Assign the variable cpu to the cpu specs</span></span>
<span><span class="fu">get_cpu</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Load the parallel package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span><span class="co"># Store the number of cores in the object no_of_cores</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># number of cores</span></span>
<span><span class="op">?</span><span class="va">detectCores</span></span></code></pre>
</div>
</div>
<p><code>microbenchmark</code> package : for efficiency and speed
comparision</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;ak&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;abcdefg&#39;</span><span class="op">)</span>,</span>
<span>  times<span class="op">=</span><span class="fl">100L</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="benchmarking-time">benchmarking time</h2>
<p>Using <code>Sys.time()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">tic</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;haha&#39;</span><span class="op">)</span></span>
<span><span class="va">toc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">toc</span> <span class="op">-</span> <span class="va">tic</span></span></code></pre>
</div>
</div>
<p>Using <code>system.time()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;hahaha&#39;</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="parallel-processing">PARALLEL PROCESSING</h1>
<p>Basic introduction :</p>
<p><code>parallel</code>, <code>foreach</code>,
<code>future.apply</code> packages uses master / worker.</p>
<p>They are good for single machine and medium size data.</p>
<p><code>sparklyr</code> utilizes Spark, which uses Map-Reduce.</p>
<h2 id="disk.frame">DISK.FRAME</h2>
<p>disk.frame is an future object that connects to a folder that
contains multiple .fst files. Those multiple fst files are chunks from
the original file.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris.df</span> <span class="op">=</span> <span class="fu">as.disk.frame</span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="co"># without path specification, it saves to temp foler</span></span>
<span><span class="va">iris.df</span> <span class="co"># nchunks 8</span></span></code></pre>
</div>
</div>
<h3 id="setup">Setup</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">setup_disk.frame</span><span class="op">(</span>workers <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.globals.maxSize <span class="op">=</span> <span class="cn">Inf</span>,  <span class="co"># Unlimited data communication</span></span>
<span>        future.rng.onMisuse <span class="op">=</span> <span class="st">&#39;ignore&#39;</span><span class="op">)</span> <span class="co"># Ignore random seeds</span></span></code></pre>
</div>
</div>
<h3 id="basic-operations">Basic operations</h3>
<h4 id="read-disk.frame">Read disk.frame</h4>
<h5 id="disk.frame-1">disk.frame()</h5>
<p>Linking the file folder path as disk.frame. It expects .fst files
within the folder. Folder itself is the <code>disk.frame</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">disk.frame</span><span class="op">(</span>path <span class="op">=</span> <span class="st">&#39;folderpath&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h5 id="csv_to_disk_frame">csv_to_disk_frame()</h5>
<p>When csv is to large to read, read in chunks</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">flights.df</span> <span class="op">&lt;-</span> <span class="fu">csv_to_disk.frame</span><span class="op">(</span></span>
<span>  <span class="va">csv_path</span>, </span>
<span>  outdir <span class="op">=</span> <span class="va">df_path</span>, </span>
<span>  in_chunk_size <span class="op">=</span> <span class="fl">1e7</span>, <span class="co"># chunk size by number of rows</span></span>
<span>  nchunks <span class="op">=</span> <span class="fl">8</span>, <span class="co"># number of chunks</span></span>
<span>  .progress <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;colnames&#39;</span><span class="op">)</span> <span class="co"># passed onto fread</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
<h6 id="jit-transformation">JIT transformation</h6>
<p>This approach is faster than reading csv and transform and save.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">df</span> <span class="op">=</span> <span class="fu">csv_to_disk.frame</span><span class="op">(</span><span class="st">&#39;filepath&#39;</span>, </span>
<span>                       inmapfn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">chunk</span><span class="op">)</span> <span class="op">{</span></span>
<span>                         <span class="co"># convert to date_str to date format and store as &quot;date&quot;</span></span>
<span>                         <span class="va">chunk</span><span class="op">[</span>, <span class="va">date</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">date_str</span>, <span class="st">&quot;%Y-%m-%d&quot;</span><span class="op">)</span><span class="op">]</span></span>
<span>                         <span class="va">chunk</span><span class="op">[</span>, <span class="va">date_str</span><span class="op">:=</span><span class="cn">NULL</span><span class="op">]</span></span>
<span>                       <span class="op">}</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h5 id="zip_to_disk.frame">zip_to_disk.frame()</h5>
<p>zip file to directly read to disk.frame. Arguments are same as
csv_to_disk.frame</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">zip_to_disk.frame</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="write-disk.frame">Write disk.frame</h4>
<h5 id="write_disk.frame">write_disk.frame()</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">write_disk.frame</span><span class="op">(</span><span class="op">)</span> <span class="co"># useful for rechunking as well!</span></span></code></pre>
</div>
</div>
<h4 id="prompt-evaluation">Prompt evaluation</h4>
<p>Currenlty, data.table opertaions are evaluated promptly, for each
chunk of <code>.fst</code> files.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris.df</span><span class="op">[</span><span class="op">]</span> <span class="co"># collect all, warning!!</span></span>
<span><span class="va">iris.df</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># 1st row of all chunks</span></span>
<span><span class="va">iris.df</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co"># first 5 rows of all chunks</span></span></code></pre>
</div>
</div>
<h4 id="lazy-evaluation">Lazy evaluation</h4>
<p>Manipulating disk.frame with lazy evaluation</p>
<p>Use evaluation with <code>cmap</code> Warning : since it is not in
memory, cant be overwritten on the same disk.frame! When
<code>cmap</code> is called without object name definition, it is
evaluated promptly.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># prompt function performance &amp; write disk.frame</span></span>
<span><span class="fu">cmap</span><span class="op">(</span><span class="va">iris.df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">chunk</span><span class="op">)</span><span class="op">{</span><span class="va">chunk</span><span class="op">[</span>,<span class="va">newval2</span><span class="op">:=</span> <span class="fl">1</span><span class="op">]</span><span class="op">}</span>,</span>
<span>     <span class="co"># keep = c(&#39;col1&#39;,&#39;col2&#39;),</span></span>
<span>     outdir <span class="op">=</span> <span class="st">&#39;df_name&#39;</span>,</span>
<span>     lazy<span class="op">=</span><span class="cn">FALSE</span>, <span class="co"># prompt writing</span></span>
<span>     overwrite <span class="op">=</span> <span class="cn">T</span>,</span>
<span>     compress <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>To do lazily, save into an object and use with
<code>write_disk.frame</code>.</p>
Warning : since it is not in memory, cant be overwritten on the same
disk.frame!
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">k</span> <span class="op">=</span> <span class="fu">cmap</span><span class="op">(</span><span class="va">iris.df</span>, <span class="kw">function</span><span class="op">(</span><span class="va">chunk</span><span class="op">)</span><span class="op">{</span><span class="va">chunk</span><span class="op">[</span>,<span class="va">newval2</span> <span class="op">:=</span> <span class="fl">2</span><span class="op">]</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu">write_disk.frame</span><span class="op">(</span><span class="va">k</span>,</span>
<span>                 outdir <span class="op">=</span> <span class="st">&#39;df_name2&#39;</span>, <span class="co"># shoulf be different folder than original disk frame</span></span>
<span>                 compress<span class="op">=</span><span class="fl">100</span>,</span>
<span>                 overwrite<span class="op">=</span><span class="cn">TRUE</span></span>
<span>                 <span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="access-chunks">Access chunks</h4>
<h5 id="get_chunk">get_chunk()</h5>
<p>Get chunk with integer id number. Does not guarantee the integer is
in sequence when hased (shardby) !!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">get_chunk</span><span class="op">(</span><span class="va">iris.df</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># needs </span></span></code></pre>
</div>
</div>
<h5 id="get_chunk_ids">get_chunk_ids()</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">get_chunk_ids</span><span class="op">(</span><span class="va">iris.df</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="rechunk">Rechunk</h4>
<p>Two approaches : using <code>write_disk.frame</code> and provide
explicit nchunks / use <code>rechunk</code> function</p>
<p>`write_disk.frame</p>
<h3 id="examples">Examples</h3>
<h4 id="shardkey">shardkey</h4>
<h2 id="future">FUTURE</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org">future</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multicore</span><span class="op">)</span> <span class="co"># forking, no RStudio, no windows</span></span></code></pre>
</div>
</div>
<p>Options</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.gc<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># garbage collection</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.globals.maxSize <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="basics-of-future">Basics of Future</h3>
<p>Basics : when future is called, the process is done behind the scene
- opens up a new session and do the job then returns the value to the
original session.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># a slow process that takes 20 secs</span></span>
<span><span class="va">slow_sum</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">slow_sum</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span> <span class="co"># has to wait 20 secs to get the answer!</span></span></code></pre>
</div>
</div>
<p>Now use future to run it behind the scene.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">fa</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="fu">slow_sum</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="co"># does job behind the scene, 10sec</span></span>
<span><span class="va">fb</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="fu">slow_sum</span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="co"># does job behind the scene, 10 sec</span></span></code></pre>
</div>
</div>
<p>To take out the calculated value, call <code>value()</code>. If it is
called too early, then it waits until the future is complete!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">fa</span><span class="op">)</span> <span class="co"># when called within 10 sec, it waits!</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">fb</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span></span></code></pre>
</div>
</div>
In order to do it in one step,
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">a</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span><span class="fu">slow_sum</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">}</span> <span class="co"># future and store value when resolved</span></span>
<span><span class="va">a</span> <span class="co"># waits if it is not resolved</span></span></code></pre>
</div>
</div>
To know if the future was resolved,
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/resolved.html">resolved</a></span><span class="op">(</span><span class="va">fa</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="garbage-collection">Garbage collection</h4>
Can be set in the beginning
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">cluster</span>, workers <span class="op">=</span> <span class="va">cl</span>, gc <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
If garbage collection needed after value was retrieved;
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span> <span class="va">expr</span> <span class="op">}</span>, gc<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="future-with-data.table">Future with data.table</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span>
<span><span class="va">dt_iris</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">dt_iris</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="va">dt_iris</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Sepal.Length</span><span class="op">)</span><span class="op">]</span>, packages<span class="op">=</span><span class="st">&#39;data.table&#39;</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="export-globals">Export globals</h3>
<p>From future documentation :</p>
<p>In most cases, such automatic collection of globals is sufficient and
less tedious and error prone than if they are manually specified.
However, for full control, it is also possible to explicitly specify
exactly which the globals are by providing their names as a character
vector. In the above example, we could use</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span> <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span>; <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">}</span>, globals <span class="op">=</span> <span class="st">&quot;a&quot;</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span> <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span>; <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">}</span>, globals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span><span class="op">)</span><span class="op">)</span> <span class="co"># same</span></span></code></pre>
</div>
</div>
we can disable the automatic search for globals by using
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span> <span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">42</span>; <span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span>; <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">}</span>, globals <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b</span> <span class="op">}</span>, globals <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span><span class="va">a</span><span class="op">*</span><span class="va">b</span><span class="op">}</span>, globals <span class="op">=</span> <span class="st">&#39;a&#39;</span><span class="op">)</span> <span class="co"># only a</span></span>
<span><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="co"># varible a not found!</span></span>
<span><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f2</span><span class="op">)</span> <span class="co"># b not found</span></span></code></pre>
</div>
</div>
Example : dt_iris and a defined in the global environment, but Im
only exporting subset of globals
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">dt_iris</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dt_iris</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>; <span class="va">iris</span><span class="op">[</span><span class="va">Sepal.Length</span> <span class="op">==</span> <span class="fl">5.1</span><span class="op">]</span><span class="op">}</span>, globals<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>iris <span class="op">=</span> <span class="va">dt_iris</span><span class="op">[</span><span class="va">Species</span><span class="op">==</span><span class="st">&#39;setosa&#39;</span><span class="op">]</span><span class="op">)</span>, package<span class="op">=</span><span class="st">&#39;data.table&#39;</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span>  <span class="co"># prints first error message, and does not do the job afterwards! </span></span>
<span><span class="va">v</span></span></code></pre>
</div>
</div>
<h3 id="errors-in-the-future">Errors in the future</h3>
Example : dt_iris and a defined in the global environment, but Im
only exporting subset of globals
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&#39;working&#39;</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dt_iris</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>; <span class="va">iris</span><span class="op">[</span><span class="va">Sepal.Length</span> <span class="op">==</span> <span class="fl">5.1</span><span class="op">]</span>; <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&#39;work done here&#39;</span><span class="op">)</span><span class="op">}</span>, globals<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>iris <span class="op">=</span> <span class="va">dt_iris</span><span class="op">[</span><span class="va">Species</span><span class="op">==</span><span class="st">&#39;setosa&#39;</span><span class="op">]</span><span class="op">)</span>, package<span class="op">=</span><span class="st">&#39;data.table&#39;</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="co"># prints first error message, and does not do the job afterwards! </span></span>
<span><span class="va">v</span> <span class="co"># no object assigned</span></span></code></pre>
</div>
</div>
<p>I can igore the error and just proceed with tryCatch with empty
function <code>error = function() {NULL}</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span></span>
<span>    <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&#39;working&#39;</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dt_iris</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>; <span class="va">dt_iris</span><span class="op">[</span><span class="va">Sepal.Length</span> <span class="op">==</span> <span class="fl">5.1</span><span class="op">]</span>; <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&#39;work done here&#39;</span><span class="op">)</span> <span class="op">}</span>,</span>
<span>    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span><span class="cn">NULL</span><span class="op">}</span></span>
<span>  <span class="op">)</span>,</span>
<span>  globals<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>iris <span class="op">=</span> <span class="va">dt_iris</span><span class="op">[</span><span class="va">Species</span><span class="op">==</span><span class="st">&#39;setosa&#39;</span><span class="op">]</span><span class="op">)</span>, </span>
<span>  package<span class="op">=</span><span class="st">&#39;data.table&#39;</span><span class="op">)</span></span>
<span><span class="va">v</span><span class="op">=</span><span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="va">v</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span></span>
<span>    <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&#39;working&#39;</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dt_iris</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span>; <span class="va">dt_iris</span><span class="op">[</span><span class="va">Sepal.Length</span> <span class="op">==</span> <span class="fl">5.1</span><span class="op">]</span>; <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&#39;work done here&#39;</span><span class="op">)</span> <span class="op">}</span>,</span>
<span>    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span><span class="cn">NULL</span><span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="set-workers-cores-for-each-process">Set workers (cores) for each
process</h3>
<h4 id="multisession-sequential">Multisession + Sequential</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html">availableCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableWorkers.html">availableWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/tweak.html">tweak</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="co"># 4 R sessions</span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/tweak.html">tweak</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># nested future use 2 separate sessions</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>H2O example for this</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/h2oai/h2o-3">h2o</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org">future</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="fu"><a href="https://future.futureverse.org/reference/tweak.html">tweak</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># only two R processes</span></span>
<span></span>
<span><span class="co"># initiate multiple h2o clusters and match them to separate R processes</span></span>
<span><span class="va">jar_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">&#39;java&#39;</span>, <span class="st">&#39;h2o.jar&#39;</span>, package<span class="op">=</span><span class="st">&#39;h2o&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">&#39;java -Xmx4g -jar {jar_path} -name n1 -nthreads 4  -port 54321&#39;</span><span class="op">)</span>, intern <span class="op">=</span> <span class="cn">F</span>, wait <span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">&#39;java -Xmx4g -jar {jar_path} -name n2 -nthreads 4  -port 54322&#39;</span><span class="op">)</span>, intern <span class="op">=</span> <span class="cn">F</span>, wait <span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">f1</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="co"># h2o.shutdown(prompt = F)</span></span>
<span>  <span class="fu">h2o.init</span><span class="op">(</span>startH2O <span class="op">=</span> <span class="cn">F</span>, port <span class="op">=</span> <span class="fl">54321</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span>, lazy <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">f2</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="co"># h2o.shutdown(prompt = F)</span></span>
<span>  <span class="fu">h2o.init</span><span class="op">(</span>startH2O <span class="op">=</span> <span class="cn">F</span>, port <span class="op">=</span> <span class="fl">54322</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span>, lazy <span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="future-h2o">Future + H2O</h4>
<p>Split data by ticker, about equal size</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">my_tickers</span> <span class="op">=</span> <span class="va">alldays</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">TICKER</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span> <span class="co"># first 20 tickers for example</span></span>
<span><span class="va">num_tickers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">my_tickers</span><span class="op">)</span></span>
<span><span class="va">each</span> <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="va">chunks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span><span class="op">(</span><span class="va">my_tickers</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="va">num_tickers</span><span class="op">/</span><span class="va">each</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">chunks</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">class</span> <span class="co">#list</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://future.futureverse.org/reference/tweak.html">tweak</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://future.futureverse.org/reference/tweak.html">tweak</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Simple example</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/tweak.html">tweak</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html">availableCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="fl">4</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/tweak.html">tweak</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">v</span> <span class="op">&lt;-</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&quot;Hello world!\n&quot;</span><span class="op">)</span></span>
<span>  <span class="fl">3.14</span></span>
<span><span class="op">}</span></span>
<span><span class="va">v</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org">future</a></span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;hello\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fl">3.14</span></span>
<span><span class="op">}</span></span>
<span><span class="va">v</span> <span class="co"># evaluates when it is called!</span></span>
<span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableWorkers.html">availableWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">future</span><span class="fu">::</span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html">availableCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">v</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;hello\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fl">3.14</span></span>
<span><span class="op">}</span></span>
<span><span class="va">v</span> <span class="co"># evaluates when it is called!</span></span></code></pre>
</div>
</div>
<p>Explicit future</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;hello\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fl">3.14</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableWorkers.html">availableWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="va">x</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="va">a</span> <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="va">a</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x</span> </span>
<span><span class="va">a</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span><span class="va">pid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pid</span> <span class="co">#1] 24919</span></span>
<span></span>
<span><span class="va">a</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="va">pid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;a&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fl">3.14</span></span>
<span><span class="op">}</span></span>
<span><span class="va">b</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">pid</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;b&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="va">pid</span></span>
<span><span class="op">}</span></span>
<span><span class="va">c</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;c&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="va">a</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="va">pid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">pid</span> <span class="co">#1] 24919</span></span>
<span><span class="va">a</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="va">pid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;a&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fl">3.14</span></span>
<span><span class="op">}</span></span>
<span><span class="va">b</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">pid</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;b&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">c</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;c&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fl">2</span> <span class="op">*</span> <span class="va">a</span></span>
<span><span class="op">}</span></span>
<span><span class="va">b</span></span>
<span><span class="va">pid</span></span>
<span><span class="va">c</span></span></code></pre>
</div>
</div>
<p>Nested future</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">sequential</span>,<span class="va">multisession</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;a&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">b</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;b&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>  <span class="va">b1</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;b1&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">b2</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&#39;Future &quot;b2&quot; ...\n&#39;</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>b.pid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span>, b1.pid <span class="op">=</span><span class="va">b1</span>, b2.pid <span class="op">=</span> <span class="va">b2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">pid</span></span>
<span></span>
<span><span class="va">a</span> <span class="co"># [1] 25887 </span></span>
<span><span class="va">b</span> <span class="co"># 25943  25943  25943 </span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/listenv">listenv</a></span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/listenv/man/listenv.html">listenv</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/listenv/man/listenv.html">listenv</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">y</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://future.futureverse.org/reference/future.html">%&lt;-%</a></span> <span class="op">{</span> <span class="va">i</span> <span class="op">+</span> <span class="va">j</span> <span class="op">/</span><span class="fl">10</span><span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">y</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="examples-1">Examples</h3>
<h4 id="export-small-global-object">Export small global object</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">f1</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/message.html">message</a></span><span class="op">(</span><span class="st">&quot;Working on &quot;</span>, <span class="st">&quot;firm_open_buy_qty&quot;</span><span class="op">)</span>;</span>
<span>    <span class="va">slim_cboe</span></span>
<span>  <span class="op">}</span>, </span>
<span>  globals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>slim_cboe <span class="op">=</span> <span class="va">cboe</span><span class="op">[</span>,<span class="va">.SD</span>, .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">key_cols</span>, <span class="st">&quot;firm_open_buy_qty&quot;</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;data.table&#39;</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/value.html">value</a></span><span class="op">(</span><span class="va">f1</span><span class="op">)</span> <span class="co"># OK</span></span></code></pre>
</div>
</div>
<h4 id="future-with-function-wrap">Future with Function wrap</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">test_func</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">colname</span>, <span class="va">whole_data</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://future.futureverse.org/reference/future.html">future</a></span><span class="op">(</span></span>
<span>    <span class="op">{</span></span>
<span>      <span class="fu">tic</span><span class="op">(</span><span class="op">)</span>;</span>
<span>      <span class="va">slim_cboe</span><span class="op">[</span>, <span class="va">test</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/froll.html">frollapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">colname</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">2</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">}</span><span class="op">)</span><span class="op">]</span></span>
<span>      <span class="fu">toc</span><span class="op">(</span><span class="op">)</span>;</span>
<span>      <span class="va">slim_cboe</span><span class="op">[</span>,<span class="va">test</span><span class="op">]</span></span>
<span>    <span class="op">}</span>, </span>
<span>    globals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>slim_cboe <span class="op">=</span> <span class="va">whole_data</span><span class="op">[</span>,<span class="va">.SD</span>, .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">key_cols</span>, <span class="va">colname</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                   colname <span class="op">=</span> <span class="va">colname</span><span class="op">)</span>, <span class="co"># colname needs to be exported again</span></span>
<span>    packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;data.table&#39;</span>, <span class="st">&#39;tictoc&#39;</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">hmm</span> <span class="op">=</span> <span class="fu">test_func</span><span class="op">(</span><span class="st">&#39;firm_open_buy_qty&#39;</span>, <span class="va">cboe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/resolved.html">resolved</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">)</span> <span class="co">#OK!</span></span></code></pre>
</div>
</div>
<h3 id="dofuture">doFuture</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org">doFuture</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.globals.maxSize <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>future.rng.onMisuse <span class="op">=</span> <span class="st">&quot;ignore&quot;</span><span class="op">)</span> <span class="co"># ignore RNG warning</span></span>
<span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/getDoParWorkers.html">getDoParWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu">handlers</span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">handlers</span><span class="op">(</span><span class="st">&quot;progress&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="basics">Basics</h3>
<p>Exporting objects</p>
When it needs to be manual, it can be turned off with
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>doFuture.foreach.export <span class="op">=</span> <span class="st">&quot;.export&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Note that when using doFuture, arguments <code>.packages</code> and
<code>.export</code> in foreach() are not necessary, as the package
deals with the exports automatically.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org">doFuture</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/getDoParWorkers.html">getDoParWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">1</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">2</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="st">&#39;Sleeping 1 sec...&#39;</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<p>doFuture.foreach.export: Specifies to what extent the .export
argument of foreach() should be respected or if globals should be
automatically identified.</p>
<p>If .export, then the globals specified by the .export argument will
be used as is.</p>
<p>If .export-and-automatic, then globals specified by .export as well
as those automatically identified are used.</p>
<p>The .export-and-automatic-with-warning is the same as
.export-and-automatic, but produces a warning if .export lacks some of
the globals that the automatic identification locates</p>
<p>this is helpful feedback to developers using foreach().</p>
<h3 id="parallel-data.table">Parallel data.table</h3>
<p>For data.table to be applied in parallel, all DTs should be splitted
and saved into a list. <code>split</code> function is a possible use, or
using disk.frame to split and read.fst is a way.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">splited_dt</span>, .packages<span class="op">=</span><span class="st">&#39;data.table&#39;</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>    <span class="va">dt</span><span class="op">[</span>, <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">DATE</span>, <span class="st">&#39;(\\d{4})(\\d{2})(\\d{2})&#39;</span>, <span class="st">&#39;\\1-\\2-\\3&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span></code></pre>
</div>
</div>
<h5 id="fread-in-chunks">fread in chunks</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">data</span><span class="op">=</span><span class="cn">NULL</span></span>
<span><span class="va">chunk.size</span> <span class="op">=</span> <span class="fl">1e8</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">[[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span><span class="st">&quot;my_data.csv&quot;</span>, nrow <span class="op">=</span> <span class="va">chunk.size</span>, skip <span class="op">=</span> <span class="va">chunk.size</span><span class="op">*</span><span class="va">i</span> <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h4 id="global-assignment">Global assignment</h4>
<p><a href="https://github.com/HenrikBengtsson/doFuture/issues/29" class="uri">https://github.com/HenrikBengtsson/doFuture/issues/29</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,b<span class="op">=</span><span class="cn">NA</span>,c<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x</span> <span class="co"># doesn&#39;t work!</span></span></code></pre>
</div>
</div>
<p>The reason for this not working is that the parallel code (whats
inside the foreach {  } expression) is evaluated in a separate R
process that the main R session from where it is called. It is not
possible for other R processes on your machine to update the variables
in your main R session. An analogue is when you run two separate R
sessions manually and you do x &lt;- 42 in one of them - then you
wouldnt expected x to be assigned in the other R session. Thats how
parallel processing in R works too. <strong>Instead, all values must be
returned at the end</strong> of a parallel evaluation.</p>
<p>Instead, treat foreach() as you treat lapply(). If you do, then
youre example is effectively equal to:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">x</span><span class="op">$</span><span class="va">c</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Instead, you should always return values. That is, make sure all of
your foreach() calls are assigned to a variable, cf. y &lt;- lapply().
So, in your case you can to do something like:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>a<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,b<span class="op">=</span><span class="cn">NA</span>,c<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>i <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, .combine <span class="op">=</span> <span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>b <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">$</span><span class="va">b</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">c</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">$</span><span class="va">c</span></span></code></pre>
</div>
</div>
<p>In the ideal case, all it takes to start using futures in R is to
replace select standard assignments (&lt;-) in your R code with future
assignments (%&lt;-%) and make sure the right-hand side (RHS)
expressions are within curly brackets ({  }). Also, if you assign these
to lists (e.g.in a for loop), you need to use a list environment
(listenv) instead of a plain list.</p>
<h2 id="future.apply-package">future.apply package</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org">future</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org">future.apply</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="plan">plan</h3>
<p>How to plan future :</p>
<ol type="1">
<li><p>sequential : sequentially, not parallel</p></li>
<li><p>multisession : PSOCK (both MAC/LINUX + WINDOWS)</p></li>
</ol>
<p>2-1. multicore : resolve futures asyncronously in separate FORKED R
sessions. (UNSTABLE with Rstudio &amp; MAC/LINUX only)</p>
<ol start="3" type="1">
<li><p>cluster : resolve futures asyncronously in separate R sessions -
one or more machines.</p></li>
<li><p>remote : separate machine - in different network</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span><span class="co">## Explicitly close multisession workers by switching plan</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="availablecores">availableCores</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://parallelly.futureverse.org/reference/availableCores.html">availableCores</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="future_lapply">future_lapply</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html">future_lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="va">rnorm</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="reproducibility">reproducibility</h3>
<p>put <code>future.seed</code> argument for reproducibility.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">sequential</span><span class="op">)</span></span>
<span><span class="va">res1</span><span class="op">=</span> <span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html">future_lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="va">rnorm</span>, future.seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multiprocess</span><span class="op">)</span></span>
<span><span class="va">res2</span><span class="op">=</span> <span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html">future_lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="va">rnorm</span>, future.seed <span class="op">=</span> <span class="fl">1234</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">res1</span>,<span class="va">res2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="parallel-package">parallel package</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>base R : <code>parallel</code> package.</p>
<p>With this package, users can use current R session as the master
process, while each worker is a separate R process.</p>
<p>To detect number of cores (hyperthreaded) and make a cluster of nodes
:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span>logical<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># physical cores only, no hyperthreading</span></span>
<span><span class="va">ncores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Make clusters &amp; stop clusters</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># start a cluster</span></span>
<span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="va">ncores</span><span class="op">)</span> <span class="co"># &#39;PSOCK&#39; is the default</span></span>
<span></span>
<span><span class="co"># cl = makeForkCluster(ncores)</span></span>
<span><span class="co"># cl = makePSOCKcluster(ncores)</span></span>
<span></span>
<span><span class="co"># stop connection to cluster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Socket vs Fork</p>
<p>In a fork cluster, each worker is a copy of the master process,
whereas socket workers start with an empty environment.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># A global variable and is defined</span></span>
<span><span class="va">a_global_var</span> <span class="op">&lt;-</span> <span class="st">&quot;before&quot;</span></span>
<span></span>
<span><span class="co"># Create a socket cluster with 2 nodes</span></span>
<span><span class="va">cl_sock</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makePSOCKcluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="co"># empty environment</span></span>
<span></span>
<span><span class="co"># Evaluate the print function on each node</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterCall</a></span><span class="op">(</span><span class="va">cl_sock</span>, <span class="va">print</span>, <span class="va">a_global_var</span><span class="op">)</span> <span class="co"># a_global_var is not defined</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">stopCluster</a></span><span class="op">(</span><span class="va">cl_sock</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>What is the process id for each cluster?</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getpid.html">Sys.getpid</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># gives current R process id</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterCall</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">Sys.getpid</span><span class="op">)</span> <span class="co"># clusters has different, independent R process</span></span></code></pre>
</div>
</div>
<h3 id="clusterapply">clusterApply()</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># single node processing : lapply</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">ncores</span><span class="op">:</span><span class="fl">1</span>, <span class="va">rnorm</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># parallel processing : clusterApply</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterApply</a></span><span class="op">(</span><span class="va">cl</span>, x<span class="op">=</span><span class="va">ncores</span><span class="op">:</span><span class="fl">1</span> , fun <span class="op">=</span> <span class="va">rnorm</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="co"># x : how many times function is called</span></span>
<span></span>
<span><span class="co"># x = c(8,7,6,5,4,3,2,1)</span></span>
<span><span class="co"># rnorm(8) for first worker</span></span>
<span><span class="co"># rnorm(7) for second worker</span></span>
<span><span class="co"># ...</span></span>
<span><span class="co"># rnorm(1) for eighth worker</span></span></code></pre>
</div>
</div>
<p>Example : more tasks than worker</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mean_of_rnorm</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">random_numbers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">random_numbers</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">n_replicates</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">n_numbers_per_replicate</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">n_numbers_per_replicate</span>, <span class="va">n_replicates</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="co"># 10000 10000 ... 10000</span></span>
<span></span>
<span><span class="co"># Parallel evaluation on n_numbers_per_replicate, n_replicates times</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterApply</a></span><span class="op">(</span><span class="va">cl</span>, </span>
<span>                      x <span class="op">=</span> <span class="va">x</span>, </span>
<span>                      fun <span class="op">=</span> <span class="va">mean_of_rnorm</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="load-balancing">load balancing</h4>
<p>Instead of waiting for the results from nodes in specific order, it
accepts results from the first worker that finished and immediately send
back new task.</p>
<p>Improves speed if the task is imbalanced, but for small tasks
overhead costs outweighs speed gains.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">tasktime</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org">future.apply</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterApply</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">tasktime</span>, <span class="va">Sys.sleep</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterApplyLB</a></span><span class="op">(</span><span class="va">cl</span>, <span class="va">tasktime</span>, <span class="va">Sys.sleep</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html">future_lapply</a></span><span class="op">(</span><span class="va">tasktime</span>, <span class="va">Sys.sleep</span><span class="op">)</span>, <span class="co"># does automatic load balancing</span></span>
<span>  times<span class="op">=</span><span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Plotting the job</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">plot_cl_apply</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">cl</span>, <span class="va">x</span>, <span class="va">fun</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">snow</span><span class="fu">::</span><span class="fu">snow.time</span><span class="op">(</span><span class="fu">snow</span><span class="fu">::</span><span class="fu">clusterApply</span><span class="op">(</span><span class="va">cl</span>, <span class="va">x</span>, <span class="va">fun</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            title <span class="op">=</span> <span class="st">&quot;Cluster usage of clusterApply&quot;</span><span class="op">)</span></span>
<span><span class="va">plot_cl_applyLB</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">cl</span>, <span class="va">x</span>, <span class="va">fun</span><span class="op">)</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu">snow</span><span class="fu">::</span><span class="fu">snow.time</span><span class="op">(</span><span class="fu">snow</span><span class="fu">::</span><span class="fu">clusterApplyLB</span><span class="op">(</span><span class="va">cl</span>, <span class="va">x</span>, <span class="va">fun</span><span class="op">)</span><span class="op">)</span>,</span>
<span>            title <span class="op">=</span> <span class="st">&quot;Cluster usage of clusterApplyLB&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_cl_apply</span><span class="op">(</span><span class="va">cl</span>, <span class="va">tasktime</span>, <span class="va">Sys.sleep</span><span class="op">)</span></span>
<span><span class="fu">plot_cl_applyLB</span><span class="op">(</span><span class="va">cl</span>, <span class="va">tasktime</span>, <span class="va">Sys.sleep</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="clusterevalq">clusterEvalQ()</h3>
<p>Evaluate the literal expressions on all workers (nodes).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterEvalQ</a></span><span class="op">(</span><span class="va">cl</span>, <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterCall</a></span><span class="op">(</span><span class="va">cl</span>, <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="va">iris</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">head</span><span class="op">)</span> <span class="co"># pipe operator works, because tidyverse is imported</span></span></code></pre>
</div>
</div>
<h3 id="clusterexport">clusterExport()</h3>
<p>Exports objects from master to all workers (nodes).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">this</span> <span class="op">&lt;-</span> <span class="st">&#39;hello&#39;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterEvalQ</a></span><span class="op">(</span><span class="va">cl</span>,<span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">this</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="co"># not found</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="st">&#39;this&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterEvalQ</a></span><span class="op">(</span><span class="va">cl</span>,<span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">this</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<h3 id="parapply">parApply()</h3>
<p>Wrapper for <code>clusterApply()</code>.</p>
<p><code>parLapply()</code>, <code>parSapply()</code> and<br />
<code>parLapplyLB()</code>, <code>parSapplyLB()</code> for load
balancing,</p>
<p>Mac/Linux has shared memory system, while windows does not.</p>
<p>For both Mac / Linux and Windows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">parLapply</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">rnorm</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterApply</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">rnorm</span><span class="op">)</span> <span class="co"># same, output is list</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">parSapply</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="va">rnorm</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Functions : clusters do not know custom functions without explicit
export.</p>
<p>Use <code>clusterExport()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># If function is defined, then it should be exported to cluster to be used.</span></span>
<span><span class="va">play</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">total</span> <span class="op">&lt;-</span> <span class="va">no_of_rolls</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="kw">while</span><span class="op">(</span><span class="va">total</span> <span class="op">&lt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">total</span> <span class="op">&lt;-</span> <span class="va">total</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>      <span class="co"># If even. Reset to 0</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">total</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl">2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="va">total</span> <span class="op">&lt;-</span> <span class="fl">0</span> </span>
<span>      <span class="va">no_of_rolls</span> <span class="op">&lt;-</span> <span class="va">no_of_rolls</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">no_of_rolls</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="co"># Export the play() function to the cluster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">clusterExport</a></span><span class="op">(</span><span class="va">cl</span>, <span class="st">&quot;play&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Re-write sapply as parSapply</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/clusterApply.html">parSapply</a></span><span class="op">(</span><span class="va">cl</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="fu">play</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="progress-bar">progress bar</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># parallel appraoch</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/psolymos/pbapply">pbapply</a></span><span class="op">)</span></span>
<span><span class="va">my_cl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html">makeCluster</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">split_max</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">col</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">split</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">col</span>,<span class="st">&#39;|&#39;</span>,fixed<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="va">int_split</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">split</span>, <span class="va">as.integer</span><span class="op">)</span></span>
<span>  <span class="va">maxed_col</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">int_split</span>, <span class="va">max</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">maxed_col</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.infinite</a></span><span class="op">(</span><span class="va">maxed_col</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">maxed_col</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">sdc</span><span class="op">)</span><span class="op">[</span><span class="fl">256</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">sdc</span><span class="op">)</span><span class="op">]</span>,<span class="st">&#39;_MAX&#39;</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="va">q</span>, <span class="st">&#39;|&#39;</span>, fixed<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,<span class="va">as.integer</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">max</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">sdc</span><span class="op">[</span>,<span class="va">S_P_I_LT</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="st">&#39;|&#39;</span>,fixed<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">max</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="progress-bar-1">Progress bar</h1>
<h2 id="dofuture-foreach-progressbar">DoFuture Foreach progressbar</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://doFuture.futureverse.org">doFuture</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://doFuture.futureverse.org/reference/registerDoFuture.html">registerDoFuture</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://progressr.futureverse.org">progressr</a></span><span class="op">)</span></span>
<span><span class="fu">handlers</span><span class="op">(</span>global <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">handlers</span><span class="op">(</span><span class="st">&quot;progress&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example</span></span>
<span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">xs</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressor</span><span class="op">(</span>along <span class="op">=</span> <span class="va">xs</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xs</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">6.0</span><span class="op">-</span><span class="va">x</span><span class="op">)</span></span>
<span>    <span class="fu">p</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">&quot;x=%g&quot;</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_fcn</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>My usage</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">my_fcn</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">split_dt</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">=</span> <span class="fu">progressor</span><span class="op">(</span>along <span class="op">=</span> <span class="va">split_dt</span><span class="op">)</span></span>
<span>  <span class="va">result_dtlist</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">split_dt</span>, j <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">split_dt</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>    <span class="fu">p</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">&quot;x=%g&quot;</span>, <span class="va">j</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">x</span><span class="op">[</span>, <span class="va">mflow_fundno</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="fu">rollapply</span><span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">mtna</span>,<span class="va">mret</span><span class="op">)</span><span class="op">]</span>,<span class="fl">2</span>, <span class="va">flow_generator_dt</span>, by.column<span class="op">=</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="va">result_dtlist</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mon_ret_flow</span> <span class="op">=</span> <span class="fu">my_fcn</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">split_ret</span><span class="op">)</span>,<span class="va">split_ret</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Usage 2</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">my_fcn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">filelist</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">progressor</span><span class="op">(</span>along <span class="op">=</span> <span class="va">filelist</span><span class="op">)</span></span>
<span>  <span class="va">list_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">filelist</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">%dopar%</a></span> <span class="op">{</span></span>
<span>    <span class="fu">p</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">&quot;x=%g&quot;</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html">fread</a></span><span class="op">(</span>cmd <span class="op">=</span> <span class="va">filelist</span><span class="op">[[</span><span class="va">x</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">list_df</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu">my_fcn</span><span class="op">(</span><span class="va">bzx_files</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="for-loop-progress-bar">for loop progress bar</h2>
<p><code>progress</code> package</p>
<p>Use for <code>for</code> loop or <code>foreach</code> loop for
parallel</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/progress#readme">progress</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># basic</span></span>
<span></span>
<span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/pkg/progress/man/progress_bar.html">progress_bar</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>total <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="va">pb</span><span class="op">$</span><span class="fu">tick</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span> <span class="op">}</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># percent and eta</span></span>
<span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/pkg/progress/man/progress_bar.html">progress_bar</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>      format <span class="op">=</span> <span class="st">&quot;  downloading [:bar] :percent eta: :eta&quot;</span>,</span>
<span>      total <span class="op">=</span> <span class="fl">100</span>, clear <span class="op">=</span> <span class="cn">FALSE</span>, width<span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="va">pb</span><span class="op">$</span><span class="fu">tick</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span> <span class="op">}</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Elapsed time</span></span>
<span><span class="va">pb</span> <span class="op">&lt;-</span> <span class="va"><a href="https://rdrr.io/pkg/progress/man/progress_bar.html">progress_bar</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  format <span class="op">=</span> <span class="st">&quot;  downloading [:bar] :percent in :elapsed&quot;</span>,</span>
<span>  total <span class="op">=</span> <span class="fl">100</span>, clear <span class="op">=</span> <span class="cn">FALSE</span>, width<span class="op">=</span> <span class="fl">60</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span><span class="va">pb</span><span class="op">$</span><span class="fu">tick</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span> <span class="op">}</span></span></code></pre>
</div>
</div>
<h2 id="apply-progressbar">apply progressbar</h2>
<p><code>pbapply</code> package</p>
<p><code>pbLapply</code>, <code>pbSapply</code> are often used</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/psolymos/pbapply">pbapply</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="data-io">Data I/O</h1>
<p><code>getwd()</code> to get the current working directory<br />
<code>file.path(&#39;~&#39;,&#39;data&#39;)</code> to make a path in programmatic form
(os independent)<br />
</p>
<h2 id="list-of-files-in-directory">List of files in directory</h2>
<p><code>list.files()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="read-flat-files">Read flat files</h2>
<ol type="1">
<li>baseR <code>utils</code> package : <code>read.csv</code>,
<code>read.delim</code>, <code>read.table</code>(ultimate)<br />
</li>
<li>Tidyverse <code>readr</code> package : <code>read_csv</code>,
<code>read_tsv</code>, <code>read_delim</code>(ultimate)<br />
</li>
<li><code>data.table</code> package : <code>fread</code></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># read some cols only</span></span>
<span><span class="co"># Column names</span></span>
<span><span class="va">properties</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;area&quot;</span>, <span class="st">&quot;temp&quot;</span>, <span class="st">&quot;size&quot;</span>, <span class="st">&quot;storage&quot;</span>, <span class="st">&quot;method&quot;</span>,</span>
<span>                <span class="st">&quot;texture&quot;</span>, <span class="st">&quot;flavor&quot;</span>, <span class="st">&quot;moistness&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="va">potatoes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv</a></span><span class="op">(</span><span class="st">&quot;potatoes.txt&quot;</span>, col_names <span class="op">=</span> <span class="va">properties</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import all data, but force all columns to be character: potatoes_char</span></span>
<span><span class="va">potatoes_char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_tsv</a></span><span class="op">(</span><span class="st">&quot;potatoes.txt&quot;</span>, col_types <span class="op">=</span> <span class="st">&quot;cccccccc&quot;</span>, col_names <span class="op">=</span> <span class="va">properties</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="read-excel-files">Read excel files</h2>
<p>Tidyverse <code>readxl</code> package</p>
<p><code>excel_sheets</code> : names of sheets in the file<br />
<code>read_excel</code> : read the sheets<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># To read all excel sheets with in a file</span></span>
<span><span class="va">pop_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://readxl.tidyverse.org/reference/excel_sheets.html">excel_sheets</a></span><span class="op">(</span><span class="st">&quot;urbanpop.xlsx&quot;</span><span class="op">)</span>, <span class="va">read_excel</span>, path <span class="op">=</span> <span class="st">&quot;urbanpop.xlsx&quot;</span><span class="op">)</span> <span class="co"># a list of dfs</span></span></code></pre>
</div>
</div>
<h2 id="read-stata-files">Read Stata files</h2>
<p>Tidverse <code>haven</code> package</p>
<p><code>read_stata</code> or <code>read_dta</code></p>
<p>R also reads labeled columns well.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://haven.tidyverse.org">haven</a></span><span class="op">)</span></span>
<span><span class="va">sugar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="fu"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span><span class="op">(</span><span class="st">&quot;http://assets.datacamp.com/production/course_1478/datasets/trade.dta&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">sugar</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sugar</span><span class="op">$</span><span class="va">Import</span> <span class="co"># label and format are also shown</span></span></code></pre>
</div>
</div>
<h2 id="database-backend">Database backend</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Load the DBI package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org">DBI</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Edit dbConnect() call</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu">RMySQL</span><span class="fu">::</span><span class="fu">MySQL</span><span class="op">(</span><span class="op">)</span>, </span>
<span>                 dbname <span class="op">=</span> <span class="st">&quot;tweater&quot;</span>, </span>
<span>                 host <span class="op">=</span> <span class="st">&quot;courses.csrrinzqubik.us-east-1.rds.amazonaws.com&quot;</span>, </span>
<span>                 port <span class="op">=</span> <span class="fl">3306</span>,</span>
<span>                 user <span class="op">=</span> <span class="st">&quot;student&quot;</span>,</span>
<span>                 password <span class="op">=</span> <span class="st">&quot;something&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build a vector of table names: tables</span></span>
<span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbListTables.html">dbListTables</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span> <span class="co">#&quot;comments&quot; &quot;tweats&quot;   &quot;users&quot;</span></span>
<span></span>
<span><span class="co"># Display structure of tables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">tables</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import the users table from tweater: users</span></span>
<span><span class="va">users</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbReadTable.html">dbReadTable</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">&quot;users&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get table names</span></span>
<span><span class="va">table_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbListTables.html">dbListTables</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Import all tables</span></span>
<span><span class="va">tables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">table_names</span>, <span class="va">dbReadTable</span>, conn <span class="op">=</span> <span class="va">con</span><span class="op">)</span> <span class="co"># list of dfs</span></span></code></pre>
</div>
</div>
<p>Use SQL Query to process on the server and retrieve the data</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Import tweat_id column of comments where user_id is 1: elisabeth</span></span>
<span><span class="va">elisabeth</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbGetQuery.html">dbGetQuery</a></span><span class="op">(</span><span class="va">con</span>, </span>
<span>                       <span class="st">&quot;SELECT tweat_id FROM comments WHERE user_id =1&quot;</span></span>
<span>                       <span class="op">)</span></span></code></pre>
</div>
</div>
<p>Send-Fetch-Clear combo : what <code>dbGetQuery</code> automatically
does at once</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Send query to the database</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">&quot;SELECT * FROM comments WHERE user_id &gt; 4&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use dbFetch() twice</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clear res</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="read-parquet">Read parquet</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># parquet file : fast to read, but makes it small (1.3GB csv -&gt; 78 MB)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/apache/arrow/">arrow</a></span><span class="op">)</span></span>
<span><span class="va">pqdata</span> <span class="op">=</span> <span class="fu">read_parquet</span><span class="op">(</span><span class="st">&#39;~/Dropbox (UFL)/Gunsu_Phil/data/SDC munibond data/sdc_toxic.parquet&#39;</span><span class="op">)</span></span>
<span><span class="va">pqdata</span> <span class="op">=</span> <span class="va">pqdata</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="co"># first 50 rows </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pqdata</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="data.table">DATA.TABLE</h1>
<p>DT[i,j,by] i : for <code>filter</code> and <code>order</code>
rows<br />
j : for <code>select/drop</code>, <code>add</code> and
<code>summerize</code> columns<br />
by : for grouping operations<br />
</p>
<h2 id="i-operations"><code>i</code> operations</h2>
<p><code>IMPORTANT</code>: i operations are executed the first thing
before j=, by= arguments. If this should be performed later, than should
use [] chain.</p>
<p>When ordering : use DT[order(col1),] for ordering and
<code>setorder</code> for in-place operation.</p>
<h3 id="remove-rows-by-reference">REMOVE ROWS BY REFERENCE</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">delete</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">DT</span>, <span class="va">del.idxs</span><span class="op">)</span> <span class="op">{</span>           <span class="co"># pls note &#39;del.idxs&#39; vs. &#39;keep.idxs&#39;</span></span>
<span>  <span class="va">keep.idxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/setops.html">setdiff</a></span><span class="op">(</span><span class="va">DT</span><span class="op">[</span>, <span class="va">.I</span><span class="op">]</span>, <span class="va">del.idxs</span><span class="op">)</span>;  <span class="co"># select row indexes to keep</span></span>
<span>  <span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span>;</span>
<span>  <span class="va">DT.subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="va">DT</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">keep.idxs</span><span class="op">]</span><span class="op">)</span>; <span class="co"># this is the subsetted table</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">DT.subset</span>, <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>;</span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">col</span> <span class="kw">in</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">DT.subset</span><span class="op">[</span>, <span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">:=</span> <span class="va">DT</span><span class="op">[[</span><span class="va">col</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">keep.idxs</span><span class="op">]</span><span class="op">]</span>;</span>
<span>    <span class="va">DT</span><span class="op">[</span>, <span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span><span class="op">]</span>;  <span class="co"># delete</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">DT.subset</span><span class="op">)</span>;</span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<p>Example</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris_dt</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu">delete</span><span class="op">(</span><span class="va">iris_dt</span>, <span class="va">iris_dt</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">Species</span><span class="op">==</span><span class="st">&#39;setosa&#39;</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">cboe</span> <span class="op">=</span> <span class="fu">delete</span><span class="op">(</span><span class="va">cboe</span>, <span class="va">cboe</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">security_type</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="order-rows">order rows</h3>
<p>setorder() function</p>
<p><code>setorder()</code> and <code>setorderv()</code> : fast inplace
ordering function</p>
<p><code>setorder()</code> : supports unquoted varaible names</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">head</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">setorder</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="va">country</span>, <span class="va">continent</span>, <span class="op">-</span><span class="va">year</span><span class="op">)</span> <span class="co"># - for descending order</span></span>
<span><span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">head</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setorder.html">setorderv</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;country&#39;</span>, <span class="st">&#39;continent&#39;</span>,<span class="st">&#39;year&#39;</span><span class="op">)</span>, order<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># ascending, descending order for character vector</span></span></code></pre>
</div>
</div>
<p>Bracket syntax - not by reference</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">country</span>,<span class="va">continent</span>,<span class="va">year</span><span class="op">)</span><span class="op">]</span> <span class="co"># not inplace, new </span></span></code></pre>
</div>
</div>
<h4 id="setkey">setkey</h4>
<p><code>setkey()</code> and <code>setkeyv()</code></p>
<p>When the data.tables key is set, then the original data.table is
sorted by the key variable(s).</p>
<p>setting key is useful for :<br />
1. efficient filtering<br />
2. efficient joining<br />
</p>
<p>This performance is achieved binary search algorithm, which is only
available when it is sorted.</p>
<p>To undo setting key, <code>setkey(data, NULL)</code></p>
<p>When <code>keyby=</code> was used, then the data.table gets those
vairables as its key automatically (therefore the return are also
ordered by <code>keyby=</code> variables)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">setkey</a></span><span class="op">(</span><span class="va">gapminder</span>,<span class="cn">NULL</span><span class="op">)</span> <span class="co"># remove key</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">haskey</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span> <span class="co"># FALSE</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">.SD</span>,keyby <span class="op">=</span><span class="va">continent</span><span class="op">]</span> <span class="co"># this is a new object</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">.SD</span>,keyby <span class="op">=</span><span class="va">continent</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">haskey</span></span></code></pre>
</div>
</div>
<p>Check if data.table has key</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">haskey</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># logical output</span></span>
<span><span class="va">x_key</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">key</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># assign the key to object</span></span>
<span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">setkeyv</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">x_key</span><span class="op">)</span> <span class="co"># set key programmatically to y</span></span></code></pre>
</div>
</div>
<h3 id="filtering-rows">filtering rows</h3>
<h4 id="helper-functions">Helper functions</h4>
<p><code>%in%</code> : if element is equal to one of several
values<br />
<code>%chin%</code> : fast character checker instead of
<code>%in%</code><br />
<code>%between%</code> : numeric check if between<br />
<code>%like%</code> : string like somthing. accepts regex<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># 1. %in%</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1952</span>,<span class="fl">1957</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># 2. %between%</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">lifeExp</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/between.html">%between%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">28</span>,<span class="fl">40</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># 3. %chin%</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">continent</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">continent</span><span class="op">)</span><span class="op">]</span> <span class="co"># %chin% only works with character vector, and continent was a factor variable</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">continent</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Asia&#39;</span>, <span class="st">&#39;Europe&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># 4. %like%</span></span>
<span><span class="va">gapminder</span><span class="op">[</span><span class="va">continent</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">&#39;^[AE]&#39;</span><span class="op">]</span> <span class="co"># Asia, Africa, America, Europe</span></span></code></pre>
</div>
</div>
<h4 id="advanced-filtering">advanced filtering</h4>
<p>CJ and SJ are convenience functions to create a data.table to be used
in i when performing a data.table query on x.</p>
<h3 id="count-unique">count unique</h3>
<p><code>uniqueN()</code> function for counting unique specified
variables.</p>
<p>Similarly <code>DT[, .N, by = var]</code> does similar thing (value
counts).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">uniqueN</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="st">&#39;cyl&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="show-duplicates">show duplicates</h3>
<p>Two approaches</p>
<ol type="1">
<li>Generating duplicated column</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">state_county</span><span class="op">[</span>, <span class="va">duplicated</span> <span class="op">:=</span> <span class="va">.N</span> <span class="op">&gt;</span><span class="fl">1</span> , by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;State&#39;</span>,<span class="st">&#39;County&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">state_county</span><span class="op">[</span><span class="va">duplicated</span><span class="op">==</span><span class="cn">T</span><span class="op">]</span></span></code></pre>
</div>
</div>
<ol start="2" type="1">
<li>use <code>duplicated(x)</code> +
<code>duplicated(x, fromLast= T)</code></li>
</ol>
<!-- -->
<ol type="1">
<li>using base::duplicated</li>
</ol>
<p>Use the column name (one and only one column) for duplicate check</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># single column duplicates : input single column</span></span>
<span><span class="va">addon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">fyear</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">fyear</span>, fromLast<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<ol start="2" type="1">
<li>using data.table S3 method Mutiple columns duplicated rows</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># multiple column duplicates : input the data.table</span></span>
<span><span class="va">addon</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">addon</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">fyear</span>, <span class="va">gvkey</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">addon</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">fyear</span>, <span class="va">gvkey</span><span class="op">)</span><span class="op">]</span>, fromLast <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># or use plyr syntax </span></span>
<span><span class="va">addon</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">.</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">.</span>,by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;fyear&#39;</span>,<span class="st">&#39;gvkey&#39;</span><span class="op">)</span><span class="op">)</span><span class="op">|</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">.</span>,by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;fyear&#39;</span>,<span class="st">&#39;gvkey&#39;</span><span class="op">)</span>, fromLast<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h3 id="drop-duplicates">drop duplicates</h3>
<p><code>unique()</code> function to drop duplicates.</p>
<p>By default, the first observation survives and others are dropped.
Refer to <code>duplicated()</code> function.</p>
<p>unique(x, incomparables=FALSE, fromLast=FALSE, by=seq_along(x),
)</p>
<p>For faster way, one can first set keys with <code>setkey()</code> and
then call <code>unique()</code> to drop duplicates by those keys.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span> <span class="co"># drop by all variables duplicate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">mtcars</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;cyl&#39;</span>,<span class="st">&#39;gear&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># drop by duplicates with cyl and gear</span></span></code></pre>
</div>
</div>
<p>As shown below, the first occurrence is marked FALSE and others are
TRUE. Those are dropped when <code>unique()</code> function was
called.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html">duplicated</a></span><span class="op">(</span><span class="va">mtcars</span>, by<span class="op">=</span><span class="st">&#39;cyl&#39;</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<h3 id="na.omit">na.omit</h3>
<p><code>na.omit()</code> function for fast dropping rows that contain
NAs.<br />
Drops any NAs with columns specified.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>V1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                V2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="va">a</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;V1&#39;</span>,<span class="st">&#39;V2&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="join">Join</h3>
<p>Right / Left (by reference) Inner joins are possible.</p>
<p>To use data.table syntax : use <code>on</code> in bracket to connect
two data.tables<br />
</p>
<p>TIP : remember to use <code>on</code> for two data.tables.
<code>by</code> is already being used for <code>group by</code>
operations!</p>
<p>Addtiional arguments:</p>
<ol type="1">
<li><p>nomatch = 0</p>
<ul>
<li>it drops non_matching, resulting inner join</li>
</ul></li>
<li><p>roll = {TRUE, FALSE, Inf, -Inf, nearest } - rolling
join</p></li>
<li><p>mult = {last} - keep only the last row of join result</p></li>
</ol>
<h4 id="right-join">Right join</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># on data.table x, work on rows that matches with data.table y</span></span>
<span><span class="co"># on keys column </span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span>, on <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">keys</span><span class="op">)</span>, nomatch<span class="op">=</span> <span class="fl">0</span><span class="op">]</span> <span class="co"># basically RIGHT JOIN x to y. to make inner join put nomatch = 0</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span>, on <span class="op">=</span> <span class="fu">.</span><span class="op">(</span>xcol <span class="op">=</span> <span class="va">ycol</span>, xcol2 <span class="op">=</span> <span class="va">ycol2</span><span class="op">)</span><span class="op">]</span> <span class="co"># when colnames are different </span></span></code></pre>
</div>
</div>
<h4 id="anti-join">Anti join</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">x</span><span class="op">[</span><span class="op">!</span><span class="va">y</span>, on <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">keys</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h4 id="left-join">Left join</h4>
<p><code>i.</code> prefix to refer to columns that are located in the
right data.table (i part of the data.table)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># left join</span></span>
<span><span class="va">ip</span><span class="op">[</span><span class="va">link_t</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;new_added_state&#39;</span>,<span class="st">&#39;new_added_county&#39;</span><span class="op">)</span> <span class="op">:=</span> <span class="fu">.</span><span class="op">(</span><span class="va">i.statecode</span>, <span class="va">i.countycode</span><span class="op">)</span>, on<span class="op">=</span><span class="fu">.</span><span class="op">(</span>GeoFIPS <span class="op">=</span> <span class="va">FIPS</span><span class="op">)</span><span class="op">]</span> <span class="co"># i.statecode and i.countycode is from link_t data</span></span></code></pre>
</div>
</div>
<p>Set keys to join : makes joins a lot more efficient and faster</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">setkey</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">colname</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">setkey</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">colname</span><span class="op">)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">y</span><span class="op">]</span> <span class="co"># automatically use on = colname</span></span></code></pre>
</div>
</div>
<h6 id="subset-left-join">Subset left join</h6>
<p>In cases it may be required to perform left join on subset of left
data.table.</p>
<p>Using <code>i.</code> with <code>fifelse</code> does the trick.</p>
<p>Example use I had before</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">temp</span><span class="op">[</span><span class="va">cpon</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">Issue_id</span>,<span class="va">Coupon</span><span class="op">)</span><span class="op">]</span>, <span class="st">&#39;Coupon&#39;</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fifelse.html">fifelse</a></span><span class="op">(</span><span class="va">Coupon_type</span><span class="op">==</span><span class="st">&#39;F&#39;</span>, <span class="va">i.Coupon</span>, <span class="cn">NA_real_</span><span class="op">)</span>, on <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">Issue_id</span><span class="op">)</span><span class="op">]</span> <span class="co"># only joined when Coupon type is &#39;F&#39;</span></span></code></pre>
</div>
</div>
<h4 id="rolling-join">Rolling join</h4>
<p>Rolling join is only supported for <code>=</code> matches. It is not
equal to non-equi join that only closest matching will survive. Default
rolling join is right join with forward rolling. The time on the right
table will be fixed, and the closest time on left table will be
matched.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">DT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>A <span class="op">=</span> <span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                 B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>, </span>
<span>                 C <span class="op">=</span> <span class="fl">6</span><span class="op">:</span><span class="fl">12</span>, </span>
<span>                 key <span class="op">=</span> <span class="st">&quot;A,B&quot;</span><span class="op">)</span></span>
<span><span class="va">DT</span></span>
<span><span class="co">#    A B  C</span></span>
<span><span class="co"># 1: a 4  7</span></span>
<span><span class="co"># 2: a 8 10</span></span>
<span><span class="co"># 3: b 1  8</span></span>
<span><span class="co"># 4: b 5  6</span></span>
<span><span class="co"># 5: b 8 11</span></span>
<span><span class="co"># 6: c 6 12</span></span>
<span><span class="co"># 7: c 9  9</span></span></code></pre>
</div>
</div>
<p>When <code>roll=TRUE</code>, then it tries to match value less than
input. Same as <code>roll=+Inf</code>. In above example, since A
matches, but B does not match 4, so it matches with B = 1 instead.<br />
When <code>roll=&#39;nearest&#39;</code> then it matches nearest one, which is B
= 5 in this case.<br />
</p>
<p><code>roll = +Inf</code> : last observation carried forwards
(locf)<br />
<code>roll = -Inf</code> : next observation carried backwards
(nocb)<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="fl">4</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="fl">4</span><span class="op">)</span>, roll<span class="op">=</span><span class="cn">TRUE</span><span class="op">]</span> <span class="co"># matches .(&#39;b&#39;, 1) -&gt; C value 4 is chosen to be match</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="fl">4</span><span class="op">)</span>, roll<span class="op">=</span> <span class="op">+</span><span class="cn">Inf</span><span class="op">]</span> <span class="co"># same</span></span>
<span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="fl">4</span><span class="op">)</span>, roll<span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">]</span> <span class="co"># matches .(&#39;b&#39;, 5)</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="fl">4</span><span class="op">)</span>, roll<span class="op">=</span><span class="st">&#39;nearest&#39;</span><span class="op">]</span> <span class="co"># matches .(&#39;b&#39;, 5) in this case</span></span></code></pre>
</div>
</div>
<p>When mathcing limits are needed : <code>roll = 2</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="fl">4</span><span class="op">)</span>, roll<span class="op">=</span><span class="fl">2</span><span class="op">]</span> <span class="co"># search .(&#39;b&#39;, 2:4) - NA if no matches within</span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="fl">4</span><span class="op">)</span>, roll<span class="op">=</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span> <span class="co"># search .(&#39;b&#39;, 4:6) - matches (&#39;b&#39;, 5)</span></span></code></pre>
</div>
</div>
<p>Filling in ends : <code>rollends =</code> argument<br />
When ends of data.table are NAs, it can filled in by using
<code>rollends</code><br />
c(TRUE, TRUE) : fill above and below</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="co"># non matched are NAs</span></span>
<span><span class="co">#     A  B  C</span></span>
<span><span class="co">#  1: b -2 NA</span></span>
<span><span class="co">#  2: b -1 NA</span></span>
<span><span class="co">#  3: b  0 NA</span></span>
<span><span class="co">#  4: b  1  8</span></span>
<span><span class="co">#  5: b  2 NA</span></span>
<span><span class="co">#  6: b  3 NA</span></span>
<span><span class="co">#  7: b  4 NA</span></span>
<span><span class="co">#  8: b  5  6</span></span>
<span><span class="co">#  9: b  6 NA</span></span>
<span><span class="co"># 10: b  7 NA</span></span>
<span><span class="co"># 11: b  8 11</span></span>
<span><span class="co"># 12: b  9 NA</span></span>
<span><span class="co"># 13: b 10 NA</span></span>
<span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, roll<span class="op">=</span><span class="cn">T</span><span class="op">]</span> <span class="co"># last observation carried forward (locf), and top is NA</span></span>
<span><span class="co">#     A  B  C</span></span>
<span><span class="co">#  1: b -2 NA</span></span>
<span><span class="co">#  2: b -1 NA</span></span>
<span><span class="co">#  3: b  0 NA</span></span>
<span><span class="co">#  4: b  1  8</span></span>
<span><span class="co">#  5: b  2  8</span></span>
<span><span class="co">#  6: b  3  8</span></span>
<span><span class="co">#  7: b  4  8</span></span>
<span><span class="co">#  8: b  5  6</span></span>
<span><span class="co">#  9: b  6  6</span></span>
<span><span class="co"># 10: b  7  6</span></span>
<span><span class="co"># 11: b  8 11</span></span>
<span><span class="co"># 12: b  9 11</span></span>
<span><span class="co"># 13: b 10 11</span></span>
<span></span>
<span><span class="va">DT</span><span class="op">[</span><span class="fu">.</span><span class="op">(</span><span class="st">&#39;b&#39;</span>,<span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span>, roll<span class="op">=</span><span class="cn">T</span>, rollends <span class="op">=</span> <span class="cn">T</span><span class="op">]</span><span class="co"># fill the top with rollends = T</span></span>
<span><span class="co">#    A  B  C</span></span>
<span><span class="co">#  1: b -2  8</span></span>
<span><span class="co">#  2: b -1  8</span></span>
<span><span class="co">#  3: b  0  8</span></span>
<span><span class="co">#  4: b  1  8</span></span>
<span><span class="co">#  5: b  2  8</span></span>
<span><span class="co">#  6: b  3  8</span></span>
<span><span class="co">#  7: b  4  8</span></span>
<span><span class="co">#  8: b  5  6</span></span>
<span><span class="co">#  9: b  6  6</span></span>
<span><span class="co"># 10: b  7  6</span></span>
<span><span class="co"># 11: b  8 11</span></span>
<span><span class="co"># 12: b  9 11</span></span>
<span><span class="co"># 13: b 10 11</span></span></code></pre>
</div>
</div>
<h5 id="example">Example</h5>
<h3 id="merge">Merge</h3>
<p>Using <code>merge()</code> function for left, right, inner(default),
full join</p>
<p><code>merge (x, y, by = c(&#39;&#39;))</code> : inner join</p>
<p><code>merge (x, y, x.by = , y.by = , all = T )</code> : all =T means
full, F means inner<br />
</p>
<p><code>merge (x, y, x.by = , y.by = , all.x = T )</code> : all.x = T
means Left join</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Example code</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span> <span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, x.by <span class="op">=</span> , y.by <span class="op">=</span> , all <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span> <span class="co"># all = TRUE means full, FALSE means inner by default</span></span></code></pre>
</div>
</div>
<h4 id="merge-indicator">merge indicator</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">crsp_mstr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">test1</span><span class="op">[</span>,<span class="va">l</span><span class="op">:=</span><span class="va">.I</span><span class="op">]</span>,<span class="va">test2</span><span class="op">[</span>,<span class="va">r</span><span class="op">:=</span><span class="va">.I</span><span class="op">]</span>, by.x<span class="op">=</span> <span class="st">&#39;ncusip&#39;</span>, by.y <span class="op">=</span> <span class="st">&#39;CUSIP&#39;</span>, all<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">crsp_mstr</span><span class="op">[</span>, <span class="va">merge_</span> <span class="op">:=</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fcase.html">fcase</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">l</span><span class="op">)</span>, <span class="st">&#39;right_only&#39;</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span>, <span class="st">&#39;left_only&#39;</span>,</span>
<span>                          default<span class="op">=</span><span class="st">&#39;both&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">crsp_mstr</span><span class="op">[</span>,<span class="va">.N</span>,<span class="va">merge_</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h4 id="multiple-merge">multiple merge</h4>
<p>with Reduce()</p>
<p><code>Reduce()</code> function reduces argument by putting outcome as
input until it is exhausted.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/funprog.html">Reduce</a></span><span class="op">(</span></span>
<span>  f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="st">&quot;|&quot;</span><span class="op">)</span><span class="op">}</span>, <span class="co"># f takes two arguments</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span><span class="op">)</span> <span class="co"># x has three </span></span>
<span><span class="op">)</span></span>
<span><span class="co"># evaluate with a, b first and then evaluate with outcome of f(a,b) with c</span></span></code></pre>
</div>
</div>
<p>When merging multiple dataset repeatedly with same column, it can be
useful.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Reduce</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">f =</span> <span class="cf">function</span>(x,y){<span class="fu">merge</span>(x,y,<span class="at">by=</span><span class="st">&#39;obstime&#39;</span>)}</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">list</span>(DT1,DT2,DT3)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co"># merges DT1 and DT2 and then merge DT3</span></span></code></pre></div>
</div>
<h3 id="choose-random-rows">choose random rows</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">DT</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">.N</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="j-operations"><code>j</code> operations</h2>
<p>DT[i,j,by]</p>
<p>i : for <code>filter</code> and <code>order</code> rows<br />
j : for <code>select</code>,<code>assign/drop</code>, and
<code>summerize</code> columns<br />
by : for grouping operations<br />
</p>
<p>Multiple Assignments :</p>
<p>Use <code>:=</code>(col_name = max(col1), col_name2 = min(col2)) form
instead, or,<br />
use
<code>c(&#39;col_name&#39;,&#39;col_name2&#39;) := .(max(col1), min(col2))</code></p>
<h3 id="order-columns">order columns</h3>
<p><code>setcolorder()</code> function</p>
<p>If not all variables are explicitly mentioned, then the columns
mentioned come front.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setcolorder.html">setcolorder</a></span><span class="op">(</span><span class="va">gapminder</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;year&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># bring year to first</span></span></code></pre>
</div>
</div>
<h3 id="selecting-columns">selecting columns</h3>
<h4 id="basics-1">basics</h4>
<p>Multiple ways to selecting columns</p>
<ol type="1">
<li>Use list of unquoted variable names <code>list()</code> or
<code>.()</code><br />
</li>
<li>Use character vector (supported in later version of
data.table)<br />
When using name object with character vector : use <code>..</code>prefix
or <code>with=F</code><br />
When <code>:=</code> is used within j, then <code>()</code> for name
object<br />
</li>
</ol>
<p>When selecting EXCEPT columns, use <code>-</code> or <code>!</code>
in front of character vector</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># When only one colname -&gt; returns vector</span></span>
<span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="va">Species</span><span class="op">]</span> <span class="co"># returns vector, but seldomly used...</span></span>
<span><span class="co"># using get() function : get evaluates string as variable</span></span>
<span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">&#39;Species&#39;</span><span class="op">)</span><span class="op">]</span> <span class="co"># equivalent, vector returned</span></span>
<span></span>
<span><span class="co"># Notice that selecting with character vector returns data.table </span></span>
<span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fu">.</span><span class="op">(</span><span class="va">Species</span><span class="op">)</span><span class="op">]</span> <span class="co"># returns dt</span></span>
<span><span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="st">&#39;Species&#39;</span><span class="op">]</span>   <span class="co"># same</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># unquoted names or character vector</span></span>
<span><span class="va">iris</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">`Species`</span>,<span class="va">Sepal.Length</span><span class="op">)</span><span class="op">]</span>  <span class="co"># USE backtick ` ` to include column names with special characters or whitespace</span></span>
<span><span class="va">iris</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Species&#39;</span>,<span class="st">&#39;Sepal.Length&#39;</span><span class="op">)</span><span class="op">]</span> <span class="co"># also returns data table </span></span>
<span></span>
<span><span class="co"># When DEselecting columns, must use character vector</span></span>
<span><span class="va">iris</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Species&#39;</span>,<span class="st">&#39;Sepal.Length&#39;</span><span class="op">)</span><span class="op">]</span> <span class="co"># deselecting Species and Sepal.Length </span></span>
<span><span class="va">iris</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Species&#39;</span>,<span class="st">&#39;Sepal.Length&#39;</span><span class="op">)</span><span class="op">]</span> <span class="co"># deselecting Species and Sepal.Length</span></span></code></pre>
</div>
</div>
<p>Selecting columns with outside named objects</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># using prefix or with=F</span></span>
<span><span class="va">my_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Species&#39;</span>,<span class="st">&#39;Sepal.Length&#39;</span><span class="op">)</span></span>
<span><span class="va">iris</span><span class="op">[</span>, <span class="va">my_cols</span>, with<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span> <span class="co"># with argument to recognize character vector OR</span></span>
<span></span>
<span><span class="co"># or use dotdot (but not much generalizable)</span></span>
<span><span class="va">iris</span><span class="op">[</span>, <span class="va">..my_cols</span><span class="op">]</span> <span class="co"># check &#39;upper&#39; environment, not in gapminder DT env</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="st">&#39;Species&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># DO NOT put list of characters</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="st">&#39;country&#39;</span>,<span class="st">&#39;Sepal.Length&#39;</span><span class="op">)</span><span class="op">]</span> <span class="co"># generates new data table and assigns those values </span></span>
<span></span>
<span><span class="co"># in order to evaluate string as column reference : use get() function</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="st">&#39;country&#39;</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">country</span><span class="op">)</span><span class="op">]</span> <span class="co"># equivalent </span></span>
<span></span>
<span><span class="co"># 2nd method : using .SDcols argument to input character vector (or incides)</span></span>
<span><span class="va">my_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;country&#39;</span>,<span class="st">&#39;year&#39;</span><span class="op">)</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="va">.SD</span>, .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;country&#39;</span>,<span class="st">&#39;year&#39;</span><span class="op">)</span><span class="op">]</span> <span class="co"># .SDcols expects character vectors </span></span></code></pre>
</div>
</div>
<h4 id="select-columns-in-sequence">select columns in sequence</h4>
<p>Select columns in sequence by its name : use <code>year:pop</code>
colon notation.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span> <span class="co"># [1] &quot;country&quot;   &quot;continent&quot; &quot;year&quot;      &quot;lifeExp&quot;   &quot;pop&quot;       &quot;gdpPercap&quot;</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="va">.SD</span>, .SDcol<span class="op">=</span><span class="va">year</span><span class="op">:</span><span class="va">pop</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h4 id="select-columns-with-name-patterns">select columns with name
patterns</h4>
<p><code>grep()</code> is the fastest. <a href="https://stackoverflow.com/questions/30189979/select-columns-of-data-table-based-on-regex" class="uri">https://stackoverflow.com/questions/30189979/select-columns-of-data-table-based-on-regex</a></p>
<p>When using name patterns to select columns,</p>
<ol type="1">
<li>Use <code>grep()</code> function :: <fastest> ,</li>
<li>Use <code>%like%</code> and <code>with=F</code> argument</li>
<li>Use <code>patterns()</code> function inside <code>.SDcols</code>
argument</li>
<li>Use <code>%like%</code> in <code>.SDcols</code> argument</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># 1. using %like% with = F </span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">&#39;^co&#39;</span>, with<span class="op">=</span><span class="cn">F</span><span class="op">]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">&#39;^co&#39;</span>, with<span class="op">=</span><span class="cn">F</span><span class="op">]</span> <span class="co"># negation</span></span>
<span></span>
<span><span class="co"># 2. using grep</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;^co&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span><span class="op">)</span>, with<span class="op">=</span><span class="cn">F</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;^co&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span><span class="op">)</span> <span class="co"># gets indices</span></span>
<span></span>
<span><span class="co"># 3. using patterns()</span></span>
<span><span class="va">mydt</span><span class="op">[</span>, <span class="va">.SD</span>, .SDcols <span class="op">=</span> <span class="fu">patterns</span><span class="op">(</span><span class="st">&quot;&lt;regex pattern&gt;&quot;</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># 4. using %like% on .SD (slow)</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="va">.SD</span>, .SDcols<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">&#39;^co&#39;</span><span class="op">]</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="va">.SD</span>, .SDcols<span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">&#39;^co&#39;</span><span class="op">]</span> <span class="co"># negation</span></span></code></pre>
</div>
</div>
<p>Benchmark result is on below</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmarking</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100000</span> d</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>foo_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;foo&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>big_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">bar =</span> <span class="fu">rnorm</span>(n), <span class="at">baz =</span> <span class="fu">rnorm</span>(n))</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>big_dt[, (foo_cols) <span class="sc">:</span><span class="er">=</span> <span class="fu">rnorm</span>(n)]</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(big_dt)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Methods</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>subsetting <span class="ot">&lt;-</span> <span class="cf">function</span>(dt) {</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">subset</span>(dt, <span class="at">select =</span> <span class="fu">grep</span>(<span class="st">&quot;bar|baz&quot;</span>, <span class="fu">names</span>(dt)))</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>usingSD <span class="ot">&lt;-</span> <span class="cf">function</span>(dt) {</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    dt[, .SD, .SDcols <span class="ot">=</span> <span class="fu">names</span>(dt) <span class="sc">%like%</span> <span class="st">&quot;bar|baz&quot;</span>]</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>usingWith <span class="ot">&lt;-</span> <span class="cf">function</span>(dt) {</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;bar|baz&quot;</span>, <span class="fu">names</span>(dt), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>    dt[, cols, with <span class="ot">=</span> <span class="cn">FALSE</span>]</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>usingDotDot <span class="ot">&lt;-</span> <span class="cf">function</span>(dt) {</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>    cols <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&quot;bar|baz&quot;</span>, <span class="fu">names</span>(dt), <span class="at">value =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>    dt[, ..cols]</span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>usingPatterns <span class="ot">&lt;-</span> <span class="cf">function</span>(dt) {</span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>  dt[, .SD, .SDcols <span class="ot">=</span> <span class="fu">patterns</span>(<span class="st">&quot;bar|baz&quot;</span>)]</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>usingLike <span class="ot">&lt;-</span> <span class="cf">function</span>(dt) {</span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a>  dt[, <span class="fu">names</span>(dt) <span class="sc">%like%</span> <span class="st">&quot;bar|baz&quot;</span>, with<span class="ot">=</span><span class="cn">FALSE</span>]</span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Benchmark</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(</span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">subsetting</span>(big_dt), <span class="fu">usingSD</span>(big_dt), <span class="fu">usingWith</span>(big_dt), <span class="fu">usingDotDot</span>(big_dt), <span class="fu">usingPatterns</span>(big_dt), <span class="fu">usingLike</span>(big_dt),</span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">times =</span> <span class="dv">5000</span></span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Unit: microseconds</span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="co">#                   expr     min        lq     mean    median        uq       max neval</span></span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="co">#     subsetting(big_dt) 370.582  977.2760 1194.875 1016.4340 1096.9285  25750.94  5000</span></span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="co">#        usingSD(big_dt) 554.330 1084.8530 1352.039 1133.4575 1226.9060 189905.39  5000</span></span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a><span class="co">#      usingWith(big_dt) 238.481  832.7505 1017.051  866.6515  927.8460  22717.83  5000</span></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a><span class="co">#    usingDotDot(big_dt) 256.005  844.8770 1101.543  878.9935  936.6040 181855.43  5000</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a><span class="co">#  usingPatterns(big_dt) 569.787 1128.0970 1411.510 1178.2895 1282.2265 177415.23  5000</span></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="co">#      usingLike(big_dt) 262.868  852.5805 1059.466  887.3455  948.6665  23971.70  5000</span></span></code></pre></div>
</div>
<h3 id="dropping-columns">dropping columns</h3>
<p>Drop columns from a data.table : two methods</p>
<ol type="1">
<li><p>Drop explicitly using <code>:= NULL</code><br />
</p></li>
<li><p>Anti-Select</p></li>
<li><p>Drop explicitly</p></li>
</ol>
<p>When dropping variables programatically by calling an object name, it
should be <code>()</code> wrapped.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">drop_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;continent&#39;</span>,<span class="st">&#39;year&#39;</span><span class="op">)</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="op">(</span><span class="va">drop_cols</span><span class="op">)</span> <span class="op">:=</span> <span class="cn">NULL</span> <span class="op">]</span> <span class="co"># should be wrapped when := operation is used with</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="va">drop_cols</span> <span class="op">:=</span> <span class="cn">NULL</span>, with<span class="op">=</span><span class="cn">F</span><span class="op">]</span> <span class="co"># this is deprecated</span></span></code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Anti-Select</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span><span class="op">[</span>,<span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;pop&#39;</span>,<span class="st">&#39;year&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">drop_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;pop&#39;</span>,<span class="st">&#39;year&#39;</span><span class="op">)</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="op">!</span><span class="va">drop_cols</span>, with<span class="op">=</span><span class="cn">F</span><span class="op">]</span> </span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="op">!</span><span class="va">..drop_cols</span><span class="op">]</span> <span class="co"># same</span></span>
<span></span>
<span></span>
<span><span class="co"># appendix</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="op">(</span><span class="va">drop_cols</span><span class="op">)</span><span class="op">]</span> <span class="co"># paranthesis does not behave as expected</span></span></code></pre>
</div>
</div>
<h3 id="replace-values">replace values</h3>
<p>Below replaces all values inplace, which is memory efficient and
fast.</p>
<p>Empty strings to NA, all DT</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw">for</span> <span class="op">(</span><span class="va">colnum</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">sdc</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/assign.html">set</a></span><span class="op">(</span><span class="va">sdc</span>, i<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">sdc</span><span class="op">[[</span><span class="va">colnum</span><span class="op">]</span><span class="op">]</span><span class="op">==</span><span class="st">&#39;&#39;</span><span class="op">)</span>, j<span class="op">=</span><span class="va">colnum</span>, value<span class="op">=</span><span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<p>NA to -1 conversion, chosen columns</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw">for</span> <span class="op">(</span><span class="va">colnum</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_along</a></span><span class="op">(</span><span class="va">sdc</span><span class="op">[</span>,<span class="va">S_P_I_LT_MAX</span><span class="op">:</span><span class="va">Moody_s_U_LT_MAX</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/assign.html">set</a></span><span class="op">(</span><span class="va">sdc</span>, i<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sdc</span><span class="op">[[</span><span class="va">colnum</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, j<span class="op">=</span><span class="va">colnum</span>, value<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<p>NA to 0 conversion, all DT</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">f_dowle2</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">DT</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">DT</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">DT</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span>, <span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">:=</span><span class="fl">0</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h4 id="nafill-imputation">nafill imputation</h4>
<p>Currently only numeric vectors work well</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">colnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;col1&#39;</span>,<span class="st">&#39;col2&#39;</span><span class="op">)</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="op">(</span><span class="va">colnames</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/nafill.html">nafill</a></span><span class="op">(</span><span class="va">x</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>   .SDcols <span class="op">=</span> <span class="va">colnames</span> ,</span>
<span>   by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">TICKER</span>, <span class="va">Date</span><span class="op">)</span><span class="op">]</span> <span class="co"># filling NAs with groupby means</span></span></code></pre>
</div>
</div>
<p>Use for only simple cases</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># last observation carried forward (locf)</span></span>
<span></span>
<span><span class="co"># next obseravation carried backward (nocb)</span></span>
<span></span>
<span><span class="op">?</span><span class="va">nafill</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span>, <span class="fl">9</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="co"># [1] NA NA  3  4 NA NA  7  8 NA NA</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/nafill.html">nafill</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">&quot;locf&quot;</span><span class="op">)</span></span>
<span><span class="co"># [1] NA NA  3  4  4  4  7  8  8  8</span></span>
<span></span>
<span><span class="va">dt</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>v1<span class="op">=</span><span class="va">x</span>, v2<span class="op">=</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/shift.html">shift</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, v3<span class="op">=</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/shift.html">shift</a></span><span class="op">(</span><span class="va">x</span>, <span class="op">-</span><span class="fl">1L</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#     v1  v2  v3</span></span>
<span><span class="co">#  1: NA  NA  NA</span></span>
<span><span class="co">#  2: NA  NA 1.5</span></span>
<span><span class="co">#  3:  3  NA 2.0</span></span>
<span><span class="co">#  4:  4 1.5  NA</span></span>
<span><span class="co">#  5: NA 2.0  NA</span></span>
<span><span class="co">#  6: NA  NA 3.5</span></span>
<span><span class="co">#  7:  7  NA 4.0</span></span>
<span><span class="co">#  8:  8 3.5  NA</span></span>
<span><span class="co">#  9: NA 4.0  NA</span></span>
<span><span class="co"># 10: NA  NA  NA</span></span>
<span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/nafill.html">nafill</a></span><span class="op">(</span><span class="va">dt</span>, <span class="st">&quot;nocb&quot;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">as.data.table</span></span>
<span><span class="co">#     V1  V2  V3</span></span>
<span><span class="co">#  1:  3 1.5 1.5</span></span>
<span><span class="co">#  2:  3 1.5 1.5</span></span>
<span><span class="co">#  3:  3 1.5 2.0</span></span>
<span><span class="co">#  4:  4 1.5 3.5</span></span>
<span><span class="co">#  5:  7 2.0 3.5</span></span>
<span><span class="co">#  6:  7 3.5 3.5</span></span>
<span><span class="co">#  7:  7 3.5 4.0</span></span>
<span><span class="co">#  8:  8 3.5  NA</span></span>
<span><span class="co">#  9: NA 4.0  NA</span></span>
<span><span class="co"># 10: NA  NA  NA</span></span>
<span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/nafill.html">setnafill</a></span><span class="op">(</span><span class="va">dt</span>, <span class="st">&quot;locf&quot;</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;v2&quot;</span>,<span class="st">&quot;v3&quot;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="zoona.locf-na.nocb">zoo::na.locf, na.nocb</h4>
<h3 id="assigning-columns">assigning columns</h3>
<p>Assigning one column : <code>col_name := max(col1)</code> can be
used.<br />
</p>
<p>Assigning multiple columns : <code>:=</code> operator cannot be
inside of list.</p>
<ol type="1">
<li><p>Use <code>:=</code>(col_name = max(col1), col_name2 = min(col2))
or,</p></li>
<li><p>use
<code>c(&#39;col_name&#39;,&#39;col_name2&#39;) := .(max(col1), min(col2))</code></p></li>
</ol>
<h4 id="lapply-.sd-assign">lapply .SD assign</h4>
<p>To programmatically write multiple functions with
<code>lapply</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>colnames <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&#39;name1&#39;</span>,<span class="st">&#39;name2&#39;</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># !doesn&#39;t work</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>DT[, colnames <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, mean), .SDcols <span class="ot">=</span> colnames] <span class="co"># does not work : LHS should be a character vector</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>DT[, (colnames) <span class="sc">:</span><span class="er">=</span> <span class="fu">lapply</span>(.SD, mean) .SDcols <span class="ot">=</span> colnames] <span class="co"># works</span></span></code></pre></div>
</div>
<h3 id="rename-columns">rename columns</h3>
<p><code>setnames()</code> is data.table function that works
inplace.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Ex 1</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">gapminder</span>, old<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;year&#39;</span>,<span class="st">&#39;pop&#39;</span><span class="op">)</span>,new<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;YEAR&#39;</span>,<span class="st">&#39;POP&#39;</span><span class="op">)</span>, skip_absent<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Add suffixes by reference</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">gdi_us_w</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gdi_us_w</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gdi_us_w</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">13</span><span class="op">]</span>,<span class="st">&#39;_us&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Example : tagging function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">tag_names</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">DT</span>,<span class="va">cols</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">DT</span>, old <span class="op">=</span> <span class="va">cols</span>, new<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">cols</span>, <span class="st">&#39;_mytag&#39;</span><span class="op">)</span>, skip_absent <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">tag_names</span><span class="op">(</span><span class="va">gapminder</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;country&#39;</span>,<span class="st">&#39;invalid&#39;</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="columns-class-converting">columns class converting</h3>
<p>When looping over, pass if it generates error</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;Date&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, value<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">:=</span> </span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, </span>
<span>              <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span></span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">x</span>, tryFormats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;%Y-%m-%d&#39;</span>,<span class="st">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="op">)</span><span class="op">)</span>, error<span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>              <span class="op">)</span> ,</span>
<span>     .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;Date&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, value<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h3 id="grep-function">grep function</h3>
<p><code>grep(pattern=&#39;^engine&#39;, x = names(gapminder))</code> returns
indecies that are matching, and argument <code>value=T</code> returns
values instead.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">col_pattern</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;^co&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span>, value<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">col_pattern</span><span class="op">)</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcol <span class="op">=</span> <span class="va">col_pattern</span><span class="op">]</span></span></code></pre>
</div>
</div>
<p>However, more intuitive and beautifuly way:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">&#39;^co&#39;</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h3 id="lapplying-function-calls">lapplying function calls</h3>
<p><code>lapply</code> and <code>sapply</code> works slightly
differently : <code>lapply</code> returns DT, <code>sapply</code>
returns a vector.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">]</span> <span class="co"># returns DT</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">.SD</span>,<span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span><span class="op">]</span> <span class="co"># returns vector</span></span></code></pre>
</div>
</div>
<h3 id="lead-lag-columns">lead &amp; lag columns</h3>
<p><code>shift(x, n=1L, fill=NA, type=c(&quot;lag&quot;, &quot;lead&quot;, &quot;shift&quot;), give.names=FALSE)</code><br />
To generate a column with lead or lag.<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span></span>
<span>  lag1_year <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/shift.html">shift</a></span><span class="op">(</span><span class="va">year</span>, n<span class="op">=</span><span class="fl">1</span>, type<span class="op">=</span><span class="st">&#39;lag&#39;</span><span class="op">)</span>,</span>
<span>  <span class="va">lifeExp</span>,</span>
<span>  <span class="va">pop</span><span class="op">)</span>, by<span class="op">=</span><span class="va">country</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="by-operations"><code>by</code> operations</h2>
<h2 id="env-operations"><code>env</code> operations</h2>
<h2 id="mult-opertations"><code>mult</code> opertations</h2>
<p>The default is <code>mult = all</code>, which means all mathcing
results would be retrieved. Other optionss are <code>first</code> or
<code>last</code>.</p>
<h2 id="special-symbols">Special symbols</h2>
<h3 id="n"><code>.N</code></h3>
<p><code>.N</code> refers to <em>the number of rows</em> for each group
(if by argument was there)</p>
<p>Use cases :</p>
<ol type="1">
<li>Value counts : NAs would also be counted.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mtcars</span><span class="op">[</span>,<span class="va">.N</span>, by<span class="op">=</span><span class="va">cyl</span><span class="op">]</span> <span class="co"># calculate nrow (.N) for each unique value of cyl</span></span></code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Last row number :</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># last row</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">.SD</span><span class="op">[</span><span class="va">.N</span><span class="op">]</span>, by<span class="op">=</span><span class="va">continent</span><span class="op">]</span></span>
<span><span class="co"># first row</span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">.SD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, by<span class="op">=</span><span class="va">continent</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">.SD</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span><span class="op">]</span>, by<span class="op">=</span><span class="va">continent</span><span class="op">]</span></span></code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Generating sequence numbers to the members of each group</li>
</ol>
<p>with <code>seq_len()</code> function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">.N</span><span class="op">)</span>, by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">continent</span>, <span class="va">country</span> <span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h3 id="sd"><code>.SD</code></h3>
<p><code>.SD</code> is useful especially when<br />
</p>
<ol type="1">
<li><p>lapplying same function over all or specific
columns(<code>.SDcols</code>) or<br />
</p></li>
<li><p>subgroup operations<br />
</p></li>
<li><p>mentioning data.table itself within the bracket<br />
</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Example for 1) </span></span>
<span><span class="va">gapminder</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">sum</span><span class="op">)</span>, .SDcols<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;lifeExp&#39;</span>, <span class="st">&#39;pop&#39;</span><span class="op">)</span>, by<span class="op">=</span> <span class="va">continent</span><span class="op">]</span><span class="op">[</span>,<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">.SD</span>,<span class="st">&#39;lifeExp&#39;</span>,<span class="st">&#39;LIFEEXP&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">gapminder</span><span class="op">[</span>,<span class="va">.SD</span>, .SDcols <span class="op">=</span> <span class="st">&#39;year&#39;</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h4 id="multiple-.sds-1">*Multiple <code>.SD</code>s</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">d</span><span class="op">[</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">SD1</span>, <span class="va">sum</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">SD2</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  env <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>SD1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Sepal.Length&#39;</span>,<span class="st">&#39;Sepal.Width&#39;</span><span class="op">)</span><span class="op">)</span>, </span>
<span>             SD2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Petal.Length&#39;</span>,<span class="st">&#39;Petal.Width&#39;</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  by <span class="op">=</span> <span class="va">Species</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/list.html">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="i"><code>.I</code></h3>
<p>.I is useful to get the row number.</p>
<h3 id="eachi"><code>.EACHI</code></h3>
<p>Used on by part of operations.</p>
<h3 id="grp"><code>.GRP</code></h3>
<p>Assigns integer numbers to each groups</p>
<h4 id="assign-chunk-group">Assign Chunk group</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">8</span> <span class="co"># number of chunks</span></span>
<span><span class="va">DT</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">.N</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="va">.N</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h3 id="grpn"><code>.GRPN</code></h3>
<p>Assigns the number of observations to each groups</p>
<h2 id="function-with-data.table">Function with data.table</h2>
<h3 id="get-1">get(), ()</h3>
<p><code>get()</code> and <code>()</code> are very useful notations when
defining a function with <code>data.table</code><br />
</p>
<p><code>get()</code> function to evaluate string to refer column
names.<br />
</p>
<p><code>()</code> to assign a column with pre-defined name object</p>
<p>When assigning new column name, <code>get(colname)</code> doesnt
work properly. Use <code>(colname)</code> instead.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># add 10 and assign new column with suffix _plus10</span></span>
<span></span>
<span><span class="co"># ERROR </span></span>
<span><span class="va">add10</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">DT</span>, <span class="va">cols</span><span class="op">)</span><span class="op">{</span> <span class="co"># DT is data.table, cols is character vector </span></span>
<span>    </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">col</span> <span class="kw">in</span> <span class="va">cols</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">new_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">col</span>, <span class="st">&quot;_plus10&quot;</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="co"># Here gets Error : data.table assigns colname as new_name literally, not as intended as .._plus10 </span></span>
<span>    <span class="va">DT</span><span class="op">[</span>, <span class="va">new_name</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span><span class="op">]</span> <span class="co"># assigns column name literally as new_name (!) which is not intended behavior</span></span>
<span></span>
<span>        <span class="co"># ANSWER: use () for generating new column names</span></span>
<span>    <span class="va">DT</span><span class="op">[</span>, <span class="op">(</span><span class="va">new_name</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/get.html">get</a></span><span class="op">(</span><span class="va">col</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span><span class="op">]</span> <span class="co"># works correctly</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">add10</span><span class="op">(</span><span class="va">gapminder</span>,<span class="st">&quot;year&quot;</span><span class="op">)</span> <span class="co"># no error returned</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">gapminder</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="read-multiple-files-as-data.tables">Read multiple files as
data.tables</h2>
<p>Use <code>rbindlist()</code> function together with
<code>list.files()</code><br />
<code>rbindlist</code> is similar to <code>rbind</code>, yet more
efficient and faster.<br />
</p>
<p><code>rbindlist</code> takes a list of data.tables and rbind it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Example workflow of reading multiple csv files and concatenating them</span></span>
<span><span class="va">table_files</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;sales2000.csv&#39;</span>,<span class="st">&#39;sales2001.csv&#39;</span><span class="op">)</span></span>
<span><span class="va">list_tables</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">table_files</span>, <span class="va">fread</span><span class="op">)</span> <span class="co"># list of data.tables</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="va">list_tables</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># fill T fills NA if columns does not match each other, idcol = specifies which file it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span> <span class="op">(</span><span class="va">x</span>, <span class="va">y</span> , fill<span class="op">=</span><span class="cn">T</span>, idcol<span class="op">=</span><span class="st">&#39;id_name&#39;</span> ,use.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="va">some_list</span>, use.names<span class="op">=</span><span class="st">&quot;check&quot;</span>, fill<span class="op">=</span><span class="cn">FALSE</span>, idcol<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="co"># use.names=&#39;check&#39; =&gt; by default it warns if position does not match names</span></span></code></pre>
</div>
</div>
<h2 id="combinations">Combinations</h2>
<p><code>foverlaps()</code> is fast way to implement. My use case was to
generate an edgelist for network analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">id</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># slow</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">&quot;A&quot;</span>, <span class="fl">10001</span><span class="op">:</span><span class="fl">15000</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">d</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span>id1 <span class="op">=</span> <span class="fl">1L</span>, id2 <span class="op">=</span> <span class="va">.I</span><span class="op">)</span><span class="op">]</span> <span class="co">## add interval columns for overlaps</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setkey.html">setkey</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">id1</span>, <span class="va">id2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/foverlaps.html">foverlaps</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">d</span>, type<span class="op">=</span><span class="st">&#39;within&#39;</span>, which<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="va">xid</span> <span class="op">!=</span> <span class="va">yid</span><span class="op">]</span></span>
<span><span class="va">olaps</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/foverlaps.html">foverlaps</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">d</span>, type<span class="op">=</span><span class="st">&#39;within&#39;</span>, which<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="va">xid</span> <span class="op">!=</span> <span class="va">yid</span><span class="op">]</span></span>
<span><span class="va">ans</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">olaps</span><span class="op">$</span><span class="va">xid</span><span class="op">]</span>, <span class="va">d</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">olaps</span><span class="op">$</span><span class="va">yid</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="set-operations">Set operations</h2>
<p>When working with multiple and duplicated data.tables</p>
<p><code>fintersect()</code> : choose UNIQUE set of rows that are common
on two data tables. If <code>all=TRUE</code>, then numbers of rows
duplicated that intersect will be also returned.<br />
<code>funion()</code> : choose UNIQUE set of UNION rows<br />
<code>fsetdiff()</code> : choose UNIQUE set of rows that are EXCLUSIVELY
existing on the left<br />
</p>
<h2 id="melt">MELT</h2>
<p>data.table melting : m to 2 columns</p>
<p><code>melt()</code> function</p>
<p>Multiple columns (measure.vars) -&gt; two columns (variable,
value)</p>
<ul>
<li>one with name of column(variable.name),<br />
</li>
<li>and one with values(value.name)</li>
</ul>
<p>id.vars = columns that are kept from melting</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html">melt</a></span><span class="op">(</span><span class="va">ebola_wide</span>, id.vars<span class="op">=</span><span class="st">&quot;Location&quot;</span>, measure.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Week_50&quot;</span>, <span class="st">&quot;Week_51&quot;</span><span class="op">)</span>, </span>
<span>     variable.name <span class="op">=</span> <span class="st">&quot;period&quot;</span>, value.name <span class="op">=</span> <span class="st">&quot;cases&quot;</span></span>
<span>     <span class="op">)</span> </span>
<span></span>
<span><span class="co"># except for Location, </span></span>
<span><span class="co"># Week_50 - 51 columns will be stacked and other columns will be dropped, </span></span>
<span><span class="co"># generating key (variable) and value pair</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="op">?</span><span class="va">melt</span></span></code></pre>
</div>
</div>
<h2 id="dcast">DCAST</h2>
<p>data.frame casting.</p>
<p><code>dcast</code> function : multiple casting is available.</p>
<p>Formula expression</p>
<ul>
<li><p>LHS = Identifing variables that should stay the same</p></li>
<li><p>RHS = The separator variable</p></li>
<li><p>value.var = values that are filling in the new columns</p></li>
<li><p>if multiple columns :</p>
<p>Special variables : <code>.</code> and <code>...</code><br />
<code>.</code> : no variable<br />
<code>...</code> : all variables not mentioned<br />
</p></li>
</ul>
<h3 id="example-1">Example</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># The name of new columns : year (2000, 2001) are there</span></span>
<span><span class="co"># (one column) =&gt; many columns</span></span>
<span></span>
<span><span class="co"># the value that will be filling those new columns : value.var</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/dcast.data.table.html">dcast</a></span><span class="op">(</span><span class="va">gdp_oceania</span>, formula <span class="op">=</span> <span class="va">country</span> <span class="op">+</span> <span class="va">continent</span> <span class="op">~</span> <span class="va">year</span>, value.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;gdp&quot;</span>, <span class="st">&quot;population&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># year as separator variable : 2000, 2001, 2002 ,... will be spreaded to the right hand side</span></span>
<span><span class="co"># Keep country and continent as identifier variables, cast year variable and values are gdp (generate 2000_gdp, 2001_gdp etc) and population (2000_population, 2001_population etc.)</span></span>
<span></span>
<span><span class="co"># when identifiers are NOT UNIQUE, then it tries to aggregate with some functions. </span></span>
<span><span class="co"># When identity needs to be filled, make sure the identifiers uniquely match each observations.</span></span></code></pre>
</div>
</div>
<h2 id="cj">CJ</h2>
<p>Cross-Join function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;ABC&quot;</span>, <span class="st">&quot;ABC&quot;</span>, <span class="st">&quot;DEF&quot;</span>, <span class="st">&quot;GHI&quot;</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;2012-05-01&quot;</span>, <span class="st">&quot;2012-05-02&quot;</span>, <span class="st">&quot;2012-05-03&quot;</span>, <span class="st">&quot;2012-05-04&quot;</span>, <span class="st">&quot;2012-05-05&quot;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/J.html">CJ</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span><span class="op">)</span> <span class="co"># All are treated as unique</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/J.html">CJ</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,unique<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="co"># only Unique ids are used</span></span></code></pre>
</div>
</div>
<h3 id="example-2">example</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">times</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2011</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">9</span>,<span class="fl">00</span>, tz<span class="op">=</span><span class="st">&#39;UTC&#39;</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2011</span>,<span class="fl">12</span>,<span class="fl">31</span>,<span class="fl">16</span>,<span class="fl">00</span>, tz<span class="op">=</span><span class="st">&#39;UTC&#39;</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">&#39;30 min&#39;</span><span class="op">)</span></span>
<span><span class="va">times</span> <span class="op">=</span> <span class="va">times</span><span class="op">[</span><span class="fl">9</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">times</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">16</span> <span class="op">]</span></span></code></pre>
</div>
</div>
<h1 id="string-manipulation">STRING MANIPULATION</h1>
<h2 id="regular-expressions">regular expressions</h2>
<hr />
<p>Characters <code>.</code> : <code>.</code> means any character<br />
<code>\\.</code> : escape, literaly dot<br />
<code>\\s</code> : one spacebar<br />
<code>[0-9]</code> : one numeric<br />
<code>\\d</code> : single digit<br />
<code>[a-zA-z]</code> : one alphabet chracter<br />
<code>\\w</code> : word character including digit (alphanumeric)<br />
<code>[:punct:]</code> : punctuation <code>.</code>, <code>!</code>,
<code>,</code><br />
</p>
<p>Multipliers</p>
<p><code>*</code> : 0, 1, ore more numbers of prefix<br />
<code>+</code> : 1 or more numbers of prefix<br />
<code>?</code> : 0 or 1 (maybe there or not)<br />
<code>*?</code> : makes multiplier lazy instead of greedy<br />
<code>^</code> : starts with<br />
<code>$</code> : ends with<br />
</p>
<p>Custom pattern <code>[]</code> : custom pattern<br />
<code>[^a-z]</code> : inverse of custom pattern<br />
</p>
<hr />
<p>Repetitions</p>
<p><code>\\w{2}</code> : exactly two characters<br />
<code>\\w{2,3}</code> : two to three characters<br />
<code>\\w{2,}</code> : minimum 2 to unlimited max<br />
<code>\\w+</code> : 1 or more<br />
<code>\\w*</code> : 0, 1, or more<br />
</p>
<p>Groups</p>
<p><code>()</code> : grouping for replacement and extraction etc.<br />
<code>(?:)</code> : non-capturing groups<br />
<code>\\1</code>,<code>\\2</code>, : backreference = referring the
first, second,  capture group<br />
</p>
<p>Negations</p>
<p><code>\\D</code> : all but digits<br />
<code>\\W</code> : all but alphanumerics<br />
<code>[^a-zA-Z]</code> : all but alphabet<br />
</p>
<p>Greedy vs Lazy</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="st">&quot;Toy story 3 in digital 3d is really good&quot;</span>, <span class="st">&#39;.*3&#39;</span><span class="op">)</span>  <span class="co"># Greedy : &quot;Toy story 3 in digital 3&quot;</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="st">&quot;Toy story 3 in digital 3d is really good&quot;</span>, <span class="st">&#39;.*?3&#39;</span><span class="op">)</span> <span class="co"># Lazy : &quot;&quot;Toy story 3&quot;</span></span></code></pre>
</div>
</div>
<p>Regular expressions with base r package:</p>
<p><code>grep</code> : Give indices that mathes pattern<br />
<code>grepl</code> : Give TRUE / FALSE result list that matches
pattern<br />
<code>sub</code> : Substitute first matching result<br />
<code>gsub</code> : Substitute ALL<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">awards</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Won 1 Oscar.&quot;</span>,</span>
<span>  <span class="st">&quot;Won 1 Oscar. Another 9 wins &amp; 24 nominations.&quot;</span>,</span>
<span>  <span class="st">&quot;1 win and 2 nominations.&quot;</span>,</span>
<span>  <span class="st">&quot;2 wins &amp; 3 nominations.&quot;</span>,</span>
<span>  <span class="st">&quot;Nominated for 2 Golden Globes. 1 more win &amp; 2 nominations.&quot;</span>,</span>
<span>  <span class="st">&quot;4 wins &amp; 1 nomination.&quot;</span><span class="op">)</span></span>
<span><span class="co"># use sub : substitute first occurence</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">&quot;.*\\s([0-9]+)\\snomination.*$&quot;</span>, <span class="st">&quot;\\1&quot;</span>, <span class="va">awards</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">test</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;koala&#39;</span>,<span class="st">&#39;panda&#39;</span>,<span class="st">&#39;monkey&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;.a$&#39;</span>, <span class="va">test</span><span class="op">)</span> <span class="co"># gives indecies that are TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">&#39;.a$&#39;</span>,<span class="va">test</span><span class="op">)</span> <span class="co"># gives logical back (TRUE/FALSE)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">&#39;a&#39;</span>,<span class="st">&#39;A&#39;</span>,<span class="va">test</span><span class="op">)</span> <span class="co"># substitutes first matches</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">&#39;a&#39;</span>,<span class="st">&#39;A&#39;</span>,<span class="va">test</span><span class="op">)</span> <span class="co"># substitue ALL matches</span></span></code></pre>
</div>
</div>
<h2 id="base-r">base R</h2>
<h3 id="paste">paste</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># use of paste() function to attach string</span></span>
<span><span class="va">pqdata</span> <span class="op">=</span> <span class="va">pqdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>new_state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">&#39;new_&#39;</span>, <span class="va">State</span>, sep<span class="op">=</span><span class="st">&#39;&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># mutate</span></span>
<span><span class="va">pqdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">State</span>, <span class="va">new_state</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="substr">substr</h3>
<p>extract substring of the string</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="st">&#39;This is the example text&#39;</span>,<span class="fl">1</span>,<span class="fl">6</span><span class="op">)</span> </span>
<span><span class="co"># &quot;This i&quot;</span></span></code></pre>
</div>
</div>
<h3 id="strsplit">strsplit</h3>
<p>splits each character elements and returns list</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;I_My_Me_Mine&#39;</span>,<span class="st">&#39;You_Your_You_Yours&#39;</span><span class="op">)</span>, <span class="st">&#39;_&#39;</span><span class="op">)</span></span>
<span><span class="co"># [[1]]</span></span>
<span><span class="co"># [1] &quot;I&quot;    &quot;My&quot;   &quot;Me&quot;   &quot;Mine&quot;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># [[2]]</span></span>
<span><span class="co"># [1] &quot;You&quot;   &quot;Your&quot;  &quot;You&quot;   &quot;Yours&quot;</span></span></code></pre>
</div>
</div>
<h4 id="tstrsplit">tstrsplit</h4>
<p>From <code>data.table</code> package, transpose and strsplit</p>
<p>split a column into several, and generate columns</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">dt</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;PX&quot;</span>, <span class="st">&quot;PY&quot;</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/tstrsplit.html">tstrsplit</a></span><span class="op">(</span><span class="va">PREFIX</span>, <span class="st">&quot;_&quot;</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#    PREFIX VALUE PX PY</span></span>
<span><span class="co"># 1:    A_B     1  A  B</span></span>
<span><span class="co"># 2:    A_C     2  A  C</span></span>
<span><span class="co"># 3:    A_D     3  A  D</span></span>
<span><span class="co"># 4:    B_A     4  B  A</span></span>
<span><span class="co"># 5:    B_C     5  B  C</span></span>
<span><span class="co"># 6:    B_D     6  B  D</span></span></code></pre>
</div>
</div>
<h3 id="grep-grepl">grep, grepl</h3>
<p>grep : globally search for regular expression and print</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="st">&#39;Payload : &quot;Adam, 5, 3&quot;, headers: h&#39;</span>, </span>
<span>          pattern <span class="op">=</span> <span class="st">&#39;([A-Za-z]+),\\s(\\d),\\s(\\d)&#39;</span><span class="op">)</span> <span class="co"># full matched and then group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;([A-Za-z]+),\\s(\\d),\\s(\\d)&#39;</span>,</span>
<span>     <span class="st">&#39;Payload : &quot;Adam, 5, 3&quot;, headers: h&#39;</span>, value<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>grepl : print logical of grep</p>
<h3 id="sub">sub</h3>
<p>substitute</p>
<h3 id="gsub">gsub</h3>
<p>global substitute</p>
<h4 id="group-pattern-extraction">Group Pattern extraction</h4>
<p>with gsub</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">&quot;\\((.*?) :: (0\\.[0-9]+)\\)&quot;</span>,</span>
<span>     <span class="st">&quot;\\1 \\2&quot;</span>,</span>
<span>     <span class="st">&quot;(sometext :: 0.1231313213)&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="format-strings">format strings</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="op">?</span><span class="va">format</span></span>
<span><span class="co"># Define the names vector</span></span>
<span><span class="va">income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">72.19</span>,<span class="fl">1030.18</span>,<span class="fl">10291.93</span>,<span class="fl">1189192.18</span><span class="op">)</span></span>
<span><span class="va">income_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Year 0&quot;</span>, <span class="st">&quot;Year 1&quot;</span>, <span class="st">&quot;Year 2&quot;</span>, <span class="st">&quot;Project Lifetime&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create pretty_income</span></span>
<span><span class="va">pretty_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">income</span>, digits<span class="op">=</span><span class="fl">2</span>, big.mark<span class="op">=</span><span class="st">&#39;,&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pretty_income</span><span class="op">)</span> <span class="co"># character vector now</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create dollar_income</span></span>
<span><span class="va">dollar_income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">&#39;$&#39;</span>, <span class="va">pretty_income</span>,sep<span class="op">=</span><span class="st">&#39;&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">dollar_income</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dollar_income</span><span class="op">)</span></span>
<span><span class="va">dollar_income</span></span>
<span><span class="co"># Create formatted_names</span></span>
<span><span class="va">formatted_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">income_names</span>, justify <span class="op">=</span> <span class="st">&#39;right&#39;</span><span class="op">)</span></span>
<span><span class="va">formatted_names</span></span>
<span><span class="co"># Create rows</span></span>
<span><span class="va">rows</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">formatted_names</span>,<span class="va">dollar_income</span>, sep<span class="op">=</span><span class="st">&#39;   &#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">rows</span><span class="op">)</span></span>
<span><span class="co"># Write rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span><span class="va">rows</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="stringr">stringr</h2>
<p><code>str_c</code> : concatenate, similar to <code>paste</code>
function<br />
</p>
<p><code>str_count</code> : number of times pattern occured on each
character elements<br />
<code>str_remove</code> : remove a pattern<br />
</p>
<p><code>str_trim</code> : stripping whitespaces beginning and the
end<br />
<code>str_to_upper</code><br />
<code>str_to_lower</code><br />
</p>
<p><code>str_length</code> : calculate length of character for all
elements, works on factors as well<br />
<code>str_sub</code> : substring access to each character elements<br />
<code>str_pad</code> : pad numbers to match the width like leading zeros
<code>000470</code></p>
<p><code>str_view</code> : shows how (regex) patterns match to the
string vector</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">pqdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test1 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">County</span>, <span class="st">&#39;as&#39;</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># detect if word &#39;as&#39; is found within column</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test2 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">County</span>, <span class="st">&#39;as&#39;</span>,<span class="st">&#39;AS&#39;</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test3 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">County</span>,<span class="st">&#39;as&#39;</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test4 <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_upper</a></span><span class="op">(</span><span class="va">County</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">County</span>, <span class="va">test1</span><span class="op">:</span><span class="va">test4</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># str_split : returns list, for the number of split outcome is not determined with character vector input</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">&#39;Tom &amp; Jerry &amp; Albin&#39;</span> , pattern <span class="op">=</span> <span class="st">&#39; &amp; &#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="st">&#39;Tom &amp; Jerry &amp; Albin&#39;</span> , pattern <span class="op">=</span> <span class="st">&#39; &amp; &#39;</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span>
<span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Tom &amp; Jerry&#39;</span>, <span class="st">&#39;Tom &amp; Jerry &amp; Albin&#39;</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/modifiers.html">fixed</a></span><span class="op">(</span><span class="st">&#39; &amp; &#39;</span><span class="op">)</span><span class="op">)</span>  <span class="co"># fixed() means do not take this as regex pattern </span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Tom &amp; Jerry&#39;</span>, <span class="st">&#39;Tom &amp; Jerry &amp; Albin&#39;</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">&#39; &amp; &#39;</span>, simplify <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># returns matrix to match </span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># str_view example</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;cat&quot;</span>, <span class="st">&quot;coat&quot;</span>, <span class="st">&quot;scotland&quot;</span>, <span class="st">&quot;tic toc&quot;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view</a></span><span class="op">(</span><span class="va">x</span>, pattern <span class="op">=</span> <span class="st">&#39;ca&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="str_view">str_view()</h3>
<p>Shows which patterns match</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_view.html">str_view</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;ab&#39;</span>, <span class="st">&#39;aab&#39;</span>, <span class="st">&#39;b&#39;</span><span class="op">)</span>, <span class="st">&#39;(a)?b&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="str_match">str_match()</h3>
<p>: extract matched groups from a string<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;The tiger&#39;</span>,<span class="st">&#39;The dragon&#39;</span><span class="op">)</span>, <span class="st">&#39;tiger&#39;</span><span class="op">)</span></span>
<span><span class="co">#     [,1]   </span></span>
<span><span class="co"># [1,] &quot;tiger&quot;</span></span>
<span><span class="co"># [2,] NA     </span></span>
<span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="st">&#39;Payload : &quot;Adam, 5, 3&quot;, headers: h&#39;</span>, </span>
<span>          pattern <span class="op">=</span> <span class="st">&#39;([A-Za-z]+),\\s(\\d),\\s(\\d)&#39;</span><span class="op">)</span> </span>
<span><span class="co">#      [,1]         [,2]   [,3] [,4]</span></span>
<span><span class="co"># [1,] &quot;Adam, 5, 3&quot; &quot;Adam&quot; &quot;5&quot;  &quot;3&quot; </span></span></code></pre>
</div>
</div>
<h3 id="str_detect">str_detect()</h3>
<p>: Detect string and yield logical vector</p>
<p>equivalent to <code>grepl</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;The tiger&#39;</span>,<span class="st">&#39;The dragon&#39;</span>,<span class="st">&#39;cat&#39;</span><span class="op">)</span>, <span class="st">&#39;^The&#39;</span><span class="op">)</span></span>
<span><span class="co"># [1]  TRUE  TRUE FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">&#39;^The&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;The tiger&#39;</span>,<span class="st">&#39;The dragon&#39;</span>,<span class="st">&#39;cat&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;The tiger&#39;</span>,<span class="st">&#39;The dragon&#39;</span>,<span class="st">&#39;cat&#39;</span><span class="op">)</span>, <span class="st">&#39;^The&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">&#39;^The&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;The tiger&#39;</span>,<span class="st">&#39;The dragon&#39;</span>,<span class="st">&#39;cat&#39;</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  times<span class="op">=</span> <span class="fl">10000L</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="str_which">str_which()</h3>
<p>detect pattern and yield the value that maching</p>
<h3 id="str_subset">str_subset()</h3>
<p><code>str_subset</code> : detect and filter only those matches the
pattern  Equivalent to <code>grep(pattern, x, value =T)</code></p>
<h3 id="str_replace">str_replace()</h3>
<p>: replace <code>the first occurrence</code> that matches a pattern to
specified string</p>
<p>similar to <code>sub</code></p>
<p><code>str_replace_all</code> : replace all if pattern occurs multiple
times</p>
<p>similar to <code>gsub</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># simple replacement</span></span>
<span></span>
<span><span class="co"># group match and replacement</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>  <span class="st">&quot;Payload : &#39;Adam, 5, 3&#39;, headers: h&quot;</span>, </span>
<span>  pattern <span class="op">=</span> <span class="st">&#39;([A-Za-z]+),\\s(\\d),\\s(\\d)&#39;</span>,<span class="co"># matches (Adam),(5),(3)</span></span>
<span>  replacement <span class="op">=</span> <span class="st">&#39;\\1 tried to log in \\2 times&#39;</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span></span>
<span>  pattern <span class="op">=</span> <span class="st">&#39;([A-Za-z]+),\\s(\\d),\\s(\\d)&#39;</span>,</span>
<span>  replacement <span class="op">=</span> <span class="st">&#39;\\1 tried to log in \\2 times&#39;</span>,</span>
<span>  x <span class="op">=</span> <span class="st">&quot;Payload : &#39;Adam, 5, 3&#39;, headers: h&quot;</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span></span>
<span>  <span class="st">&quot;Payload : &#39;Adam, 5, 3&#39;, headers: h&quot;</span>, </span>
<span>  pattern <span class="op">=</span> <span class="st">&#39;([A-Za-z]+),\\s(\\d),\\s(\\d)&#39;</span>,<span class="co"># matches (Adam),(5),(3)</span></span>
<span>  replacement <span class="op">=</span> <span class="st">&#39;\\1 tried to log in \\2 times&#39;</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span></span>
<span>  pattern <span class="op">=</span> <span class="st">&#39;([A-Za-z]+),\\s(\\d),\\s(\\d)&#39;</span>,</span>
<span>  replacement <span class="op">=</span> <span class="st">&#39;\\1 tried to log in \\2 times&#39;</span>,</span>
<span>  x <span class="op">=</span> <span class="st">&quot;Payload : &#39;Adam, 5, 3&#39;, headers: h&quot;</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="str_split">str_split()</h3>
<p>: split strings apart by separator specified<br />
</p>
<p>similar to base <code>strsplit</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;I_My_Me_Mine&#39;</span>,<span class="st">&#39;You_Your_You_Yours&#39;</span><span class="op">)</span>, <span class="st">&#39;_&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html">str_split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;I_My_Me_Mine&#39;</span>,<span class="st">&#39;You_Your_You_Yours&#39;</span><span class="op">)</span>, <span class="st">&#39;_&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="glue-package">glue package</h2>
<p>When r code string needs to be evaluated within the string, glue
package can be useful.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/tidyverse/glue">&#39;glue&#39;</a></span><span class="op">)</span></span>
<span><span class="va">animal</span> <span class="op">&lt;-</span> <span class="st">&quot;shark&quot;</span></span>
<span><span class="va">verb</span> <span class="op">&lt;-</span> <span class="st">&quot;ate&quot;</span></span>
<span><span class="va">noun</span> <span class="op">&lt;-</span> <span class="st">&quot;fish&quot;</span></span>
<span><span class="va">string</span><span class="op">=</span><span class="st">&quot;Sammy the {animal} {verb} a {noun}.&quot;</span> <span class="co"># when called by glue, animal, verb, noun are executed in r</span></span>
<span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="va">string</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Can be used to glue (paste or attach) two or more strings as
well.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="va">animal</span>,<span class="va">verb</span>,<span class="va">noun</span>, .sep <span class="op">=</span> <span class="st">&#39; &#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Temporary variable</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span></span>
<span>  <span class="st">&#39;Hi {username}!&#39;</span>,</span>
<span>  username <span class="op">=</span> <span class="st">&#39;Matthew&#39;</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="stringdist-package">stringdist package</h2>
<p>String distance</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/markvanderloo/stringdist">stringdist</a></span><span class="op">)</span></span>
<span><span class="fu">stringdist</span><span class="op">(</span><span class="st">&quot;saturday&quot;</span>, <span class="st">&quot;sunday&quot;</span>, method<span class="op">=</span><span class="st">&#39;lv&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Finding a match</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">amatch</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="st">&#39;sonday&#39;</span>,</span>
<span>  table <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;friday&#39;</span>,<span class="st">&#39;sunday&#39;</span>,<span class="st">&#39;saturday&#39;</span><span class="op">)</span>,</span>
<span>  maxDist <span class="op">=</span><span class="fl">1</span>,</span>
<span>  method<span class="op">=</span><span class="st">&#39;lv&#39;</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="methods">methods</h3>
<p>-lv : Levenshtein distance -dl : Damerau-Levenshtein</p>
<p>-qgram : qgrams distance (n-grams) -jaccard : sum of not shared
divided by shared -cosine : cosine difference between two vectors</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">qgrams</span><span class="op">(</span><span class="st">&#39;Honolulu&#39;</span>,<span class="st">&#39;Hanolulu&#39;</span>, q<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># the more shared, the more close</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">stringdist</span><span class="op">(</span><span class="st">&#39;Honolulu&#39;</span>,<span class="st">&#39;Hanolulu&#39;</span>, method<span class="op">=</span><span class="st">&#39;qgram&#39;</span>, q<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># sum of not shared qgrams</span></span>
<span><span class="fu">stringdist</span><span class="op">(</span><span class="st">&#39;Honolulu&#39;</span>,<span class="st">&#39;Hanolulu&#39;</span>, method<span class="op">=</span><span class="st">&#39;jaccard&#39;</span><span class="op">)</span> <span class="co"># more similar, close to zero</span></span>
<span><span class="fu">stringdist</span><span class="op">(</span><span class="st">&#39;Honolulu&#39;</span>,<span class="st">&#39;Hanolulu&#39;</span>, method<span class="op">=</span><span class="st">&#39;cosine&#39;</span><span class="op">)</span> <span class="co"># more similar, less theta ( close to zero)</span></span></code></pre>
</div>
</div>
<h2 id="fuzzyjoin-package">fuzzyjoin package</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dgrtwo/fuzzyjoin">fuzzyjoin</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>stringdist_join()</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">stringdist_join</span><span class="op">(</span></span>
<span>  <span class="va">frame_a</span>,</span>
<span>  <span class="va">frame_b</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;frame_a_col&quot;</span> <span class="op">=</span> <span class="st">&quot;frame_b_col&quot;</span><span class="op">)</span>,</span>
<span>  max_dist <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  distance_col <span class="op">=</span> <span class="st">&quot;distance&quot;</span>,</span>
<span>  ignore_case <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Custom fuzzy matching</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">func_1</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">left</span>,<span class="va">right</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">stringdist</span><span class="op">(</span><span class="va">left</span>,<span class="va">right</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">5</span> <span class="co"># string distance less than 5</span></span>
<span><span class="op">}</span></span>
<span><span class="va">func_2</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">left</span>,<span class="va">right</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">left</span><span class="op">-</span><span class="va">right</span><span class="op">)</span> <span class="op">&lt;=</span><span class="fl">3</span>  <span class="co"># number distance less than 3</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">fuzzy_left_join</span><span class="op">(</span></span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;a_col1&#39;</span> <span class="op">=</span> <span class="st">&#39;b_col1&#39;</span>,</span>
<span>         <span class="st">&#39;a_col2&#39;</span> <span class="op">=</span> <span class="st">&#39;b_col2&#39;</span><span class="op">)</span>,</span>
<span>  match_fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">&#39;a_col1&#39;</span> <span class="op">=</span> <span class="va">func_1</span>, </span>
<span>                 <span class="st">&#39;a_col2&#39;</span> <span class="op">=</span> <span class="va">func_2</span> <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="date-and-time">DATE and TIME</h1>
<h2 id="posix">POSIX</h2>
<p>ISO Time format :</p>
<pre><code>&#39;2021-06-02 12:00:00&#39;
&#39;%Y-%m-%d %H:%M:%S&#39;</code></pre>
<table>
<colgroup>
<col style="width: 100%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="text-align: left;">Date</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>%Y</code>: 4-digit year (1982)<br />
<code>%y</code>: 2-digit year (82)<br />
<code>%m</code>: 2-digit month (01)<br />
<code>%d</code>: 2-digit day of the month (13)<br />
</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%A</code>: weekday (Wednesday)<br />
<code>%a</code>: abbreviated weekday (Wed)<br />
<code>%B</code>: month (January)<br />
<code>%b</code>: abbreviated month (Jan)<br />
</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://stackoverflow.com/questions/45549449/transform-year-week-to-date-object/45587644#45587644" class="uri">https://stackoverflow.com/questions/45549449/transform-year-week-to-date-object/45587644#45587644</a></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%U</code>: Week of year as a decimal
number (00-53), first Sunday of the year as day 1 of week 1
<code>%u</code>: Weekday as a decimal number (17, Monday is 1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Time ?week <code>%H</code>: hours as a
decimal number (00-23)<br />
<code>%I</code>: hours as a decimal number (01-12)<br />
<code>%M</code>: minutes as a decimal number<br />
<code>%S</code>: seconds as a decimal number<br />
<code>%T</code>: shorthand notation for the typical format
%H:%M:%S<br />
<code>%p</code>: AM/PM indicator<br />
</td>
</tr>
</tbody>
</table>
<h3 id="datetime-conversions">Datetime Conversions</h3>
<p>POSIXct is basically an integer number, second after 1970-01-01.</p>
<p>TAKEAWAY : USE <code>as.POSIXct</code>!</p>
<p><code>Date</code> objects for date, and <code>POSIXct</code> objects
for datetime. <code>POSIXct</code> is most preferred and universal -
<code>data.table</code> forces to use as.POSIXct instead of
strptime.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&#39;2017-12-25 12:34:02&#39;</span><span class="op">)</span> <span class="co"># automatic identification of ISO format</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="st">&#39;2017-12-25 12:34:02&#39;</span>, format <span class="op">=</span> <span class="st">&#39;%Y-%m-%d %T&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">class</span> <span class="co"># POSIXlt</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="st">&#39;2017-12-25 12:34:02&#39;</span><span class="op">)</span> <span class="co"># basic format is recognized</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="st">&#39;2020-05-18&#39;</span>, format <span class="op">=</span> <span class="st">&#39;%Y-%m-%d&#39;</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<p>Benchmark : Integer to Date</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># integer format to date</span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">880904</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">880904</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="fl">880904</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">880904</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="fl">880904</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unit: microseconds</span></span>
<span><span class="co">#                                                 expr    min      lq     mean  median      uq    max neval</span></span>
<span><span class="co">#     as.Date(as.character(880904), format = &quot;%y%m%d&quot;) 11.630 12.5580 13.25445 12.9200 13.3545 24.865   100</span></span>
<span><span class="co">#    strptime(as.character(880904), format = &quot;%y%m%d&quot;)  9.883 10.4540 11.16121 10.9035 11.1555 21.288   100</span></span>
<span><span class="co">#                  strptime(880904, format = &quot;%y%m%d&quot;)  9.863 10.2970 11.17324 10.7460 11.0925 37.027   100</span></span>
<span><span class="co">#  as.POSIXct(as.character(880904), format = &quot;%y%m%d&quot;) 26.980 27.7465 29.88938 28.4275 29.2475 80.642   100</span></span>
<span><span class="co">#      as.POSIXct(strptime(880904, format = &quot;%y%m%d&quot;)) 20.241 20.7970 23.07031 21.2615 21.8460 99.860   100</span></span>
<span>     </span>
<span><span class="co"># string format to date</span></span>
<span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">&#39;880904&#39;</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="st">&#39;880904&#39;</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&#39;880904&#39;</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strptime</a></span><span class="op">(</span><span class="st">&#39;880904&#39;</span>, format <span class="op">=</span> <span class="st">&#39;%y%m%d&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unit: microseconds</span></span>
<span><span class="co">#                                               expr    min      lq     mean  median      uq     max neval</span></span>
<span><span class="co">#               as.Date(&quot;880904&quot;, format = &quot;%y%m%d&quot;)  7.748  8.2855  9.84746  8.5780  8.9335  32.249   100</span></span>
<span><span class="co">#              strptime(&quot;880904&quot;, format = &quot;%y%m%d&quot;)  6.442  6.8290  7.56529  6.9935  7.2230  29.866   100</span></span>
<span><span class="co">#            as.POSIXct(&quot;880904&quot;, format = &quot;%y%m%d&quot;) 20.680 21.3785 24.82438 21.6185 22.0085  94.032   100</span></span>
<span><span class="co">#  as.POSIXct(strptime(&quot;880904&quot;, format = &quot;%y%m%d&quot;)) 14.944 15.5050 18.69356 15.7945 16.0575 117.387   100</span></span></code></pre>
</div>
</div>
<h3 id="generate-date-time-variable">Generate date / time variable</h3>
<p><code>as.Date</code>, <code>as.POSIXct</code>,
<code>ISOdate</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">&#39;2011-01-01&#39;</span><span class="op">)</span>,  <span class="co"># generates date</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&#39;2011-01-01&#39;</span><span class="op">)</span>, <span class="co"># POSIXct</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">11</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span> <span class="co"># POSIXct</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Unit: microseconds</span></span>
<span><span class="co">#                      expr     min       lq      mean   median       uq     max neval</span></span>
<span><span class="co">#     as.Date(&quot;2011-01-01&quot;)  32.563  37.0975  41.44812  39.8715  43.1170 143.752   100</span></span>
<span><span class="co">#  as.POSIXct(&quot;2011-01-01&quot;) 104.800 114.0320 121.04771 117.5525 123.0000 242.566   100</span></span>
<span><span class="co">#         ISOdate(11, 1, 1)  61.747  67.3165  71.76522  70.1420  73.3855 129.363   100</span></span></code></pre>
</div>
</div>
<h3 id="generate-time-sequence">Generate Time Sequence</h3>
Generate simple time sequence
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2011</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2012</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, by<span class="op">=</span><span class="st">&#39;30 min&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
Generate day sequence with time frame
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">TIMESLOTS</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2011</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">9</span>,<span class="fl">30</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2011</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">16</span><span class="op">)</span>, by<span class="op">=</span><span class="st">&#39;30 min&#39;</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="va">TIMESLOTS</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">364</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">add1</span> <span class="op">=</span> <span class="va">TIMESLOTS</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/difftime.html">as.difftime</a></span><span class="op">(</span><span class="va">i</span>, units<span class="op">=</span><span class="st">&#39;days&#39;</span><span class="op">)</span></span>
<span>  <span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">temp</span>, <span class="va">add1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<p>Only business days (weekdays)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">days</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2011</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html">ISOdate</a></span><span class="op">(</span><span class="fl">2011</span>,<span class="fl">1</span>,<span class="fl">15</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">&#39;day&#39;</span><span class="op">)</span></span>
<span><span class="va">days</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">weekdays</a></span><span class="op">(</span><span class="va">days</span><span class="op">)</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/chmatch.html">%chin%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Saturday&#39;</span>,<span class="st">&#39;Sunday&#39;</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="data.table-functions">data.table functions</h2>
<p>For extracting integer date parts : for FAST sorting , aggregating
and joining purposes</p>
<p><code>year(x)</code> : 4 digit year<br />
<code>quarter(x)</code><br />
<code>month(x)</code><br />
<code>isoweek(x)</code><br />
<code>week(x)</code><br />
<code>yday(x)</code> : day of the year (1-366)<br />
<code>wday(x)</code> : day of the week<br />
<code>mday(x)</code> : day of the month (1~31)<br />
<code>hour(x)</code> : hour (1~24)<br />
<code>minute(x)</code><br />
<code>second(x)</code></p>
<h2 id="base-r-1">base R</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Get the current date: today</span></span>
<span><span class="va">today</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Date</span></span>
<span><span class="co"># Get the current time: now</span></span>
<span><span class="va">now</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># POSIXct</span></span>
<span><span class="co"># See what now looks like under the hood</span></span>
<span><span class="va">today</span>;<span class="va">now</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">today</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/base/class.html">unclass</a></span><span class="op">(</span><span class="va">now</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="numeric-to-date">numeric to date</h3>
<p>Its easier to convert to character</p>
<h4 id="numeric-to-character">numeric to character</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/formatc.html">formatC</a></span><span class="op">(</span><span class="fl">880904</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">880904</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Unit: nanoseconds</span></span>
<span><span class="co">#                  expr   min      lq     mean median      uq   max neval</span></span>
<span><span class="co">#       formatC(880904) 16553 22516.0 29228.28  24649 28396.0 95061   100</span></span>
<span><span class="co">#  as.character(880904)   985  1066.5  1993.59   1671  1924.5 15206   100</span></span>
<span></span>
<span><span class="op">?</span><span class="va">as.ITime</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">880904</span><span class="op">)</span>, format <span class="op">=</span> <span class="st">&quot;%y%m%d&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="as.date">as.Date</h4>
<p><code>as.Date()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Definition of character strings representing dates</span></span>
<span><span class="va">str1</span> <span class="op">&lt;-</span> <span class="st">&quot;May 23, &#39;96&quot;</span></span>
<span><span class="va">str2</span> <span class="op">&lt;-</span> <span class="st">&quot;2012-03-15&quot;</span></span>
<span><span class="va">str3</span> <span class="op">&lt;-</span> <span class="st">&quot;30/January/2006&quot;</span></span>
<span></span>
<span><span class="co"># Convert the strings to dates: date1, date2, date3</span></span>
<span><span class="va">date1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">str1</span>, format <span class="op">=</span> <span class="st">&quot;%b %d, &#39;%y&quot;</span><span class="op">)</span></span>
<span><span class="va">date2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">str2</span>, format <span class="op">=</span> <span class="st">&quot;%Y-%m-%d&quot;</span><span class="op">)</span></span>
<span><span class="va">date3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">str3</span>, format <span class="op">=</span> <span class="st">&#39;%d/%B/%Y&#39;</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Convert dates to formatted strings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">date1</span>, <span class="st">&quot;%A&quot;</span><span class="op">)</span> <span class="co"># take out weekday (full)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">date2</span>, <span class="st">&quot;%m&quot;</span><span class="op">)</span> <span class="co"># take out month 2 digit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">date3</span>, <span class="st">&quot;%b %Y&quot;</span><span class="op">)</span> <span class="co"># take out abb. month 4 digit year</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Definition of character strings representing times</span></span>
<span><span class="va">str1</span> <span class="op">&lt;-</span> <span class="st">&quot;May 23, &#39;96 hours:23 minutes:01 seconds:45&quot;</span></span>
<span><span class="va">str2</span> <span class="op">&lt;-</span> <span class="st">&quot;2012-3-12 14:23:08&quot;</span></span>
<span></span>
<span><span class="co"># Convert the strings to POSIXct objects: time1, time2</span></span>
<span><span class="va">time1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">str1</span>, format <span class="op">=</span> <span class="st">&quot;%B %d, &#39;%y hours:%H minutes:%M seconds:%S&quot;</span><span class="op">)</span></span>
<span><span class="va">time2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">str2</span>, format <span class="op">=</span> <span class="st">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert times to formatted strings</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">time1</span>, format<span class="op">=</span> <span class="st">&#39;%M&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">time2</span>,format<span class="op">=</span><span class="st">&#39;%I:%M %p&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>tryFormats : converts to date with different noticeable formats</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">data</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;Date&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, value<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">x</span>, tryFormats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;%Y-%m-%d&#39;</span>,<span class="st">&#39;%Y-%m-%d %H:%M:%S&#39;</span><span class="op">)</span><span class="op">)</span>, error<span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span> , .SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grep</a></span><span class="op">(</span><span class="st">&#39;Date&#39;</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, value<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h3 id="time-difference">time difference</h3>
<p><code>time_length()</code> function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># years to maturity</span></span>
<span><span class="va">fisd</span><span class="op">[</span>, <span class="va">YEAR_TO_MAT</span> <span class="op">:=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/time_length.html">time_length</a></span><span class="op">(</span><span class="va">MATURITY</span><span class="op">-</span><span class="va">DATED_DATE</span>, unit <span class="op">=</span> <span class="st">&#39;year&#39;</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h2 id="anytime">anytime</h2>
<p>Automatid date and time parser, fast!</p>
<h2 id="lubridate">lubridate</h2>
<p>Automatic date and time parser, easy to work with!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org">&#39;lubridate&#39;</a></span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="st">&#39;2020, Apr 12&#39;</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parse as date and time (with no seconds!)</span></span>
<span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html">mdy_hm</a></span><span class="op">(</span><span class="st">&quot;July 15, 2012 12:56&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Add a line to create whole months on air variable</span></span>
<span><span class="va">baker_time</span> <span class="op">&lt;-</span> <span class="va">baker_time</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>time_on_air <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/interval.html">interval</a></span><span class="op">(</span><span class="va">first_date_appeared_uk</span>, <span class="va">last_date_appeared_uk</span><span class="op">)</span>, <span class="co"># interval object</span></span>
<span>         weeks_on_air <span class="op">=</span> <span class="va">time_on_air</span> <span class="op">/</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html">weeks</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># in weeks</span></span>
<span>         months_on_air <span class="op">=</span> <span class="va">time_on_air</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html">%/%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/weekday.POSIXt.html">months</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co"># in month (modulo - round down version)</span></span></code></pre>
</div>
</div>
<h2 id="posixct-base-package">POSIXct : base package</h2>
<ul>
<li><code>POSIXlt</code> : list format time</li>
<li><code>POSIXct</code> : calander time - integer</li>
</ul>
<h3 id="converting-integer-posix-to-posixct">Converting integer posix to
posixct</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create POSIXct dates from a hypothetical Excel dataset</span></span>
<span><span class="co">#  excelDT: integer &quot;days since January 1, 1900&quot;</span></span>
<span></span>
<span><span class="va">excelDT</span><span class="op">[</span>, <span class="va">posix</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="va">timecol</span>, origin <span class="op">=</span> <span class="st">&quot;1900-01-01&quot;</span><span class="op">)</span>, tz <span class="op">=</span> <span class="st">&quot;UTC&quot;</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Convert strings to POSIXct</span></span>
<span><span class="co"># stringDT: string dates like &quot;2017-01-01&quot;</span></span>
<span></span>
<span><span class="va">stringDT</span><span class="op">[</span>, <span class="va">posix</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">timecol</span>, tz <span class="op">=</span> <span class="st">&quot;UTC&quot;</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Convert epoch seconds to POSIXct</span></span>
<span><span class="co"># epochSecondsDT: integer seconds since January 1, 1970 (&quot;epoch seconds&quot;)</span></span>
<span></span>
<span><span class="va">epochSecondsDT</span><span class="op">[</span>, <span class="va">posix</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">timecol</span>, tz <span class="op">=</span> <span class="st">&quot;UTC&quot;</span>, origin <span class="op">=</span> <span class="st">&quot;1970-01-01&quot;</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Convert epoch milliseconds to POSIXct</span></span>
<span><span class="co"># epochMillisDT: integer milliseconds since January 1, 1970 (&quot;epoch millis&quot;)</span></span>
<span></span>
<span><span class="va">epochMillisDT</span><span class="op">[</span>, <span class="va">posix</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">timecol</span> <span class="op">/</span> <span class="fl">1000</span>, tz <span class="op">=</span> <span class="st">&quot;UTC&quot;</span>, origin <span class="op">=</span> <span class="st">&quot;1970-01-01&quot;</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h3 id="generating-posix">Generating posix</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Generate a series of dates</span></span>
<span><span class="va">march_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html">seq.POSIXt</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2017-03-01&quot;</span><span class="op">)</span>, to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2017-03-31&quot;</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">31</span><span class="op">)</span></span>
<span><span class="co"># Generate hourly data</span></span>
<span><span class="va">hourly_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html">seq.POSIXt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2017-05-01 00:00:00&quot;</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&#39;2017-05-02 00:00:00&#39;</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">24</span><span class="op">)</span> <span class="co"># to make hourly observations : 1 day 24 hours : 25 observations</span></span>
<span><span class="op">?</span><span class="va">as.POSIXct</span></span>
<span></span>
<span><span class="co"># Generate sample IoT data</span></span>
<span><span class="va">iotDT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span></span>
<span>    timestamp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html">seq.POSIXt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2016-04-19 00:00:00&quot;</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2016-04-20 00:00:00&quot;</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>    engine_temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>    ambient_temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iotDT</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="xts-package">xts package</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/xts">xts</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Simulated data : 2017/6/15 from 00 to 01, 100 observations</span></span>
<span><span class="va">some_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">some_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.POSIXt.html">seq.POSIXt</a></span><span class="op">(</span></span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2017-06-15 00:00:00Z&quot;</span>, tz <span class="op">=</span> <span class="st">&quot;UTC&quot;</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="st">&quot;2017-06-15 01:00:00Z&quot;</span>, tz <span class="op">=</span> <span class="st">&quot;UTC&quot;</span><span class="op">)</span>,</span>
<span>  length.out <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make your own &#39;xts&#39; object</span></span>
<span><span class="va">myXTS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/xts/man/xts.html">xts</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">some_data</span>, order.by <span class="op">=</span> <span class="va">some_dates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">myXTS</span><span class="op">)</span></span>
<span><span class="co"># check time zone</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/xts/man/tzone.html">tzone</a></span><span class="op">(</span><span class="va">myXTS</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># All observations after 2017-06-15 00:45:00</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>fifteenXTS <span class="ot">&lt;-</span> myXTS[<span class="st">&#39;2017-06-15 00:45:00/&#39;</span>]</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 10-minute aggregations</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>tenMinuteXTS <span class="ot">&lt;-</span> <span class="fu">to.minutes10</span>(myXTS)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tenMinuteXTS) <span class="co"># automatically makes Open, High, Low, Close on 10 min intervals</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 1-minute aggregations</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>oneMinuteXTS <span class="ot">&lt;-</span> <span class="fu">to.minutes</span>(myXTS)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="st">``</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a><span class="co"># TIDYVERSE</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Package : dplyr</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>Package <span class="st">`</span><span class="at">dplyr</span><span class="st">`</span> offers intuitive verbs <span class="cf">for</span> data wrangling<span class="sc">:</span>\</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">filter</span><span class="st">`</span>\</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">mutate</span><span class="st">`</span>\</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">arrange</span><span class="st">`</span>\</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">select</span><span class="st">`</span>\</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">summarize</span><span class="st">`</span>\</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="do">### Filter</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">filter</span><span class="st">`</span> to filter rows</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="co"># filter by subset</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(State<span class="sc">==</span><span class="st">&#39;CA&#39;</span> <span class="sc">|</span> Yield_Amount <span class="sc">==</span><span class="dv">100</span>) </span></code></pre></div>
</div>
<h3 id="select">Select</h3>
<p><code>select</code> to select cols, rename cols, and reorder
cols.</p>
<p>There are helper funcitons that can be used inside
<code>select</code>.<br />
<code>starts_with</code>, <code>everything</code> and
<code>multiple renaming</code> are those examples.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># filter by subset</span></span>
<span><span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">State</span><span class="op">==</span><span class="st">&#39;CA&#39;</span> <span class="op">|</span> <span class="va">Yield_Amount</span> <span class="op">==</span><span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">State</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">&#39;Y&#39;</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">&#39;ity&#39;</span><span class="op">)</span>,<span class="va">ms</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># starts_with , ends_with, everything</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">Yield_Amount</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># drop a column</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>Newname_ms <span class="op">=</span> <span class="va">ms</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># rename column ms to Newname_ms</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Multiple columns renaming </span></span>
<span><span class="va">pqdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>new_name_ <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">&#39;Y&#39;</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># multiple renaming with prefix</span></span></code></pre>
</div>
</div>
<h3 id="mutate">Mutate</h3>
<h4 id="recode-column">Recode column</h4>
<p>To Recode column</p>
<p>For basic recode, use <code>recode</code> ,
<code>recode_factor</code><br />
For multiple recode, use <code>case_when</code><br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">pqdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>State <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">State</span>, <span class="st">&#39;PA&#39;</span> <span class="op">=</span> <span class="st">&#39;PAPAPA&#39;</span>, .default <span class="op">=</span> <span class="st">&#39;Not_my_interest&#39;</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># single recode</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>State2 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span> <span class="co"># multiple recoding</span></span>
<span>    <span class="va">State</span> <span class="op">==</span> <span class="st">&#39;Not_my_interest&#39;</span> <span class="op">~</span> <span class="st">&#39;My_interest&#39;</span>,</span>
<span>    <span class="va">State</span> <span class="op">==</span> <span class="st">&#39;PAPAPA&#39;</span> <span class="op">~</span> <span class="st">&#39;HELLO&#39;</span>,</span>
<span>    <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA_character_</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">State</span>,<span class="va">State2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="summarize-aggregation-method">Summarize : aggregation
method</h3>
<p>When it comes to summarize (or, aggregate) the data into one row, not
necessarily boradcasting all the data, use <code>summerize</code>
verb.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Calculate descriptive statistics</span></span>
<span><span class="va">calcium</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Group by visit and group</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">visit</span>, <span class="va">group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Calculate summary stats of bmd</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_bmd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">bmd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="co"># if na.rm not mentioned, then one NA will make it NA for all</span></span>
<span>           median_bmd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">bmd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>           minimum_bmd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">bmd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>           maximum_bmd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">bmd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>           standev_bmd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">bmd</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>           num_miss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">bmd</span><span class="op">)</span><span class="op">)</span>,</span>
<span>           n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="joining-dataframes">Joining dataframes</h3>
<p><code>inner_join()</code> for Inner join<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">votes_joined</span> <span class="op">&lt;-</span> <span class="va">votes_processed</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">descriptions</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;rcid&quot;</span>, <span class="st">&quot;session&quot;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="data-concatenation-binding">Data concatenation (binding)</h2>
<p><code>rbindlist()</code> for data.table solution(fastest)<br />
<code>rbind()</code> for data.frames, baseR solution<br />
<code>bind_rows()</code> with tidyverse solution<br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="dv">2015</span> <span class="ot">=</span> sales_2015, <span class="dv">2016</span> <span class="ot">=</span> sales_2016, <span class="at">idcol =</span> <span class="st">&#39;year&#39;</span>) <span class="co"># now 2015, 2016 will be put into idcol variable </span></span></code></pre></div>
</div>
<h2 id="cleaning-column-names">Cleaning column names</h2>
<p>Using <code>janitor</code> package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="va">pqdata</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">clean_names</span><span class="op">(</span>case <span class="op">=</span> <span class="st">&#39;snake&#39;</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># All lowercase, no whitespace, snake (default)</span></span>
<span>  <span class="fu">clean_names</span><span class="op">(</span>case <span class="op">=</span> <span class="st">&#39;upper_camel&#39;</span><span class="op">)</span> <span class="co"># upper camel style</span></span></code></pre>
</div>
</div>
<h2 id="type-format-conversion">Type (format) conversion</h2>
<p>5 types of format in R :
<code>integer</code>,<code>numeric</code>,<code>character</code>,
<code>logical</code>,<code>factor</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># To numeric </span></span>
<span><span class="va">pqdata</span><span class="op">$</span><span class="va">ms_yield</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">pqdata</span><span class="op">$</span><span class="va">ms_yield</span><span class="op">)</span></span>
<span><span class="co"># To factor (category)</span></span>
<span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_call</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_call</span><span class="op">)</span></span>
<span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_go</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_go</span><span class="op">)</span></span>
<span><span class="co"># to date</span></span>
<span><span class="va">pqdata</span><span class="op">$</span><span class="va">Final_Maturity</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="va">pqdata</span><span class="op">$</span><span class="va">Final_Maturity</span><span class="op">)</span></span>
<span><span class="va">pqdata</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;ms_yield&quot;</span>,<span class="st">&quot;d_call&quot;</span>,<span class="st">&quot;d_go&quot;</span>,<span class="st">&quot;Final_Maturity&quot;</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<p>Instead, when only number parts are needed to be parsed,
<code>readr::parse_number</code> function can be used within.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">ratings3</span> <span class="op">&lt;-</span> <span class="va">ratings2</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># Unite and change the separator</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unite.html">unite</a></span><span class="op">(</span><span class="va">viewers_7day</span>, <span class="va">viewers_millions</span>, <span class="va">viewers_decimal</span>, sep <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Adapt to cast viewers as a number</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>viewers_7day <span class="op">=</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html">parse_number</a></span><span class="op">(</span><span class="va">viewers_7day</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="web-data">WEB DATA</h1>
<h2 id="read-csv-from-web">Read CSV from web</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">csv_url</span> <span class="op">&lt;-</span> <span class="st">&quot;http://s3.amazonaws.com/assets.datacamp.com/production/course_1561/datasets/chickwts.csv&quot;</span></span>
<span><span class="va">csv_data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">csv_url</span><span class="op">)</span></span>
<span><span class="va">csv_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">head</span></span></code></pre>
</div>
</div>
<h2 id="download-files">Download files</h2>
<p>download.file() does the trick.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">csv_url</span> <span class="op">&lt;-</span> <span class="st">&quot;http://s3.amazonaws.com/assets.datacamp.com/production/course_1561/datasets/chickwts.csv&quot;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span>url <span class="op">=</span> <span class="va">csv_url</span>, destfile <span class="op">=</span> <span class="st">&quot;feed_data.csv&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="using-api">Using API</h2>
<p>The first thing to check : whether theres R package available for
the website.</p>
<ul>
<li>Google search CRAN [website address]</li>
</ul>
<p>If no API wrapper found in CRAN then use below methods.</p>
<p>Package <code>httr</code> can be alternative of pythons
<code>BeautifulSoup</code></p>
<h3 id="get-post">GET, POST</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://httr.r-lib.org/">&#39;httr&#39;</a></span><span class="op">)</span></span>
<span><span class="co"># Get the url, save response to resp</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">&quot;http://www.example.com/&quot;</span></span>
<span><span class="va">resp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="va">url</span><span class="op">)</span></span>
<span><span class="co"># Print resp</span></span>
<span><span class="va">resp</span></span>
<span></span>
<span><span class="co"># Get the raw content of resp: raw_content</span></span>
<span><span class="va">raw_content</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op">(</span><span class="va">resp</span>, as <span class="op">=</span> <span class="st">&quot;text&quot;</span><span class="op">)</span> <span class="co"># Default =&gt; automatic JSON parsing -&gt; list if JSON</span></span>
<span></span>
<span><span class="co"># Print the head of raw_content</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">raw_content</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Make a POST request to http://httpbin.org/post with the body &quot;this is a test&quot;</span></span>
<span><span class="va">post_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/POST.html">POST</a></span><span class="op">(</span>url <span class="op">=</span> <span class="st">&#39;http://httpbin.org/post&#39;</span>,body <span class="op">=</span> <span class="st">&#39;this is a test&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">post_result</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="page-error-handling">Page error handling</h3>
<p><code>http_error</code> function returns <code>TRUE</code> if the web
page is broken.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">fake_url</span> <span class="op">&lt;-</span> <span class="st">&quot;http://google.com/fakepagethatdoesnotexist&quot;</span></span>
<span></span>
<span><span class="co"># Make the GET request</span></span>
<span><span class="va">request_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="va">fake_url</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check request_result</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://httr.r-lib.org/reference/http_error.html">http_error</a></span><span class="op">(</span><span class="va">request_result</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/warning.html">warning</a></span><span class="op">(</span><span class="st">&#39;The request failed&#39;</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op">(</span><span class="va">request_result</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<h3 id="api">API</h3>
<p>There are two types of URLs:</p>
<ol type="1">
<li>Directory based URLs<br />
This is very intuitive case, one can simply work on the string
manipulation to work on this stuff.</li>
<li>Parameter based URLs<br />
One has to send query on the homepage, and <code>httr</code>s
<code>GET</code> function nicely does the job.</li>
</ol>
<h4 id="directory-based-url-api">Directory based URL API</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Construct a directory-based API URL to `http://swapi.co/api`,</span></span>
<span><span class="co"># looking for person `1` in `people`</span></span>
<span><span class="va">directory_url</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">&quot;http://swapi.co/api&quot;</span>, <span class="st">&quot;people&quot;</span>, <span class="st">&quot;1&quot;</span>, sep <span class="op">=</span> <span class="st">&#39;/&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a GET call with it</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">directory_url</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="va">directory_url</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="query-based-url-api">Query based URL API</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create list with nationality and country elements</span></span>
<span><span class="va">query_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>nationality <span class="op">=</span> <span class="st">&#39;americans&#39;</span>, </span>
<span>    country <span class="op">=</span> <span class="st">&#39;antigua&#39;</span><span class="op">)</span></span>
<span>    </span>
<span><span class="co"># Make parameter-based call to httpbin, with query_params</span></span>
<span><span class="va">parameter_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="st">&#39;https://httpbin.org/get&#39;</span>, query <span class="op">=</span> <span class="va">query_params</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print parameter_response</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">parameter_response</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="user-agents">User agents</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">&quot;https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia/all-access/all-agents/Aaron_Halfaker/daily/2015100100/2015103100&quot;</span></span>
<span></span>
<span><span class="co"># Add the email address and the test sentence inside user_agent()</span></span>
<span><span class="va">server_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="va">url</span>, <span class="fu"><a href="https://httr.r-lib.org/reference/user_agent.html">user_agent</a></span><span class="op">(</span><span class="st">&quot;my@email.address this is a test&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">server_response</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># sleep function</span></span></code></pre>
</div>
</div>
<h4 id="json-to-dataframe">JSON to dataframe</h4>
<p><code>jsonlite</code> package, and <code>httr</code> packages
<code>httr</code>s <code>content</code> function uses
<code>jsonlite</code> at the backend.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># jsonlite use case</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://arxiv.org/abs/1403.2805">jsonlite</a></span><span class="op">)</span></span>
<span><span class="co"># Definition of quandl_url</span></span>
<span><span class="va">quandl_url</span> <span class="op">&lt;-</span> <span class="st">&quot;https://www.quandl.com/api/v3/datasets/WIKI/FB/data.json?auth_token=i83asDsiWUUyfoypkgMz&quot;</span></span>
<span><span class="co"># Import Quandl data: quandl_data</span></span>
<span><span class="va">quandl_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/jsonlite/man/fromJSON.html">fromJSON</a></span><span class="op">(</span><span class="va">quandl_url</span><span class="op">)</span></span>
<span><span class="va">quandl_data</span> <span class="co"># JSON is parsed into list object</span></span>
<span></span>
<span></span>
<span><span class="co"># httr use case</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/">httr</a></span><span class="op">)</span></span>
<span><span class="va">response</span> <span class="op">=</span> <span class="fu"><a href="https://httr.r-lib.org/reference/GET.html">GET</a></span><span class="op">(</span><span class="va">quandl_url</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span> <span class="co"># Also parsed into list object</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># use dplyr package</span></span>
<span><span class="co"># Notice : content(resp_json) is list class</span></span>
<span><span class="fu"><a href="https://httr.r-lib.org/reference/http_type.html">http_type</a></span><span class="op">(</span><span class="va">resp_json</span><span class="op">)</span> <span class="co"># check if the response is json type</span></span>
<span><span class="va">revs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># bind_rows function makes named list into dataframe</span></span>
<span></span>
<span><span class="op">?</span><span class="va">http_type</span></span></code></pre>
</div>
</div>
<h4 id="xml-to-dataframe">XML to dataframe</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://xml2.r-lib.org/">&#39;xml2&#39;</a></span><span class="op">)</span></span>
<span><span class="va">rev_text</span> <span class="op">=</span> <span class="fu"><a href="https://httr.r-lib.org/reference/content.html">content</a></span><span class="op">(</span><span class="va">resp_xml</span>, as <span class="op">=</span> <span class="st">&#39;text&#39;</span><span class="op">)</span> <span class="co"># as =&#39;parsed&#39; does the xml parsing but it is being explicit here</span></span>
<span><span class="va">rev_xml</span> <span class="op">=</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_xml</a></span><span class="op">(</span><span class="va">rev_text</span><span class="op">)</span></span>
<span><span class="co"># Examine the structure of rev_xml</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_structure.html">xml_structure</a></span><span class="op">(</span><span class="va">rev_xml</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>3</p>
<p>Now using XPath to find elements</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Find all nodes using XPATH &quot;/api/query/pages/page/revisions/rev&quot;</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html">xml_find_all</a></span><span class="op">(</span><span class="va">rev_xml</span>, <span class="st">&quot;/api/query/pages/page/revisions/rev&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find all rev nodes anywhere in document</span></span>
<span><span class="va">rev_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html">xml_find_all</a></span><span class="op">(</span><span class="va">rev_xml</span>, <span class="st">&#39;//rev&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use xml_text() to get text from rev_nodes</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_text.html">xml_text</a></span><span class="op">(</span><span class="va">rev_nodes</span><span class="op">)</span></span>
<span><span class="co"># All rev nodes</span></span>
<span><span class="va">rev_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html">xml_find_all</a></span><span class="op">(</span><span class="va">rev_xml</span>, <span class="st">&quot;//rev&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The first rev node</span></span>
<span><span class="va">first_rev_node</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/xml_find_all.html">xml_find_first</a></span><span class="op">(</span><span class="va">rev_xml</span>, <span class="st">&quot;//rev&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find all attributes with xml_attrs()</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_attr.html">xml_attrs</a></span><span class="op">(</span><span class="va">first_rev_node</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find user attribute with xml_attr()</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_attr.html">xml_attr</a></span><span class="op">(</span><span class="va">first_rev_node</span>, <span class="st">&#39;user&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find user attribute for all rev nodes</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_attr.html">xml_attr</a></span><span class="op">(</span><span class="va">rev_nodes</span>, <span class="st">&#39;user&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find anon attribute for all rev nodes</span></span>
<span><span class="fu"><a href="http://xml2.r-lib.org/reference/xml_attr.html">xml_attr</a></span><span class="op">(</span><span class="va">rev_nodes</span>, <span class="st">&#39;anon&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="web-scraping">Web scraping</h2>
<h3 id="rselenium">RSelenium</h3>
<h4 id="installation-1">Installation</h4>
<h5 id="java-installation">Java Installation</h5>
<p>Prerequisite: Java has to be installed, so that hitting
<code>java</code> on terminal should work. Installing openjdk from brew
does not set the link well, so go to <a href="http://www.java.com" class="uri">http://www.java.com</a> and download (jre) Or below code
downloads the file &amp; opens it</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">&#39;https://javadl.oracle.com/webapps/download/AutoDL?BundleId=244576_d7fc238d0cbf4b0dac67be84580cfb4b&#39;</span>, <span class="st">&#39;~/Downloads/jre8.dmg&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="st">&#39;~/Downloads/jre8.dmg&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h5 id="rselenium-1">Rselenium</h5>
First install RSelenium package
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&#39;RSelenium&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Then download Selenium Server binary, which can be found here <a href="http://selenium-release.storage.googleapis.com/index.html" class="uri">http://selenium-release.storage.googleapis.com/index.html</a>
Look for selenium-server-standalone-x.xx.x.jar.</p>
<p>This command would do the trick for now.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">&#39;http://selenium-release.storage.googleapis.com/3.9/selenium-server-standalone-3.9.1.jar&#39;</span>, <span class="st">&#39;~/.R/selenium-standalone-3.9.1.jar&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>For standalone server operation. I put that in <code>~/.R/</code>
folder.</p>
<p>Run .jar file from console on mac using</p>
<pre><code>java -jar ~/.R/selenium-standalone-3.9.1.jar</code></pre>
<p>For Safari, enable developer menu &gt; allow automation. For Chrome,
download proper version of chrome driver and locate it in
<code>/usr/local/bin</code> which is already in the path(then it is
done)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">driver_file_zipped</span> <span class="op">=</span> <span class="st">&#39;~/Downloads/chromedriver_mac64.zip&#39;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/download.file.html">download.file</a></span><span class="op">(</span><span class="st">&#39;https://chromedriver.storage.googleapis.com/90.0.4430.24/chromedriver_mac64.zip&#39;</span>, <span class="va">driver_file_zipped</span><span class="op">)</span> </span>
<span><span class="co"># then move the file to the /usr/local/bin</span></span></code></pre>
</div>
</div>
<h5 id="authrization-problem">Authrization problem</h5>
<p>IF Chromedriver is not authorized app by Apple, so needs to be
un-quarantined. Navigate to chromedriver path (/usr/local/bin/) and</p>
<pre><code>sudo xattr -d com.apple.quarantine /usr/local/bin/chromedriver </code></pre>
<p>(this worked for me)</p>
<p>If Apple cannot identify the developer still,</p>
<pre><code>spctl --add --label &#39;Approved&#39; &lt;name-of-executable&gt;</code></pre>
<h4 id="basic-commands">Basic Commands</h4>
<p>Start selenium server</p>
<p>On terminal,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb45"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="ex">java</span> <span class="at">-jar</span> ~/.R/selenium-standalone-3.9.1.jar</span></code></pre></div>
</div>
<p>Or by using rstudioapi package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rstudioapi/man/terminalExecute.html">terminalExecute</a></span><span class="op">(</span><span class="st">&#39;java -jar ~/.R/selenium-standalone-3.9.1.jar&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
Run driver
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://docs.ropensci.org/RSelenium">RSelenium</a></span><span class="op">)</span></span>
<span><span class="va">remDr</span> <span class="op">=</span> <span class="fu">remoteDriver</span><span class="op">(</span></span>
<span>  remoteServerAddr <span class="op">=</span> <span class="st">&quot;localhost&quot;</span>,</span>
<span>  port <span class="op">=</span> <span class="fl">4444L</span>,</span>
<span>  browserName <span class="op">=</span> <span class="st">&quot;chrome&quot;</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Basic examples</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">remDr</span><span class="op">$</span><span class="fu">open</span><span class="op">(</span><span class="op">)</span> <span class="co"># fire up the browser</span></span></code></pre>
</div>
</div>
<h3 id="rvest">rvest</h3>
<p>with <code>rvest</code> package (similar to BeautifulSoup4 in python,
for simple web scraping only)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Load rvest</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://rvest.tidyverse.org/">&#39;rvest&#39;</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hadley Wickham&#39;s Wikipedia page</span></span>
<span><span class="va">test_url</span> <span class="op">&lt;-</span> <span class="st">&quot;https://en.wikipedia.org/wiki/Hadley_Wickham&quot;</span></span>
<span></span>
<span><span class="co"># Read the URL stored as &quot;test_url&quot; with read_html()</span></span>
<span><span class="va">test_xml</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://xml2.r-lib.org/reference/read_xml.html">read_html</a></span><span class="op">(</span><span class="va">test_url</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_xml</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">test_node_xpath</span> <span class="op">=</span> <span class="st">&quot;//*[contains(concat( \&quot; \&quot;, @class, \&quot; \&quot; ), concat( \&quot; \&quot;, \&quot;vcard\&quot;, \&quot; \&quot; ))]&quot;</span></span>
<span><span class="co"># Use html_node() to grab the node with the XPATH stored as `test_node_xpath`</span></span>
<span><span class="va">node</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_node</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">test_xml</span>, xpath <span class="op">=</span> <span class="va">test_node_xpath</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the first element of the result</span></span>
<span><span class="va">node</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
</div>
<p>Extracting with <code>rvest</code></p>
<ul>
<li><code>html_text</code> get text contents</li>
<li><code>html_attr</code> get specific attribute</li>
<li><code>html_name</code> get tag name</li>
<li><code>html_table</code> HTML table structures can converted to
<code>data.frame</code></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_text.html">html_text</a></span><span class="op">(</span><span class="va">node</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_name.html">html_name</a></span><span class="op">(</span><span class="va">node</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_attr.html">html_attr</a></span><span class="op">(</span><span class="va">node</span>, <span class="st">&#39;class&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rvest.tidyverse.org/reference/html_table.html">html_table</a></span><span class="op">(</span><span class="va">node</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="css-selector">CSS selector</h3>
<p>The major difference between XPath and CSS is that CSS finds all of
the meeting condition.</p>
<p>CSS is great for finding objects with <code>id</code> or
<code>class</code>.</p>
<p>To select a certain <code>class</code>, add <code>.</code><br />
To select a certain <code>id</code>, add <code>#</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Select the table elements</span></span>
<span><span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op">(</span><span class="va">test_xml</span>, css <span class="op">=</span> <span class="st">&#39;table&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select elements with class = &quot;infobox&quot;</span></span>
<span><span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op">(</span><span class="va">test_xml</span>, css <span class="op">=</span> <span class="st">&#39;.infobox&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Select elements with id = &quot;firstHeading&quot;</span></span>
<span><span class="fu"><a href="https://rvest.tidyverse.org/reference/rename.html">html_nodes</a></span><span class="op">(</span><span class="va">test_xml</span>, css <span class="op">=</span> <span class="st">&#39;#firstHeading&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="ggplot2">GGPLOT2</h1>
<p><code>ggplot2()</code></p>
<p>Grammar of graphics (Leland Wilkinson, 1999)</p>
<p>Data : data being plotted</p>
<pre><code>- 1. Aesthetics : the scales onto which we map our data (x, y, col, fill, size, alpha, linetype, labels, shape) 
- 2. Geometrics : the visual elements used for our data (line, point, ...) 
- 3. Facets : plotting small multiples 
- 4. Statistics : representations of data to aid understanding (adding regression line to plot) 
- 5. Coordinates : the space on which the data will be plotted (xlim, ylim, ...) 
- 6. Themes : All non-data ink</code></pre>
<h2 id="my-samples">My samples</h2>
<h3 id="error-bar">Error bar</h3>
<p><code>geom_ribbon</code> : area errorbar with two standard
deviation</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">monthly</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">peer_sim_rig_quintile</span><span class="op">)</span>,<span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">ln_port_mtna</span>,na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span>, <span class="fu">se_mean</span><span class="op">(</span><span class="va">ln_port_mtna</span><span class="op">)</span><span class="op">)</span>, keyby <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">caldt</span>, <span class="va">peer_sim_rig_quintile</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">caldt</span>, y<span class="op">=</span><span class="va">V1</span>, color<span class="op">=</span><span class="va">peer_sim_rig_quintile</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">V1</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">V2</span>, ymax <span class="op">=</span> <span class="va">V1</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">V2</span>, fill<span class="op">=</span><span class="va">peer_sim_rig_quintile</span><span class="op">)</span>, linetype<span class="op">=</span><span class="fl">0</span>,  alpha<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p><code>geom_errorbar</code> : dynamite like</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">acf_avg</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">I</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">mean</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">se</span>, ymax <span class="op">=</span> <span class="va">mean</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="va">se</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">&#39;blue&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="legend">Legend</h3>
<p>Legend position, title change</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">tot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> x<span class="op">=</span> <span class="va">class_name</span>, y<span class="op">=</span><span class="va">N</span>, fill<span class="op">=</span><span class="va">ID</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">&#39;identity&#39;</span>, position<span class="op">=</span><span class="st">&#39;fill&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">&#39;Proportion&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">&#39;Lipper-Class&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">&#39;bottom&#39;</span></span>
<span>        <span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>fill<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">&quot;PeerStrength&quot;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="scaling-axis">Scaling axis</h3>
<h4 id="date-ticks">Date ticks</h4>
Scale yearly ticks to monthly ticks
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">optvol</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">year</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span> <span class="op">&gt;=</span><span class="fl">2019</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Year</span>, y<span class="op">=</span> <span class="va">sum_volume</span>,color <span class="op">=</span> <span class="va">cp_flag</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="st">&#39;1 month&#39;</span>, date_labels <span class="op">=</span> <span class="st">&#39;%b-%y&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="scientific-notation">Scientific notation</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">intraday_sum</span><span class="op">[</span><span class="va">TIME</span> <span class="op">!=</span> <span class="st">&#39;09:30&#39;</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">datetime</span>, y<span class="op">=</span><span class="va">sum_vols_f</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&quot;Intraday Sum Option Trading Volume, Firms&quot;</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_datetime</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">&#39;30 min&#39;</span>, date_labels <span class="op">=</span> <span class="st">&quot;%H:%M&quot;</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/scientific_format.html">scientific</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="million-k-notation">Million, K notation</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/label_number.html">label_number</a></span><span class="op">(</span>suffix <span class="op">=</span> <span class="st">&quot; M&quot;</span>, scale <span class="op">=</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<h2 id="aesthetics">1 Aesthetics</h2>
<h3 id="about-aesthetics-aes">About aesthetics (aes)</h3>
<p>Aesthetics and attributes are a bit confusing terms.</p>
<p>Aesthetics : calls variables, and are essential part<br />
</p>
<p>Attributes : calls character vectors, and are non-essential.<br />
note :: attributes are always called in Geom layer.<br />
</p>
<p>Aesthetics : elements(:= variables) that are being represented x y
fill color size alpha : transparency level linetype labels : Text on the
plot, or on the axis shape</p>
<h3 id="adjusting-aesthetics">Adjusting Aesthetics</h3>
<p>xlim() ylim() labs() scale_*_* position(within the geom function)</p>
<h4 id="position">position</h4>
<p>Adjusting overlapping position. How should <code>ggplot</code> handle
those?</p>
<ul>
<li>identity : just do overlap if plotting on the same
coordination<br />
</li>
<li>jitter : spread dots</li>
<li>dodge : plot bar next to each other</li>
<li>jitterdodge : spread dots and place next to each other</li>
<li>stack : plot bar on top of each</li>
<li>fill : normalize to 1 and fill color by proportion of each</li>
<li>nudge</li>
</ul>
<p>For more detailed adjustments on jitter:</p>
<p><code>position_jitter()</code> function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">ps</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Sepal.Length</span>, y<span class="op">=</span><span class="va">Sepal.Width</span>, col<span class="op">=</span><span class="va">Species</span>, position <span class="op">=</span> <span class="va">ps</span><span class="op">)</span><span class="op">)</span> <span class="co"># position =&#39;identity&#39; is the default</span></span></code></pre>
</div>
</div>
<h4 id="scale">scale</h4>
<p>Usually have <code>scale_*_*()</code> naming conventions.</p>
<p>scale_x_ <em>scale_y_</em> scale_color_ <em>scale_fill_</em>
scale_shape_ <em>scale_linetype_</em> scale_size_*</p>
<p>Attributes: name : name of the scale - or, only for axis lable
change, use <code>labs()</code> function. limits : breaks : expand : gap
between the plot and axis labels : category name change</p>
<p>Scale axis and labels</p>
<p><code>scale_x_continuous()</code><br />
<code>scale_color_discrete()</code><br />
</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Sepal.Length</span>, y<span class="op">=</span><span class="va">Sepal.Width</span>, col<span class="op">=</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">&#39;X label&#39;</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span><span class="op">)</span>, breaks <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">8</span>, <span class="fl">3</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># scale x axis and modify x label</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_color_discrete</a></span><span class="op">(</span><span class="st">&#39;Label on Species&#39;</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;SeToSa&#39;</span>,<span class="st">&#39;VerSiColor&#39;</span>,<span class="st">&#39;VirGiniCa&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># legend </span></span></code></pre>
</div>
</div>
<h2 id="geometrics">2 Geometrics</h2>
<p>Attributes : change how it looks - ONLY CALLED IN GEOM LAYER!</p>
<p>color = red size = 10 shape = 4 fill = black storke = 2 alpha -
0.3</p>
<h3 id="dot-plots">Dot plots</h3>
<h4 id="geom_point">geom_point()</h4>
<p><code>geom_point</code> and <code>geom_jitter</code> for describing
relationship between two variablaes.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># overplotting problem : =&gt; make it transparent, or use hollow dots instead, or use geom_jitter</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">diamonds</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carat</span>, y <span class="op">=</span> <span class="va">price</span>, color<span class="op">=</span> <span class="va">clarity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p><code>geom_jitter()</code> :: equivalent to
<code>geom_point(position=&#39;jitter&#39;)</code> For overlapping dots, use
<code>geom_jitter()</code> to see the density more clearly</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">a1</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Sepal.Length</span>, y<span class="op">=</span> <span class="va">Sepal.Width</span>, col<span class="op">=</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">&#39;geom_point plot&#39;</span><span class="op">)</span></span>
<span><span class="va">a2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Sepal.Length</span>, y<span class="op">=</span> <span class="va">Sepal.Width</span>, col<span class="op">=</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&#39;geom_jitter plot&#39;</span><span class="op">)</span></span>
<span><span class="va">a1</span>;<span class="va">a2</span></span></code></pre>
</div>
</div>
<p>one variable scatterplot</p>
<p>Dummy (meaningless) y axis for scatter plot set 0 in y</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mpg</span>, y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="geom_dotpoint">geom_dotpoint()</h4>
<p><code>geom_dotpoint()</code> for clear points</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, <span class="va">wt</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">am</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot</a></span><span class="op">(</span>stackdir <span class="op">=</span> <span class="st">&quot;center&quot;</span>, binaxis <span class="op">=</span> <span class="st">&quot;y&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="geom_violin">geom_violin()</h4>
<p>: For describing distribution of several categories, with more
graphical advantage</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># aes(fill = group) : fill color group by variable &#39;group&#39;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="bar-plots">Bar plots</h3>
<h4 id="geom_histogram">geom_histogram()</h4>
<p>It is closely related to stat function : <code>stat_bin()</code>
<code>geom_histogram()</code> : For describinag distribution of one
dimensional numeric CONTINUOUS variable</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Sepal.Width</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="co">#same as above for position = identity is the default</span></span></code></pre>
</div>
</div>
<p>Density on y instead of count :</p>
<p>Use <code>aes(y=..density..)</code> inside
<code>geom_histogram</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Sepal.Width</span>, <span class="va">..density..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>When <code>fill=</code> aesthetic was used, default position is
stack</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Sepal.Width</span>, fill<span class="op">=</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>, binwidth<span class="op">=</span><span class="fl">0.1</span>, position<span class="op">=</span><span class="st">&#39;stack&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>, binwidth<span class="op">=</span><span class="fl">0.1</span>, position<span class="op">=</span><span class="st">&#39;dodge&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>, binwidth<span class="op">=</span><span class="fl">0.1</span>, position<span class="op">=</span><span class="st">&#39;fill&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">..density..</span><span class="op">)</span>, binwidth<span class="op">=</span><span class="fl">0.1</span>, position<span class="op">=</span><span class="st">&#39;identity&#39;</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span> <span class="co"># overlapped, it needs alpha to show overlapped regions</span></span></code></pre>
</div>
</div>
<h4 id="geom_bar-geom_col">geom_bar(), geom_col()</h4>
<p>geom_bar() : count of y (or density of y) in each factor x =&gt;
stat_count() geom_col() : actual value of y in each factor x =&gt;
stat_identity()</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Change the position argument to stack</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">[</span>,<span class="fu">`:=`</span><span class="op">(</span>am <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">am</span><span class="op">)</span>, cyl<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">mtcars</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span> , fill<span class="op">=</span><span class="va">am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># by default position =&#39;stack&#39;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">&quot;Set1&quot;</span><span class="op">)</span> <span class="co"># color palette</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Change the position argument to fill - proportion comparisions</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, fill <span class="op">=</span> <span class="va">am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">&#39;fill&#39;</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, fill <span class="op">=</span> <span class="va">am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">&#39;dodge&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>For more details on dodge position</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">posn_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cyl</span>, fill <span class="op">=</span> <span class="va">am</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="va">posn_d</span>, alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Custom range of colors</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mtcars</span><span class="op">[</span>,<span class="va">gear</span><span class="op">:=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">gear</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gear</span>, fill <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">&quot;fill&quot;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="line-plots">Line Plots</h3>
<p>Useful for time series(continuous or discrete) plots</p>
<h4 id="geom_line">geom_line()</h4>
<p><code>geom_line</code> : For comparing time trend of a (several)
variables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">economics</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">date</span>,<span class="va">unemploy</span><span class="op">/</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Lineplot with different groups</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># EX 1</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gdi</span><span class="op">[</span><span class="va">GeoFIPS</span><span class="op">==</span><span class="st">&#39;00000&#39;</span><span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">value</span>, color<span class="op">=</span><span class="va">tencode</span>, group<span class="op">=</span><span class="va">tencode</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Filling area</p>
<p><code>geom_area()</code> :: same as geom_line(position=fill)
(?)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># use fill argument in aes</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">by_year_continent</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">medianGdpPercap</span>, fill <span class="op">=</span> <span class="va">continent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_area</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="geom_rect">geom_rect()</h4>
<p>Adding rectangular shades on the lineplot</p>
<p><code>geom_rect</code> : rectangular shape</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># recession time data</span></span>
<span><span class="va">recess</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">31</span>, <span class="fl">1400</span>, <span class="fl">3652</span>, <span class="fl">4199</span>, <span class="fl">7486</span>, </span>
<span><span class="fl">11382</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">&quot;Date&quot;</span><span class="op">)</span>, end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">304</span>, <span class="fl">1885</span>, <span class="fl">3834</span>, <span class="fl">4687</span>, </span>
<span><span class="fl">7729</span>, <span class="fl">11627</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">&quot;Date&quot;</span><span class="op">)</span><span class="op">)</span>, .Names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;begin&quot;</span>, <span class="st">&quot;end&quot;</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">&quot;data.frame&quot;</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, </span>
<span><span class="op">-</span><span class="fl">6L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">recess</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">economics</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">unemploy</span><span class="op">/</span><span class="va">pop</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">recess</span>,</span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymax <span class="op">=</span> <span class="cn">Inf</span> , xmin <span class="op">=</span> <span class="va">begin</span>, xmax <span class="op">=</span> <span class="va">end</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span><span class="op">)</span>,</span>
<span>         inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>, fill <span class="op">=</span> <span class="st">&quot;red&quot;</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Frequency polygraph : similar to histogram</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">mpg</span>, color <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="geom_smooth">geom_smooth()</h4>
<p><code>geom_smooth()</code> : with method lm, adds regression
line</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span><span class="op">)</span> <span class="co"># factor variable to be colored</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">wt</span>, y <span class="op">=</span> <span class="va">mpg</span>, col <span class="op">=</span> <span class="va">cyl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">&#39;lm&#39;</span>, se<span class="op">=</span><span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, method<span class="op">=</span><span class="st">&#39;lm&#39;</span>, se<span class="op">=</span><span class="cn">F</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="geom_density_ridges">geom_density_ridges()</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggridges/">ggridges</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_density_ridges</span><span class="op">(</span>bandwidth <span class="op">=</span> <span class="fl">3.5</span>, alpha<span class="op">=</span><span class="fl">0.7</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="box-plots">Box plots</h3>
<p><code>geom_col</code> : For describing distribution of several
categories</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gapminder_1952</span> <span class="op">&lt;-</span> <span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op">==</span> <span class="fl">1952</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add a title to this graph: &quot;Comparing GDP per capita across continents&quot;</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gapminder_1952</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">continent</span>, y <span class="op">=</span> <span class="va">gdpPercap</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&quot;Comparing GDP per capita across continents&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p><code>fct_rev</code> : converts to factor vector and reverses the
order.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Edit to reverse x-axis order</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">bakers</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="va">skill</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">series_winner</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="crosshairs">Crosshairs</h3>
<h4 id="geom_vline">geom_vline()</h4>
<p><code>geom_vline()</code> and <code>geom_hline()</code></p>
<p>Example : lets draw mean of values on the axis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris.summary</span> <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">mean</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Species</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Sepal.Length</span>, y<span class="op">=</span><span class="va">Sepal.Width</span>, col<span class="op">=</span><span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">iris.summary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">Sepal.Length</span>, col<span class="op">=</span><span class="va">Species</span><span class="op">)</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">iris.summary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>yintercept<span class="op">=</span><span class="va">Sepal.Width</span>, col <span class="op">=</span><span class="va">Species</span><span class="op">)</span>, linetype<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="geom_hline">geom_hline()</h4>
<h2 id="facets">3 Facets</h2>
<h3 id="facet_grid">facet_grid()</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Facet rows by am and columns by cyl</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">am</span><span class="op">)</span>, cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="label-facets">label facets</h4>
<p>Labeling facets : labeller argument</p>
<p>The default value is</p>
<ul>
<li>label_value: Default, displays only the value</li>
</ul>
<p>Common alternatives are:</p>
<ul>
<li>label_both: Displays both the value and the variable name</li>
<li>label_context: Displays only the values or both the values and
variables depending on whether multiple factors are faceted</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Facet rows by am and columns by cyl</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">vs</span>, <span class="va">cyl</span><span class="op">)</span> , labeller <span class="op">=</span> <span class="st">&#39;label_context&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="adjusting-scalespace">adjusting scale/space</h4>
<p><code>coored_fixed()</code> fixes the coordinates along the facets.
This conflicts with <code>scales =&#39;free_x&#39;</code> and
<code>&#39;free_y&#39;</code> or both, <code>&#39;free&#39;</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bodywt</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">brainwt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span> alpha<span class="op">=</span><span class="fl">0.6</span>, shape <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">vore</span><span class="op">)</span>,</span>
<span>             cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">conservation</span><span class="op">)</span></span>
<span>             <span class="op">)</span></span></code></pre>
</div>
</div>
<p>adjusting plot sizes</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># without free space</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bodywt</span><span class="op">)</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">vore</span><span class="op">)</span>,</span>
<span>             scales <span class="op">=</span> <span class="st">&#39;free_y&#39;</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&quot;without free space&quot;</span><span class="op">)</span></span>
<span><span class="co"># with free space (y axis)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> <span class="va">bodywt_log</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">vore</span><span class="op">)</span>,</span>
<span>             scales <span class="op">=</span> <span class="st">&#39;free_y&#39;</span>,</span>
<span>             space <span class="op">=</span> <span class="st">&#39;free_y&#39;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&quot;with free space&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="margin-plot">margin plot</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bodywt</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">brainwt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span> alpha<span class="op">=</span><span class="fl">0.6</span>, shape <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">vore</span><span class="op">)</span>,</span>
<span>             cols <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">conservation</span><span class="op">)</span>,</span>
<span>             margin<span class="op">=</span><span class="cn">TRUE</span>, <span class="co"># or &#39;vore&#39; / &#39;vonservation&#39; for only one side of margin</span></span>
<span>             <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="facet_wrap">facet_wrap()</h3>
<p>When scale of <code>BOTH x and y axis</code> need to be different for
EACH plots. All else are similar to <code>facet_grid()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">bodywt</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">brainwt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span> alpha<span class="op">=</span><span class="fl">0.6</span>, shape <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span>facet <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">vore</span><span class="op">)</span>, nrow <span class="op">=</span><span class="fl">2</span>, scales<span class="op">=</span><span class="st">&#39;free&#39;</span> <span class="co"># or &#39;fixed&#39;</span></span>
<span>             <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="multiple-plots">Multiple plots</h3>
<p><code>gridExtra</code> package</p>
<p>grid.arrange() function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Example</span></span>
<span><span class="va">plot1</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span></span>
<span><span class="va">plot2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">disp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">plot1</span>, <span class="va">plot2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="statistics">4 Statistics</h2>
<p>Two types of statistics :</p>
<ol type="1">
<li>called within <code>geom</code> : <code>geom</code> are the wrapper
function of <code>stat</code>.</li>
<li>called independently</li>
</ol>
<h2 id="coordinates">5 Coordinates</h2>
<p>starts with <code>coord_</code></p>
<h3 id="xlim-ylim">xlim, ylim</h3>
<p>Unlike <code>coord_cartesian</code>, it drops observations (reduces
data)</p>
<h3 id="coord_cartesian">coord_cartesian()</h3>
<p>ZOOMing in (instead of cutting values)</p>
<p>If coord_cartesian were used</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>if corrd was not used : cut offs off the sample with scale</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span> <span class="co"># different fit, for it uses reduced data</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="coord_fixed">coord_fixed()</h3>
<p>Coordination ratio</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Fix the coordinate ratio</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># 1:1 ratio as default</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, y <span class="op">=</span> <span class="va">Sepal.Width</span>, color <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Fix the coordinate ratio</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="co"># 10:1 ratio</span></span></code></pre>
</div>
</div>
<h3 id="coord_expand">coord_expand()</h3>
<p>expand sets a buffer margin around the plot, so data and axes dont
overlap.</p>
<p>Setting expand to F draws the axes to the limits of the data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add Cartesian coordinates with zero expansion</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>clip decides whether plot elements that would lie outside the plot
panel are displayed or ignored (clipped).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">wt</span>, <span class="va">mpg</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add Cartesian coordinates with zero expansion</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="cn">F</span>,clip<span class="op">=</span><span class="st">&#39;off&#39;</span><span class="op">)</span> <span class="co"># dots pop up over axis</span></span></code></pre>
</div>
</div>
<h3 id="coordinates-vs-scales">coordinates vs scales</h3>
<p>coordinates does not transform the data, while scales transforms the
data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">msleep</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">msleep</span><span class="op">)</span></span>
<span><span class="co"># Produce a scatter plot of brainwt vs. bodywt</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bodywt</span>, <span class="va">brainwt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&quot;Raw Values&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Plot with a scale_*_*() function:</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bodywt</span>, <span class="va">brainwt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a log10 x scale</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a log10 y scale</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&quot;Scale_ functions&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># coords does not change the variable scale!</span></span>
<span><span class="co"># Plot with transformed coordinates</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">msleep</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">bodywt</span>, <span class="va">brainwt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a log10 coordinate transformation for x and y axes</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_trans.html">coord_trans</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">&quot;log10&quot;</span>, y <span class="op">=</span> <span class="st">&quot;log10&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="coord_flip">coord_flip()</h3>
<p>Flip x and y axis</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Plot fcyl bars, filled by fam</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">am</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Place bars side by side</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">&quot;dodge&quot;</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="sec_axis">sec_axis()</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">airquality</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">airquality</span><span class="op">)</span></span>
<span><span class="va">airquality</span><span class="op">[</span>,<span class="fu">`:=`</span><span class="op">(</span>Month <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_pad.html">str_pad</a></span><span class="op">(</span><span class="va">Month</span>,<span class="fl">2</span>,<span class="st">&#39;left&#39;</span>,<span class="fl">0</span><span class="op">)</span>, Day <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_pad.html">str_pad</a></span><span class="op">(</span><span class="va">Day</span>,<span class="fl">2</span>,<span class="st">&#39;left&#39;</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">airquality</span><span class="op">[</span>,<span class="va">Date</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/pkg/zoo/man/yearmon.html">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span><span class="fl">1973</span>,<span class="va">Month</span>, <span class="va">Day</span><span class="op">)</span>, format<span class="op">=</span><span class="st">&#39;%Y%m%d&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># From previous step</span></span>
<span><span class="va">y_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">59</span>, <span class="fl">68</span>, <span class="fl">77</span>, <span class="fl">86</span>, <span class="fl">95</span>, <span class="fl">104</span><span class="op">)</span></span>
<span><span class="va">y_labels</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y_breaks</span> <span class="op">-</span> <span class="fl">32</span><span class="op">)</span> <span class="op">*</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">9</span></span>
<span><span class="va">secondary_y_axis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/sec_axis.html">sec_axis</a></span><span class="op">(</span></span>
<span>  trans <span class="op">=</span> <span class="va">identity</span>,</span>
<span>  name <span class="op">=</span> <span class="st">&quot;Celsius&quot;</span>,</span>
<span>  breaks <span class="op">=</span> <span class="va">y_breaks</span>,</span>
<span>  labels <span class="op">=</span> <span class="va">y_labels</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update the plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">airquality</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">Temp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add the secondary y-axis </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>sec.axis <span class="op">=</span> <span class="va">secondary_y_axis</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">&quot;Date (1973)&quot;</span>, y <span class="op">=</span> <span class="st">&quot;Fahrenheit&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="polar-coordinates">polar coordinates</h3>
<h4 id="pie-charts">pie charts</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Run the code, view the plot, then update it</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a polar coordinate system</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">&quot;y&quot;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reduce the bar width to 0.1</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">&quot;y&quot;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a continuous x scale from 0.5 to 1.5</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="themes">6 Themes</h2>
<p>Base plot</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Species</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># aes(fill = group) : fill color group by variable &#39;group&#39;</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p><code>theme()</code> function</p>
<p>axis panel legend plot</p>
<p>line : all lines (axis) rect : all rectangular shaped ones (legend,
panel) text : all labels and texts (x,y axis labels)</p>
<p>element_blank() : remove the item</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">Sepal.Length</span>, y<span class="op">=</span> <span class="va">Sepal.Width</span>, color<span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        rect <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="axis">axis</h3>
<h4 id="axis.text">axis.text</h4>
<h4 id="axis.line">axis.line</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">&quot;red&quot;</span>, linetype <span class="op">=</span> <span class="st">&quot;dashed&quot;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="axis.ticks">axis.ticks</h4>
<p>axis.ticks.length : length of ticks</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># Set the axis tick length to 2 lines</span></span>
<span>    axis.ticks.length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">2</span>, <span class="st">&quot;cm&quot;</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="plot">plot</h3>
<h4 id="plot.margin">plot.margin</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    <span class="co"># Set the plot margin to (10, 30, 50, 70) millimeters</span></span>
<span>    plot.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">50</span>, <span class="fl">70</span>, <span class="st">&quot;mm&quot;</span><span class="op">)</span> </span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">iris</span><span class="op">[</span>,<span class="va">.N</span>,<span class="va">Species</span><span class="op">]</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span>N<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span>,<span class="va">Species</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h4 id="plot.title">plot.title</h4>
<p>Title position</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">&#39;This is the title&#39;</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>  plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="panel">panel</h3>
<h4 id="panel.grid">panel.grid</h4>
<p>Removing veritcal grid</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="line">line</h3>
<h3 id="text-1">text</h3>
<h3 id="rect">rect</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>rect <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">&#39;grey92&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="legend-1">legend</h3>
<h4 id="legend.position">legend.position</h4>
<p>Here, the new value can be</p>
<p>top, bottom, left, or right: place it at that side of the
plot. none: dont draw it. c(x, y): c(0, 0) means the bottom-left and
c(1, 1) means the top-right.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Length</span>, fill <span class="op">=</span> <span class="va">Species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">&#39;bottom&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="legend.key">legend.key</h4>
<p>legend.key.size</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">3</span>,<span class="st">&#39;cm&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="legend.margin">legend.margin</h4>
<p>margins on legend</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">baseplot</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>  <span class="co"># Set the legend margin to (20, 30, 40, 50) points</span></span>
<span>  legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">margin</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="st">&quot;pt&quot;</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Bar plot with two variables, x on the categorical, y on the numeric
value</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">iris_summ</span> <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="va">sum</span><span class="op">)</span>, by<span class="op">=</span><span class="va">Species</span><span class="op">]</span></span>
<span><span class="va">iris_summ</span></span></code></pre>
</div>
</div>
<p>To draw bar plot with above table : X on Species, y on
Speal.Legnth</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris_summ</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Species</span>, y<span class="op">=</span><span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_bar() throws an error for stat=&#39;count&#39; is the default</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">&#39;identity&#39;</span><span class="op">)</span> <span class="co"># throws an error</span></span></code></pre>
</div>
</div>
<h3 id="built-in-themes">Built-in themes</h3>
<p>For more pre-built themes, <code>ggthemes</code> package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_dark</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="update-theme">update theme</h3>
<p><code>theme_update()</code> function</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">theme_recession</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>  rect <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">&quot;grey92&quot;</span><span class="op">)</span>,</span>
<span>  legend.key <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span><span class="op">(</span>color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">&quot;white&quot;</span>, size <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">&quot;dotted&quot;</span><span class="op">)</span>,</span>
<span>  axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">&quot;grey25&quot;</span><span class="op">)</span>,</span>
<span>  plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">&quot;italic&quot;</span>, size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>  legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">baseplot</span> <span class="op">+</span> <span class="va">theme_recession</span></span>
<span><span class="va">theme_recession</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_update</a></span><span class="op">(</span>axis.line <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">&#39;red&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">baseplot</span> <span class="op">+</span> <span class="va">theme_recession</span></span></code></pre>
</div>
</div>
<h3 id="set-default-theme">set default theme</h3>
<p><code>theme_set()</code> function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="va">theme_recession</span><span class="op">)</span></span>
<span><span class="va">baseplot</span></span></code></pre>
</div>
</div>
<h3 id="color-arguments">color arguments</h3>
<p><a href="http://sape.inf.usi.ch/quick-reference/ggplot2/colour" class="uri">http://sape.inf.usi.ch/quick-reference/ggplot2/colour</a></p>
<h2 id="helper-functions-1">Helper functions</h2>
<h3 id="reorder">reorder</h3>
<p>Plot with re-ordered variable</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># set y axis as country ordered with respect to logFoldChange</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">logFoldChange</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html">reorder</a></span><span class="op">(</span><span class="va">country</span>, <span class="va">logFoldChange</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># add a visual anchor at x = 0</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="examples-2">EXAMPLES</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jennybc/gapminder">gapminder</a></span><span class="op">)</span></span>
<span><span class="va">gapminder</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">setDT</span></span>
<span><span class="va">gm2007</span> <span class="op">=</span> <span class="va">gapminder</span><span class="op">[</span><span class="va">year</span> <span class="op">==</span><span class="fl">2007</span>, <span class="fu">.</span><span class="op">(</span><span class="va">country</span>, <span class="va">continent</span>, <span class="va">lifeExp</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="va">lifeExp</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">lifeExp</span><span class="op">)</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">|</span> <span class="va">lifeExp</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">lifeExp</span>, decreasing <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">plt_country_vs_lifeExp</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gm2007</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lifeExp</span>, y <span class="op">=</span> <span class="va">country</span>, color <span class="op">=</span> <span class="va">lifeExp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xend <span class="op">=</span> <span class="fl">30</span>, yend <span class="op">=</span> <span class="va">country</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">lifeExp</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">&quot;white&quot;</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span><span class="st">&quot;&quot;</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">90</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">&quot;top&quot;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">&quot;Highest and lowest life expectancies, 2007&quot;</span>, caption<span class="op">=</span><span class="st">&quot;Source: gapminder&quot;</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">plt_country_vs_lifeExp</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">plot2</span> <span class="op">=</span> </span>
<span>  <span class="va">plt_country_vs_lifeExp</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.line.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">&quot;black&quot;</span><span class="op">)</span>,</span>
<span>    axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">&quot;none&quot;</span></span>
<span>    <span class="op">)</span></span>
<span><span class="va">plot2</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">global_mean</span> <span class="op">=</span> <span class="fl">67.00742</span></span>
<span><span class="va">x_start</span> <span class="op">=</span> <span class="va">global_mean</span> <span class="op">+</span><span class="fl">4</span></span>
<span><span class="va">y_start</span> <span class="op">=</span> <span class="fl">5.5</span></span>
<span></span>
<span><span class="va">plot3</span> <span class="op">=</span> <span class="va">plot2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">global_mean</span>, color <span class="op">=</span> <span class="st">&quot;grey40&quot;</span>, linetype <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    <span class="st">&quot;text&quot;</span>,</span>
<span>    x <span class="op">=</span> <span class="va">x_start</span>, y <span class="op">=</span> <span class="va">y_start</span>,</span>
<span>    label <span class="op">=</span> <span class="st">&quot;The\nglobal\naverage&quot;</span>,</span>
<span>    vjust <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">&quot;grey40&quot;</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">plot3</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">x_end</span> <span class="op">=</span> <span class="va">global_mean</span></span>
<span><span class="va">y_end</span> <span class="op">=</span> <span class="fl">7.5</span></span>
<span><span class="co"># add curve</span></span>
<span><span class="va">plot4</span> <span class="op">=</span> <span class="va">plot3</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span></span>
<span>    <span class="st">&quot;curve&quot;</span>,</span>
<span>    x <span class="op">=</span> <span class="va">x_start</span>, y <span class="op">=</span> <span class="va">y_start</span>,</span>
<span>    xend <span class="op">=</span> <span class="va">x_end</span>, yend <span class="op">=</span> <span class="va">y_end</span>,</span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">&quot;closed&quot;</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">&quot;grey40&quot;</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">plot4</span></span></code></pre>
</div>
</div>
<h3 id="dynamite-plot">dynamite plot</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mtcars</span><span class="op">[</span>, <span class="va">fcyl</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Plot wt vs. fcyl</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">fcyl</span>, y <span class="op">=</span> <span class="va">wt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a bar summary stat of means, colored skyblue</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">&quot;bar&quot;</span>, fill <span class="op">=</span> <span class="st">&quot;skyblue&quot;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add an errorbar summary stat std deviation limits</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">mean_sdl</span>, fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mult <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, geom <span class="op">=</span> <span class="st">&quot;errorbar&quot;</span>, width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="regression">REGRESSION</h1>
<p>Basic regression comparison between Stata &amp; R<br />
In Stata, <code>i.var</code> indicates factor (categorical) and
<code>c.var</code> indicates continuous</p>
<p><code>#</code> : interaction only &lt;=&gt; <code>:</code><br />
<code>##</code> : multiplication combination &lt;=&gt;
<code>*</code></p>
<table>
<colgroup>
<col style="width: 47%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Stata</th>
<th style="text-align: center;">R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">y x1 x2</td>
<td style="text-align: center;">y ~ x1 + x2</td>
</tr>
<tr class="even">
<td style="text-align: center;">y x1,nocons</td>
<td style="text-align: center;">y ~ 0 + x1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">gen ylog = log(y) ; gen x2log = log(x2)
; ylog x2log</td>
<td style="text-align: center;">log(y) ~ log(x2)</td>
</tr>
<tr class="even">
<td style="text-align: center;">gen x3 = x1 + x2 ; y x3</td>
<td style="text-align: center;">y ~ I(x1 + x2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">y i.x1</td>
<td style="text-align: center;">y ~ as.factor(x1)</td>
</tr>
<tr class="even">
<td style="text-align: center;">y c.x1#c.x2</td>
<td style="text-align: center;">y ~ x1:x2</td>
</tr>
<tr class="odd">
<td style="text-align: center;">y c.x1##c.x2</td>
<td style="text-align: center;">y ~ x1*x2</td>
</tr>
<tr class="even">
<td style="text-align: center;">y c.x1##i.x2</td>
<td style="text-align: center;">y ~ x1*as.factor(x2)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">areg y x1 [w=x3], a(id1) cl(id1)</td>
<td style="text-align: center;">felm(y ~ x1 | id1 | 0 | id1 , data=df,
weight = x3 )</td>
</tr>
<tr class="even">
<td style="text-align: center;">reghdfe y x3 (x2 = x1), a(id1) cl(id1
id2)</td>
<td style="text-align: center;">felm(y ~ x3 | id1 | (x2 ~ x1) | id1 +
id2, data = df)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">reghdfe y x2, a(c.x3#i.id1 id1) cl(id1
id2)</td>
<td style="text-align: center;">felm(y ~ x2 | x3:id1 + id1, df</td>
</tr>
</tbody>
</table>
<p><code>Regression code example</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">lmOut</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">count</span> <span class="op">~</span> <span class="va">time</span>, data <span class="op">=</span> <span class="va">dat</span>, family <span class="op">=</span> <span class="st">&#39;gaussian&#39;</span><span class="op">)</span> <span class="co"># OLS regression</span></span>
<span><span class="va">lr_1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">goal</span> <span class="op">~</span> <span class="va">player</span>, data <span class="op">=</span> <span class="va">scores</span>, family <span class="op">=</span> <span class="st">&#39;poisson&#39;</span><span class="op">)</span> <span class="co"># GLM (poisson) regression</span></span>
<span><span class="va">lr_2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">success</span>,<span class="va">fail</span><span class="op">)</span><span class="op">~</span><span class="va">x</span>, <span class="va">dataWide</span>, family<span class="op">=</span><span class="st">&#39;binomial&#39;</span><span class="op">)</span> <span class="co"># Logistic regression</span></span>
<span><span class="va">busLogit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Bus</span> <span class="op">~</span> <span class="va">CommuteDays</span>, data <span class="op">=</span> <span class="va">bus</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">&quot;logit&quot;</span><span class="op">)</span><span class="op">)</span> <span class="co"># Logit regression</span></span>
<span><span class="va">busProbit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Bus</span> <span class="op">~</span> <span class="va">CommuteDays</span>, data <span class="op">=</span> <span class="va">bus</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">&quot;probit&quot;</span><span class="op">)</span><span class="op">)</span> <span class="co"># Probit regression</span></span></code></pre>
</div>
</div>
<h2 id="linear-regression">Linear regression</h2>
<p>Rs base function <code>lm</code> covers pretty much.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_call</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_call</span><span class="op">)</span> <span class="co"># somehow the type is not perfectly converted, so make it inteager again</span></span>
<span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_go</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span><span class="op">(</span><span class="va">pqdata</span><span class="op">$</span><span class="va">d_go</span><span class="op">)</span></span>
<span><span class="va">reg1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ms_yield</span> <span class="op">~</span> <span class="va">d_go</span><span class="op">+</span><span class="va">d_call</span><span class="op">+</span><span class="va">d_go</span><span class="op">:</span><span class="va">d_call</span>, data<span class="op">=</span><span class="va">pqdata</span><span class="op">)</span></span>
<span><span class="va">reg2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ms_yield</span> <span class="op">~</span> <span class="va">d_go</span><span class="op">*</span><span class="va">d_call</span>, <span class="va">pqdata</span><span class="op">)</span></span>
<span><span class="va">reg3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ms_yield</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">d_go</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">d_call</span><span class="op">)</span>, <span class="va">pqdata</span><span class="op">)</span></span>
<span><span class="va">reg4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">ms_yield</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">d_go</span><span class="op">)</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">d_call</span><span class="op">)</span>, <span class="va">pqdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">texreg</span><span class="fu">::</span><span class="fu">screenreg</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">reg1</span>,<span class="va">reg2</span>,<span class="va">reg3</span>,<span class="va">reg4</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="fixed-effects-regression">Fixed Effects regression</h3>
<p>Package <code>lfe</code> gives fast estimation results with
high-dimiensional fixed effects.</p>
<p>General expression form :</p>
<p><span class="math display">\[
y  \sim  x1 + x2 \ \  | \ f1 + f2 \ | \ \ (Q \ | \ W  \sim  z1 + z2) \ |
\ clu1 + clu2
\]</span></p>
<ul>
<li>y : regressand<br />
</li>
<li>x1, x2 : regressor<br />
</li>
<li>f1, f2 : fixed effect variables<br />
</li>
<li>Q,W : instrumented variables<br />
</li>
<li>z1, z2 : instrument variables<br />
</li>
<li>clu1, clu2 : clustered standard error<br />
</li>
</ul>
<p>Parts that are not used : put 0</p>
<p>example:</p>
<p><span class="math display">\[
y \sim x  \ | \ f1 \ | \ 0  \ | \ 0
\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">model</span> <span class="op">=</span> <span class="fu">felm</span><span class="op">(</span><span class="va">ms_yield</span> <span class="op">~</span> <span class="va">d_go</span> <span class="op">+</span> <span class="va">d_call</span> <span class="op">|</span> <span class="va">toxic_state_name</span> <span class="op">+</span> <span class="va">year</span> <span class="op">|</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">toxic_state_name</span> <span class="op">+</span> <span class="va">toxic_county_name</span>, data <span class="op">=</span> <span class="va">pqdata</span>, cmethod<span class="op">=</span><span class="st">&quot;reghdfe&quot;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="logistic-regression">Logistic Regression</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, <span class="va">data</span>, family<span class="op">=</span><span class="st">&#39;binomial&#39;</span><span class="op">)</span> <span class="co"># family =&#39;binomial&#39; uses logit function as link function</span></span></code></pre>
</div>
</div>
<h2 id="programatic-formula">programatic formula</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># our modeling effort, </span></span>
<span><span class="co"># fully parameterized!</span></span>
<span><span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">outcome</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">variables</span>, collapse <span class="op">=</span> <span class="st">&quot; + &quot;</span><span class="op">)</span>, </span>
<span>        sep <span class="op">=</span> <span class="st">&quot; ~ &quot;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span>
<span><span class="co"># mpg ~ cyl + disp + hp + carb</span></span></code></pre>
</div>
</div>
<p>Example from Munibond project</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">Y</span> <span class="op">=</span> <span class="st">&#39;ms_w_y_amount&#39;</span></span>
<span><span class="va">controls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;competitive_d&#39;</span>,<span class="st">&#39;taxable_d&#39;</span>,<span class="st">&#39;go_d&#39;</span>,<span class="st">&#39;credit_enhance_d&#39;</span>,<span class="st">&#39;callable_d&#39;</span>,<span class="st">&#39;s_f_m_rating&#39;</span>,<span class="st">&#39;unrated_d&#39;</span>,<span class="st">&#39;asset_backed_d&#39;</span>, <span class="st">&#39;ln_ms_w_yrs_to_mat&#39;</span>,<span class="st">&#39;ln_ms_w_size&#39;</span>,<span class="st">&#39;Insured_Amount&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">&#39; + &#39;</span><span class="op">)</span></span>
<span><span class="va">diff</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;post2001_d * HighIPW5_d&#39;</span><span class="op">)</span></span>
<span><span class="va">fixed</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Dated_Year&#39;</span>,<span class="st">&#39;statecode&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">&#39; + &#39;</span><span class="op">)</span> <span class="co"># year and state fixed effect</span></span>
<span><span class="va">IV</span> <span class="op">=</span> <span class="st">&#39;0&#39;</span></span>
<span><span class="va">clustered</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Dated_Year&#39;</span>,<span class="st">&#39;statecode&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">&#39; + &#39;</span><span class="op">)</span> <span class="co"># year and state clustered </span></span>
<span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span></span>
<span>  <span class="va">Y</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">diff</span>, sep<span class="op">=</span><span class="st">&#39; ~ &#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># diff</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">controls</span>, sep<span class="op">=</span><span class="st">&#39; + &#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># controls</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">fixed</span>, sep <span class="op">=</span> <span class="st">&#39; | &#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># fixed</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">IV</span>, sep <span class="op">=</span> <span class="st">&#39; | &#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># IV reg</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">clustered</span>, sep <span class="op">=</span> <span class="st">&#39; | &#39;</span><span class="op">)</span> <span class="co"># se clustering</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="rmse">RMSE</h2>
<p>Root Mean Squared Error (Residual Standard Error in R)</p>
<p><span class="math display">\[RMSE \equiv
\sqrt{\frac{\Sigma_ie_i^2}{df}}\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mod</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, <span class="va">data</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/df.residual.html">df.residual</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span> <span class="co"># is the RMSE, average difference between actual vs fit</span></span></code></pre>
</div>
</div>
<h2 id="leverage-and-influence">Leverage and Influence</h2>
<p>What about outliers?</p>
<p><code>.hat</code> : Leverage in the <code>augment()</code> tells how
much the explanatory variable is far from its own average.<br />
<code>.cooksd</code> : Cooks distance, tells how much that point
influences the overall regression model.</p>
<h2 id="model.matrix">model.matrix()</h2>
<p>R automatically generate matrices from formula. To see how it works
in action, use <code>model.matrix</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># verify how the formula works in R</span></span>
<span><span class="va">my_size</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.1</span>,<span class="fl">1.2</span>,<span class="fl">1.3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">my_size</span><span class="op">)</span> <span class="co"># interpret it as numerical variable</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">color</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;black&#39;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">color</span><span class="op">)</span> <span class="co"># character vector : automatically generate dummies with this variable</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">color</span><span class="op">)</span> <span class="co"># by alphabetical order : &#39;black&#39; is the first one, and is subsumed to intercept</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">color</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># without intercept : explicit dummies</span></span></code></pre>
</div>
</div>
<h1 id="machine-learning">MACHINE LEARNING</h1>
<h2 id="h2o">H2O</h2>
<h3 id="init-and-shutdown">Init and Shutdown</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">h2o.init</span><span class="op">(</span><span class="op">)</span> <span class="co"># initialize, use all core and 25% of memory</span></span>
<span><span class="fu">h2o.shutdown</span><span class="op">(</span><span class="op">)</span> <span class="co"># close connection</span></span>
<span></span>
<span><span class="fu">h2o.init</span><span class="op">(</span>max_mem_size <span class="op">=</span> <span class="st">&#39;800G&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="h2o.jar-location-installed-by-r">h2o.jar location installed by
R</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">jar_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">&#39;java&#39;</span>, <span class="st">&#39;h2o.jar&#39;</span>, package<span class="op">=</span><span class="st">&#39;h2o&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
Copy to current working directory
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.copy</a></span><span class="op">(</span><span class="va">jar_path</span>, <span class="st">&#39;./h2o.jar&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="run-java-instances">Run java instances</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">&#39;java -Xmx3g -jar h2o.jar -name n1 -nthreads 3  -port 54321&#39;</span><span class="op">)</span>, intern <span class="op">=</span> <span class="cn">F</span>, wait <span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.html">system</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">&#39;java -Xmx3g -jar h2o.jar -name n2 -nthreads 3  -port 54322&#39;</span><span class="op">)</span>, intern <span class="op">=</span> <span class="cn">F</span>, wait <span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/h2oai/h2o-3">h2o</a></span><span class="op">)</span></span>
<span><span class="fu">h2o.init</span><span class="op">(</span>startH2O <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu">h2o.shutdown</span><span class="op">(</span>prompt <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">h2o.init</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="supervised-ml-caret">Supervised ML: caret</h2>
<p><code>caret</code> package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="train-test-split">train-test split</h2>
<p><code>createDataPartition()</code> function, p=0.7 stands for 70% of
train set. The output is the rownames(index number).</p>
<p>To create an index with 70% of the breast_cancer_data to create a
training set and stratify the partitions by the response variable
diagnosis:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu">createDataPartition</span><span class="op">(</span><span class="va">breast_cancer_data</span><span class="op">$</span><span class="va">diagnosis</span>, p <span class="op">=</span> <span class="fl">0.7</span>, list <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="train">train()</h2>
<h3 id="preprocess">1 preProcess</h3>
<h4 id="missing-values">missing values</h4>
<p>Generate missing values for demo</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>, <span class="st">&#39;hp&#39;</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="va">Y</span> <span class="op">=</span> <span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span></span>
<span><span class="va">X</span> <span class="op">=</span> <span class="va">mtcars</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span></code></pre>
</div>
</div>
<ul>
<li><p>If the data is missing at random, <code>medianImpute</code> is
good option</p></li>
<li><p>It missing is non-random, <code>knnImpute</code> should be
considered</p>
<ul>
<li>it imputes with observations that are similar</li>
</ul></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># medianImpute</span></span>
<span><span class="va">median_model</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">X</span>, </span>
<span>  y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&quot;glm&quot;</span>,</span>
<span>  preProcess <span class="op">=</span> <span class="st">&quot;medianImpute&quot;</span> <span class="co"># knnImpute</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="center-and-scale">center and scale</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">model_prep</span> <span class="op">=</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">X</span>,</span>
<span>  y <span class="op">=</span> <span class="va">Y</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&#39;glm&#39;</span>,</span>
<span>  preProcess <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;medianImpute&#39;</span>, <span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span><span class="op">)</span> <span class="co"># combination of preprocessing</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">model_prep</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">RMSE</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="low-information-variable">low-information variable</h4>
<p>Low-variance variables dont contain much information</p>
<p>They cause computational problems and bugs, and makes fitting longer
- good reason to drop them - <code>preProcess = zv</code> to drop
constant columns - <code>preProcess = nzv</code> to drop nearly constant
columns - Also <code>caret</code> provides function
<code>nearZeroVar()</code> to detect those columns - nearZeroVar() takes
in data x, then looks at the ratio of the most common value to the
second most common value, freqCut, and the percentage of distinct values
out of the number of total samples, uniqueCut.</p>
<p>Example: constant column</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">X</span><span class="op">$</span><span class="va">bad</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="fu">train</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,method<span class="op">=</span><span class="st">&#39;glm&#39;</span>, preProcess<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;medianImpute&#39;</span>,<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>,<span class="st">&#39;pca&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># PCA goes wrong because of constant variable</span></span>
<span><span class="fu">train</span><span class="op">(</span><span class="va">X</span>,<span class="va">Y</span>,method<span class="op">=</span><span class="st">&#39;glm&#39;</span>, preProcess<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;zv&#39;</span>,<span class="st">&#39;medianImpute&#39;</span>,<span class="st">&#39;center&#39;</span>,<span class="st">&#39;scale&#39;</span>,<span class="st">&#39;pca&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># now it works fine</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">nearZeroVar</span><span class="op">(</span><span class="va">X</span>, names<span class="op">=</span><span class="cn">T</span>, freqCut <span class="op">=</span> <span class="fl">2</span>, uniqueCut <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="co"># gives the names of columns</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="op">?</span><span class="va">setdiff</span></span></code></pre>
</div>
</div>
<h4 id="pca">PCA</h4>
<p>PCA combines low-variance and correlated variables into single set of
high-variance perpendicular predictors. It also prevents collenearity.
First component has highest variance, and so on.</p>
<p>Best practice : drop only zero-variance, and use PCA to capture
low-variance variables.</p>
<h3 id="trcontrol">2 trControl</h3>
<p>To choose the best model with the best fit, train-test split must be
the same, even in Cross-validation.</p>
<p>Can do this by predefining <code>trainControl</code> object that is
reusable for multiple models.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create custom indices: myFolds</span></span>
<span><span class="co"># By saving the indexes in the train control, we can fit many models using the same CV folds.</span></span>
<span><span class="va">myFolds</span> <span class="op">&lt;-</span> <span class="fu">createFolds</span><span class="op">(</span><span class="va">churn_y</span>, k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create reusable trainControl object: myControl</span></span>
<span><span class="va">myControl</span> <span class="op">&lt;-</span> <span class="fu">trainControl</span><span class="op">(</span></span>
<span>  summaryFunction <span class="op">=</span> <span class="va">twoClassSummary</span>,</span>
<span>  classProbs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># IMPORTANT!</span></span>
<span>  verboseIter <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  savePredictions <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  index <span class="op">=</span> <span class="va">myFolds</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="cross-validation">Cross Validation</h4>
<p>To do cross validation, need to modify <code>trainContol()</code></p>
<ul>
<li>number : how many slices of train/test split.
<code>number = 5</code> means slice the data randomly into 5 chunks and
do 4:1 train/test split = 5 possible scenarios</li>
<li>repeats : how many repeats it will perform. Do another random slice
and repeat the operation according to above number.</li>
</ul>
<p>10 fold CV</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">tenfold_cv</span> <span class="op">=</span> <span class="fu">trainControl</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">&quot;cv&quot;</span>, </span>
<span>    number <span class="op">=</span> <span class="fl">10</span>,</span>
<span>    verboseIter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co"># Fit lm model using 10-fold CV: model</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">price</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>  <span class="va">diamonds</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">tenfold_cv</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model</span></span></code></pre>
</div>
</div>
<p>5*5 fold CV</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">repeated_cv</span> <span class="op">=</span> <span class="fu">trainControl</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">&quot;repeatedcv&quot;</span>, </span>
<span>    number <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    repeats <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    verboseIter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit lm model using 5 * 5 fold CV</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">price</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>  <span class="va">diamonds</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&quot;lm&quot;</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">repeated_cv</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Print model to console</span></span>
<span><span class="va">model</span></span></code></pre>
</div>
</div>
<h4 id="search">search</h4>
<p>search = grid or random</p>
<p>Since searching all grid is computationally expensive, Randomly
choose hyperparameters within the specified grid. Random search is used
especailly when hyperparameter is given in continuous range
variable.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Train control with random search</span></span>
<span><span class="va">fitControl</span> <span class="op">&lt;-</span> <span class="fu">trainControl</span><span class="op">(</span>method <span class="op">=</span> <span class="st">&quot;repeatedcv&quot;</span>,</span>
<span>                           number <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                           repeats <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                           search <span class="op">=</span> <span class="st">&quot;random&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test 6 random hyperparameter combinations</span></span>
<span><span class="fu">tic</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">nn_model_voters_big_grid</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span><span class="va">turnout16_2016</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>                   data <span class="op">=</span> <span class="va">voters_train_data</span>, </span>
<span>                   method <span class="op">=</span> <span class="st">&quot;nnet&quot;</span>, </span>
<span>                   trControl <span class="op">=</span> <span class="va">fitControl</span>,</span>
<span>                   verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   tuneLength <span class="op">=</span> <span class="fl">6</span> <span class="co"># need to be specified in random search</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="fu">toc</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="adaptive-resampling">Adaptive resampling</h4>
<p>Grid search : all hyperparameter combinations are searched Random
search : random subsets of hyperparameter combinations are searched</p>
<p>=&gt; All of the combinations will be tested</p>
<p>Adaptive resampling : hyperparameter combinations are resampled with
values near combinations that performed well.</p>
<p>=&gt; combinations that are sub-optimal will not be tested - faster
and efficient.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">trainControl</span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">&#39;adaptive_cv&#39;</span>,</span>
<span>  search <span class="op">=</span> <span class="st">&#39;random&#39;</span>,</span>
<span>  adaptive <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    min <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>    method <span class="op">=</span> <span class="st">&#39;gls&#39;</span>,</span>
<span>    complete <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    </span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<ul>
<li><code>min</code> : minimum number of resamples per
hyperparameter</li>
<li><code>alpha</code> : confidence level for removing hyperparameters.
Doesnt change that much</li>
<li><code>method</code> : gls for linear model and BT for
Bradley-Terry (for large number of hyperparameters)</li>
<li><code>complete</code> : <code>TRUE</code> generates full resampling
set / <code>FALSE</code> saves time and still get the optimal
combination</li>
</ul>
<h3 id="tunelength">3 tuneLength</h3>
<p>Should be specified especially with random search.</p>
<p>Automatically tries different values of hyperparameters E.g.
<code>tuneLength = 5</code> in SVM, it tries degree = 1,2,3,4,5, scale =
0.001,0.01,0.1,1,10, c = 0, 0.25, 0.5, 1, 2, 4</p>
<p>Which argument do you need to set in combination with
trainControl(search = random) in order to perform random search?
[Correct! Tune length defines the number of (randomly sampled) tuning
parameter combinations to compare.]</p>
<h3 id="tunegrid">4 tuneGrid</h3>
<p>Manual hyperparameter tuning : <code>tuneGrid</code> +
<code>expand.Grid</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Define Cartesian grid</span></span>
<span><span class="va">man_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                        scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span><span class="op">)</span>, </span>
<span>                        C <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">svm_model_voters_grid</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span><span class="va">turnout16_2016</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>                   data <span class="op">=</span> <span class="va">voters_train_data</span>, </span>
<span>                   method <span class="op">=</span> <span class="st">&quot;svmPoly&quot;</span>, </span>
<span>                   trControl <span class="op">=</span> <span class="va">fitControl</span>,</span>
<span>                   verbose<span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                   tuneGrid <span class="op">=</span> <span class="va">man_grid</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="model-comparison">model comparison</h2>
<ul>
<li>Highest average AUC</li>
<li>Lowest std in AUC</li>
<li><code>resamples()</code> function</li>
</ul>
<p>Now that you have fit two models to the churn dataset, its time to
compare their out-of-sample predictions and choose which one is the best
model for your dataset.</p>
<p>You can compare models in caret using the resamples() function,
provided they have the same training data and use the same trainControl
object with preset cross-validation folds. resamples() takes as input a
list of models and can be used to compare dozens of models at once
(though in this case you are only comparing two models).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># model comparison example</span></span>
<span><span class="va">model_list</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>  glmnet <span class="op">=</span> <span class="va">model_glmnet</span>,</span>
<span>  rf <span class="op">=</span> <span class="va">model_rf</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># collect resamples from CV folds</span></span>
<span><span class="va">resamps</span> <span class="op">=</span> <span class="fu">resamples</span><span class="op">(</span><span class="va">model_list</span><span class="op">)</span></span>
<span><span class="va">resamps</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">resamps</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>You can make this plot using the bwplot() function, which makes a box
and whisker plot of the models out of sample scores. Box and whisker
plots show the median of each distribution as a line and the
interquartile range of each distribution as a box around the median
line. You can pass the metric = ROC argument to the bwplot() function
to show a plot of the models out-of-sample ROC scores and choose the
model with the highest median ROC.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create bwplot</span></span>
<span><span class="fu">bwplot</span><span class="op">(</span><span class="va">resamples</span>, metric <span class="op">=</span> <span class="st">&quot;ROC&quot;</span><span class="op">)</span></span>
<span><span class="co"># Create xyplot</span></span>
<span><span class="fu">xyplot</span><span class="op">(</span><span class="va">resamples</span>, metric <span class="op">=</span> <span class="st">&quot;ROC&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Ensembling models</p>
<p>That concludes the course! As a teaser for a future course on making
ensembles of caret models, Ill show you how to fit a stacked ensemble
of models using the caretEnsemble package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create ensemble model: stack</span></span>
<span><span class="va">stack</span> <span class="op">&lt;-</span> <span class="fu">caretStack</span><span class="op">(</span><span class="va">model_list</span>, method <span class="op">=</span> <span class="st">&quot;glm&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">stack</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="make-prediction">Make prediction</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">iris_caret</span> <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">Species</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="st">&#39;versicolor&#39;</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co"># Get the number of observations</span></span>
<span><span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">iris_caret</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Shuffle row indices: permuted_rows</span></span>
<span><span class="va">permuted_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">n_obs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly order data: iris_caret</span></span>
<span><span class="va">iris_caret_shuffled</span> <span class="op">&lt;-</span> <span class="va">iris_caret</span><span class="op">[</span><span class="va">permuted_rows</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Identify row to split on: split</span></span>
<span><span class="va">split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">n_obs</span> <span class="op">*</span> <span class="fl">0.6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create train</span></span>
<span><span class="va">train</span> <span class="op">&lt;-</span> <span class="va">iris_caret_shuffled</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">split</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Create test</span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="va">iris_caret_shuffled</span><span class="op">[</span><span class="op">(</span><span class="va">split</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">n_obs</span>, <span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="co"># Fit glm model: model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, family <span class="op">=</span> <span class="st">&quot;binomial&quot;</span>, <span class="va">train</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict on test: p</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">&quot;response&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If p exceeds threshold of 0.5, M else R: m_or_r</span></span>
<span><span class="va">m_or_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">p</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, <span class="st">&quot;versicolor&quot;</span>, <span class="st">&quot;virginica&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to factor: p_class</span></span>
<span><span class="va">p_class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">m_or_r</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">test</span><span class="op">[[</span><span class="st">&quot;Species&quot;</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="confusion-matrix">Confusion Matrix</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create confusion matrix</span></span>
<span><span class="fu">confusionMatrix</span><span class="op">(</span><span class="va">p_class</span>, <span class="va">test</span><span class="op">[[</span><span class="st">&quot;Species&quot;</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="roc-curve">ROC curve</h3>
<p><code>Receiver Operating Characteristic</code> curve.</p>
<p>About classification threshold : manually calculating and comparing
dozens of confusion matrices is a tedious work.</p>
<p>ROC curve : plot true / false <code>positive</code> rate at
<code>EVERY POSSIBLE threshold</code>.</p>
<ul>
<li><p>Visualize tradeoffs between two extremes :
<code>100% true positive</code> vs <code>0% false positive</code></p>
<ul>
<li><p>Suppose a binary classification problem : which probability
should be used for classification? (50 pos 50 neg)</p>
<ul>
<li>If 0% : then it classifies always positive.
<code>100% true positive</code> but also 100% false positive.</li>
<li>If 100% : always classify negative. 100% false negative but also
100% true negative (<code>0% false positive</code>)</li>
</ul></li>
</ul></li>
<li><p>X axis : false positive (left better off)</p></li>
<li><p>Y axis : true positive (up better off)</p></li>
</ul>
<p>Use package <code>caTools</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">caTools</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predict on test: p</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">test</span>, type <span class="op">=</span> <span class="st">&quot;response&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make ROC curve</span></span>
<span><span class="fu">colAUC</span><span class="op">(</span><span class="va">p</span>, <span class="va">test</span><span class="op">[[</span><span class="st">&quot;Class&quot;</span><span class="op">]</span><span class="op">]</span>, plotROC <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="auc">AUC</h3>
<p><code>Area Under the Curve</code> : gives one statistic that
summarizes the models accuracy without having to specify all the
details of the model!</p>
<ul>
<li>0.5 is random guessing</li>
<li>1 is perfect model</li>
<li>0 is model always wrong</li>
</ul>
<p>Most models lies between 0.5 and 1</p>
<p>Rule of thumb :</p>
<ul>
<li>0.9 is <code>A</code></li>
<li>0.8 is <code>B</code></li>
<li>and so forth</li>
</ul>
<p>You can use the trainControl() function in caret to use AUC (instead
of acccuracy), to tune the parameters of your models. The
twoClassSummary() convenience function allows you to do this easily.</p>
<p>When using twoClassSummary(), be sure to always include the argument
classProbs = TRUE or your model will throw an error! (You cannot
calculate AUC with just class predictions. You need to have class
probabilities as well.)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create trainControl object: myControl</span></span>
<span><span class="va">myControl</span> <span class="op">&lt;-</span> <span class="fu">trainControl</span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">&quot;cv&quot;</span>,</span>
<span>  number <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  summaryFunction <span class="op">=</span> <span class="va">twoClassSummary</span>,</span>
<span>  classProbs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># IMPORTANT!</span></span>
<span>  verboseIter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train glm with custom trainControl: model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>  <span class="va">Sonar</span>, </span>
<span>  method <span class="op">=</span> <span class="st">&quot;glm&quot;</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">myControl</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print model to console</span></span>
<span><span class="va">model</span></span></code></pre>
</div>
</div>
<h3 id="glmnet-model">glmnet Model</h3>
<p>Extension of glm models with built-in variable selection. It is great
baseline model for any type of prediction, with several advantages: -
quick fit - ignores noisy varibles - provides interpretable
coefficients</p>
<p>Helps handle collinerity of regressors / small sample errors</p>
<ul>
<li>Lasso regression : penalize number of non-zero coefficients</li>
<li>Ridge regression : penalize absolute magnitude of coefficients</li>
</ul>
<p>It attempts to find parsimonious models, and pairs well with
<code>random forest</code> models (it tends to yield different
results!)</p>
<p>glmnet model has two tuning parameters :</p>
<ul>
<li><code>alpha [0, 1]</code> : 0 is pure Ridge, and 1 is pure Lasso
regression</li>
<li><code>lambda (0, inf)</code> : size of penalty, high being simpler
models (penalize for complex)</li>
</ul>
<p>Classification problems are a little more complicated than regression
problems because you have to provide a custom summaryFunction to the
train() function to use the AUC metric to rank your models. Start by
making a custom trainControl, as you did in the previous chapter. Be
sure to set classProbs = TRUE, otherwise the twoClassSummary for
summaryFunction will break.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create custom trainControl: myControl</span></span>
<span><span class="va">myControl</span> <span class="op">&lt;-</span> <span class="fu">trainControl</span><span class="op">(</span></span>
<span>  method <span class="op">=</span> <span class="st">&quot;cv&quot;</span>, </span>
<span>  number <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  summaryFunction <span class="op">=</span> <span class="va">twoClassSummary</span>,</span>
<span>  classProbs <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># IMPORTANT!</span></span>
<span>  verboseIter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Fit glmnet model: model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>  <span class="va">overfit</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&quot;glmnet&quot;</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">myControl</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print model to console</span></span>
<span><span class="va">model</span></span>
<span></span>
<span><span class="co"># Print maximum ROC statistic</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">model</span><span class="op">[[</span><span class="st">&quot;results&quot;</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">&quot;ROC&quot;</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="glmnet-tuning">glmnet tuning</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># make a custom tuning grid</span></span>
<span><span class="va">myGrid</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span></span>
<span>  alpha<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0.0001</span>, <span class="fl">0.1</span>, length<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># fit a model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>  data <span class="op">=</span> <span class="va">overfit</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">&#39;ROC&#39;</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&#39;glmnet&#39;</span>,</span>
<span>  tuneGrid <span class="op">=</span> <span class="va">myGrid</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">myControl</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># plot results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p><code>caret</code> automatically chooses best alpha and lambda
coefficient here, so no need to do further.</p>
<h3 id="random-forest-model">random forest Model</h3>
<p>Instead of <code>randomForest</code>, <code>ranger</code> is faster,
stable and use less memory.</p>
<p>Pros - Yield very accurate, non-linear models with no extra work -
Robust against over-fitting - Requires little preprocessing (no
log-transform, normalize..) - Captures threshould effects and variable
interactions well</p>
<p>Cons - A bit slower than glmnet - Less interpretable - Needs
hyperparameters before fitting the model, which might be a bit
arbitrary</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">mlbench</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Sonar</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Fit random forest: model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">quality</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>  tuneLength <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">wine</span>, </span>
<span>  method <span class="op">=</span> <span class="st">&#39;ranger&#39;</span>,</span>
<span>  trControl <span class="op">=</span> <span class="fu">trainControl</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">&quot;cv&quot;</span>, </span>
<span>    number <span class="op">=</span> <span class="fl">5</span>, </span>
<span>    verboseIter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print model to console</span></span>
<span><span class="va">model</span></span></code></pre>
</div>
</div>
<p><code>mtry</code> is the most important hyperparameter : number of
randomly selected variables used at each split - lower mtry : more
random - highter mtry : less random</p>
<p>High value : potentially more accurate model, but at the expense of
waiting much longer for it to run.</p>
<p><code>caret</code> does this hyperparameter selection
::<code>tuneLength()</code> argument in <code>train()</code>
function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># fit a model with deeper tuning grid</span></span>
<span><span class="va">model</span> <span class="op">=</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>  data <span class="op">=</span> <span class="va">Sonar</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&#39;ranger&#39;</span>,</span>
<span>  tuneLength <span class="op">=</span> <span class="fl">10</span> <span class="co"># hyperparameter selection </span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="custom-tuning">custom tuning</h3>
<p>Custom tuning grids to <code>tuneGrid()</code> argument</p>
<p>Pros : - Most flexible - Complete control Cons : - Knowledge in the
model - Can dramatically increase the runtime</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># From previous step</span></span>
<span><span class="va">tuneGrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  .mtry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span>,</span>
<span>  .splitrule <span class="op">=</span> <span class="st">&quot;variance&quot;</span>,</span>
<span>  .min.node.size <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit random forest: model</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  <span class="va">quality</span> <span class="op">~</span><span class="va">.</span>,</span>
<span>  tuneGrid <span class="op">=</span> <span class="va">tuneGrid</span>,</span>
<span>  data <span class="op">=</span> <span class="va">wine</span>, </span>
<span>  method <span class="op">=</span> <span class="st">&#39;ranger&#39;</span>,</span>
<span>  trControl <span class="op">=</span> <span class="fu">trainControl</span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">&quot;cv&quot;</span>, </span>
<span>    number <span class="op">=</span> <span class="fl">5</span>, </span>
<span>    verboseIter <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print model to console</span></span>
<span><span class="va">model</span></span>
<span></span>
<span><span class="co"># Plot model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>with custom trainControl</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Fit random forest: model_rf</span></span>
<span><span class="va">model_rf</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">churn_x</span>, </span>
<span>  y <span class="op">=</span> <span class="va">churn_y</span>,</span>
<span>  metric <span class="op">=</span> <span class="st">&quot;ROC&quot;</span>,</span>
<span>  method <span class="op">=</span> <span class="st">&quot;ranger&quot;</span>,</span>
<span>  trControl <span class="op">=</span> <span class="va">myControl</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="unsupervised-ml">Unsupervised ML</h2>
<p>Data</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> a<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean<span class="op">=</span><span class="fl">0</span>,sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, b<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, mean<span class="op">=</span><span class="fl">1</span>, sd<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x</span></span></code></pre>
</div>
</div>
<h3 id="kmeans">kmeans</h3>
<p><code>stats</code> package</p>
<p>k-means has random component : - randomly assign each points into
groups - calculate centers of groups - each point is assigned to cluster
of nearest center (iteration 1) - calculate centers of groups - each
point is assigned to cluster of nearest center (iteration 2) -  - until
it no longer changes any assignments of each point</p>
<p>Model selection</p>
<ul>
<li><p>in R, kmeans uses total within cluster sum of squares</p>
<ul>
<li>which is the squared distance from point to center</li>
</ul></li>
<li><p>Best is minimum one</p></li>
<li><p><code>nstart</code> does multiple random assignment and give the
best(minimum SS) one</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Fit a k-means model to x using 3 centers and run the k-means algorithm 20 times. Store the result in km.out.</span></span>
<span><span class="va">km.out</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">x</span> , centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span><span class="fl">20</span><span class="op">)</span> <span class="co"># 20 initial random assignemnts and give the best one</span></span>
<span><span class="co"># Inspect the result</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">km.out</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">km.out</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">km.out</span><span class="op">$</span><span class="va">cluster</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="va">km.out</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>     main <span class="op">=</span> <span class="st">&quot;k-means with 3 clusters&quot;</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">&quot;&quot;</span>, ylab <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Model selection</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Set up 2 x 3 plotting grid</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Run kmeans() on x with three clusters and one start</span></span>
<span>  <span class="va">km.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">x</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Plot clusters</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">x</span>, col <span class="op">=</span> <span class="va">km.out</span><span class="op">$</span><span class="va">cluster</span>, </span>
<span>       main <span class="op">=</span> <span class="va">km.out</span><span class="op">$</span><span class="va">tot.withinss</span>, </span>
<span>       xlab <span class="op">=</span> <span class="st">&quot;&quot;</span>, ylab <span class="op">=</span> <span class="st">&quot;&quot;</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
</div>
<p>How many clusters to choose?</p>
<p>Choose one with highest elbow(kink)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Initialize total within sum of squares error: wss</span></span>
<span><span class="va">wss</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="co"># For 1 to 15 cluster centers</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">km.out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">x</span>, centers <span class="op">=</span> <span class="va">i</span>, nstart <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span>  <span class="co"># Save total within sum of squares to wss variable</span></span>
<span>  <span class="va">wss</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">km.out</span><span class="op">$</span><span class="va">tot.withinss</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plot total within sum of squares vs. number of clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="va">wss</span>, type <span class="op">=</span> <span class="st">&quot;b&quot;</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">&quot;Number of Clusters&quot;</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">&quot;Within groups sum of squares&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set k equal to the number of clusters corresponding to the elbow location</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">2</span>  <span class="co"># 3 is probably OK, too</span></span></code></pre>
</div>
</div>
<h3 id="hierarchical-clustering">hierarchical clustering</h3>
<p>Number of cluster is not known ahead of time</p>
<p>Two approaches : bottom-up and top-down - bottom-up approach:
<code>hclust()</code> function 1) assign all different cluster N 2) join
<code>closest</code> one pair to one group, now N-1 clusters - here to
find closest one, similarity measure should be used. Simple one is
euclidean distance. 3) join next closest pair to one group, N-2 -
cluster to clusters, 4 methods to determine. 1) and 3) makes balanced
one and popular. 1) complete : pairwise similarity between all
observations in cluster 1 and 2, pick largest similarity to gauge
distance between clusters - <code>method = &#39;complete&#39;</code> 2) single :
pairwise but pick smallest one to gauge distance -
<code>method = &#39;single&#39;</code> 3) average : pairwise and pick average of
distances - <code>method = &#39;average&#39;</code> 4) centroid : find center of
each clusters and check distance between those centers - it can make
inversion, undesirable and much less used 4)  5) until all of them are
clustered into one cluster</p>
<p>Preprocessing</p>
<p>Difference in units makes problem, standardizing is needed before
clustering Use <code>scale(x)</code> for this step.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># distance matrix, euclidean distance</span></span>
<span><span class="co">#  dist(x) </span></span>
<span><span class="va">hclust.out</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">hclust.out</span><span class="op">)</span></span>
<span><span class="co"># dentrogram</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hclust.out</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">6</span>, col<span class="op">=</span><span class="st">&#39;red&#39;</span><span class="op">)</span> <span class="co"># cut at height 6, two clusters</span></span></code></pre>
</div>
</div>
<p>Generate vector of clustering outcome</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Cut by height</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">hclust.out</span>, h <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span>
<span><span class="co"># Cut by number of clusters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">hclust.out</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Cluster linkage methods</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Cluster using complete linkage: hclust.complete</span></span>
<span><span class="va">hclust.complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">&quot;complete&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cluster using average linkage: hclust.average</span></span>
<span><span class="va">hclust.average</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">&quot;average&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cluster using single linkage: hclust.single</span></span>
<span><span class="va">hclust.single</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">&quot;single&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot dendrogram of hclust.complete</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hclust.complete</span>, main <span class="op">=</span> <span class="st">&quot;Complete&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot dendrogram of hclust.average</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hclust.average</span>, main <span class="op">=</span> <span class="st">&quot;Average&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot dendrogram of hclust.single</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">hclust.single</span>, main <span class="op">=</span> <span class="st">&quot;Single&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="dimensionality-reduction">Dimensionality reduction</h3>
<p>Dimensionality reduction is needed for: - to find structure in
features - aid in visualization</p>
<p>principal component analysis - linear combination of features - find
lower dimensional representation that maintains and describes maximum
amount of variance from original data - maintain most variance in the
data - components are orthgonal (uncorrelated) by construction</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">pr.iris</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>,</span>
<span>                 scale <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># divide by std to set standard deviation to 1</span></span>
<span>                 center <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># demean the data, centered around zero</span></span>
<span>                 <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">pr.iris</span><span class="op">)</span> <span class="co"># variance explained by each component</span></span>
<span><span class="co"># here, PC1 explains 92% of variability of the data</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">pr.iris</span></span>
<span></span>
<span><span class="va">pr.iris</span><span class="op">$</span><span class="va">center</span></span>
<span><span class="va">pr.iris</span><span class="op">$</span><span class="va">scale</span></span>
<span><span class="va">pr.iris</span><span class="op">$</span><span class="va">rotation</span></span>
<span><span class="co"># Rotation : the directions of the principal component vectors in terms of the original features/variables. This information allows you to define new data in terms of the original principal components</span></span></code></pre>
</div>
</div>
<h4 id="visualizing">Visualizing</h4>
<p>See the factor loadings : <code>biplot()</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/stats/biplot.html">biplot</a></span><span class="op">(</span><span class="va">pr.iris</span><span class="op">)</span> <span class="co"># Petal.Width and Petal.Length has similar loadings</span></span></code></pre>
</div>
</div>
<p>Screeplot</p>
<p>A scree plot shows the variance explained as the number of principal
components increases. Sometimes the cumulative variance explained is
plotted as well.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">pr.var</span> <span class="op">=</span> <span class="va">pr.iris</span><span class="op">$</span><span class="va">sdev</span><span class="op">^</span><span class="fl">2</span> <span class="co"># make it variance</span></span>
<span><span class="va">pve</span> <span class="op">=</span> <span class="va">pr.var</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">pr.var</span><span class="op">)</span> <span class="co"># proportion of variance explained</span></span>
<span><span class="co"># Plot variance explained for each principal component</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pve</span>, xlab <span class="op">=</span> <span class="st">&quot;Principal Component&quot;</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">&quot;Proportion of Variance Explained&quot;</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">&quot;b&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot cumulative proportion of variance explained</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">pve</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">&quot;Principal Component&quot;</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">&quot;Cumulative Proportion of Variance Explained&quot;</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">&quot;b&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="deep-learning">Deep Learning</h2>
<h1 id="network-analysis">NETWORK ANALYSIS</h1>
<h2 id="my-functions">My Functions</h2>
<h3 id="remove-zero-weight-edges">Remove zero weight edges</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">delete.edges</span><span class="op">(</span><span class="va">test_graph</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu">E</span><span class="op">(</span><span class="va">test_graph</span><span class="op">)</span><span class="op">$</span><span class="va">weight</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="concepts">Concepts</h2>
<h3 id="centrality-measures">Centrality measures</h3>
<p>: to see important and influential vertices</p>
<ul>
<li><p>degree centrality</p>
<ul>
<li>out-degree : how many edges does a vertex send out</li>
<li>in-degree : how mane edges does a vertex receives</li>
<li>total-degree : sum of out and in degree (undirected networks degree
centrality)</li>
<li><code>degree</code> function</li>
</ul></li>
<li><p>strength</p>
<ul>
<li>used in weighted networks (connection strength)</li>
<li>summation of weights of edges connected to each node</li>
<li><code>strength</code> function</li>
</ul></li>
<li><p>betweenness</p>
<ul>
<li>a measure that quantifies how often a node lies on the shortest path
between other nodes.</li>
<li>In other words, searching for <code>hub</code></li>
<li>Both directed / non-directed</li>
<li><code>betweenness()</code></li>
</ul></li>
<li><p>weighted betweenness</p>
<ul>
<li>when edges are weighted, then shortest path is the MINUMUM of sum of
weights.</li>
<li>Usually weights need to be inversed to calculate correctly</li>
<li><code>edge_betweenness(g, weight =dist_weight)</code></li>
</ul></li>
<li><p>closeness</p>
<ul>
<li>a measure that quantifies how close a node is to all other nodes in
the network in terms of shortest path distance.</li>
<li><code>closeness()</code></li>
</ul></li>
<li><p>eigenvector centrality (undirected network)</p>
<ul>
<li>How well connected a vertex is</li>
<li>Highest eigenvector centrality : those that are connected to many
others but especially who themselves are highly connected to others</li>
</ul></li>
<li><p>closeness centrality</p>
<ul>
<li>Counting how many steps are required to get to every other node</li>
<li><code>closeness()</code></li>
</ul></li>
<li><p>transitivity (clustering coefficient)</p>
<ul>
<li>the extent to which the nodes in the network are connected</li>
</ul></li>
</ul>
<p><span class="math inline">\(\frac{number\ of\ triangles}{number\ of\
triads}\)</span> at each node</p>
<pre><code>-   type global

    -   computed for the whole network

-   type local

    -   computed for each node separately</code></pre>
<ul>
<li><p>pagerank centrality</p>
<ul>
<li><code>page.rank()</code></li>
</ul></li>
<li><p>dyads : two connected vertices(nodes)</p></li>
<li><p>triads : three connected verticies</p>
<ul>
<li>triangle</li>
</ul></li>
</ul>
<h3 id="overall-structure-of-network">Overall structure of network</h3>
<ul>
<li><p>density</p>
<ul>
<li>Proportion of edges that actually do exist in the network out of all
potentially could exist between every pair of vertices</li>
<li>Measure of how interconnected a network is</li>
<li><code>edge_density()</code> funciton</li>
<li>Network connectance(density)</li>
<li>Number of edges in a fully connected network : <span class="math inline">\(_nC_2 = \frac{nodes(nodes-1)}2\)</span></li>
<li>Network connectance : <span class="math inline">\(p = \frac{number\
of\ edges\ connected}{_nC_2}\)</span></li>
</ul></li>
<li><p>average path length</p>
<ul>
<li>Mean of length of shortest path between all pairs of vertices in the
network</li>
<li>the more connected overall, the shorter the shortest-length</li>
<li><code>mean_distance()</code> function</li>
</ul></li>
</ul>
<h3 id="connectivity">Connectivity</h3>
<p>: Measures how densely connected the vertices of a graph are.</p>
<p>Vertex / Edge connectivity : how man vertices or edges need to be
removed to disconnect graph, creating two distinct graphs.
<code>vertex_connectivity()</code>, <code>edge_connectivity()</code> :
returns integer</p>
<p>More details about - how many, which are cut, what are the partitions
after the cut? <code>min_cut( value.only =FALSE)</code>, and
<code>stMincuts(graph, &#39;node1&#39;,&#39;node2&#39;)</code></p>
<p>connectivity randomizations</p>
<h2 id="igraph-package">igraph package</h2>
<p>Setup</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://igraph.org">igraph</a></span><span class="op">)</span></span>
<span><span class="co"># sample data</span></span>
<span><span class="va">friends</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Jessie&quot;</span>, <span class="st">&quot;Jessie&quot;</span>, <span class="st">&quot;Sidney&quot;</span>, <span class="st">&quot;Sidney&quot;</span>, </span>
<span><span class="st">&quot;Karl&quot;</span>, <span class="st">&quot;Sidney&quot;</span>, <span class="st">&quot;Britt&quot;</span>, <span class="st">&quot;Shayne&quot;</span>, <span class="st">&quot;Sidney&quot;</span>, <span class="st">&quot;Sidney&quot;</span>, <span class="st">&quot;Jessie&quot;</span>, </span>
<span><span class="st">&quot;Donnie&quot;</span>, <span class="st">&quot;Sidney&quot;</span>, <span class="st">&quot;Rene&quot;</span>, <span class="st">&quot;Shayne&quot;</span>, <span class="st">&quot;Jessie&quot;</span>, <span class="st">&quot;Rene&quot;</span>, <span class="st">&quot;Elisha&quot;</span>, </span>
<span><span class="st">&quot;Eugene&quot;</span>, <span class="st">&quot;Berry&quot;</span>, <span class="st">&quot;Odell&quot;</span>, <span class="st">&quot;Odell&quot;</span>, <span class="st">&quot;Britt&quot;</span>, <span class="st">&quot;Elisha&quot;</span>, <span class="st">&quot;Lacy&quot;</span>, </span>
<span><span class="st">&quot;Britt&quot;</span>, <span class="st">&quot;Karl&quot;</span><span class="op">)</span>, name2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Sidney&quot;</span>, <span class="st">&quot;Britt&quot;</span>, <span class="st">&quot;Britt&quot;</span>, <span class="st">&quot;Donnie&quot;</span>, </span>
<span><span class="st">&quot;Berry&quot;</span>, <span class="st">&quot;Rene&quot;</span>, <span class="st">&quot;Rene&quot;</span>, <span class="st">&quot;Sidney&quot;</span>, <span class="st">&quot;Elisha&quot;</span>, <span class="st">&quot;Whitney&quot;</span>, <span class="st">&quot;Whitney&quot;</span>, </span>
<span><span class="st">&quot;Odell&quot;</span>, <span class="st">&quot;Odell&quot;</span>, <span class="st">&quot;Whitney&quot;</span>, <span class="st">&quot;Donnie&quot;</span>, <span class="st">&quot;Lacy&quot;</span>, <span class="st">&quot;Lacy&quot;</span>, <span class="st">&quot;Eugene&quot;</span>, </span>
<span><span class="st">&quot;Jude&quot;</span>, <span class="st">&quot;Odell&quot;</span>, <span class="st">&quot;Rickie&quot;</span>, <span class="st">&quot;Karl&quot;</span>, <span class="st">&quot;Lacy&quot;</span>, <span class="st">&quot;Jude&quot;</span>, <span class="st">&quot;Whitney&quot;</span>, </span>
<span><span class="st">&quot;Whitney&quot;</span>, <span class="st">&quot;Tommy&quot;</span><span class="op">)</span><span class="op">)</span>, .Names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;name1&quot;</span>, <span class="st">&quot;name2&quot;</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">&quot;data.frame&quot;</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, </span>
<span><span class="op">-</span><span class="fl">27L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">friends</span><span class="op">)</span> <span class="co"># unordered network</span></span>
<span><span class="va">friends.mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">friends</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="conversion">Conversion</h3>
<h4 id="matrix-to-graph">Matrix to graph</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># edgelist accepts matrix, not dataframe</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_edgelist.html">graph.edgelist</a></span><span class="op">(</span><span class="va">friends.mat</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="dataframe-to-graph">Dataframe to graph</h4>
<p><code>graph_from_data_frame</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">friends1_edges</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Joe&quot;</span>, <span class="st">&quot;Joe&quot;</span>, <span class="st">&quot;Joe&quot;</span>, <span class="st">&quot;Erin&quot;</span>, <span class="st">&quot;Kelley&quot;</span>, </span>
<span><span class="st">&quot;Ronald&quot;</span>, <span class="st">&quot;Ronald&quot;</span>, <span class="st">&quot;Ronald&quot;</span>, <span class="st">&quot;Michael&quot;</span>, <span class="st">&quot;Michael&quot;</span>, <span class="st">&quot;Michael&quot;</span>, </span>
<span><span class="st">&quot;Valentine&quot;</span>, <span class="st">&quot;Troy&quot;</span>, <span class="st">&quot;Troy&quot;</span>, <span class="st">&quot;Jasmine&quot;</span>, <span class="st">&quot;Jasmine&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Carey&quot;</span>, </span>
<span><span class="st">&quot;Frankie&quot;</span>, <span class="st">&quot;Frankie&quot;</span>, <span class="st">&quot;Micheal&quot;</span>, <span class="st">&quot;Micheal&quot;</span>, <span class="st">&quot;Keith&quot;</span>, <span class="st">&quot;Keith&quot;</span>, </span>
<span><span class="st">&quot;Gregory&quot;</span><span class="op">)</span>, name2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Ronald&quot;</span>, <span class="st">&quot;Michael&quot;</span>, <span class="st">&quot;Troy&quot;</span>, <span class="st">&quot;Kelley&quot;</span>, </span>
<span><span class="st">&quot;Valentine&quot;</span>, <span class="st">&quot;Troy&quot;</span>, <span class="st">&quot;Perry&quot;</span>, <span class="st">&quot;Jasmine&quot;</span>, <span class="st">&quot;Troy&quot;</span>, <span class="st">&quot;Jasmine&quot;</span>, <span class="st">&quot;Juan&quot;</span>, </span>
<span><span class="st">&quot;Perry&quot;</span>, <span class="st">&quot;Jasmine&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Carey&quot;</span>, <span class="st">&quot;Demetrius&quot;</span>, <span class="st">&quot;Frankie&quot;</span>, </span>
<span><span class="st">&quot;Micheal&quot;</span>, <span class="st">&quot;Merle&quot;</span>, <span class="st">&quot;Merle&quot;</span>, <span class="st">&quot;Alex&quot;</span>, <span class="st">&quot;Gregory&quot;</span>, <span class="st">&quot;Marion&quot;</span>, <span class="st">&quot;Marion&quot;</span></span>
<span><span class="op">)</span>, hours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">2L</span>, <span class="fl">3L</span>, <span class="fl">5L</span>, <span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">5L</span>, <span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">5L</span>, </span>
<span><span class="fl">3L</span>, <span class="fl">2L</span>, <span class="fl">6L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">2L</span>, <span class="fl">1L</span>, <span class="fl">1L</span>, <span class="fl">3L</span>, <span class="fl">2L</span><span class="op">)</span><span class="op">)</span>, .Names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;name1&quot;</span>, </span>
<span><span class="st">&quot;name2&quot;</span>, <span class="st">&quot;hours&quot;</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">&quot;data.frame&quot;</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="op">-</span><span class="fl">25L</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">friends1_nodes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/structure.html">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Joe&quot;</span>, <span class="st">&quot;Erin&quot;</span>, <span class="st">&quot;Kelley&quot;</span>, <span class="st">&quot;Ronald&quot;</span>, <span class="st">&quot;Michael&quot;</span>, </span>
<span><span class="st">&quot;Valentine&quot;</span>, <span class="st">&quot;Troy&quot;</span>, <span class="st">&quot;Jasmine&quot;</span>, <span class="st">&quot;Juan&quot;</span>, <span class="st">&quot;Carey&quot;</span>, <span class="st">&quot;Frankie&quot;</span>, <span class="st">&quot;Micheal&quot;</span>, </span>
<span><span class="st">&quot;Keith&quot;</span>, <span class="st">&quot;Gregory&quot;</span>, <span class="st">&quot;Perry&quot;</span>, <span class="st">&quot;Demetrius&quot;</span>, <span class="st">&quot;Merle&quot;</span>, <span class="st">&quot;Alex&quot;</span>, <span class="st">&quot;Marion&quot;</span></span>
<span><span class="op">)</span>, gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, </span>
<span><span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span><span class="op">)</span><span class="op">)</span>, .Names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;name&quot;</span>, </span>
<span><span class="st">&quot;gender&quot;</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">&quot;data.frame&quot;</span>, row.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="op">-</span><span class="fl">19L</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">friends1_edges</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create an igraph object with attributes directly from dataframes</span></span>
<span><span class="va">g1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span>d <span class="op">=</span> <span class="va">friends1_edges</span>, vertices <span class="op">=</span> <span class="va">friends1_nodes</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># d : symbolic edge list in first two columns</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Subset edges greater than or equal to 5 hours</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">[[</span><span class="va">hours</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">]</span><span class="op">]</span> </span>
<span></span>
<span><span class="co"># Set vertex color by gender</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">gender</span> <span class="op">==</span> <span class="st">&quot;F&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot the graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g1</span>, vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">[[</span><span class="va">hours</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as_adjacency_matrix.html">as_adjacency_matrix</a></span><span class="op">(</span><span class="va">g1</span>, attr <span class="op">=</span> <span class="st">&#39;hours&#39;</span> <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="basic-features">Basic features</h3>
<p>Vertices and Edges</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Subset vertices and edges</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># number of nodes ( 2 commands)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">vcount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="co"># old</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">gorder</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="co"># Count number of edges</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gsize.html">ecount</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="co"># old</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gsize.html">gsize</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="add-attributes">add attributes</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">genders</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, </span>
<span><span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>, <span class="st">&quot;M&quot;</span>, <span class="st">&quot;M&quot;</span><span class="op">)</span></span>
<span><span class="va">ages</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">21</span>, <span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">18</span>, <span class="fl">23</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">21</span>, <span class="fl">18</span>, <span class="fl">19</span>, </span>
<span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">hours</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">1</span>, </span>
<span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="vertex-attributes">Vertex attributes</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create new vertex attribute called &#39;gender&#39;</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/set_vertex_attr.html">set_vertex_attr</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&quot;gender&quot;</span>, value <span class="op">=</span> <span class="va">genders</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create new vertex attribute called &#39;age&#39;</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/set_vertex_attr.html">set_vertex_attr</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&quot;age&quot;</span>, value <span class="op">=</span> <span class="va">ages</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View all vertex attributes in a list</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/vertex_attr.html">vertex_attr</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View attributes of first five vertices in a dataframe</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span> </span></code></pre>
</div>
</div>
<h4 id="edge-attributes">Edge attributes</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create new edge attribute called &#39;hours&#39;</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/set_edge_attr.html">set_edge_attr</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&quot;hours&quot;</span>, value <span class="op">=</span> <span class="va">hours</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View edge attributes of graph object</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/edge_attr.html">edge_attr</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Find all edges that include &quot;Britt&quot;</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">[[</span><span class="fu">inc</span><span class="op">(</span><span class="st">&#39;Britt&#39;</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Find all pairs that spend 4 or more hours together per week</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">[[</span><span class="va">hours</span><span class="op">&gt;=</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>  </span></code></pre>
</div>
</div>
<h2 id="directed-network">directed network</h2>
<p>Check if the graph object is directed / weighted</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/is_directed.html">is.directed</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/is_weighted.html">is.weighted</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Is there an edge going from vertex 184 to vertex 178?</span></span>
<span><span class="va">g</span><span class="op">[</span><span class="st">&#39;184&#39;</span>, <span class="st">&#39;178&#39;</span><span class="op">]</span> <span class="co"># 1</span></span>
<span></span>
<span><span class="co"># Is there an edge going from vertex 18 to vertex 20?</span></span>
<span><span class="va">g</span><span class="op">[</span><span class="st">&#39;178&#39;</span>, <span class="st">&#39;184&#39;</span><span class="op">]</span> <span class="co"># 0</span></span>
<span></span>
<span><span class="co"># Show all edges going to or from vertex 184</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/incident.html">incident</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&#39;184&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;all&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show all edges going out from vertex 184</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/incident.html">incident</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&#39;184&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;out&quot;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Relationships between vertices</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Identify all neighbors of vertex 12 regardless of direction</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/neighbors.html">neighbors</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&#39;12&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;all&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify other vertices that direct edges towards vertex 12</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/neighbors.html">neighbors</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&#39;12&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;in&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify any vertices that receive an edge from vertex 42 and direct an edge to vertex 124</span></span>
<span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/neighbors.html">neighbors</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&#39;42&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;out&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">n2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/neighbors.html">neighbors</a></span><span class="op">(</span><span class="va">g</span>, <span class="st">&#39;124&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;in&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/intersection.html">intersection</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Distances between vertices</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co">#- Which two vertices are the furthest apart in the graph ?</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/diameter.html">farthest_vertices</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#- Shows the path sequence between two furthest apart vertices.(it is called a diameter)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/diameter.html">get_diameter</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Identify vertices that are reachable within two connections from vertex 42</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/ego.html">ego</a></span><span class="op">(</span><span class="va">g</span>, <span class="fl">2</span>, <span class="st">&#39;42&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;out&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify vertices that can reach vertex 42 within two connections</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/ego.html">ego</a></span><span class="op">(</span><span class="va">g</span>, <span class="fl">2</span>, <span class="st">&#39;42&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;in&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Calculate the out-degree of each vertex</span></span>
<span><span class="va">g.outd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span><span class="op">(</span><span class="va">g</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;out&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View a summary of out-degree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">g.outd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make a histogram of out-degrees</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">g.outd</span>, breaks <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find the vertex that has the maximum out-degree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">g.outd</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Calculate betweenness of each vertex</span></span>
<span><span class="va">g.b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/betweenness.html">betweenness</a></span><span class="op">(</span><span class="va">g</span>, directed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show histogram of vertex betweenness</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">g.b</span>, breaks <span class="op">=</span> <span class="fl">80</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create plot with vertex size determined by betweenness score</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g</span>, </span>
<span>     vertex.label <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>     edge.color <span class="op">=</span> <span class="st">&#39;black&#39;</span>,</span>
<span>     vertex.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">g.b</span><span class="op">)</span><span class="op">+</span><span class="fl">1</span>,</span>
<span>     edge.arrow.size <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>     layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html">layout_nicely</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>One issue with the measles dataset is that there are three
individuals for whom no information is known about who infected them.
One of these individuals (vertex 184) appears ultimately responsible for
spreading the disease to many other individuals even though they did not
directly infect too many individuals. However, because vertex 184 has no
incoming edge in the network they appear to have low betweenness. One
way to explore the importance of this vertex is by visualizing the
geodesic distances of connections going out from this individual. In
this exercise you shall create a plot of these distances from this
patient zero.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Make an ego graph</span></span>
<span><span class="va">g184</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/ego.html">make_ego_graph</a></span><span class="op">(</span><span class="va">g</span>, <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/diameter.html">diameter</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, nodes <span class="op">=</span> <span class="st">&#39;184&#39;</span>, mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;all&quot;</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Get a vector of geodesic distances of all vertices from vertex 184 </span></span>
<span><span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/distances.html">distances</a></span><span class="op">(</span><span class="va">g184</span>, <span class="st">&quot;184&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a color palette of length equal to the maximal geodesic distance plus one.</span></span>
<span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;dodgerblue&quot;</span>, <span class="st">&quot;cyan&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set color attribute to vertices of network g184.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g184</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="va">dists</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Visualize the network based on geodesic distance from vertex 184 (patient zero).</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g184</span>, </span>
<span>     vertex.label <span class="op">=</span> <span class="va">dists</span>, </span>
<span>     vertex.label.color <span class="op">=</span> <span class="st">&quot;white&quot;</span>,</span>
<span>     vertex.label.cex <span class="op">=</span> <span class="fl">.6</span>,</span>
<span>     edge.color <span class="op">=</span> <span class="st">&#39;black&#39;</span>,</span>
<span>     vertex.size <span class="op">=</span> <span class="fl">7</span>,</span>
<span>     edge.arrow.size <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>     main <span class="op">=</span> <span class="st">&quot;Geodesic Distances from Patient Zero&quot;</span></span>
<span>     <span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="eigenvector-centrality">eigenvector centrality</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Make an undirected network</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/graph_from_data_frame.html">graph_from_data_frame</a></span><span class="op">(</span><span class="va">gump</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Identify key nodes using eigenvector centrality</span></span>
<span><span class="va">g.ec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/eigen_centrality.html">eigen_centrality</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">g.ec</span><span class="op">$</span><span class="va">vector</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot Forrest Gump Network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g</span>,</span>
<span>vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, </span>
<span>vertex.label.cex <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>vertex.size <span class="op">=</span> <span class="fl">25</span><span class="op">*</span><span class="op">(</span><span class="va">g.ec</span><span class="op">$</span><span class="va">vector</span><span class="op">)</span>,</span>
<span>edge.color <span class="op">=</span> <span class="st">&#39;gray88&#39;</span>,</span>
<span>main <span class="op">=</span> <span class="st">&quot;Forrest Gump Network&quot;</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="census">census</h2>
<p>Dyads (two connected vertices)</p>
<p>3 types</p>
<ul>
<li>Null : no edges</li>
<li>Asymettric : one directional edge</li>
<li>Mutual : two directed edge back and forth</li>
</ul>
<p>Triads (three connected vertices)</p>
<p>16 types</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Perform dyad census</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/dyad_census.html">dyad_census</a></span><span class="op">(</span><span class="va">amzn_g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform triad census</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/triad_census.html">triad_census</a></span><span class="op">(</span><span class="va">amzn_g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find the edge density</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/edge_density.html">edge_density</a></span><span class="op">(</span><span class="va">amzn_g</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="network-structure">Network Structure</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Get density of a graph</span></span>
<span><span class="va">gd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/edge_density.html">edge_density</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Get the diameter of the graph g</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/diameter.html">diameter</a></span><span class="op">(</span><span class="va">g</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># average path length</span></span>
<span></span>
<span><span class="co">#Get the average path length of the graph g</span></span>
<span><span class="va">g.apl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/distances.html">mean_distance</a></span><span class="op">(</span><span class="va">g</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">g.apl</span></span></code></pre>
</div>
</div>
<p>Generating random network with given parameters</p>
<p>Random graph &amp; randomization tests - To determine if the network
is particularly different from those random networks</p>
<ol type="1">
<li>Generate 1000 graphs based on original network, with same number of
vertices and similar density</li>
<li>Calculate average path length of original network</li>
<li>Calculate average path length of 1000 random networks</li>
<li>determine how many random networks have length greater or less than
original average length path</li>
</ol>
<p>Generate 1000 random graphs</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">gl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">&#39;list&#39;</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">gl</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/erdos.renyi.game.html">erdos.renyi.game</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">gorder</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, <span class="co"># same number of vertices</span></span>
<span>    p.or.m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/edge_density.html">edge_density</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, <span class="co"># similar density</span></span>
<span>    type <span class="op">=</span> <span class="st">&#39;gnp&#39;</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># calculate average mean distance of 1000 random graphs</span></span>
<span></span>
<span><span class="va">gl.apls</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">glm</span> ,<span class="va">mean_distance</span>, directed <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># histogram of random mean distances</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">gl.apls</span>, breaks <span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Generate a random graph using the function erdos.renyi.game(). The
first argument n should be the number of nodes of the graph g which can
be calculated using gorder(), the second argument p.or.m should be the
density of the graph g which you previously stored as the object gd. The
final argument is set as type=gnp to tell the function that you are
using the density of the graph to generate a random graph.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create one random graph with the same number of nodes and edges as g</span></span>
<span><span class="va">g.random</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/erdos.renyi.game.html">erdos.renyi.game</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">gorder</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, p.or.m <span class="op">=</span> <span class="va">gd</span>, type <span class="op">=</span> <span class="st">&quot;gnp&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g.random</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g.random</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get density of new random graph `g.random`</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/edge_density.html">edge_density</a></span><span class="op">(</span><span class="va">g.random</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Get the average path length of the random graph g.random</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/distances.html">mean_distance</a></span><span class="op">(</span><span class="va">g.random</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Generate 1000 random graphs</span></span>
<span><span class="va">gl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">&#39;list&#39;</span>,<span class="fl">1000</span><span class="op">)</span></span>
<span>  </span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">gl</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/erdos.renyi.game.html">erdos.renyi.game</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">gorder</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, p.or.m <span class="op">=</span> <span class="va">gd</span>, type <span class="op">=</span> <span class="st">&quot;gnp&quot;</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Calculate average path length of 1000 random graphs</span></span>
<span><span class="va">gl.apls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">gl</span>, <span class="va">mean_distance</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the distribution of average path lengths</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">gl.apls</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">g.apl</span>, col <span class="op">=</span> <span class="st">&quot;red&quot;</span>, lty <span class="op">=</span> <span class="fl">3</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the proportion of graphs with an average path length lower than our observed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gl.apls</span> <span class="op">&lt;</span> <span class="va">g.apl</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="network-substructure">network substructure</h3>
<h4 id="closed-triangles">closed triangles</h4>
<p>For every three vertices there exists three potential edges. If all
edges exist, then the triad is said to be <code>closed</code>.</p>
<p>To identify all closed triangles : <code>triangles()</code>
function.</p>
<p>Global Transitivity : probability that the adjacent verticies of a
given vertex are connected. <code>transitivity()</code> function.</p>
<p>Local Transitivity : the proportion of closed triangles that a vertex
is a part of, out of theoretical number of closed triangles it could be
a part of given its connections.</p>
<p><code>count_triangles()</code> function yields the number of closed
triangle of given vertex.</p>
<h4 id="clique">clique</h4>
<p>In a clique, every vertex is connected to every other vertex.
<code>largest_cliques()</code></p>
<p><code>max_cliques()</code> : identify cliques of any size, 2+</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Show all triangles in the network.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/count_triangles.html">triangles</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Count the number of triangles that vertex &quot;BUBBA&quot; is in.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/count_triangles.html">count_triangles</a></span><span class="op">(</span><span class="va">g</span>, vids <span class="op">=</span> <span class="st">&#39;BUBBA&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate  the global transitivity of the network.</span></span>
<span><span class="va">g.tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/transitivity.html">transitivity</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="va">g.tr</span></span>
<span></span>
<span><span class="co"># Calculate the local transitivity for vertex BUBBA.</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/transitivity.html">transitivity</a></span><span class="op">(</span><span class="va">g</span>, vids <span class="op">=</span> <span class="st">&#39;BUBBA&#39;</span>, type <span class="op">=</span> <span class="st">&quot;local&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Calculate average transitivity of 1000 random graphs</span></span>
<span><span class="va">gl.tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">gl</span>, <span class="va">transitivity</span><span class="op">)</span></span>
<span><span class="va">gl.trs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">gl.tr</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get summary statistics of transitivity scores</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">gl.trs</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the proportion of graphs with a transitivity score higher than Forrest Gump&#39;s network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">gl.trs</span> <span class="op">&gt;</span> <span class="va">g.tr</span><span class="op">)</span> <span class="co"># 0 - randomized networks gave lower transitivity score than Gump&#39;s network</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Identify the largest cliques in the network</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cliques.html">largest_cliques</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine all maximal cliques in the network and assign to object &#39;clq&#39;</span></span>
<span><span class="va">clq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cliques.html">max_cliques</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the size of each maximal clique.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">clq</span>, <span class="va">length</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Visualize largest cliques</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Assign largest cliques output to object &#39;lc&#39;</span></span>
<span><span class="va">lc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cliques.html">largest_cliques</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create two new undirected subgraphs, each containing only the vertices of each largest clique.</span></span>
<span><span class="va">gs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html">as.undirected</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html">subgraph</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">lc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">gs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html">as.undirected</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html">subgraph</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">lc</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot the two largest cliques side-by-side</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># To plot two plots side-by-side</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gs1</span>,</span>
<span>     vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, </span>
<span>     vertex.label.cex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>     vertex.size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     edge.color <span class="op">=</span> <span class="st">&#39;gray28&#39;</span>,</span>
<span>     main <span class="op">=</span> <span class="st">&quot;Largest Clique 1&quot;</span>,</span>
<span>     layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout.deprecated.html">layout.circle</a></span><span class="op">(</span><span class="va">gs1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gs2</span>,</span>
<span>     vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, </span>
<span>     vertex.label.cex <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>     vertex.size <span class="op">=</span> <span class="fl">0</span>,</span>
<span>     edge.color <span class="op">=</span> <span class="st">&#39;gray28&#39;</span>,</span>
<span>     main <span class="op">=</span> <span class="st">&quot;Largest Clique 2&quot;</span>,</span>
<span>     layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout.deprecated.html">layout.circle</a></span><span class="op">(</span><span class="va">gs2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="relationship-measures">Relationship measures</h2>
<p>Assortativity</p>
<ul>
<li>The preferential attachement of vertices to other verticies that are
similar in numerical or categorical attributes</li>
<li>E.g. political party, gender, age</li>
<li>Network with high assortativity? how high is high? =&gt; by
<code>randomization test</code></li>
</ul>
<p>Reciprocity (directed network)</p>
<ul>
<li>equal to proportion of edges that are symmetrical. (A -&gt; B) and
(B -&gt; A)</li>
<li>Proportion of outgoing edges that also have an incoming edge.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Convert the gender attribute into a numeric value</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">gender</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the assortativity of the network based on gender</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the assortativity degree of the network</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity.degree</a></span><span class="op">(</span><span class="va">g1</span>, directed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Using randomizations to assess assortativity</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Calculate the observed assortativity</span></span>
<span><span class="va">observed.assortativity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity</a></span><span class="op">(</span><span class="va">g1</span>, <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the assortativity of the network randomizing the gender attribute 1000 times</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span><span class="op">(</span><span class="st">&#39;list&#39;</span>, <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/assortativity.html">assortativity</a></span><span class="op">(</span><span class="va">g1</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Plot the distribution of assortativity values and add a red vertical line at the original observed value</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">observed.assortativity</span>, col <span class="op">=</span> <span class="st">&quot;red&quot;</span>, lty <span class="op">=</span> <span class="fl">3</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Reciprocity</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Make a plot of the chimp grooming network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g</span>,</span>
<span>     edge.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>,</span>
<span>     edge.arrow.size <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>     edge.arrow.width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Calculate the reciprocity of the graph</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/reciprocity.html">reciprocity</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Dyacity(Homophily measure)</p>
<ul>
<li>Connectedness between nodes with the <code>same label</code>
compared to what is expected in a random configuration of the
network</li>
<li>Expected number of same label edges : All possible number of edges
within the same label * connectance(density) of network <span class="math inline">\(p\)</span></li>
<li>$n_{green}C_2 * p = $</li>
<li>e.g.9 white nodes 6 green nodes, 21 edges and p =0.2 - <span class="math inline">\(_6C_2 * 0.2 = 3\)</span> - <span class="math inline">\(D = \frac{number\ of\ same\ label\
edges}{expected\ number\ of\ same\ label\ edges}\)</span></li>
<li>Dyadic : D &gt;1 D ~ 1 random , D &lt; 1 anti-dyadic</li>
</ul>
<p>Heterophilicity</p>
<ul>
<li>Connectedness between nodes with different labels compared to what
is expected for a random configuration of the network</li>
<li>Expected number of cross label edges : <span class="math inline">\(n_wn_gp\)</span></li>
<li>e.g.9 white nodes 6 green nodes 21 edges and connectance <span class="math inline">\(p=0.2\)</span></li>
<li>expected number of cross label edges is 11 (<span class="math inline">\(9*6*0.2\)</span>)</li>
<li><span class="math inline">\(H = \frac{number\ of\ cross\ label\
edges}{expected\ number\ of\ cross\ label\ edges}\)</span></li>
<li>H &gt; 1 : heterophilic / H = 1 : random / H &lt; 1 :
Heterophobic</li>
</ul>
<p>Network connectance</p>
<h3 id="community-detection">community detection</h3>
<p>Several algorithms are out there, and they have pros and cons, so all
should be tried out to determine the best fit.</p>
<ul>
<li><p>fastgreedy detection</p>
<ul>
<li>modularity score based</li>
<li>works by tyring to build larger and larger commnunities by adding
vertices to each community one by one and assessing modularity
score</li>
<li>modularity score : an index of how inter-connected edges are within
vs between communities.</li>
<li><code>cluster_fastgreedy</code></li>
</ul></li>
<li><p>edge-betweenness</p>
<ul>
<li>works by dividing the network into smaller and smaller pieces until
it finds edges that it perceives to be bridges between communities.</li>
<li><code>cluster_edge_betweenness</code></li>
</ul></li>
<li><p>leading eigenvector</p>
<ul>
<li><code>cluster_leading_eigen</code></li>
</ul></li>
<li><p>label propergation</p>
<ul>
<li><code>cluster_label_prop</code></li>
</ul></li>
<li><p>infomap</p></li>
<li><p>louvain (multilevel)</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Perform fast-greedy community detection on network graph</span></span>
<span><span class="va">kc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_fast_greedy.html">fastgreedy.community</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine sizes of each community</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/communities.html">sizes</a></span><span class="op">(</span><span class="va">kc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine which individuals belong to which community</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/communities.html">membership</a></span><span class="op">(</span><span class="va">kc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the community structure of the network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">kc</span>, <span class="va">g</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Perform edge-betweenness community detection on network graph</span></span>
<span><span class="va">gc</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_edge_betweenness.html">edge.betweenness.community</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Determine sizes of each community</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/communities.html">sizes</a></span><span class="op">(</span><span class="va">gc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot community networks determined by fast-greedy and edge-betweenness methods side-by-side</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">kc</span>, <span class="va">g</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">gc</span>, <span class="va">g</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="community-comparison">community comparison</h3>
<p>How to compare the communities found by each detection methods?</p>
<p><code>compare(method =&#39;vi&#39;)</code> to find similarity. -One possible
use : <code>vi</code> variation information metric. - How much variation
is there in community membership for each vertex - The closer to zero,
the more likely any two vertices to be found in the same community</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># From previous step</span></span>
<span><span class="va">retweet_graph_undir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html">as.undirected</a></span><span class="op">(</span><span class="va">retweet_graph</span><span class="op">)</span></span>
<span><span class="va">communities_fast_greedy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_fast_greedy.html">cluster_fast_greedy</a></span><span class="op">(</span><span class="va">retweet_graph_undir</span><span class="op">)</span></span>
<span><span class="va">communities_infomap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_infomap.html">cluster_infomap</a></span><span class="op">(</span><span class="va">retweet_graph_undir</span><span class="op">)</span></span>
<span><span class="va">communities_louvain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/cluster_louvain.html">cluster_louvain</a></span><span class="op">(</span><span class="va">retweet_graph_undir</span><span class="op">)</span></span>
<span></span>
<span><span class="va">two_users</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;bass_analytics&quot;</span>, <span class="st">&quot;big_data_flow&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Subset membership of communities_fast_greedy by two_users</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/communities.html">membership</a></span><span class="op">(</span><span class="va">communities_fast_greedy</span><span class="op">)</span><span class="op">[</span><span class="va">two_users</span><span class="op">]</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Collective Inferencing</p>
<p>Collective inferencing is a procedure to simultaneously label nodes
in interconnected data to reduce classification error.</p>
<p>In this exercise you will perform collective inferencing and see the
effect it has on the churn prediction using the AUC performance measure.
AUC, or area under the ROC curve, is commonly used to assess the
performance of classification techniques.</p>
<p>AUC = probability that a randomly chosen churner is ranked higher by
the model than a randomly chosen non-churner AUC = number between 0.5
and 1, where a higher number means a better model</p>
<h2 id="network-features">Network features</h2>
<p><code>degree()</code> function</p>
<p>number of nodes that are connected to each node (first order)</p>
<p><code>neighborhood.size(g, order=2)</code></p>
<p>2nd order neighberhood (connected within 2, including itself)</p>
<p><code>count_triangles()</code></p>
<p>How many triangles does a node form?</p>
<p>Centrality measures - Betweenness - Closeness</p>
<h2 id="network-visualization-package">Network Visualization
package</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/briatte/ggnetwork">ggnetwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com">ggraph</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="igraph-base">igraph base</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># See a list of possible layouts</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="st">&quot;package:igraph&quot;</span>, pattern <span class="op">=</span> <span class="st">&quot;^layout_.&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Plot the graph object g1 in a circle layout</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g1</span>, vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_in_circle.html">layout_in_circle</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Plot the graph object g in a Fruchterman-Reingold layout </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g1</span>, vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_with_fr.html">layout_with_fr</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Plot the graph object g in a Tree layout </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g1</span>, vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, layout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_as_tree.html">layout_as_tree</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Plot the graph object g using igraph&#39;s chosen layout </span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html">layout_nicely</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g1</span>, vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, layout <span class="op">=</span> <span class="va">m1</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create a vector of weights based on the number of hours each pair spend together</span></span>
<span><span class="va">w1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">$</span><span class="va">hours</span></span>
<span></span>
<span><span class="co"># Plot the network varying edges by weights</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html">layout_nicely</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g1</span>, </span>
<span>        vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, </span>
<span>        edge.color <span class="op">=</span> <span class="st">&#39;black&#39;</span>,</span>
<span>        edge.width <span class="op">=</span> <span class="va">w1</span>,</span>
<span>        layout <span class="op">=</span> <span class="va">m1</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="network-filtering">Network Filtering</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create a new igraph object by deleting edges that are less than 2 hours long </span></span>
<span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/delete_edges.html">delete_edges</a></span><span class="op">(</span><span class="va">g1</span>, <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g1</span><span class="op">)</span><span class="op">[</span><span class="va">hours</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Plot the new graph </span></span>
<span><span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span><span class="op">$</span><span class="va">hours</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_nicely.html">layout_nicely</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">g2</span>, </span>
<span>     vertex.label.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, </span>
<span>     edge.color <span class="op">=</span> <span class="st">&#39;black&#39;</span>,</span>
<span>     edge.width <span class="op">=</span> <span class="va">w2</span>,</span>
<span>     layout <span class="op">=</span> <span class="va">m2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Add a node attribute called churn</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">churn</span> <span class="op">&lt;-</span> <span class="va">customers</span><span class="op">$</span><span class="va">churn</span></span>
<span></span>
<span><span class="co"># Add a node attribute called color</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">churn</span></span>
<span></span>
<span><span class="co"># Change the color of churners to red and non-churners to white</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">&quot;1&quot;</span>,<span class="st">&quot;red&quot;</span>,<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">&quot;0&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">color</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the network</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">network</span>, vertex.label <span class="op">=</span> <span class="cn">NA</span>, edge.label <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>     edge.color <span class="op">=</span> <span class="st">&quot;black&quot;</span>, vertex.size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Subgraph with conditions</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Create a subgraph with only churners</span></span>
<span><span class="va">churnerNetwork</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/subgraph.html">induced_subgraph</a></span><span class="op">(</span><span class="va">network</span>, </span>
<span>                    v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">network</span><span class="op">)</span><span class="op">$</span><span class="va">churn</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>                    </span>
<span><span class="co"># Plot the churner network                     </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">churnerNetwork</span>, vertex.label <span class="op">=</span> <span class="cn">NA</span>, vertex.size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="ggraph">ggraph</h3>
<p>Regular graph(Karmada-Kawai layout)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">&quot;with_kk&quot;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co"># Add a node text geometry, mapping label to id and repelling</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_text.html">geom_node_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">id</span><span class="op">)</span>, repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>circular graph</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Visualize the network in a circular layout</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">&quot;in_circle&quot;</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Map tie transparency to its weight</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Grid graph</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Change the layout so points are on a grid</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">&quot;on_grid&quot;</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Visualize betweennesss</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Plot with the Kamada-Kawai layout </span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">&quot;with_kk&quot;</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Add an edge link geom, mapping alpha to weight</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Add a node point geom, mapping size to degree</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">degree</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Highlight edges</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Make is_weak TRUE whenever the tie is weak</span></span>
<span><span class="va">is_weak</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">weight</span> <span class="op">==</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">&quot;with_kk&quot;</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add an edge link geom, mapping color to is_weak</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">is_weak</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Subgraph</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">&quot;with_kk&quot;</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Map filter to is_weak</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>filter <span class="op">=</span> <span class="va">is_weak</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> </span></code></pre>
</div>
</div>
<h3 id="ggnetwork">ggnetwork</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Call ggplot</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span></span>
<span>  <span class="co"># Convert retweet_samp to a ggnetwork</span></span>
<span>  <span class="fu">ggnetwork</span><span class="op">(</span><span class="va">retweet_samp</span><span class="op">)</span>, </span>
<span>  <span class="co"># Specify x, y, xend, yend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add a node layer</span></span>
<span>  <span class="fu">geom_nodes</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Change the edges to arrows of length 6 pts</span></span>
<span>  <span class="fu">geom_edges</span><span class="op">(</span>arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">6</span>, <span class="st">&quot;pt&quot;</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Use the blank theme</span></span>
<span>  <span class="fu">theme_blank</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="visnetwork">visNetwork</h3>
<p>Interactive visualization package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># convert igraph to visNetwork</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">toVisNetworkData</span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the network</span></span>
<span><span class="fu">visNetwork</span><span class="op">(</span></span>
<span>  nodes <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">nodes</span>, </span>
<span>  edges <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">edges</span>, </span>
<span>  width <span class="op">=</span> <span class="fl">300</span>, </span>
<span>  height <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>It is possible to change the layout of the visualization using the
visNetwork() and visIgraphLayout() function calls. The igraph package
contains several functions that provide algorithms to lay out the nodes.
You can pass the function name as a string to the layout argument of
visIgraphLayout() to use it.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Update the plot</span></span>
<span><span class="fu">visNetwork</span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">nodes</span>, edges <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">edges</span>, width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Change the layout to be in a circle</span></span>
<span>  <span class="fu">visIgraphLayout</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">&quot;layout_with_kk&quot;</span><span class="op">)</span></span>
<span><span class="co"># on grid format</span></span>
<span><span class="fu">visNetwork</span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">nodes</span>, edges <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">edges</span>, width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Change the layout to be on a grid</span></span>
<span>  <span class="fu">visIgraphLayout</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">&quot;layout_on_grid&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Here, we will highlight the nearest nodes and ties when a node is
selected.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Add to the plot</span></span>
<span><span class="fu">visNetwork</span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">nodes</span>, edges <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">edges</span>, width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Choose an operator</span></span>
<span>  <span class="fu">visIgraphLayout</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">&quot;layout_with_kk&quot;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Change the options to highlight the nearest nodes and ties</span></span>
<span>  <span class="fu">visOptions</span><span class="op">(</span>highlightNearest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Nodes by ID</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Update the plot</span></span>
<span><span class="fu">visNetwork</span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">nodes</span>, edges <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">edges</span>, width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">visIgraphLayout</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">&quot;layout_with_kk&quot;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Change the options to allow selection of nodes by ID</span></span>
<span>  <span class="fu">visOptions</span><span class="op">(</span>nodesIdSelection <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Nodes by group (cluster)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Update the plot</span></span>
<span><span class="fu">visNetwork</span><span class="op">(</span>nodes <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">nodes</span>, edges <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">edges</span>, width <span class="op">=</span> <span class="fl">300</span>, height <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">visIgraphLayout</span><span class="op">(</span>layout <span class="op">=</span> <span class="st">&quot;layout_with_kk&quot;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Change options to select by group</span></span>
<span>  <span class="fu">visOptions</span><span class="op">(</span>selectedBy <span class="op">=</span> <span class="st">&quot;group&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="classifier">Classifier</h2>
<h3 id="relational-neighber-classifier">relational neighber
classifier</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># You are given two vectors: ChurnNeighbors and NonChurnNeighbors with each customer&#39;s number of neighbors that have churned and not churned, respectively.</span></span>
<span><span class="co"># Compute the churn probabilities</span></span>
<span><span class="va">churnProb</span> <span class="op">&lt;-</span> <span class="va">ChurnNeighbors</span> <span class="op">/</span> <span class="op">(</span><span class="va">ChurnNeighbors</span> <span class="op">+</span> <span class="va">NonChurnNeighbors</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Find who is most likely to churn</span></span>
<span><span class="va">mostLikelyChurners</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">churnProb</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">churnProb</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract the IDs of the most likely churners</span></span>
<span><span class="va">customers</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">mostLikelyChurners</span><span class="op">]</span></span></code></pre>
</div>
</div>
<p>probabilistic relational neighbor classifier</p>
<h2 id="adjacency-matrix">Adjacency Matrix</h2>
<p><code>as_adjacency_matrix(g)</code></p>
<p>With weighted network,</p>
<p><code>as_adjacency_matrix(g, attr = &#39;weight&#39;)</code></p>
<h2 id="hierarchical-clustering-1">Hierarchical clustering</h2>
<p>The basic idea behind hierarchical clustering is to define a measure
of similarity between groups of nodes and then incrementally merge
together the most similar groups of nodes until all nodes belongs to a
unique cluster. The result of this process is called a dendrogram.</p>
<p>Similarity measure</p>
<p>pearson similarity is used</p>
<ul>
<li>single linkage : the similarity between groups is the max of
similarities between nodes of different groups</li>
<li>complete linkage : the similarity between groups is the min of
similarities between nodes of different groups</li>
<li>average linkage : the similarity between groups is the average of
similarities between nodes of different groups</li>
</ul>
<p>Hierarchical clustering algorithm</p>
<ol type="1">
<li>evaluate the similarity measures for all node pairs</li>
<li>assign each node to a group of its own</li>
<li>find a pair of groups with the highest similarity and join them
together into single group</li>
<li>calculate similarity between new composite groups and all
others</li>
<li>repeat 3),4) until all nodes are grouped into one.</li>
</ol>
<p>in R, <code>hclust</code> package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># compute a distance matrix</span></span>
<span><span class="va">D</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="va">S</span></span>
<span></span>
<span><span class="co"># obtain a distance object </span></span>
<span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># run average-linkage clustering method and plot the dendrogram </span></span>
<span><span class="va">cc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">&quot;average&quot;</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cc</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Cut the dendrogram tree into 4 clusters</span></span>
<span><span class="va">cls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">cc</span>, k <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="co"># factor vector that classifies each into 1,2,3,4</span></span>
<span></span>
<span><span class="co"># Add cluster information to nodes</span></span>
<span><span class="va">nodes_with_clusters</span> <span class="op">&lt;-</span> <span class="va">nodes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>cluster <span class="op">=</span> <span class="va">cls</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># See the result</span></span>
<span><span class="va">nodes_with_clusters</span></span></code></pre>
</div>
</div>
<p>Visualize cluster</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># From previous step</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="va">nodes</span><span class="op">$</span><span class="va">cluster</span></span>
<span></span>
<span><span class="co"># Update the plot</span></span>
<span><span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">&quot;with_kk&quot;</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="va">weight</span><span class="op">)</span>, show.legend<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">cluster</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">&quot;cluster&quot;</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="co"># Facet the nodes by cluster, with a free scale</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/facet_nodes.html">facet_nodes</a></span><span class="op">(</span><span class="op">~</span> <span class="va">cluster</span>, scales<span class="op">=</span><span class="st">&quot;free&quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="predictive-models">Predictive models</h2>
<p>from graph object -&gt; data.frame -&gt; run ML</p>
<p>Logistic regression : white-box, comprehensible Random forest :
black-box, powerful</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Set the seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the index vector</span></span>
<span><span class="va">index_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">studentnetworkdata</span><span class="op">)</span>, <span class="fl">2</span> <span class="op">/</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">studentnetworkdata</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make the training set</span></span>
<span><span class="va">training_set</span> <span class="op">&lt;-</span> <span class="va">studentnetworkdata</span><span class="op">[</span><span class="va">index_train</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Make the test set</span></span>
<span><span class="va">test_set</span> <span class="op">&lt;-</span> <span class="va">studentnetworkdata</span><span class="op">[</span><span class="op">-</span><span class="va">index_train</span>, <span class="op">]</span></span></code></pre>
</div>
</div>
<p>Logit model</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Make firstModel</span></span>
<span><span class="va">firstModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Future</span> <span class="op">~</span> <span class="va">degree</span> <span class="op">+</span> <span class="va">degree2</span> <span class="op">+</span> <span class="va">triangles</span> <span class="op">+</span> <span class="va">betweenness</span> <span class="op">+</span> <span class="va">closeness</span> <span class="op">+</span> <span class="va">transitivity</span>, family <span class="op">=</span> <span class="st">&#39;binomial&#39;</span>, data <span class="op">=</span> <span class="va">training_set</span><span class="op">)</span></span>
<span><span class="co"># Build the model</span></span>
<span><span class="va">secondModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Future</span> <span class="op">~</span> <span class="va">ChurnNeighbors</span> <span class="op">+</span> <span class="va">RelationalNeighbor</span> <span class="op">+</span> <span class="va">ChurnNeighborsSecond</span> <span class="op">+</span> <span class="va">RelationalNeighborSecond</span> <span class="op">+</span> <span class="va">averageDegree</span> <span class="op">+</span> <span class="va">averageTriangles</span> <span class="op">+</span> <span class="va">averageTransitivity</span> <span class="op">+</span> <span class="va">averageBetweenness</span>, </span>
<span>                   family <span class="op">=</span> <span class="st">&#39;binomial&#39;</span>, data <span class="op">=</span> <span class="va">training_set</span><span class="op">)</span></span>
<span><span class="co"># Build the model</span></span>
<span><span class="va">thirdModel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">Future</span><span class="op">~</span><span class="va">.</span>, family <span class="op">=</span> <span class="st">&#39;binomial&#39;</span>, data<span class="op">=</span><span class="va">training_set</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Random forest model</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Load package</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span> <span class="co"># slower than ranger package</span></span>
<span></span>
<span><span class="co"># Set seed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">863</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build model</span></span>
<span><span class="va">rfModel</span> <span class="op">&lt;-</span> <span class="fu">randomForest</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Future</span><span class="op">)</span><span class="op">~</span><span class="va">.</span> ,data<span class="op">=</span><span class="va">training_set</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot variable importance</span></span>
<span><span class="fu">varImpPlot</span><span class="op">(</span><span class="va">rfModel</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="examples-3">Examples</h2>
<p>Generate a column with degree / strength from graph object</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">nodes_with_centrality</span> <span class="op">&lt;-</span> <span class="va">nodes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/degree.html">degree</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span>,</span>
<span>    <span class="co"># Add a column containing the strength of each node</span></span>
<span>    strength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/strength.html">strength</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Arrange rows by descending strength</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">strength</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># See the result</span></span>
<span><span class="va">nodes_with_centrality</span></span></code></pre>
</div>
</div>
<h1 id="database-server-computing-hpc">DATABASE &amp; SERVER COMPUTING
(HPC)</h1>
<h2 id="ssh">SSH</h2>
<h3 id="hypergator-conn">Hypergator conn</h3>
<pre><code>ssh gunsu.son@hpg.rc.ufl.edu</code></pre>
<h3 id="wrds-conn">WRDS conn</h3>
<pre><code>ssh mgson633@wrds-cloud.wharton.upenn.edu</code></pre>
<h2 id="filezilla">Filezilla</h2>
<h3 id="site-manager">Site Manager</h3>
<p>Go to</p>
<h4 id="hypergator">Hypergator</h4>
<pre><code>- host : hpg.rc.ufl.edu
- port : 22</code></pre>
<h4 id="wrds">WRDS</h4>
<pre><code>- host : wrds-cloud.wharton.upenn.edu
- port : 22</code></pre>
<h2 id="scp">SCP</h2>
<p>Upload and download files from server</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb52"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Downloading</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scp</span> mgson633@wrds-cloud.wharton.upenn.edu:/home/ufl/mgson633/SAS/ibes/suecars.sas7bdat /Users/matthewson/Desktop <span class="co"># download</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scp user@server:/path/to/remotefile.zip /Local/Target/Destination</span></span></code></pre></div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>rstudioapi<span class="sc">::</span><span class="fu">terminalExecute</span>(<span class="st">&#39;scp ~/Dropbox\ \(UFL\)/Nimal_Matthew/Projects/Options_ML/outputs/alldays_c.fst gunsu.son@hpg.rc.ufl.edu:/blue/nimalendran/matthewson/projects/optm/data&#39;</span>)</span></code></pre></div>
</div>
<h2 id="sparklyr">Sparklyr</h2>
<h3 id="installation-2">Installation</h3>
Install local spark
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://spark.rstudio.com/">sparklyr</a></span><span class="op">)</span></span>
<span><span class="fu">spark_install</span><span class="op">(</span><span class="op">)</span> <span class="co">#2.4.3 and 2.7 as default</span></span></code></pre>
</div>
</div>
<h3 id="config">Config</h3>
<p>For SAS reading package : use saurfangs Spark package for SAS
reading</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">config</span> <span class="op">&lt;-</span> <span class="fu">spark_config</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">config</span><span class="op">[</span><span class="st">&quot;sparklyr.shell.packages&quot;</span><span class="op">]</span> <span class="op">=</span> <span class="st">&quot;saurfang:spark-sas7bdat:2.0.0-s_2.11&quot;</span></span>
<span><span class="va">config</span><span class="op">[</span><span class="st">&quot;sparklyr.shell.repositories&quot;</span><span class="op">]</span> <span class="op">=</span> <span class="st">&quot;https://repos.spark-packages.org/&quot;</span></span>
<span></span>
<span><span class="va">sc</span> <span class="op">=</span> <span class="fu">spark_connect</span><span class="op">(</span>master <span class="op">=</span> <span class="st">&quot;local&quot;</span>, config <span class="op">=</span> <span class="va">config</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="wrds-1">WRDS</h2>
<h3 id="setup-for-wrds">Setup for WRDS</h3>
<p>For more details, check wrds website<br />
<a href="https://wrds-www.wharton.upenn.edu/pages/support/programming-wrds/programming-r/r-from-your-computer/" class="uri">https://wrds-www.wharton.upenn.edu/pages/support/programming-wrds/programming-r/r-from-your-computer/</a></p>
<h3 id="install-package-rpostgres">Install package : Rpostgres</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&quot;RPostgres&quot;</span><span class="op">)</span></span>
<span><span class="co"># install.packages(&quot;RPostgres&quot;, repos = &quot;https://r-dbi.r-universe.dev&quot;)</span></span></code></pre>
</div>
</div>
<h3 id="pgpass-file">.pgpass file</h3>
<p>For local and WRDS cloud use <code>option(alt)</code> +
<code>cmd</code> + <code>enter</code> to run in terminal<br />
</p>
<pre><code>nano ~/.pgpass</code></pre>
<p>Save below inside .pgpass file</p>
<pre><code>wrds-pgdata.wharton.upenn.edu:9737:wrds:wrds_username:wrds_password</code></pre>
<p>Run below to secure file</p>
<pre><code>chmod 600 ~/.pgpass</code></pre>
<p>For Windows</p>
<pre><code>%APPDATA%\postgresql\pgpass.conf</code></pre>
<p>On CMD:</p>
<pre><code>echo wrds-pgdata.wharton.upenn.edu:9737:wrds:wrds_username:wrds_password &gt; %APPDATA%\postgresql\pgpass.conf</code></pre>
<h3 id="dbplyr-on-wrds">DBPLYR ON WRDS</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dbplyr.tidyverse.org/">dbplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpostgres.r-dbi.org">RPostgres</a></span><span class="op">)</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu"><a href="https://rpostgres.r-dbi.org/reference/Postgres.html">Postgres</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                 host<span class="op">=</span><span class="st">&#39;wrds-pgdata.wharton.upenn.edu&#39;</span>,</span>
<span>                 port<span class="op">=</span><span class="fl">9737</span>,</span>
<span>                 dbname<span class="op">=</span><span class="st">&#39;wrds&#39;</span>,</span>
<span>                 sslmode<span class="op">=</span><span class="st">&#39;require&#39;</span>,</span>
<span>                 user<span class="op">=</span><span class="st">&#39;mgson633&#39;</span></span>
<span>                 <span class="op">)</span></span></code></pre>
</div>
</div>
<p>WRDS table names</p>
<p><a href="https://wrds-www.wharton.upenn.edu/users/products/" class="uri">https://wrds-www.wharton.upenn.edu/users/products/</a></p>
<p>The solution is to either by explicit with:</p>
<p>crsp_a_stock.dsf crsp_m_stock.dsf crsp_q_stock.dsf</p>
<p>Dsf = tbl(con, in_schema(tr_ibes,act_epsus))</p>
<p>OR</p>
<p>dbExecute(con, SET search_path=crsp_a_stock) Dsf = tbl(con,
dsf)</p>
<h4 id="crsp">CRSP</h4>
<h5 id="sp500-identifiers">S&amp;P500 Identifiers</h5>
<p>Join dsf and dsenames (for ticker symbol) then query</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">dsf</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cusip</span>, <span class="va">permno</span>, <span class="va">date</span>, <span class="va">ret</span>, <span class="va">retx</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">year</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2018</span>,<span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">right_join</a></span><span class="op">(</span><span class="va">dsenames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">permno</span>,<span class="va">namedt</span>,<span class="va">nameendt</span>,<span class="va">permno</span>,<span class="va">ticker</span><span class="op">)</span>, </span>
<span>                   sql_on <span class="op">=</span> <span class="st">&#39;&quot;LHS&quot;.date &gt;= &quot;RHS&quot;.namedt AND &quot;LHS&quot;.date &lt;= &quot;RHS&quot;.nameendt AND &quot;LHS&quot;.permno = &quot;RHS&quot;.permno&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ticker</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html">local</a></span><span class="op">(</span><span class="va">special_tickers</span><span class="op">$</span><span class="va">Ticker</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
S&amp;P500 Constituent
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># crsp.dsp500list / crsp.msp500list</span></span>
<span><span class="va">dsp500list</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html">in_schema</a></span><span class="op">(</span><span class="st">&#39;crsp_a_indexes&#39;</span>, <span class="st">&#39;dsp500list&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># daily stock file S&amp;P500 list</span></span>
<span><span class="va">snp500</span> <span class="op">=</span> <span class="va">dsp500list</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">start</span> <span class="op">&lt;=</span> <span class="st">&#39;2019-01-01&#39;</span>,  <span class="va">ending</span> <span class="op">&gt;=</span> <span class="st">&#39;2021-03-31&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">setDT</span> </span>
<span><span class="co"># samples to be included during the sample period</span></span>
<span></span>
<span><span class="va">snp500</span><span class="op">[</span>,<span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/duplicated.html">uniqueN</a></span><span class="op">(</span><span class="va">permno</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<p>Permno to TICKER : use Company identifiers</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># crsp.dsenames / crsp.msenames</span></span>
<span><span class="va">dsenames</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html">in_schema</a></span><span class="op">(</span><span class="st">&#39;crsp_a_stock&#39;</span>, <span class="st">&#39;dsenames&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># daily names</span></span>
<span><span class="va">dsenames</span> <span class="op">=</span> <span class="va">dsenames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">setDT</span></span></code></pre>
</div>
</div>
<p>Merge</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># names that are valid at 2019-01-01, and registered as snp throughout the sample period (2019 ~ 2021 Mar)</span></span>
<span><span class="va">snp500_tickers</span> <span class="op">=</span> <span class="va">dsenames</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">permno</span>, <span class="va">namedt</span>, <span class="va">nameendt</span>, <span class="va">ncusip</span>, <span class="va">ticker</span>, <span class="va">tsymbol</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span><span class="va">nameendt</span> <span class="op">&gt;=</span> <span class="st">&#39;2019-01-01&#39;</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span><span class="va">snp500</span>, on <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">permno</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="va">.</span><span class="op">[</span><span class="va">start</span> <span class="op">&lt;=</span> <span class="st">&#39;2019-01-01&#39;</span> <span class="op">&amp;</span> <span class="va">ending</span> <span class="op">&gt;=</span> <span class="st">&#39;2021-03-31&#39;</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="va">.</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">ticker</span><span class="op">)</span><span class="op">]</span></span></code></pre>
</div>
</div>
<h5 id="dsfmsf">DSF,MSF</h5>
<p>Daily / monthly stock files</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">dsf</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html">in_schema</a></span><span class="op">(</span><span class="st">&#39;crsp_a_stock&#39;</span>, <span class="st">&#39;dsf&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dsfhdr</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>,<span class="st">&#39;dsfhdr&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Merge identifier (permno to cusip and ticker)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">dsenames</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html">in_schema</a></span><span class="op">(</span><span class="st">&#39;crsp_a_stock&#39;</span>, <span class="st">&#39;dsenames&#39;</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">setDT</span></span>
<span></span>
<span></span>
<span><span class="va">dsf2</span><span class="op">[</span>,<span class="va">date_copy</span> <span class="op">:=</span> <span class="va">date</span><span class="op">]</span></span>
<span><span class="va">dsf2</span> <span class="op">=</span> <span class="va">dsenames</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">permno</span>, <span class="va">ticker</span>, <span class="va">namedt</span>,<span class="va">nameendt</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="va">dsf2</span>, on <span class="op">=</span> <span class="fu">.</span><span class="op">(</span>permno <span class="op">=</span> <span class="va">permno</span>, <span class="va">namedt</span> <span class="op">&lt;=</span> <span class="va">date_copy</span>, <span class="va">nameendt</span> <span class="op">&gt;=</span> <span class="va">date_copy</span><span class="op">)</span><span class="op">]</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">permno</span>,<span class="va">ticker</span>,<span class="va">date</span>, <span class="va">ret</span>,<span class="va">retx</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setattr.html">setnames</a></span><span class="op">(</span><span class="va">dsf2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;PERMNO&#39;</span>,<span class="st">&#39;TICKER&#39;</span>,<span class="st">&#39;date&#39;</span>,<span class="st">&#39;RET&#39;</span>,<span class="st">&#39;RETX&#39;</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">query</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">con</span>,</span>
<span>            <span class="st">&quot;</span></span>
<span><span class="st">            select a.*, b.date, b.ret</span></span>
<span><span class="st">            from crsp.msp500list as a,</span></span>
<span><span class="st">            crsp.msf as b</span></span>
<span><span class="st">            where a.permno=b.permno</span></span>
<span><span class="st">            and b.date &gt;= a.start and b.date&lt;= a.ending</span></span>
<span><span class="st">            and b.date&gt;=&#39;01/01/2000&#39;</span></span>
<span><span class="st">            order by date;</span></span>
<span><span class="st">            &quot;</span><span class="op">)</span></span>
<span><span class="va">sp500</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">query</span><span class="op">)</span></span>
<span><span class="va">sp500</span></span></code></pre>
</div>
</div>
<h4 id="trace">Trace</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># connect to trace data</span></span>
<span><span class="va">trace</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">&#39;trace&#39;</span><span class="op">)</span></span>
<span><span class="co"># lazy query</span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="va">trace</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">year</a></span><span class="op">(</span><span class="va">trd_exctn_dt</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">2005</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">trd_exctn_dt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span> <span class="op">==</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># last observations for each group</span></span>
<span><span class="co"># show example</span></span>
<span><span class="va">query</span></span>
<span><span class="co"># show query</span></span>
<span><span class="va">query</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">show_query</span></span>
<span><span class="co"># submit and retrieve</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="va">query</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span></span></code></pre>
</div>
</div>
<h4 id="compustat">COMPUSTAT</h4>
<p>Daily short interest file</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">comp</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">&#39;sec_shortint&#39;</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="va">comp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">query</span></span></code></pre>
</div>
</div>
<p>Fundamentals Annual (funda)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">funda</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">&#39;funda&#39;</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="va">funda</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># select(gvkey, tic, cusip, fyr, dvt) %&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span></span>
<span><span class="va">temp</span></span></code></pre>
</div>
</div>
<h4 id="taq">TAQ</h4>
<p>General information for TAQ on WRDS <a href="https://wrds-www.wharton.upenn.edu/pages/support/manuals-and-overviews/taq/general/wrds-overview-taq/" class="uri">https://wrds-www.wharton.upenn.edu/pages/support/manuals-and-overviews/taq/general/wrds-overview-taq/</a></p>
<p>Due to the very large size of the data, each year is located in a
different physical directory: /wrds/taq.YYYY for Monthly and
/wrds/nyse/taq_msecYYYY for Daily</p>
<h5 id="nbbom">NBBOM</h5>
<p>Millisecond national best bid and offer (NBBO) file</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/collectivemedia/tictoc">tictoc</a></span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">nbbom</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">&#39;nbbom_20200102&#39;</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="va">nbbom</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">sym_root</span>, <span class="va">sym_suffix</span>, <span class="va">time_m</span>, <span class="va">best_bid</span>,<span class="va">best_bidsiz</span>, <span class="va">best_ask</span>, <span class="va">best_asksiz</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sym_suffix</span><span class="op">)</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">9</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>temp<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">minute</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">sym_root</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span>, <span class="va">temp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html">toc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># 451.146 sec elapsed # including download &amp; memory loading</span></span>
<span><span class="co"># 371.793 sec elapsed</span></span></code></pre>
</div>
</div>
<h5 id="wct">WCT</h5>
<p>WRDS Consolidated Trades (WCT)</p>
<p>The NBBOs Bid and Ask midpoints are matched to each trade at seconds
0, -1, -2 and -5 relative to their trade time, and stored along with
trades in the same datasets.</p>
<p>These WRDS-generated trades files are labeled as
<code>wct_YYYYMMDD</code>. This approach provides users with all
necessary components to infer the trade directions, regardless of what
specifications and assumptions are employed on the trade-quote lag or on
trade filters. Please see the Lee and Ready research application for
more information. Additionally the following article, Matching TAQ
Trades and Quotes in the Presence of Multiple Quotes, may be useful for
understanding more about WCT files.</p>
<p>Millisecond stock trading volume and buy/sell indicator using Lee
Ready algorithm</p>
<p>SAS code is here: <a href="https://wrds-www.wharton.upenn.edu/pages/support/applications/microstructure-research/lee-and-ready-1991-algorithm/" class="uri">https://wrds-www.wharton.upenn.edu/pages/support/applications/microstructure-research/lee-and-ready-1991-algorithm/</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">wct</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">&#39;wct_20200102&#39;</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op">=</span> <span class="va">nbbom</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">sym_root</span>, <span class="va">sym_suffix</span>, <span class="va">time_m</span>, <span class="va">best_bid</span>,<span class="va">best_bidsiz</span>, <span class="va">best_ask</span>, <span class="va">best_asksiz</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">sym_suffix</span><span class="op">)</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">9</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span><span class="op">&lt;=</span><span class="fl">15</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>temp<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">minute</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">sym_root</span>, <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/IDateTime.html">hour</a></span><span class="op">(</span><span class="va">time_m</span><span class="op">)</span>, <span class="va">temp</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/ranking.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">query</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html">toc</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="optionmetrics">OptionMetrics</h4>
<p><code>optionmnames</code> :</p>
<p>Includes 1) secid, symbol, optionid, root, suffix, effect_date,
cusip, ticker, class, issuer, issue</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">opnames</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>,<span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html">in_schema</a></span><span class="op">(</span><span class="st">&#39;optionm_all&#39;</span>, <span class="st">&#39;optionmnames&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sample2</span> <span class="op">=</span> <span class="va">opnames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span></span>
<span><span class="va">sample2</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">opnames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">optionid</span> <span class="op">==</span> <span class="fl">130940651</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">opnames</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>To match, should use <em>secid and effect_date</em></p>
<p><code>opprcd</code> : Option Prices data</p>
<p>includes 1) option price 2) delta gamma open_interest implied_vol
vega theta</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">opprcd</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html">in_schema</a></span><span class="op">(</span><span class="st">&#39;optionm_all&#39;</span>,<span class="st">&#39;opprcd2020&#39;</span><span class="op">)</span><span class="op">)</span> <span class="co"># It includes year</span></span>
<span><span class="va">sample</span> <span class="op">=</span> <span class="va">opprcd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">collect</span></span>
<span><span class="va">sample</span></span></code></pre>
</div>
</div>
<p><code>secprd2020</code> : Underlying Security price data by year</p>
<p>includes secid symbol optionid root suffix effect_date cusip ticker
class issuer issue</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">secprd2020</span> <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="fu"><a href="https://dbplyr.tidyverse.org/reference/in_schema.html">in_schema</a></span><span class="op">(</span><span class="st">&#39;optionm_all&#39;</span>,<span class="st">&#39;secprd2020&#39;</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">secprd2020</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h3 id="rpostgres-1">RPostgres</h3>
<h4 id="connection">Connection</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpostgres.r-dbi.org">RPostgres</a></span><span class="op">)</span></span>
<span><span class="va">wrds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span><span class="fu"><a href="https://rpostgres.r-dbi.org/reference/Postgres.html">Postgres</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                  host<span class="op">=</span><span class="st">&#39;wrds-pgdata.wharton.upenn.edu&#39;</span>,</span>
<span>                  port<span class="op">=</span><span class="fl">9737</span>,</span>
<span>                  dbname<span class="op">=</span><span class="st">&#39;wrds&#39;</span>,</span>
<span>                  sslmode<span class="op">=</span><span class="st">&#39;require&#39;</span>,</span>
<span>                  user<span class="op">=</span><span class="st">&#39;mgson633&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h4 id="query">Query</h4>
<p>Query is done through combinations of query + fetch + close</p>
<ol type="1">
<li><code>dbSendQuery()</code> : Send query to existing connection,
<code>wrds</code></li>
<li><code>dbFetch()</code> : Fetch data from resulting response
<code>n</code> : number of rows fetching</li>
<li><code>dbClearResult(res)</code> : closes connection (response)</li>
</ol>
<h4 id="all-libraries">All libraries</h4>
<p>All data libraries available at WRDS</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, <span class="st">&quot;select distinct table_schema</span></span>
<span><span class="st">                   from information_schema.tables</span></span>
<span><span class="st">                   </span></span>
<span><span class="st">                   order by table_schema&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">temp</span></span></code></pre>
</div>
</div>
<h4 id="all-datasets-within-library">All datasets within library</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                   <span class="st">&quot;</span></span>
<span><span class="st">                   select distinct table_name</span></span>
<span><span class="st">                   from information_schema.columns</span></span>
<span><span class="st">                   where table_schema=&#39;taqm_2021&#39;</span></span>
<span><span class="st">                   order by table_name</span></span>
<span><span class="st">                   &quot;</span></span>
<span>                   <span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span>, n<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">View</span></span></code></pre>
</div>
</div>
<h4 id="all-columns-within-dataset">All columns within dataset</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                   <span class="st">&quot;</span></span>
<span><span class="st">                   select column_name</span></span>
<span><span class="st">                   from information_schema.columns</span></span>
<span><span class="st">                   where table_schema=&#39;optionm&#39;</span></span>
<span><span class="st">                   and table_name=&#39;opvold&#39;</span></span>
<span><span class="st">                   order by column_name</span></span>
<span><span class="st">                   &quot;</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span>, n<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">temp</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Check the table</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                   <span class="st">&quot;</span></span>
<span><span class="st">                   select *</span></span>
<span><span class="st">                   from taqm_2011.ctm_20110401</span></span>
<span><span class="st">                   limit 1000</span></span>
<span><span class="st">                   &quot;</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span>, n<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">View</span></span>
<span></span>
<span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                   <span class="st">&quot;</span></span>
<span><span class="st">                   select *</span></span>
<span><span class="st">                   from taqmsec.ctm_20201201</span></span>
<span><span class="st">                   limit 1000</span></span>
<span><span class="st">                   &quot;</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span>, n<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">View</span></span></code></pre>
</div>
</div>
<h4 id="postgresql">PostgreSQL</h4>
<h5 id="wildcards">Wildcards</h5>
<p><code>%</code> matchs any numbers of characters <code>_</code> matchs
only ne character</p>
<h5 id="in-between-like">IN, BETWEEN, LIKE</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>  SELECT <span class="sc">*</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  FROM baby_names</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  WHERE </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  state <span class="fu">IN</span>(<span class="st">&#39;CA&#39;</span>, <span class="st">&#39;NY&#39;</span>, <span class="st">&#39;TX&#39;</span>) and</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  state NOT <span class="fu">IN</span>(<span class="st">&#39;FL&#39;</span>, <span class="st">&#39;GA&#39;</span>) and</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  year BETWEEN <span class="dv">2010</span> and <span class="dv">2014</span> and</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>  name LIKE <span class="st">&#39;J%n&#39;</span></span></code></pre></div>
</div>
<h5 id="programmatic-query">Programmatic Query</h5>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">mytext</span> <span class="op">=</span> <span class="st">&#39;taqmsec.cqm_20201201&#39;</span></span>
<span><span class="va">symbols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;AAPL&#39;</span>,<span class="st">&#39;AA&#39;</span><span class="op">)</span></span>
<span><span class="va">symbols1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/shQuote.html">shQuote</a></span><span class="op">(</span><span class="va">symbols</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_c.html">str_c</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">&#39;,&#39;</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span></span>
<span>                  <span class="st">&quot;</span></span>
<span><span class="st">                  SELECT sym_root as symbol, date, time_m, bid, bidsiz, ask, asksiz</span></span>
<span><span class="st">                  FROM {mytext}</span></span>
<span><span class="st">                  WHERE </span></span>
<span><span class="st">                  bid !=0 and </span></span>
<span><span class="st">                  ask !=0 and </span></span>
<span><span class="st">                  sym_root IN ({symbols1})</span></span>
<span><span class="st">                  LIMIT 1000</span></span>
<span><span class="st">                  &quot;</span></span>
<span>                  <span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h5 id="dates-and-times">Dates and Times</h5>
Use <code>extract</code> function to extract year/month/hour etc.
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                   <span class="st">&quot;</span></span>
<span><span class="st">                   SELECT cusip_id, bond_sym_id, trd_exctn_dt</span></span>
<span><span class="st">                   FROM trace.trace_btds144a</span></span>
<span><span class="st">                   WHERE extract(year from trd_exctn_dt) &lt;= 2005</span></span>
<span><span class="st">                   LIMIT 100</span></span>
<span><span class="st">                   &quot;</span></span>
<span>                   <span class="op">)</span></span></code></pre>
</div>
</div>
<h5 id="trace-examples">TRACE examples</h5>
<p>TRACE btds query</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                  <span class="st">&quot;</span></span>
<span><span class="st">                  SELECT *</span></span>
<span><span class="st">                  FROM trace.trace</span></span>
<span><span class="st">                  WHERE extract(year from trd_exctn_dt) &lt;= 2005</span></span>
<span><span class="st">                  LIMIT 100</span></span>
<span><span class="st">                  &quot;</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">trace2002.2005</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>TRACE btds 144a query</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                   <span class="st">&quot;</span></span>
<span><span class="st">                   SELECT cusip_id, bond_sym_id, trd_exctn_dt</span></span>
<span><span class="st">                   FROM trace.trace_btds144a</span></span>
<span><span class="st">                   WHERE extract(year from trd_exctn_dt) &lt;= 2005</span></span>
<span><span class="st">                   LIMIT 100</span></span>
<span><span class="st">                   &quot;</span></span>
<span>                   <span class="op">)</span></span>
<span></span>
<span><span class="va">trace_btds2002.2005</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h5 id="compustat-examples">Compustat examples</h5>
<p>Compustat fundamental annual</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>,</span>
<span>                  <span class="st">&quot;</span></span>
<span><span class="st">                  select gvkey, datadate, fyear,cusip, at,ch,mkvalt,revt,xint,oibdp,ppegt</span></span>
<span><span class="st">                  from compa.funda</span></span>
<span><span class="st">                  where</span></span>
<span><span class="st">                  consol =&#39;C&#39; and</span></span>
<span><span class="st">                  indfmt = &#39;INDL&#39; and</span></span>
<span><span class="st">                  datafmt = &#39;STD&#39; and</span></span>
<span><span class="st">                  popsrc = &#39;D&#39; and</span></span>
<span><span class="st">                  curcd = &#39;USD&#39;</span></span>
<span><span class="st">                  &quot;</span></span>
<span>                  <span class="op">)</span></span></code></pre>
</div>
</div>
<p>Compustat fundamental quarterly</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>,</span>
<span>                  <span class="st">&quot;</span></span>
<span><span class="st">                  select *</span></span>
<span><span class="st">                  from comp.fundq</span></span>
<span><span class="st">                  where</span></span>
<span><span class="st">                  consol =&#39;C&#39; and</span></span>
<span><span class="st">                  indfmt = &#39;INDL&#39; and</span></span>
<span><span class="st">                  popsrc = &#39;D&#39; and</span></span>
<span><span class="st">                  datafmt = &#39;STD&#39; and</span></span>
<span><span class="st">                  curcdq = &#39;USD&#39;</span></span>
<span><span class="st">                  &quot;</span></span>
<span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Joining two compustat</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>, </span>
<span>                   <span class="st">&quot;select a.gvkey, a.datadate, a.tic,</span></span>
<span><span class="st">                   a.conm, a.at, a.lt, b.prccm, b.cshoq</span></span>
<span><span class="st">                   from comp.funda a join comp.secm b</span></span>
<span><span class="st">                   on a.gvkey = b.gvkey</span></span>
<span><span class="st">                   and a.datadate = b.datadate</span></span>
<span><span class="st">                   where a.tic = &#39;IBM&#39;</span></span>
<span><span class="st">                   and a.datafmt = &#39;STD&#39;</span></span>
<span><span class="st">                   and a.consol = &#39;C&#39;</span></span>
<span><span class="st">                   and a.indfmt = &#39;INDL&#39;&quot;</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span>, n <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbClearResult.html">dbClearResult</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre>
</div>
</div>
<h5 id="crsp-examples">CRSP examples</h5>
<p>CCM link table</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>,<span class="st">&quot;</span></span>
<span><span class="st">                  select * </span></span>
<span><span class="st">                  from crsp.ccmxpf_lnkhist</span></span>
<span><span class="st">                  &quot;</span><span class="op">)</span></span>
<span><span class="va">crspa.link</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="va">crspa.link</span></span></code></pre>
</div>
</div>
<p>CRSP msenames</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>,<span class="st">&quot;</span></span>
<span><span class="st">                  select * </span></span>
<span><span class="st">                  from crsp.msenames</span></span>
<span><span class="st">                  &quot;</span><span class="op">)</span></span>
<span><span class="va">temp</span> <span class="op">=</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbFetch.html">dbFetch</a></span><span class="op">(</span><span class="va">res</span>, n<span class="op">=</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">temp</span></span></code></pre>
</div>
</div>
<p>CRSP daily stock file</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dbi.r-dbi.org/reference/dbSendQuery.html">dbSendQuery</a></span><span class="op">(</span><span class="va">wrds</span>,</span>
<span>                  <span class="st">&quot;select *</span></span>
<span><span class="st">                  from crsp.dsf</span></span>
<span><span class="st">                  &quot;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>CCM Linktable SAS Query</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># Code from Phil</span></span>
<span></span>
<span><span class="co"># 1. Merge permno on Compustat using linktable</span></span>
<span></span>
<span><span class="co"># proc sql;</span></span>
<span><span class="co">#   create table comp2 as</span></span>
<span><span class="co">#   select a.*, b.lpermno as permno</span></span>
<span><span class="co">#   from key_control as a left join crsp.ccmxpf_lnkhist as b</span></span>
<span><span class="co">#   on a.gvkey_string=b.gvkey and b.linkprim in (&#39;P&#39;, &#39;C&#39;) and</span></span>
<span><span class="co">#   b.LINKTYPE in (&#39;LU&#39;, &#39;LC&#39;) and</span></span>
<span><span class="co">#   a.datadate &gt;= b.LINKDT and (a.datadate &lt;= b.LINKENDDT or missing(b.LINKENDDT))</span></span>
<span><span class="co">#   order by gvkey, datadate;</span></span>
<span><span class="co"># quit;</span></span>
<span><span class="co"># </span></span>
<span> </span>
<span><span class="co"># 2. Merge ncusip and others on Compustat using msenames</span></span>
<span></span>
<span><span class="co"># proc sql;</span></span>
<span><span class="co">#       create table comp3</span></span>
<span><span class="co">#       as select a.*, b.ncusip, b.COMNAM,b.siccd, b.ticker as ticker_crsp</span></span>
<span><span class="co">#       from comp2 as a left join (select distinct ncusip, COMNAM, permno, namedt, nameendt, ticker, siccd from crsp.msenames</span></span>
<span><span class="co">#     where not missing(ncusip)) as b</span></span>
<span><span class="co">#       on a.permno = b.permno and b.namedt&lt;=a.datadate&lt;=b.nameendt;</span></span>
<span><span class="co"># quit;</span></span>
<span></span>
<span></span>
<span><span class="co"># rsubmit;</span></span>
<span><span class="co"># Data funda;</span></span>
<span><span class="co"># Set comp.funda;</span></span>
<span><span class="co"># Where at~=. Or at&gt;=0;</span></span>
<span><span class="co"># where sale~=. or sale&gt;=0;</span></span>
<span><span class="co"># where ebitda~=.;</span></span>
<span><span class="co"># Keep gvkey datadate;</span></span>
<span><span class="co"># Run;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># proc sql; </span></span>
<span><span class="co">#   create table getf_3 as </span></span>
<span><span class="co">#   select a.*, b.lpermno as permno_all</span></span>
<span><span class="co">#   from funda a left join crsp.ccmxpf_linktable b </span></span>
<span><span class="co">#     on a.gvkey eq b.gvkey </span></span>
<span><span class="co">#     and b.lpermno ne . </span></span>
<span><span class="co">#     and b.linktype in (&quot;LC&quot; &quot;LN&quot; &quot;LU&quot; &quot;LX&quot; &quot;LD&quot; &quot;LS&quot;) </span></span>
<span><span class="co">#     and b.linkprim IN (&quot;C&quot;, &quot;P&quot;)  </span></span>
<span><span class="co">#     and ((a.datadate &gt;= b.LINKDT) or b.LINKDT eq .B) and  </span></span>
<span><span class="co">#        ((a.datadate &lt;= b.LINKENDDT) or b.LINKENDDT eq .E)   ; </span></span>
<span><span class="co"># quit;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># proc sql;</span></span>
<span><span class="co">#       create table getf_4</span></span>
<span><span class="co">#       as select a.*, ncusip as ncusip_all </span></span>
<span><span class="co">#       from getf_3 as a left join (select distinct ncusip, COMNAM, permno, namedt, nameendt, ticker  from crsp.msenames</span></span>
<span><span class="co">#     where not missing(ncusip)) as b</span></span>
<span><span class="co">#       on a.permno_all = b.permno and b.namedt&lt;=a.datadate&lt;=b.nameendt;</span></span>
<span><span class="co"># quit;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># proc download data=getf_4 out=getf_4;run;</span></span>
<span><span class="co"># endrsubmit;</span></span>
<span><span class="co">#         </span></span>
<span><span class="co"># proc sql;</span></span>
<span><span class="co">#   create table comp2 as</span></span>
<span><span class="co">#   select a.*, b.lpermno as permno</span></span>
<span><span class="co">#   from key_control as a left join crsp.ccmxpf_lnkhist as b</span></span>
<span><span class="co">#   on a.gvkey_string=b.gvkey and b.linkprim in (&#39;P&#39;, &#39;C&#39;) and</span></span>
<span><span class="co">#   b.LINKTYPE in (&#39;LU&#39;, &#39;LC&#39;) and</span></span>
<span><span class="co">#   a.datadate &gt;= b.LINKDT and (a.datadate &lt;= b.LINKENDDT or missing(b.LINKENDDT))</span></span>
<span><span class="co">#   order by gvkey, datadate;</span></span>
<span><span class="co"># quit;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># proc sql;</span></span>
<span><span class="co">#       create table comp3</span></span>
<span><span class="co">#       as select a.*, b.ncusip, b.COMNAM,b.siccd, b.ticker as ticker_crsp</span></span>
<span><span class="co">#       from comp2 as a left join (select distinct ncusip, COMNAM, permno, namedt, nameendt, ticker siccd from crsp.msenames</span></span>
<span><span class="co">#     where not missing(ncusip)) as b</span></span>
<span><span class="co">#       on a.permno = b.permno and b.namedt&lt;=a.datadate&lt;=b.nameendt;</span></span>
<span><span class="co"># quit;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># rsubmit;</span></span>
<span><span class="co"># Data funda;</span></span>
<span><span class="co"># Set comp.funda;</span></span>
<span><span class="co"># Where at~=. Or at&gt;=0;</span></span>
<span><span class="co"># where sale~=. or sale&gt;=0;</span></span>
<span><span class="co"># where ebitda~=.;</span></span>
<span><span class="co"># Keep gvkey datadate;</span></span>
<span><span class="co"># Run;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># proc sql; </span></span>
<span><span class="co">#   create table getf_3 as </span></span>
<span><span class="co">#   select a.*, b.lpermno as permno_all</span></span>
<span><span class="co">#   from funda a left join crsp.ccmxpf_linktable b </span></span>
<span><span class="co">#     on a.gvkey eq b.gvkey </span></span>
<span><span class="co">#     and b.lpermno ne . </span></span>
<span><span class="co">#     and b.linktype in (&quot;LC&quot; &quot;LN&quot; &quot;LU&quot; &quot;LX&quot; &quot;LD&quot; &quot;LS&quot;) </span></span>
<span><span class="co">#     and b.linkprim IN (&quot;C&quot;, &quot;P&quot;)  </span></span>
<span><span class="co">#     and ((a.datadate &gt;= b.LINKDT) or b.LINKDT eq .B) and  </span></span>
<span><span class="co">#        ((a.datadate &lt;= b.LINKENDDT) or b.LINKENDDT eq .E)   ; </span></span>
<span><span class="co"># quit;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># proc sql;</span></span>
<span><span class="co">#       create table getf_4</span></span>
<span><span class="co">#       as select a.*, ncusip as ncusip_all </span></span>
<span><span class="co">#       from getf_3 as a left join (select distinct ncusip, COMNAM, permno, namedt, nameendt, ticker  from crsp.msenames</span></span>
<span><span class="co">#     where not missing(ncusip)) as b</span></span>
<span><span class="co">#       on a.permno_all = b.permno and b.namedt&lt;=a.datadate&lt;=b.nameendt;</span></span>
<span><span class="co"># quit;</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># proc download data=getf_4 out=getf_4;run;</span></span>
<span><span class="co"># endrsubmit;</span></span></code></pre>
</div>
</div>
<h5 id="taq-examples">TAQ examples</h5>
<pre><code>libname scratch &quot;/scratch/ufl/mgson633/&quot;;

%macro loop;

%let start_date=20200101;
%let end_date=20200331;
data scratch.quotes_&amp;end_date; stop; run;

%do %while (&amp;end_date &gt;= &amp;start_date);
    %let date_id = &amp;start_date;
    
    %if %sysfunc(exist(taqmsec.cqm_&amp;date_id)) %then %do;
    
        data quotes / view=quotes;
        set taqmsec.cqm_&amp;date_id (  /* where=(sym_root in(&quot;AAPL&quot;, &quot;MCD&quot;, &quot;AACQ&quot;, &quot;AAIC&quot;)) */  keep=sym_root sym_suffix date time_m bid bidsiz ask asksiz);
        if not missing(sym_suffix) then delete;
        time = floor(time_m/600);
        if (54 &lt;= time &lt;= 90) and bid NE 0 and ask NE 0 and bidsiz NE 0 and asksiz NE 0 then output;
        run;
    
        data quotes1 (drop=sym_suffix);
        set quotes;
        by sym_root time;
        where not missing(sym_root);
        if last.time then output; 
        run;
        
        data scratch.quotes_&amp;end_date; set scratch.quotes_&amp;end_date quotes1; run;
        
    %end;
    
%let start_date = %eval(&amp;start_date+1);
%end;

%mend loop;

%loop;</code></pre>
<p>National best bid and offer</p>
<pre><code>data quotes;
    set taqmsec.nbbom_20200102 (  where=(sym_root in(&quot;AAPL&quot;, &quot;MCD&quot;, &quot;AACQ&quot;, &quot;AAIC&quot;)) 
    keep=sym_root sym_suffix date time_m best_bid best_bidsiz best_ask best_asksiz);
    if not missing(sym_suffix) then delete;
    time = floor(time_m/600);
    if (54 &lt;= time &lt;= 90) then output;
run;
    
data quotes1 (drop=sym_suffix);
set quotes;
by sym_root time;
where not missing(sym_root);
if last.time then output; 
run;</code></pre>
<h2 id="batch-job-on-wrds">Batch Job on WRDS</h2>
<p>Info</p>
<p>Job Limits Both interactive and batch jobs have the following
limits:</p>
<p>You can use up to 5 concurrent jobs (10 Core Maximum), and may queue
any additional jobs. Additional jobs will wait in the queue until active
jobs have finished. You can use up to 150GB memory, and may queue any
additional jobs. Additional jobs will wait in the queue until your
current total memory allocation drops below the limit. Your subscribing
institution can run up to 10 concurrent jobs across all users who are
members of that institution, and may queue any additional jobs.
Additional jobs will wait in the queue until active jobs have finished.
Each active batch job may run for one week (168 hours). Each active
interactive job may run for 3 days (72 hours). Jobs running after the
limit has elapsed will be automatically terminated. Batch jobs
additionally have the following CPU and RAM usage restrictions:</p>
<p>By default, a WRDS Cloud job is assigned to 2 cores (for a total of 4
threads) per job. Users may request up to 8 cores (for a total of 16
threads) per job. By default, a WRDS Cloud job is assigned 8GB per core
(for a total of 16GB if left at the default core count). Users may
request up to 48GB RAM total per job (calculated as RAM * cores
requested).</p>
<p>Connect to wrds cloud system</p>
<pre><code>ssh mgson633@wrds-cloud.wharton.upenn.edu</code></pre>
<p>For interactive R jobs</p>
<pre><code>qrsh \# connect to the WRDS interactive node R --no-save --no-restore</code></pre>
<h3 id="batch-job-sas-example">Batch job SAS example</h3>
<p>When sourcing sas file directly</p>
<pre><code>qsas my_sample.sas</code></pre>
<p>When sourcing shell script</p>
<pre><code>qsub script.sh</code></pre>
<pre><code>#!/bin/bash
#$ -cwd
#$ -m abe
#$ -M gunsu.son@ufl.edu
#$ -pe onenode 8
#$ -l m_mem_free=6G

sas my_program.sas</code></pre>
<h3 id="batch-job-r-example">Batch job R example</h3>
<p>Maximum example</p>
<pre><code>#!/bin/bash
#$ -cwd
#$ -m abe
#$ -M gunsu.son@ufl.edu
#$ -pe onenode 8
#$ -l m_mem_free=6G

cd /home/ufl/mgson633/Projects/Fund_centrality/codes

R CMD BATCH run_batch2_17-21.R 17-21.out</code></pre>
<p>Above MAXIMUM for 1 job: 8 core, 48 GB ram</p>
<p>return log back to cwd, give email notification, 8 core, 6g mem per
core.</p>
<p>Default batch jobs: CPU Cores: 2 per job RAM Usage: 16GB per job</p>
<p>HARD LIMIT : 5 jobs with 150G Memory / 10 cores maximum</p>
<h3 id="submit-batch-job">Submit batch job</h3>
<pre><code>qsub my_program.sh
qsub -q all.q@wrds-sas24-h my_program.sh </code></pre>
<h3 id="managing-jobs">Managing jobs</h3>
<p>Show all currently-running and queued jobs submitted by all users</p>
<pre><code>qstat -u \* </code></pre>
<p>Show all compute nodes, including number of processors and amount of
RAM per node</p>
<pre><code>qhost
qhost -j </code></pre>
<p>Delete your job #1234567</p>
<pre><code>qdel 1234567 </code></pre>
<h3 id="request-more-computing-power">request more computing power</h3>
<p><a href="https://wrds-www.wharton.upenn.edu/pages/support/the-wrds-cloud/running-jobs/batch-jobs-wrds-cloud/" class="uri">https://wrds-www.wharton.upenn.edu/pages/support/the-wrds-cloud/running-jobs/batch-jobs-wrds-cloud/</a></p>
<p>Requesting Additional CPU / RAM By default, the WRDS Cloud imposes
the following limitations on resource consumption (CPU and RAM) to
maintain a fair use environment for all WRDS users:</p>
<p>batch jobs: CPU Cores: 2 per job RAM Usage: 16GB per job interactive
jobs: CPU Cores: 1 per job RAM Usage: 8GB per job</p>
<p>If you need more than this for your job, you may request more up to
the following hard limits:</p>
<p>CPU Cores: 8 per job RAM Usage: 48GB Total per Job</p>
<pre><code>\#!/bin/bash 
\#\$ -cwd 
\#\$ -pe onenode 8 
\#\$ -l m_mem_free=6G</code></pre>
<h2 id="hipergator">HiPerGator</h2>
<p>Log-in nodes : limit 16 cores, 64GB ram, 10 mins</p>
<p>Do not run programs on login nodes</p>
<p>HiperGator 1 : 4 sockets, 16cores each - 64 cores on node , 250GB ram
(retired) HiperGator 2 : 2 sockets, 16cores each - 32 cores on node ,
120GB ram HiperGator 3 : 8 sockets, 16cores each - 128 cores on node,
1024GB ram</p>
<p>More info : <code>nodeInfo</code></p>
<ul>
<li><p>Home Area: /home/<user></p>
<ul>
<li>40GB limit</li>
<li>scripts, code, small data</li>
<li>Do NOT use for job input/output</li>
</ul></li>
<li><p>Blue storage : /blue/<group>/<user> (hypergator 3.0) :
/ufrc/<group>/<user> is 2.0 ver</p>
<ul>
<li>ALL input/output from jobs should go here</li>
<li>/blue/nimalendran/matthewson</li>
</ul></li>
</ul>
<h3 id="base-info">Base Info</h3>
<p>To see running jobs</p>
<pre><code>sacct</code></pre>
<p>slurm info</p>
<pre><code>slurmInfo</code></pre>
<p>To browse all hypergator nodes specifiction : NodeInfo</p>
<pre><code>nodeInfo</code></pre>
<p>show QoS info</p>
<pre><code>showQos nimalendran
showQos nimalendran-b</code></pre>
<p>To check the disk quota for blue Currently we have 4TB quota for blue
storage</p>
<pre><code>blue_quota</code></pre>
<h3 id="connection-id">Connection &amp; ID</h3>
<p>Connecting from Mac (Connect to Log in nodes )</p>
<pre><code>ssh &lt;username&gt;@hpg.rc.ufl.edu</code></pre>
<p>Check group membership</p>
<pre><code>id

uid=3670(gunsu.son) gid=3446(nimalendran) groups=3446(nimalendran)</code></pre>
<p>Check Association of user</p>
<pre><code>showAssoc gunsu.son</code></pre>
<h3 id="connect">Connect</h3>
<h4 id="connect-to-development-server">connect to development
server</h4>
<p>From log in node to development, 60 mins</p>
<pre><code>srundev -t 60</code></pre>
<p>now node is from login to development</p>
<p>Instead, interactive on SLURM (connect to compute server) is another
option, see below SLURM INTERACTIVE <code>srun</code></p>
<h4 id="connect-to-to-compute-server">connect to to compute server</h4>
<pre><code>srun --partition=hpg-default --ntasks=1 --cpus-per-task=128 --qos=nimalendran-b --nodes=1 --mem=1024gb --time=96:00:00 --mail-type=END,FAIL --mail-user=gunsu.son@ufl.edu --pty bash -i</code></pre>
<h3 id="rstudio-server">RStudio Server</h3>
<h4 id="setup-1">Setup</h4>
<ol type="1">
<li>Installation</li>
</ol>
<p>Take a look at the server info:</p>
<pre><code>lsb_release -a</code></pre>
<p>HPG is RedHatEnterpriseServer Release is 7.7</p>
<p>RedHat/CentOS 7 is the right one for HPG.</p>
<pre><code>wget https://download2.rstudio.org/server/centos7/x86_64/rstudio-server-rhel-1.4.1717-x86_64.rpm
sudo yum install rstudio-server-rhel-1.4.1717-x86_64.rpm</code></pre>
<ol start="2" type="1">
<li>User Setup</li>
</ol>
<h3 id="run-r">Run R</h3>
<pre><code>module load R
R</code></pre>
<p>Check computing allocation of group</p>
<pre><code>slurmInfo nimalendran
sacct

showQos nimalendran</code></pre>
<p>SFTP Setup</p>
<ul>
<li>port 22</li>
<li>hpg.rc.ufl.edu</li>
</ul>
<h3 id="slurm">SLURM</h3>
<h4 id="slurm-interactive">SLURM INTERACTIVE</h4>
<p>You can request resources for an interactive session (i.e.job) and
start a command shell (bash, for example). Within that command shell you
will have access to the resources you requested and can run whatever
commands and processes you wish. Consider the example below. It will
give you 4 GB of memory for 8 hours on a real compute host and present
you, once the job starts, with an interactive command shell (bash). From
that shell you can run commands and launch processes just as you would
from any other host (login or otherwise).</p>
<p>QOS</p>
<pre><code>srun --partition=hpg2-compute --ntasks=1 --cpus-per-task=24 --qos=nimalendran --nodes=1  --mem-per-cpu=3gb --time=08:00:00 --pty bash -i</code></pre>
<p>QOS-b</p>
<p>Hypergator 2.0 : 1 node max = 32 cpu (2 socket 16 cores each) 125GB
ram</p>
<pre><code>srun --partition=hpg2-compute --ntasks=1 --cpus-per-task=32 --qos=nimalendran-b --nodes=1  --mem-per-cpu=3gb --time=08:00:00 --pty bash -i</code></pre>
<p>Hypergator 3.0 : 1 node max = 128 cpu (8 socket 16 cores each) 1TB
ram Check with <code>nodeInfo</code></p>
<pre><code>srun --partition=hpg-default --ntasks=1 --cpus-per-task=128 --qos=nimalendran-b --nodes=1 --mem-per-cpu=7gb --time=72:00:00 --pty bash -i</code></pre>
<p>Hypergator 3.0 : 1 node 100 cpu 600 GB ram</p>
<pre><code>srun --partition=hpg-default --ntasks=1 --cpus-per-task=100 --qos=nimalendran-b --nodes=1 --mem-per-cpu=6gb --time=08:00:00 --pty bash -i





srun --partition=hpg-default --nodes=10 --ntasks-per-node=1 --cpus-per-task=12 --qos=nimalendran-b --mem-per-cpu=6gb --time=08:00:00 --pty bash -i</code></pre>
<p>Suppose you need 16 cores. Here are some use cases:</p>
<p>Processes : think of a new terminal, or R instances</p>
<p>you use mpi and do not care about where those cores are distributed:
ntasks=16 you want to launch 16 independent processes (no
communication): ntasks=16 you want those cores to spread across
distinct nodes: ntasks=16 and ntasks-per-node=1 or ntasks=16 and
nodes=16 you want those cores to spread across distinct nodes and no
interference from other jobs: ntasks=16 nodes=16 exclusive you want
16 processes to spread across 8 nodes to have two processes per node:
ntasks=16 ntasks-per-node=2</p>
<p>you want 16 processes to stay on the same node: ntasks=16
ntasks-per-node=16 you want one process that can use 16 cores for
multithreading: ntasks=1 cpus-per-task=16 you want 4 processes that
can use 4 cores each for multithreading: ntasks=4 cpus-per-task=4</p>
<p>Slurm complicates this, however, by using the terms <code>core</code>
and <code>cpu</code> interchangeably depending on the context and Slurm
command. cpus-per-tasks= for example is actually specifying the
<code>number of cores</code> per task.</p>
<h4 id="submit-batch-jobs">Submit batch jobs</h4>
<p>Save .sh script and run the script file with
<code>sbatch job_file.sh</code></p>
<pre><code>#!/bin/bash
#SBATCH --job-name=slurm_r_similarity      # Job name
#SBATCH --mail-type=END,FAIL         # Mail events (NONE, BEGIN, END, FAIL, ALL)
#SBATCH --mail-user=gunsu.son@ufl.edu    # Where to send mail.  Set this to your email address
#SBATCH --ntasks=1                  # Number of MPI tasks (i.e. processes)
#SBATCH --cpus-per-task=64            # Number of cores per MPI task (multithreading)
#SBATCH --qos=nimalendran-b         # QOS
#SBATCH --nodes=1                    # Maximum number of nodes to be allocated
#SBATCH --ntasks-per-node=1         # Maximum number of tasks on each node
#SBATCH --ntasks-per-socket=1        # Maximum number of tasks on each socket
#SBATCH --distribution=cyclic:cyclic # Distribute tasks cyclically first among nodes and then among sockets within a node
#SBATCH --mem-per-cpu=3Gb          # Memory (i.e. RAM) per processor
#SBATCH --time=24:00:00              # Wall time limit (days-hrs:min:sec)
#SBATCH --output=R_run_log.log     # Path to the standard output and error files relative to the working directory
#SBATCH --partition=hpg2-compute   # To which partition


cd /blue/nimalendran/gunsu.son/projects/code


module load R

Rscript --vanilla slurm_work.R</code></pre>
<p>to check the queue : my job running on the server</p>
<pre><code>squeue -u username</code></pre>
<p>to cancel job</p>
<pre><code>scancel job_id_number</code></pre>
<p>historical info about jobs</p>
<pre><code>sacct</code></pre>
<h5 id="multiple-batch-jobs-in-parallel">Multiple batch jobs in
parallel</h5>
<p>You could ask for 29 tasks, 1 cpu per task (you will get from 29 cpus
on a node to 1 cpu in 29 different nodes), and in the slurm script you
should start your calculus with srun, telling srun to allocate one
task/cpu per chunk.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb95"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --ntasks=29</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co">#SBATCH --cpus-per-task=1</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="dt">{</span><span class="dv">1</span><span class="dt">..</span><span class="dv">29</span><span class="dt">}</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">srun</span> <span class="at">-n</span> 1 <span class="op">&lt;</span>your_script<span class="op">&gt;</span> <span class="va">$n</span> <span class="kw">&amp;</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a><span class="cf">done</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a><span class="bu">wait</span></span></code></pre></div>
</div>
<h4 id="mpi-jobs">MPI jobs</h4>
<p>To run MPI script, must use <code>srun</code></p>
<pre><code>srun --mpi=pmix_v2 myApp</code></pre>
<p>You must set ntasks=1, and then set cpus-per-task to the number of
OpenMP threads you wish to use.</p>
<p>1 node and multiple cores (say 64 cores with group-b QOS)</p>
<p>Maximum 32 workers and workers has 1 core, 2 nodes (server
computers), each nodes can have 16 max workers. Since server computers
have two sockets and each socket has 16 cores, setting ntasks per socket
to be half of that for fun, 8</p>
<pre><code>#SBATCH --ntasks =32
#SBATCH --cpus-per-task=1
#SBATCH --nodes =2
#SBATCH --ntasks-per-node=16
#SBATCH --ntasks-per-socket=8
#SBATCH --constraint=infiniband</code></pre>
<p>Other example</p>
<p>Using 4 server computer nodes. Each node can do 4 tasks in parallel
(ntasks per node). Each task can have 4 workers (cores).</p>
<pre><code>#SBATCH --ntasks =16
#SBATCH --cpus-per-task=4
#SBATCH --nodes =4
#SBATCH --ntasks-per-node=4
#SBATCH --ntasks-per-socket=2
#SBATCH --constraint=infiniband</code></pre>
<p>ntasks=# : Number of tasks (use with distributed parallelism).</p>
<p>ntasks-per-node=# : Number of tasks per node (use with distributed
parallelism).</p>
<p>cpus-per-task=# : Number of CPUs allocated to each task (use with
shared memory parallelism).</p>
<p>Q: if every node has 24 cores, is there any difference between these
commands?</p>
<p>sbatch ntasks 24 [] sbatch ntasks 1 cpus-per-task 24 []</p>
<p>Answer:</p>
<p>Yes there is a difference between those two submissions. You are
correct that usually ntasks is for mpi and cpus-per-task is for
multithreading, but lets look at your commands:</p>
<p>For your first example, the sbatch ntasks 24 [] will allocate a job
with 24 tasks. These tasks in this case are only 1 CPUs, but may be
split across multiple nodes. So you get a total of 24 CPUs across
multiple nodes.</p>
<p>For your second example, the sbatch ntasks 1 cpus-per-task 24 []
will allocate a job with 1 task and 24 CPUs for that task. Thus you will
get a total of 24 CPUs on a single node.</p>
<p>In other words, <strong>a task cannot be split across multiple
nodes</strong>. Therefore, using cpus-per-task will ensure it gets
allocated to the same node, while using ntasks can and may allocate it
to multiple nodes.</p>
<p>Suppose you need 16 cores. Here are some use cases:</p>
<p>you use mpi and do not care about where those cores are distributed:
ntasks=16 you want to launch 16 independent processes (no
communication): ntasks=16 you want those cores to spread across
distinct nodes: ntasks=16 and ntasks-per-node=1 or ntasks=16 and
nodes=16 you want those cores to spread across distinct nodes and no
interference from other jobs: ntasks=16 nodes=16 exclusive</p>
<p>exclusive ensures srun uses distinct CPUs for each job step</p>
<p>you want 16 processes to spread across 8 nodes to have two processes
per node: ntasks=16 ntasks-per-node=2 you want 16 processes to stay on
the same node: ntasks=16 ntasks-per-node=16 you want one process that
can use 16 cores for multithreading: ntasks=1 cpus-per-task=16 you
want 4 processes that can use 4 cores each for multithreading: ntasks=4
cpus-per-task=4</p>
<p><a href="https://login.scg.stanford.edu/faqs/cores/" class="uri">https://login.scg.stanford.edu/faqs/cores/</a></p>
<h4 id="h2o-on-slurm">H2O on SLURM</h4>
<pre><code>module load R
R</code></pre>
<p><a href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/faq/clusters.html#how-can-i-create-a-multi-node-h2o-cluster-on-a-slurm-system" class="uri">https://docs.h2o.ai/h2o/latest-stable/h2o-docs/faq/clusters.html#how-can-i-create-a-multi-node-h2o-cluster-on-a-slurm-system</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span></span>
<span><span class="co"># Check on the nodes we have access to.</span></span>
<span><span class="va">p</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&quot;SLURM nodes:&quot;</span>, <span class="va">node_list</span>, <span class="st">&quot;\n&quot;</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop up IPs of the allocated nodes.</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">node_list</span> <span class="op">!=</span> <span class="st">&quot;&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">id</span> <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">node_list</span>, <span class="st">&#39;(.*)\\[(.*)\\]&#39;</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">numbers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_match.html">str_match</a></span><span class="op">(</span><span class="va">node_list</span>, <span class="st">&#39;(.*)\\[(.*)\\]&#39;</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span>, <span class="st">&#39;,&#39;</span><span class="op">)</span></span>
<span>  <span class="va">nodes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strsplit.html">strsplit</a></span><span class="op">(</span><span class="va">node_list</span>, <span class="st">&quot;,&quot;</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">ips</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">args</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;hosts&quot;</span>, <span class="va">nodes</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span><span class="op">(</span><span class="st">&quot;getent&quot;</span>, args <span class="op">=</span> <span class="va">args</span>, stdout <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>    <span class="co"># Extract the IP from the result output.</span></span>
<span>    <span class="va">ips</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span><span class="st">&quot;^([^ ]+) +.*$&quot;</span>, <span class="st">&quot;\\1&quot;</span>, <span class="va">result</span>, perl <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&quot;SLURM IPs:&quot;</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">ips</span>, collapse<span class="op">=</span><span class="st">&quot;, &quot;</span><span class="op">)</span>, <span class="st">&quot;\n&quot;</span><span class="op">)</span></span>
<span>  <span class="co"># Combine into a network string for h2o.</span></span>
<span>  <span class="va">network</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">ips</span>, <span class="st">&quot;/32&quot;</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">&quot;,&quot;</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&quot;Network:&quot;</span>, <span class="va">network</span>, <span class="st">&quot;\n&quot;</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Specify how many nodes we want h2o to use.</span></span>
<span><span class="va">h2o_num_nodes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">ips</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Options to pass to java call:</span></span>
<span><span class="va">args</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="co"># -Xmx30g allocate 30GB of RAM per node. Needs to come before &quot;-jar&quot;</span></span>
<span>  <span class="st">&quot;-Xmx30g&quot;</span>,</span>
<span>  <span class="co"># Specify path to downloaded h2o jar.</span></span>
<span>  <span class="st">&quot;-jar ~/software/h2o-latest/h2o.jar&quot;</span>,</span>
<span>  <span class="co"># Specify a cloud name for the cluster.</span></span>
<span>  <span class="st">&quot;-name h2o_r&quot;</span>,</span>
<span>  <span class="co"># Specify IPs of other nodes.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">&quot;-network&quot;</span>, <span class="va">network</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">&quot;Args:\n&quot;</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">args</span>, collapse<span class="op">=</span><span class="st">&quot;\n&quot;</span><span class="op">)</span>, <span class="st">&quot;\n&quot;</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run once for each node we want to start.</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">node_i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">h2o_num_nodes</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&quot;\nLaunching h2o worker on&quot;</span>, <span class="va">ips</span><span class="op">[</span><span class="va">node_i</span><span class="op">]</span>, <span class="st">&quot;\n&quot;</span><span class="op">)</span></span>
<span>  <span class="va">new_args</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ips</span><span class="op">[</span><span class="va">node_i</span><span class="op">]</span>, <span class="st">&quot;java&quot;</span>, <span class="va">args</span><span class="op">)</span></span>
<span>  <span class="co"># Ssh into the target IP and launch an h2o worker with its own</span></span>
<span>  <span class="co"># output and error files. These could go in a subdirectory.</span></span>
<span>  <span class="va">cmd_result</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span><span class="op">(</span><span class="st">&quot;ssh&quot;</span>, args <span class="op">=</span> <span class="va">new_args</span>,</span>
<span>                       stdout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">&quot;h2o_out_&quot;</span>, <span class="va">node_i</span>, <span class="st">&quot;.txt&quot;</span><span class="op">)</span>,</span>
<span>                       stderr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">&quot;h2o_err_&quot;</span>, <span class="va">node_i</span>, <span class="st">&quot;.txt&quot;</span><span class="op">)</span>,</span>
<span>                       <span class="co"># Need to specify wait=F so that it runs in the background.</span></span>
<span>                       wait <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span>  <span class="co"># This should be 0.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">&quot;Cmd result:&quot;</span>, <span class="va">cmd_result</span>, <span class="st">&quot;\n&quot;</span><span class="op">)</span></span>
<span>  <span class="co"># Wait one second between inits.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">1L</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># Wait 3 more seconds to find all the nodes, otherwise we may only</span></span>
<span><span class="co"># find the node on localhost.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="fl">3L</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if h2o is running. We will see ssh processes and one java process.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system2.html">system2</a></span><span class="op">(</span><span class="st">&quot;ps&quot;</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;-ef&quot;</span>, <span class="st">&quot;| grep h2o.jar&quot;</span><span class="op">)</span>, stdout <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">h2oEnsemble</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to our existing h2o cluster.</span></span>
<span><span class="co"># Do not try to start a new server from R.</span></span>
<span><span class="fu">h2o.init</span><span class="op">(</span>startH2O <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#################################</span></span>
<span></span>
<span><span class="co"># Run H2O commands here.</span></span>
<span></span>
<span><span class="co">#################################</span></span>
<span><span class="fu">h2o.shutdown</span><span class="op">(</span>prompt <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h1 id="unix-shell">UNIX SHELL</h1>
<h2 id="head">Head</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">terminalExecute</span><span class="op">(</span><span class="st">&#39;head -n 5 data.csv&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="word-count">Word count</h2>
<p><code>wc</code></p>
<h2 id="list-files">List files</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>ls folder</span></code></pre></div>
</div>
<p>list files with pattern matching - using * (any)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>ls folder<span class="sc">/</span>regex</span></code></pre></div>
</div>
<h2 id="move-files">Move files</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">terminalExecute</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>mv fromPath toPath</span></code></pre></div>
</div>
<p>with pattern : use regex</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>mv crust.etcMC<span class="sc">*</span> <span class="er">/</span>home<span class="sc">/</span>out</span></code></pre></div>
</div>
<h1 id="latex-1">LaTeX</h1>
<h2 id="tinytex">TinyTex</h2>
<p><a href="https://yihui.org/tinytex/" class="uri">https://yihui.org/tinytex/</a></p>
<p>Install TinyTex</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&#39;tinytex&#39;</span><span class="op">)</span></span>
<span><span class="fu">tinytex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytex/man/install_tinytex.html">install_tinytex</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>In terminal, make the folder writable</p>
<pre><code>sudo chown -R `whoami`:admin /usr/local/bin</code></pre>
<h2 id="bibtex">BibTex</h2>
<p>Put this codebox on top of the code to identify the workding
folder</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co">#Set Environment Variables</span></span>
<span><span class="va">TEXINPUTS</span><span class="op">=</span><span class="st">&quot;~/Dropbox (UFL)/My Projects/Fund_centrality/code/latex&quot;</span> <span class="co">#Path to tex file in Windows</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>TEXINPUTS<span class="op">=</span><span class="st">&quot;~/Dropbox (UFL)/My Projects/Fund_centrality/code/latex&quot;</span>, BIBINPUTS<span class="op">=</span><span class="va">TEXINPUTS</span>,BSTINPUTS<span class="op">=</span><span class="va">TEXINPUTS</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#Path to texfiles in Windows, set BIB files and BST files the same</span></span>
<span></span>
<span><span class="co">#Run before clicking &quot;Compile PDF&quot;</span></span></code></pre>
</div>
</div>
<h3 id="package-install">package install</h3>
<p>Install missing packages from log file :</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="co"># put log file location</span></span>
<span><span class="fu">tinytex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytex/man/parse_install.html">parse_install</a></span><span class="op">(</span><span class="st">&#39;latex/beamer/uf_theme.log&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Search package name by filename</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb105"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="ex">tlmgr</span> search <span class="at">--global</span> <span class="at">--file</span> <span class="st">&quot;/authblk.sty&quot;</span></span></code></pre></div>
</div>
<p>Then the package name one level upper folder :
<code>preprint</code></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb106"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="ex">tlmgr</span> install preprint</span></code></pre></div>
</div>
<p>Usually the filename identical to the package name.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">tinytex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytex/man/tlmgr.html">tlmgr</a></span><span class="op">(</span><span class="st">&#39;install ae grfext&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>Or within the terminal</p>
<pre><code>tlmgr install ae grfext</code></pre>
<h2 id="sweave">Sweave</h2>
<p>Put this</p>
<pre><code>\\SweaveOpts{concordance=TRUE}</code></pre>
<h2 id="knitr">Knitr</h2>
<p>Use package PatchSynctex for concordance, and setting working
directory for .bib recognition.</p>
<pre><code>\documentclass[11pt]{article}

&lt;&lt;Setup, eval=T, echo=FALSE, include = FALSE, results=&#39;hide&#39;&gt;&gt;=
opts_knit$set(concordance=TRUE, self.contained=TRUE)##$
require(patchSynctex)
setwd(&#39;~/Dropbox (UFL)/My Projects/Fund_centrality/code/latex&#39;)
Sys.setenv(TEXINPUTS=getwd(),
BIBINPUTS=getwd(),
BSTINPUTS=getwd())
@

\usepackage[margin=1in]{geometry} % for margin set
\usepackage{setspace} % for double spacing
\usepackage{hyperref} % hyperlinks</code></pre>
<h2 id="stargazer">Stargazer</h2>
<p>Descriptive statistics table</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">stargazer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/stargazer/man/stargazer.html">stargazer</a></span><span class="op">(</span><span class="va">iris</span>, </span>
<span>                     type<span class="op">=</span><span class="st">&#39;text&#39;</span>, </span>
<span>                     title <span class="op">=</span><span class="st">&#39;Descriptive stat, iris&#39;</span>,</span>
<span>                     notes <span class="op">=</span> <span class="st">&#39;This is note of the table.&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<p>T statistics instead of standard error</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/base/trace.html">trace</a></span><span class="op">(</span><span class="fu">stargazer</span><span class="fu">:::</span><span class="va">.stargazer.wrap</span>, edit <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># .format.t.stats.left &lt;- &quot;t = &quot; and .format.t.stats.right &lt;- &quot;&quot; modify this, line at (7050~7060)</span></span></code></pre>
</div>
</div>
<p>My example of regression table</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu">stargazer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">spec1</span>,<span class="va">spec2</span>,<span class="va">spec3</span>,<span class="va">spec4</span>,<span class="va">spec5</span>,<span class="va">spec6</span><span class="op">)</span>, </span>
<span>          <span class="co"># dep.var.caption = &#39;Dependant Variables&#39;,</span></span>
<span>          <span class="co"># initial.zero = F</span></span>
<span>          <span class="co"># type=&#39;text&#39;,</span></span>
<span>          </span>
<span>          report<span class="op">=</span><span class="st">&#39;vc*t&#39;</span>,</span>
<span>          label <span class="op">=</span> <span class="st">&#39;tab:table3&#39;</span>,</span>
<span>          digits<span class="op">=</span><span class="fl">3</span>,</span>
<span>          title <span class="op">=</span> <span class="st">&quot;Holding Distinctiveness and Alpha&quot;</span>,</span>
<span>          dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;$Alpha_{t}$&#39;</span>,<span class="st">&#39;$Alpha_{t+1}$&#39;</span><span class="op">)</span>,</span>
<span>          covariate.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;Centraltity&#39;</span>,<span class="st">&#39;Concentration&#39;</span>,<span class="st">&#39;ln(Size)&#39;</span>,<span class="st">&#39;Age&#39;</span>,<span class="st">&#39;Expense Ratio&#39;</span>,<span class="st">&#39;Turnover Ratio&#39;</span>,<span class="st">&#39;Flow&#39;</span>,<span class="st">&#39;Centrality * Concentration&#39;</span><span class="op">)</span>,</span>
<span>          add.lines <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Fund Fixed Effect&quot;</span>, <span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Month Fixed Effect&quot;</span>, <span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span><span class="op">)</span>,</span>
<span>                           <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&quot;Fund SE Cluster&quot;</span>, <span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span>,<span class="st">&quot;Yes&quot;</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          omit.stat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">&#39;rsq&#39;</span>,<span class="st">&#39;ser&#39;</span><span class="op">)</span>, <span class="co"># omit rsquared, standard error residual</span></span>
<span>          omit.table.layout <span class="op">=</span> <span class="st">&quot;n&quot;</span> <span class="co"># omit notes below </span></span>
<span>          <span class="op">)</span> </span></code></pre>
</div>
</div>
<h1 id="git-github">Git (Github)</h1>
<p>Default git installation (MacOS)</p>
<pre><code>/usr/bin/git</code></pre>
<p>Git : version control of folder and all files</p>
<p>Staging area : waiting stage that will be committed finally in
later</p>
<p>Git has a staging area in which it stores files with changes you want
to save that havent been saved yet.</p>
<h2 id="basic-commands-1">Basic Commands</h2>
<h3 id="status">status</h3>
<p>Status of git (which files are modified but not not staged for
commitment?, or which files are staged to be committed?)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb111"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> status</span></code></pre></div>
</div>
<h3 id="diff">diff</h3>
<p>Show the modified part of the files</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb112"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># See what changes have made</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff <span class="co"># show all changes </span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff file1 <span class="co"># comapre previous filname1 and revised filename1 </span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff <span class="at">-r</span> HEAD <span class="co"># -r : compare to particular revision, HEAD : the most recent commit</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff <span class="at">-r</span> HEAD<span class="pp">~</span>1 <span class="co"># HEAD~1 refers to a commit before most recent commit</span></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="co"># compared to the most recent commitment, show all changes </span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff <span class="at">-r</span> HEAD file1 <span class="co"># compare file1 with most recent commitment</span></span></code></pre></div>
</div>
<p>Show the difference between two commits</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb113"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff ID1..ID2 <span class="co"># two hash IDs that are connected through dotdot</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff abc123..def456</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> diff HEAD..HEAD<span class="pp">~</span>2</span></code></pre></div>
</div>
<h3 id="add">add</h3>
<p>Add files to be staged (modifications to be done)</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb114"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add files to the staging area so that it may be committed later</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add file1</span></code></pre></div>
</div>
<p>When another change in file1 was done, then it has to be staged again
to be committed</p>
<h3 id="reset">reset</h3>
<p>When unstaging should be done, use <code>git reset</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb115"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset <span class="co"># unstage all</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset HEAD <span class="co"># same</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset file1 <span class="co"># undo staging file1 </span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset HEAD file1 <span class="co"># same</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> reset HEAD <span class="at">--</span> file1 <span class="co"># same</span></span></code></pre></div>
</div>
<h3 id="checkout">checkout</h3>
<p>Checkout is like loading the (specific) saved version, discarding new
changes made, while committing is saving the current version. Undo the
changes that you made since the last commit. When modified file(s)
should not be staged, use <code>git checkout</code>.</p>
When modify a file but would not want to stage the modifications made,
use git checkout
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb116"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout file1 <span class="co"># remove unstaged modification and load the last committed version</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout <span class="at">--</span> file1 <span class="co"># be careful that -- should be spaced between </span></span></code></pre></div>
</div>
It can be used to go back further into the files history.
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb117"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> checkout hash file1 <span class="co"># load the specific history version of the file, removing changes that were made after this.</span></span></code></pre></div>
</div>
<h3 id="commit">commit</h3>
<p>Making commitment to the github</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb118"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="co"># commit it</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">&quot;Commitment Message&quot;</span> <span class="co"># add commitment message to it</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">--amend</span> <span class="at">-m</span> <span class="st">&quot;Amend the message I just committed&quot;</span> <span class="co"># to amend the commit just made</span></span></code></pre></div>
</div>
<h3 id="log">log</h3>
<p>Browsing the log of git</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb119"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> log <span class="co"># show the most recent git committments with commitment messages. The most recent one is on the top</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> log file1 <span class="co"># show only git commits related to the file1</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> log <span class="at">-2</span> file1 <span class="co">#show most recent 2 commits of file1</span></span></code></pre></div>
</div>
<h3 id="show">show</h3>
<p>Browse specific commit by its hash</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb120"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> show someHash <span class="co">#View specific commit by its hash, with some initial characters of hash</span></span></code></pre></div>
</div>
See the change of the file in detail: who changed when, what in a file
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb121"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> annotate file1</span></code></pre></div>
</div>
<h3 id="remove">remove</h3>
Clean (remove) files that are not staged
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb122"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clean <span class="at">-n</span> <span class="co"># list of files that are in the repository, but untracked - currently it does not have any history.</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clean <span class="at">-f</span> <span class="co"># delete those untracked file in the repository</span></span></code></pre></div>
</div>
<h2 id="ignore-files">Ignore files</h2>
<p>generate .gitignore file to make exceptions</p>
<p>To create list of files that git should ignore : generate .gitignore
file such as</p>
<pre><code>foldername
*.mpl</code></pre>
<h2 id="config-1">Config</h2>
<p>Show config setting</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb124"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--list</span> <span class="co"># lists all the custom configs</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--list</span> <span class="at">--local</span> <span class="co"># for the specific project (repo)</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--list</span> <span class="at">--global</span> <span class="co"># for every projects</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--list</span> <span class="at">--system</span> <span class="co"># for the system, every user of this computer</span></span></code></pre></div>
</div>
<p>Set config</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb125"><pre class="sourceCode zsh"><code class="sourceCode zsh"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set name and email address globally</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.name John Doe <span class="co"># set user name as John Doe</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> config <span class="at">--global</span> user.email address@gmail.com <span class="co"># set user email address</span></span></code></pre></div>
</div>
<h1 id="gmailr">GmailR</h1>
<p><a href="http://console.developers.google.com/" class="uri">http://console.developers.google.com/</a></p>
<p>and setup Gmail API &amp; Credentials (OAuth -&gt; get client ID and
pwd in json file)</p>
<p>It is TESTing mode when created -&gt; Change it into production
mode.</p>
<h2 id="install">Install</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">&#39;gmailr&#39;</span><span class="op">)</span></span></code></pre>
</div>
</div>
<h2 id="usage">Usage</h2>
<p>client_secret.json : downloaded from the google cloud platform
console.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gmailr.r-lib.org">gmailr</a></span><span class="op">)</span></span>
<span><span class="fu">gm_auth_configure</span><span class="op">(</span>path <span class="op">=</span> <span class="st">&#39;~/Dropbox (UFL)/Data Workshop/R/client_secret.json&#39;</span><span class="op">)</span></span>
<span><span class="op">?</span><span class="va">gm_auth_configure</span></span></code></pre>
</div>
</div>
<p>Send email</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class="va">email_message</span> <span class="op">=</span> </span>
<span>  <span class="fu">gm_mime</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">gm_to</span><span class="op">(</span><span class="st">&#39;gsist156@gmail.com&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="co"># gm_from(&#39;mgson633@gmail.com&#39;) %&gt;%  #doesn&#39;t work actually.</span></span>
<span>  <span class="fu">gm_subject</span><span class="op">(</span><span class="st">&#39;Test message&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">gm_text_body</span><span class="op">(</span><span class="st">&#39;This is the body&#39;</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">gm_attach_file</span><span class="op">(</span><span class="st">&#39;~/Dropbox (UFL)/Data Workshop/R/R_CookBook.nb.html&#39;</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gm_send_message</span><span class="op">(</span><span class="va">email_message</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
